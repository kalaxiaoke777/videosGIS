/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.21/esri/copyright.txt for details.
*/
import{_ as t}from"./tslib.es6.js";import s,{b as r,c as e,n as i}from"../core/Accessor.js";import{clone as o,a as n}from"../core/lang.js";import{b as a}from"./JSONSupport.js";import{g as h}from"./metadata.js";import{subclass as c}from"../core/accessorSupport/decorators/subclass.js";class g{constructor(){this._propertyOriginMap=new Map,this._originStores=new Array(r),this._values=new Map}clone(t){const s=new g,e=this._originStores[0];e&&e.forEach(((t,r)=>{s.set(r,o(t),0)}));for(let e=2;e<r;e++){const r=this._originStores[e];r&&r.forEach(((r,i)=>{t&&t.has(i)||s.set(i,o(r),e)}))}return s}get(t,s){const r=void 0===s?this._values:this._originStores[s];return r?r.get(t):void 0}keys(t){const s=null==t?this._values:this._originStores[t];return s?[...s.keys()]:[]}set(t,s,r=6){let e=this._originStores[r];if(e||(e=new Map,this._originStores[r]=e),e.set(t,s),!this._values.has(t)||n(this._propertyOriginMap.get(t))<=r){const e=this._values.get(t);return this._values.set(t,s),this._propertyOriginMap.set(t,r),e!==s}return!1}delete(t,s=6){const r=this._originStores[s];if(!r)return;const e=r.get(t);if(r.delete(t),this._values.has(t)&&this._propertyOriginMap.get(t)===s){this._values.delete(t);for(let r=s-1;r>=0;r--){const s=this._originStores[r];if(s&&s.has(t)){this._values.set(t,s.get(t)),this._propertyOriginMap.set(t,r);break}}}return e}has(t,s){const r=void 0===s?this._values:this._originStores[s];return!!r&&r.has(t)}revert(t,s){for(;s>0&&!this.has(t,s);)--s;const r=this._originStores[s],e=r&&r.get(t),i=this._values.get(t);return this._values.set(t,e),this._propertyOriginMap.set(t,s),i!==e}originOf(t){return this._propertyOriginMap.get(t)||0}forEach(t){this._values.forEach(t)}}const p=s=>{let r=class extends s{constructor(...t){super(...t);const s=n(h(this)),r=s.metadatas,e=s.store,i=new g;s.store=i,e.keys().forEach((t=>{i.set(t,e.get(t),0)})),Object.keys(r).forEach((t=>{s.internalGet(t)&&i.set(t,s.internalGet(t),0)}))}read(t,s){a(this,t,s)}getAtOrigin(t,s){const r=u(this),e=i(s);if("string"==typeof t)return r.get(t,e);const o={};return t.forEach((t=>{o[t]=r.get(t,e)})),o}originOf(t){return e(this.originIdOf(t))}originIdOf(t){return u(this).originOf(t)}revert(t,s){const r=u(this),e=i(s),o=h(this);let n;n="string"==typeof t?"*"===t?r.keys(e):[t]:t,n.forEach((t=>{o.invalidate(t),r.revert(t,e),o.commit(t)}))}};return r=t([c("esri.core.ReadOnlyMultiOriginJSONSupport")],r),r};function u(t){return h(t).store}let l=class extends(p(s)){};l=t([c("esri.core.ReadOnlyMultiOriginJSONSupport")],l);export{p as R};
