/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.21/esri/copyright.txt for details.
*/
import{d as n,g as t,f as r,k as c,b as e,a as o,s,c as u,A as a,n as i}from"./mathUtils.js";import{i as f}from"../core/lang.js";import"./sphere.js";import{b as g,a as m}from"./vectorStacks.js";function h(n=O){return[n[0],n[1],n[2],n[3]]}function p(n,t,r,c){return M(n,t,r,c,m.get())}function b(n,t=h()){return M(n[0],n[1],n[2],n[3],t)}function M(n,t,r,c,e=h()){return e[0]=n,e[1]=t,e[2]=r,e[3]=c,e}function d(n,t,r){return c(r,n),r[3]=t,r}function j(n,t,r){const c=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],e=Math.abs(c-1)>1e-5&&c>1e-12?1/Math.sqrt(c):1;return r[0]=t[0]*e,r[1]=t[1]*e,r[2]=t[2]*e,r[3]=-(r[0]*n[0]+r[1]*n[1]+r[2]*n[2]),r}function l(n,t,r,c=h()){const e=r[0]-t[0],o=r[1]-t[1],s=r[2]-t[2],u=n[0]-t[0],a=n[1]-t[1],i=n[2]-t[2],f=o*i-s*a,g=s*u-e*i,m=e*a-o*u,p=f*f+g*g+m*m,b=Math.abs(p-1)>1e-5&&p>1e-12?1/Math.sqrt(p):1;c[0]=f*b,c[1]=g*b,c[2]=m*b,c[3]=-(c[0]*n[0]+c[1]*n[1]+c[2]*n[2])}function v(t,r,c,e,o){if(t.count<3)return!1;t.getVec(c,k);let u=e,f=!1;for(;u<t.count-1&&!f;)t.getVec(u,q),u++,f=!a(k,q);if(!f)return!1;for(u=Math.max(u,o),f=!1;u<t.count&&!f;)t.getVec(u,V),u++,s(x,k,q),i(x,x),s(w,q,V),i(w,w),f=!a(k,V)&&!a(q,V)&&Math.abs(n(x,w))<y;return f?(l(k,q,V,r),!0):(0!==c||1!==e||2!==o)&&v(t,r,0,1,2)}const y=.99619469809,k=e(),q=e(),V=e(),x=e(),w=e();function A(t,r,c){return t!==c&&b(t,c),c[3]=-n(c,r),c}function S(n,t){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=-n[3],t}function U(n,t,r,c){return o(V,t,n),j(r,V,c)}function z(n,t,r,c){return L(n,t,s(g.get(),r,t),P,c)}function B(n,t,r){return!!f(t)&&L(n,t.origin,t.direction,Q,r)}function C(n,t,r){return L(n,t.origin,t.vector,0,r)}function D(n,t,r){return L(n,t.origin,t.vector,1,r)}function E(n,t){return K(n,t)>=0}function F(n,t){const r=t[0],c=t[1],e=t[2],o=t[3],s=t[4],u=t[5];return n[0]*(n[0]>0?r:o)+n[1]*(n[1]>0?c:s)+n[2]*(n[2]>0?e:u)+n[3]>=0}function G(t,r){const c=n(t,r.ray.direction),e=-K(t,r.ray.origin);if(e<0&&c>=0)return!1;if(c>-1e-6&&c<1e-6)return e>0;if((e<0||c<0)&&!(e<0&&c<0))return!0;const o=e/c;return c>0?o<r.c1&&(r.c1=o):o>r.c0&&(r.c0=o),r.c0<=r.c1}function H(t,r){const c=n(t,r.ray.direction),e=-K(t,r.ray.origin);if(c>-1e-6&&c<1e-6)return e>0;const o=e/c;return c>0?o<r.c1&&(r.c1=o):o>r.c0&&(r.c0=o),r.c0<=r.c1}function I(n,c,e){const o=r(g.get(),n,-n[3]),u=J(n,s(g.get(),c,o),g.get());return t(e,u,o),e}function J(t,c,e){const o=r(g.get(),t,n(t,c));return s(e,c,o),e}function K(t,r){return n(t,r)+t[3]}function L(c,e,o,s,a){const i=n(c,o);if(0===i)return!1;let f=-(n(c,e)+c[3])/i;return 1&s&&(f=u(f,0,1)),!(!(4&s)&&f<0||!(8&s)&&f>1)&&(t(a,e,r(a,o,f)),!0)}function N(n){return n}const O=[0,0,1,0],P=12,Q=8;export{b as a,H as b,h as c,G as d,U as e,l as f,E as g,M as h,F as i,B as j,C as k,D as l,A as m,N as n,d as o,I as p,j as q,S as r,K as s,J as t,v as u,z as v,p as w};
