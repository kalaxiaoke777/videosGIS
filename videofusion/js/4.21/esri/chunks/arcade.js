// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.21/esri/copyright.txt for details.
//>>built
define("require exports ../arcade/arcadeCompiler ../arcade/arcadeRuntime ../arcade/parser ../arcade/treeAnalysis ../core/has ../core/promiseUtils".split(" "),function(f,c,g,l,h,q,v,r){function J(a,b){return!0===b.useAsync||!0===a.isAsync?Y(a,b):v("csp-restrictions")?function(d){return l.executeScript(a,d)}:g.compileScript(a,b)}function Y(a,b){if(null===e)throw Error("Async Arcade must be enabled for this script");return v("csp-restrictions")||!1===Z?function(d){return e.executeScript(a,d)}:g.compileScript(a,
b,!0)}function K(a){l.extend(a);g.extend(a,"sync");null===e?w.push(a):(g.extend(a,"async"),e.extend(a))}function x(a,b=[]){return h.parseScript(a,b)}function L(a,b,d=""){return h.validateScript(a,b,d)}function M(a,b,d,k=""){return h.scriptCheck(a,b,d,k)}function N(a,b,d=[]){a=h.parseScript(a,d);return y(a,b)}function y(a,b){if(!0===b.useAsync||!0===a.isAsync){if(null===e)throw Error("Async Arcade must be enabled for this script");return e.executeScript(a,b)}return l.executeScript(a,b)}function z(a,
b){return l.referencesMember(a,b)}function O(a,b){return l.referencesFunction(a,b)}function P(a,b){return h.extractFieldLiterals(a)}function Q(a){return h.extractExpectedFieldLiterals(a)}function t(a,b=[]){void 0===a.usesGeometry&&q.findScriptDependencies(a,b);return!0===a.usesGeometry}function A(){return B?B:B=r.all([new Promise(function(a,b){f(["../geometry/geometryEngine"],a,b)}),new Promise(function(a,b){f(["../arcade/functions/geomsync"],a,b)})]).then(([a,b])=>{C=!0;b.setGeometryEngine(a);return!0})}
function u(){return null!==D?D:D=g.enableAsyncSupport().then(()=>new Promise(function(a,b){f(["../arcade/arcadeAsyncRuntime"],a,b)})).then(a=>{e=a;for(const b of w)e.extend(b),g.extend(b,"async");w=null;return!0})}function R(){return E}function F(){return e?!0:!1}function S(){return C}function G(){return H?H:H=u().then(()=>r.all([new Promise(function(a,b){f(["../arcade/featureSetUtils"],a,b)}),new Promise(function(a,b){f(["../arcade/functions/featuresetbase"],a,b)}),new Promise(function(a,b){f(["../arcade/functions/featuresetgeom"],
a,b)}),new Promise(function(a,b){f(["../arcade/functions/featuresetstats"],a,b)}),new Promise(function(a,b){f(["../arcade/functions/featuresetstring"],a,b)})]).then(([a,b,d,k,m])=>{T=a;e.extend([b,d,k,m]);g.extend([b,d,k,m],"async");return E=!0}))}function I(a,b=[]){void 0===a.usesFeatureSet&&q.findScriptDependencies(a,b);return!0===a.usesFeatureSet}function U(a,b=[]){void 0===a.isAsync&&q.findScriptDependencies(a,b);return!0===a.isAsync}function aa(a,b){if(b)for(const d of b)if(z(a,d))return!0;return!1}
function V(a,b,d=[],k=!1){return r.create((m,ba)=>{const n="string"===typeof a?x(a):a,p=[];n&&(!1===C&&(t(n)||k)&&p.push(A()),!1===F()&&(!0===n.isAsync||b)&&p.push(u()),!1===E&&(I(n)||aa(n,d))&&p.push(G()));p.length?r.all(p).then(()=>{m(!0)},ba):m(!0)})}function W(a){if(t(a))return!0;a=q.findFunctionCalls(a);let b=!1;for(let d=0;d<a.length;d++)if(-1<ca.indexOf(a[d])){b=!0;break}return b}function X(){return T}const ca="feature angle bearing centroid envelopeintersects extent geometry isselfintersecting ringisclockwise".split(" "),
Z=function(){if(v("csp-restrictions"))return!1;try{return(new Function("function* test() {}; return true"))()}catch(a){return!1}}();let E=!1,C=!1,e=null,w=[],B=null,D=null,H=null,T=null;var da=Object.freeze({__proto__:null,compileScript:J,extend:K,parseScript:x,validateScript:L,scriptCheck:M,parseAndExecuteScript:N,executeScript:y,referencesMember:z,referencesFunction:O,extractFieldLiterals:P,extractExpectedFieldLiterals:Q,scriptUsesGeometryEngine:t,enableGeometrySupport:A,enableAsyncSupport:u,isFeatureSetSupportEnabled:R,
isAsyncEnabled:F,isGeometryEnabled:S,enableFeatureSetSupport:G,scriptUsesFeatureSet:I,scriptIsAsync:U,loadScriptDependencies:V,scriptTouchesGeometry:W,featureSetUtils:X});c.arcade=da;c.compileScript=J;c.enableAsyncSupport=u;c.enableFeatureSetSupport=G;c.enableGeometrySupport=A;c.executeScript=y;c.extend=K;c.extractExpectedFieldLiterals=Q;c.extractFieldLiterals=P;c.featureSetUtils=X;c.isAsyncEnabled=F;c.isFeatureSetSupportEnabled=R;c.isGeometryEnabled=S;c.loadScriptDependencies=V;c.parseAndExecuteScript=
N;c.parseScript=x;c.referencesFunction=O;c.referencesMember=z;c.scriptCheck=M;c.scriptIsAsync=U;c.scriptTouchesGeometry=W;c.scriptUsesFeatureSet=I;c.scriptUsesGeometryEngine=t;c.validateScript=L});