// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.21/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/mixins/ArcGISCachedService":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../support/serviceTileInfoProperty ../support/TilemapCache ../../geometry/SpatialReference".split(" "),function(l,u,q,b,g,h,d,f,n,
c,m,y,J){l.ArcGISCachedService=E=>{E=function(G){function C(){var D=G.apply(this,arguments)||this;D.copyright=null;D.minScale=0;D.maxScale=0;D.spatialReference=null;D.tileInfo=null;D.tilemapCache=null;return D}u._inheritsLoose(C,G);var N=C.prototype;N.readMinScale=function(D,K){return null!=K.minLOD&&null!=K.maxLOD?D:0};N.readMaxScale=function(D,K){return null!=K.minLOD&&null!=K.maxLOD?D:0};N.readTilemapCache=function(D,K){return K.capabilities&&-1<K.capabilities.indexOf("Tilemap")?new y.TilemapCache({layer:this}):
null};u._createClass(C,[{key:"supportsBlankTile",get:function(){return 10.2<=this.version}}]);return C}(E);q.__decorate([g.property({json:{read:{source:"copyrightText"}}})],E.prototype,"copyright",void 0);q.__decorate([g.property()],E.prototype,"minScale",void 0);q.__decorate([n.reader("service","minScale")],E.prototype,"readMinScale",null);q.__decorate([g.property()],E.prototype,"maxScale",void 0);q.__decorate([n.reader("service","maxScale")],E.prototype,"readMaxScale",null);q.__decorate([g.property({type:J})],
E.prototype,"spatialReference",void 0);q.__decorate([g.property({readOnly:!0})],E.prototype,"supportsBlankTile",null);q.__decorate([g.property(m.serviceTileInfoProperty)],E.prototype,"tileInfo",void 0);q.__decorate([g.property()],E.prototype,"tilemapCache",void 0);q.__decorate([n.reader("service","tilemapCache",["capabilities"])],E.prototype,"readTilemapCache",null);q.__decorate([g.property()],E.prototype,"version",void 0);return E=q.__decorate([c.subclass("esri.layers.mixins.ArcGISCachedService")],
E)};Object.defineProperty(l,"__esModule",{value:!0})})},"esri/layers/support/serviceTileInfoProperty":function(){define(["exports","./TileInfo"],function(l,u){function q(g,h,d,f){if(!g)return null;const {minScale:n,maxScale:c,minLOD:m,maxLOD:y}=h;if(null!=m&&null!=y)return f&&f.ignoreMinMaxLOD?u.fromJSON(g):u.fromJSON({...g,lods:g.lods.filter(({level:J})=>null!=J&&J>=m&&J<=y)});if(0!==n&&0!==c){const J=n?Math.round(1E4*n)/1E4:Infinity,E=c?Math.round(1E4*c)/1E4:-Infinity;return u.fromJSON({...g,lods:g.lods.filter(G=>
{G=Math.round(1E4*G.scale)/1E4;return G<=J&&G>=E})})}return u.fromJSON(g)}const b={type:u,json:{origins:{service:{read:{source:["tileInfo","minScale","maxScale","minLOD","maxLOD"],reader:q}}}}};l.readServiceTileInfo=q;l.serviceTileInfoProperty=b;Object.defineProperty(l,"__esModule",{value:!0})})},"esri/layers/support/TileInfo":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/maybe ../../core/unitUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../geometry/Point ../../geometry/SpatialReference ../../geometry/support/aaBoundingRect ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ./LOD".split(" "),
function(l,u,q,b,g,h,d,f,n,c,m,y,J,E,G,C,N,D,K){var B;q=new q.JSONMap({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});b=B=function(z){function r(x){x=z.call(this,x)||this;x.dpi=96;x.format=null;x.origin=null;x.minScale=0;x.maxScale=0;x.size=null;x.spatialReference=null;return x}l._inheritsLoose(r,z);r.create=function(x=
{}){const {resolutionFactor:t=1,scales:A,size:L=256,spatialReference:F=G.WebMercator,numLODs:O=24}=x;if(!N.isValid(F)){x=[];if(A)for(var Q=0;Q<A.length;Q++){var R=A[Q];x.push({level:Q,scale:R,resolution:R})}else for(Q=5E-4,R=O-1;0<=R;R--)x.unshift({level:R,scale:Q,resolution:Q}),Q*=2;return new B({dpi:96,lods:x,origin:new E(0,0,F),size:[L,L],spatialReference:F})}Q=N.getInfo(F);x=x.origin?new E({x:x.origin.x,y:x.origin.y,spatialReference:F}):Q?new E({x:Q.origin[0],y:Q.origin[1],spatialReference:F}):
new E({x:0,y:0,spatialReference:F});Q=1/(39.37*h.getMetersPerUnitForSR(F)*96);R=[];if(A)for(var V=0;V<A.length;V++){var U=A[V];R.push({level:V,scale:U,resolution:U*Q})}else{var W=N.isGeographic(F)?512/L*5.916575275917094E8:256/L*5.91657527591555E8;V=Math.ceil(O/t);R.push({level:0,scale:W,resolution:W*Q});for(U=1;U<V;U++)W/=2**t,R.push({level:U,scale:W,resolution:W*Q})}return new B({dpi:96,lods:R,origin:x,size:[L,L],spatialReference:F})};var w=r.prototype;w.readOrigin=function(x,t){return E.fromJSON({spatialReference:t.spatialReference,
...x})};w.readSize=function(x,t){return[t.cols,t.rows]};w.writeSize=function(x,t){t.cols=x[0];t.rows=x[1]};w.zoomToScale=function(x){const t=this.scales;if(0>=x)return t[0];if(x>=t.length-1)return t[t.length-1];{const A=Math.floor(x);return t[A]/(t[A]/t[A+1])**(x-A)}};w.scaleToZoom=function(x){const t=this.scales,A=t.length-1;let L=0;for(;L<A;L++){const F=t[L],O=t[L+1];if(F<=x)break;if(O===x)return L+1;if(F>x&&O<x)return L+Math.log(F/x)/Math.log(F/O)}return L};w.snapScale=function(x,t=.95){x=this.scaleToZoom(x);
return x%Math.floor(x)>=t?this.zoomToScale(Math.ceil(x)):this.zoomToScale(Math.floor(x))};w.tileAt=function(x,t,A,L){var F=this.lodAt(x);if(!F)return null;let O;if("number"===typeof t)O=t,t=A;else{if(N.equals(t.spatialReference,this.spatialReference))O=t.x,t=t.y;else{L=D.project(t,this.spatialReference);if(g.isNone(L))return null;O=L.x;t=L.y}L=A}A=F.resolution*this.size[0];F=F.resolution*this.size[1];L||(L={id:null,level:0,row:0,col:0,extent:C.create()});L.level=x;L.row=Math.floor((this.origin.y-
t)/F+.001);L.col=Math.floor((O-this.origin.x)/A+.001);this.updateTileInfo(L);return L};w.updateTileInfo=function(x,t=0){var A=this.lodAt(x.level);A||1!==t||(t=this.lods[this.lods.length-1],t.level<x.level&&(A=t));if(A){var L=x.level-A.level;t=A.resolution*this.size[0]/2**L;A=A.resolution*this.size[1]/2**L;x.id=`${x.level}/${x.row}/${x.col}`;x.extent||(x.extent=C.create());x.extent[0]=this.origin.x+x.col*t;x.extent[1]=this.origin.y-(x.row+1)*A;x.extent[2]=x.extent[0]+t;x.extent[3]=x.extent[1]+A}};
w.upsampleTile=function(x){const t=this._upsampleLevels[x.level];if(!t||-1===t.parentLevel)return!1;x.level=t.parentLevel;x.row=Math.floor(x.row/t.factor+.001);x.col=Math.floor(x.col/t.factor+.001);this.updateTileInfo(x);return!0};w.getTileBounds=function(x,t){var {resolution:A}=this.lodAt(t.level);const L=A*this.size[0];A*=this.size[1];x[0]=this.origin.x+t.col*L;x[1]=this.origin.y-(t.row+1)*A;x[2]=x[0]+L;x[3]=x[1]+A;return x};w.lodAt=function(x){return this._levelToLOD&&this._levelToLOD[x]||null};
w.clone=function(){return B.fromJSON(this.write({}))};w._initializeUpsampleLevels=function(){const x=this.lods;this._upsampleLevels=[];let t=null;for(let A=0;A<x.length;A++){const L=x[A];this._upsampleLevels[L.level]={parentLevel:t?t.level:-1,factor:t?t.resolution/L.resolution:0};t=L}};l._createClass(r,[{key:"isWrappable",get:function(){const {spatialReference:x,origin:t}=this;if(x&&t){const A=N.getInfo(x);return x.isWrappable&&Math.abs(A.origin[0]-t.x)<=A.dx}return!1}},{key:"lods",set:function(x){let t=
0,A=0;const L=[];this._levelToLOD={};x&&(t=-Infinity,A=Infinity,x.forEach(F=>{L.push(F.scale);t=F.scale>t?F.scale:t;A=F.scale<A?F.scale:A;this._levelToLOD[F.level]=F}));this._set("scales",L);this._set("minScale",t);this._set("maxScale",A);this._set("lods",x);this._initializeUpsampleLevels()}}]);return r}(b.JSONSupport);u.__decorate([d.property({type:Number,json:{write:!0}})],b.prototype,"compressionQuality",void 0);u.__decorate([d.property({type:Number,json:{write:!0}})],b.prototype,"dpi",void 0);
u.__decorate([d.property({type:String,json:{read:q.read,write:q.write,origins:{"web-scene":{read:!1,write:!1}}}})],b.prototype,"format",void 0);u.__decorate([d.property({readOnly:!0})],b.prototype,"isWrappable",null);u.__decorate([d.property({type:E,json:{write:!0}})],b.prototype,"origin",void 0);u.__decorate([m.reader("origin")],b.prototype,"readOrigin",null);u.__decorate([d.property({type:[K],value:null,json:{write:!0}})],b.prototype,"lods",null);u.__decorate([d.property({readOnly:!0})],b.prototype,
"minScale",void 0);u.__decorate([d.property({readOnly:!0})],b.prototype,"maxScale",void 0);u.__decorate([d.property({readOnly:!0})],b.prototype,"scales",void 0);u.__decorate([d.property({cast:z=>Array.isArray(z)?z:"number"===typeof z?[z,z]:[256,256]})],b.prototype,"size",void 0);u.__decorate([m.reader("size",["rows","cols"])],b.prototype,"readSize",null);u.__decorate([J.writer("size",{cols:{type:n.Integer},rows:{type:n.Integer}})],b.prototype,"writeSize",null);u.__decorate([d.property({type:G,json:{write:!0}})],
b.prototype,"spatialReference",void 0);return b=B=u.__decorate([y.subclass("esri.layers.support.TileInfo")],b)})},"esri/layers/support/LOD":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/accessorSupport/decorators/subclass".split(" "),function(l,u,q,b,g,h,d,f){var n;q=n=function(c){function m(y){y=c.call(this,y)||
this;y.cols=null;y.level=0;y.levelValue=null;y.resolution=0;y.rows=null;y.scale=0;return y}l._inheritsLoose(m,c);m.prototype.clone=function(){return new n({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})};return m}(q.JSONSupport);u.__decorate([b.property({type:Number,json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],q.prototype,"cols",void 0);u.__decorate([b.property({type:h.Integer,
json:{write:!0}})],q.prototype,"level",void 0);u.__decorate([b.property({type:String,json:{write:!0}})],q.prototype,"levelValue",void 0);u.__decorate([b.property({type:Number,json:{write:!0}})],q.prototype,"resolution",void 0);u.__decorate([b.property({type:Number,json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],q.prototype,"rows",void 0);u.__decorate([b.property({type:Number,json:{write:!0}})],q.prototype,"scale",void 0);return q=n=u.__decorate([f.subclass("esri.layers.support.LOD")],
q)})},"esri/layers/support/TilemapCache":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../request ../../core/Accessor ../../core/Error ../../core/Handles ../../core/Logger ../../core/LRUCache ../../core/PooledArray ../../core/promiseUtils ../../core/scheduling ../../core/urlUtils ../../core/watchUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/subclass ./Tilemap".split(" "),
function(l,u,q,b,g,h,d,f,n,c,m,y,J,E,G,C,N,D,K){var B;const z=f.getLogger("esri.layers.support.TilemapCache");l.TilemapCache=B=function(r){function w(t){t=r.call(this,t)||this;t._handles=new d;t._pendingTilemapRequests={};t._availableLevels={};t.levels=5;t.cacheByteSize=2097152;t.request=b;t._prefetchingEnabled=!0;return t}u._inheritsLoose(w,r);var x=w.prototype;x.initialize=function(){this._tilemapCache=new n(this.cacheByteSize);this._handles.add([this.watch(["layer.parsedUrl","layer.tileServers?"],
()=>this._initializeTilemapDefinition()),E.init(this,"layer.tileInfo.lods",t=>this._initializeAvailableLevels(t),!0)]);this._initializeTilemapDefinition()};x.destroy=function(){this._handles&&(this._handles.destroy(),this._handles=null)};x.castLevels=function(t){return 2>=t?(z.error("Minimum levels for Tilemap is 3, but got ",t),3):t};x.fetchTilemap=function(t,A,L,F){if(!this._availableLevels[t])return Promise.reject(new h("tilemap-cache:level-unavailable",`Level ${t} is unavailable in the service`));
const O=this._tmpTilemapDefinition;if(t=this._tilemapFromCache(t,A,L,O))return Promise.resolve(t);const Q=F&&F.signal;F={...F,signal:null};return new Promise((R,V)=>{m.onAbort(Q,()=>V(m.createAbortError()));const U=K.tilemapDefinitionId(O);let W=this._pendingTilemapRequests[U];if(!W){W=K.Tilemap.fromDefinition(O,F).then(da=>{this._tilemapCache.put(U,da,da.byteSize);return da});const ca=()=>delete this._pendingTilemapRequests[U];this._pendingTilemapRequests[U]=W;W.then(ca,ca)}W.then(R,V)})};x.getAvailability=
function(t,A,L){return this._availableLevels[t]?(t=this._tilemapFromCache(t,A,L,this._tmpTilemapDefinition))?t.getAvailability(A,L):"unknown":"unavailable"};x.getAvailabilityUpsample=function(t,A,L,F){F.level=t;F.row=A;F.col=L;t=this.layer.tileInfo;for(t.updateTileInfo(F);;)if(A=this.getAvailability(F.level,F.row,F.col),"unavailable"===A){if(!t.upsampleTile(F))return"unavailable"}else return A};x.fetchAvailability=function(t,A,L,F){return this._availableLevels[t]?this.fetchTilemap(t,A,L,F).catch(O=>
O).then(O=>{if(O instanceof K.Tilemap)return O=O.getAvailability(A,L),"unavailable"===O?Promise.reject(new h("tile-map:tile-unavailable","Tile is not available",{level:t,row:A,col:L})):O;if(m.isAbortError(O))throw O;return"unknown"}):Promise.reject(new h("tilemap-cache:level-unavailable",`Level ${t} is unavailable in the service`))};x.fetchAvailabilityUpsample=function(t,A,L,F,O){F.level=t;F.row=A;F.col=L;const Q=this.layer.tileInfo;Q.updateTileInfo(F);const R=this.fetchAvailability(t,A,L,O).catch(V=>
{if(m.isAbortError(V))throw V;if(Q.upsampleTile(F))return this.fetchAvailabilityUpsample(F.level,F.row,F.col,F);throw V;});this._fetchAvailabilityUpsamplePrefetch(F.id,t,A,L,O,R);return R};x._fetchAvailabilityUpsamplePrefetch=function(){var t=u._asyncToGenerator(function*(A,L,F,O,Q,R){if(this._prefetchingEnabled){var V=`prefetch-${A}`;if(!this._handles.has(V)){var U=m.createAbortController();R.then(()=>U.abort(),()=>U.abort());var W=!1;this._handles.add({remove(){W||(W=!0,U.abort())}},V);yield y.waitTicks(10,
U.signal).catch(()=>{});W||(W=!0,this._handles.remove(V));if(!m.isAborted(U))for(A={id:A,level:L,row:F,col:O},Q={...Q,signal:U.signal},L=this.layer.tileInfo,F=0;B._prefetches.length<B._maxPrefetch&&L.upsampleTile(A);++F){const ca=this.fetchAvailability(A.level,A.row,A.col,Q);B._prefetches.push(ca);O=()=>{B._prefetches.removeUnordered(ca)};ca.then(O,O)}}}});return function(A,L,F,O,Q,R){return t.apply(this,arguments)}}();x._initializeTilemapDefinition=function(){if(this.layer.parsedUrl){var t=this.layer.parsedUrl,
A=t.query;this._tilemapCache.clear();this._tmpTilemapDefinition={service:{url:t.path,query:A?J.objectToQuery(A):null,tileServers:this.layer.tileServers,request:this.request,type:this.layer.type},width:this.size,height:this.size,level:0,row:0,col:0}}};x._tilemapFromCache=function(t,A,L,F){F.level=t;F.row=A-A%this.size;F.col=L-L%this.size;t=K.tilemapDefinitionId(F);return this._tilemapCache.get(t)};x._initializeAvailableLevels=function(t){this._availableLevels={};t&&t.forEach(A=>this._availableLevels[A.level]=
!0)};u._createClass(w,[{key:"size",get:function(){return 1<<this.levels}},{key:"test",get:function(){const t=this;return{get prefetchingEnabled(){return t._prefetchingEnabled},set prefetchingEnabled(A){t._prefetchingEnabled=A},hasTilemap(A,L,F){return!!t._tilemapFromCache(A,L,F,t._tmpTilemapDefinition)}}}}]);return w}(g);l.TilemapCache._maxPrefetch=4;l.TilemapCache._prefetches=new c({initialSize:B._maxPrefetch});q.__decorate([G.property({constructOnly:!0,type:Number})],l.TilemapCache.prototype,"levels",
void 0);q.__decorate([N.cast("levels")],l.TilemapCache.prototype,"castLevels",null);q.__decorate([G.property({readOnly:!0,type:Number})],l.TilemapCache.prototype,"size",null);q.__decorate([G.property({constructOnly:!0,type:Number})],l.TilemapCache.prototype,"cacheByteSize",void 0);q.__decorate([G.property({constructOnly:!0})],l.TilemapCache.prototype,"layer",void 0);q.__decorate([G.property({constructOnly:!0})],l.TilemapCache.prototype,"request",void 0);l.TilemapCache=B=q.__decorate([D.subclass("esri.layers.support.TilemapCache")],
l.TilemapCache);Object.defineProperty(l,"__esModule",{value:!0})})},"esri/layers/support/Tilemap":function(){define(["exports","../../request","../../core/arrayUtils","../../core/Error","../../core/lang"],function(l,u,q,b,g){function h(f){if("vector-tile"===f.service.type)var n=`${f.service.url}/tilemap/${f.level}/${f.row}/${f.col}/${f.width}/${f.height}`;else n=f.service.tileServers,n=`${n&&n.length?n[f.row%n.length]:f.service.url}/tilemap/${f.level}/${f.row}/${f.col}/${f.width}/${f.height}`;(f=
f.service.query)&&(n=`${n}?${f}`);return n}let d=function(){function f(){this.location={left:0,top:0,width:0,height:0};this._allAvailability="unknown";this.byteSize=40}var n=f.prototype;n.getAvailability=function(c,m){if("unknown"!==this._allAvailability)return this._allAvailability;c=(c-this.location.top)*this.location.width+(m-this.location.left);m=c>>3;const y=this._tileAvailabilityBitSet;return 0>m||m>y.length?"unknown":y[m]&1<<c%8?"available":"unavailable"};n._updateFromData=function(c){let m=
!0,y=!0;const J=new Uint8Array(Math.ceil(this.location.width*this.location.height/8));let E=0;for(let G=0;G<c.length;G++){const C=G%8;c[G]?(y=!1,J[E]|=1<<C):m=!1;7===C&&++E}y?this._allAvailability="unavailable":m?this._allAvailability="available":(this._allAvailability="unknown",this._tileAvailabilityBitSet=J,this.byteSize+=J.length)};f.fromDefinition=function(c,m){const y=c.service.request||u,{row:J,col:E,width:G,height:C}=c,N={query:{f:"json"}};m=m?{...N,...m}:N;return y(h(c),m).then(D=>D.data).catch(D=>
{if(D&&D.details&&422===D.details.httpStatus)return{location:{top:J,left:E,width:G,height:C},valid:!0,data:q.constant(G*C,0)};throw D;}).then(D=>{if(D.location&&(D.location.top!==J||D.location.left!==E||D.location.width!==G||D.location.height!==C))throw new b("tilemap:location-mismatch","Tilemap response for different location than requested",{response:D,definition:{top:J,left:E,width:G,height:C}});return f.fromJSON(D)})};f.fromJSON=function(c){f.validateJSON(c);const m=new f;m.location=Object.freeze(g.clone(c.location));
m._updateFromData(c.data);return Object.freeze(m)};f.validateJSON=function(c){if(!c||!c.location)throw new b("tilemap:missing-location","Location missing from tilemap response");if(!1===c.valid)throw new b("tilemap:invalid","Tilemap response was marked as invalid");if(!c.data)throw new b("tilemap:missing-data","Data missing from tilemap response");if(!Array.isArray(c.data))throw new b("tilemap:data-mismatch","Data must be an array of numbers");if(c.data.length!==c.location.width*c.location.height)throw new b("tilemap:data-mismatch",
"Number of data items does not match width/height of tilemap");};return f}();l.Tilemap=d;l["default"]=d;l.tilemapDefinitionId=function(f){return`${f.level}/${f.row}/${f.col}/${f.width}/${f.height}`};Object.defineProperty(l,"__esModule",{value:!0})})},"esri/layers/support/imageUtils":function(){define(["exports"],function(l){l.checkWebPSupport=function(u){const q={lossy:"UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",lossless:"UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA\x3d\x3d",alpha:"UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA\x3d\x3d",
animation:"UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA"};return new Promise(b=>{const g=new Image;g.onload=()=>{g.onload=g.onerror=null;b(0<g.width&&0<g.height)};g.onerror=()=>{g.onload=g.onerror=null;b(!1)};g.src="data:image/webp;base64,"+q[u]})};Object.defineProperty(l,"__esModule",{value:!0})})},"esri/layers/support/SpriteSource":function(){define(["../../chunks/_rollupPluginBabelHelpers","../../request","../../core/Error",
"../../core/Logger","../../core/urlUtils"],function(l,u,q,b,g){const h=b.getLogger("esri.layers.support.SpriteSource");return function(){function d(n,c,m,y){this.baseURL=n;this.devicePixelRatio=c;this.maxTextureSize=m;this._spriteImageFormat=y;this._isRetina=!1;this._spritesData={};this.height=this.width=this.image=null;this.loadStatus="not-loaded"}var f=d.prototype;f.getSpriteInfo=function(n){return this._spritesData[n]};f.load=function(){var n=l._asyncToGenerator(function*(c){if(this.baseURL){this.loadStatus=
"loading";try{yield this._loadSprites(c),this.loadStatus="loaded"}catch{this.loadStatus="failed"}}else this.loadStatus="failed"});return function(c){return n.apply(this,arguments)}}();f._loadSprites=function(n){this._isRetina=1.15<this.devicePixelRatio?!0:!1;const c=g.urlToObject(this.baseURL),m=c.query?"?"+g.objectToQuery(c.query):"",y=this._isRetina?"@2x":"",J=`${c.path}${y}.${this._spriteImageFormat}${m}`;return Promise.all([u(`${c.path}${y}.json${m}`,n),u(J,{responseType:"image",...n})]).then(([E,
G])=>{var C=Object.keys(E.data);if(!C||0===C.length||1===C.length&&"_ssl"===C[0]||!G||!G.data)return this._spritesData=this.image=null,this.width=this.height=0,Promise.resolve(null);this._spritesData=E.data;E=G.data;G=Math.max(this.maxTextureSize,4096);if(E.width>G||E.height>G)throw E=`Sprite resource for style ${c.path} is bigger than the maximum allowed of ${G} pixels}`,h.error(E),new q("SpriteSource",E);this.width=E.width;this.height=E.height;G=document.createElement("canvas");C=G.getContext("2d");
G.width=E.width;G.height=E.height;C.drawImage(E,0,0,E.width,E.height);E=C.getImageData(0,0,E.width,E.height);E=new Uint8Array(E.data);for(C=0;C<E.length;C+=4)G=E[C+3]/255,E[C]*=G,E[C+1]*=G,E[C+2]*=G;this.image=E})};l._createClass(d,[{key:"spriteNames",get:function(){const n=[];for(const c in this._spritesData)n.push(c);n.sort();return n}}]);return d}()})},"esri/layers/support/vectorTileLayerLoader":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../config ../../request ../../core/promiseUtils ../../core/urlUtils ../../views/2d/engine/vectorTiles/style/VectorTileSource".split(" "),
function(l,u,q,b,g,h,d){function f(){f=u._asyncToGenerator(function*(D,K){const B={source:null,sourceBase:null,sourceUrl:null,validatedSource:null,style:null,styleBase:null,styleUrl:null,sourceNameToSource:{},primarySourceName:"",spriteFormat:"png"},[z,r]="string"===typeof D?[D,null]:[null,D.jsonUrl],w=z?h.urlToObject(z):null;yield m(B,"esri",D,r,K);D={layerDefinition:B.validatedSource,url:z,parsedUrl:w,serviceUrl:B.sourceUrl,style:B.style,styleUrl:B.styleUrl,spriteUrl:B.style.sprite&&c(B.styleBase,
B.style.sprite),spriteFormat:B.spriteFormat,glyphsUrl:B.style.glyphs&&c(B.styleBase,B.style.glyphs),sourceNameToSource:B.sourceNameToSource,primarySourceName:B.primarySourceName};n(D.spriteUrl);n(D.glyphsUrl);return D});return f.apply(this,arguments)}function n(D){D&&(D=h.getOrigin(D),N&&-1===N.indexOf(D)&&N.push(D))}function c(...D){let K=void 0;for(let B=0;B<D.length;++B)h.isProtocolRelative(D[B])?K&&(K=K.split("://")[0]+":"+D[B].trim()):K=h.isAbsolute(D[B])?D[B]:h.join(K,D[B]);return h.removeTrailingSlash(K)}
function m(D,K,B,z,r){return y.apply(this,arguments)}function y(){y=u._asyncToGenerator(function*(D,K,B,z,r){g.throwIfAborted(r);if("string"===typeof B){z=h.normalize(B);n(z);var w=h.urlToObject(z);w=yield b(w.path,{query:{f:"json"},responseType:"json",...r});B=z}else w={data:B},B=B.jsonUrl||null;const x=w.data;w.ssl&&(B&&(B=B.replace(/^http:/i,"https:")),z&&(z=z.replace(/^http:/i,"https:")));return x.sources?(D.styleUrl=B||null,J(D,x,z,r)):x.sources?Promise.reject("You must specify the URL or the JSON for a service or for a style."):
D.sourceUrl?G(D,x,z,!1,K,r):(D.sourceUrl=B||null,G(D,x,z,!0,K,r))});return y.apply(this,arguments)}function J(D,K,B,z){return E.apply(this,arguments)}function E(){E=u._asyncToGenerator(function*(D,K,B,z){B=B?h.removeFile(B):h.appBaseUrl;D.styleBase=B;D.style=K;D.styleUrl&&n(D.styleUrl);K["sprite-format"]&&"webp"===K["sprite-format"].toLowerCase()&&(D.spriteFormat="webp");const r=[];if(K.sources&&K.sources.esri){const w=K.sources.esri;w.url?yield m(D,"esri",c(B,w.url),void 0,z):r.push(m(D,"esri",w,
B,z))}for(const w of Object.keys(K.sources))"esri"!==w&&"vector"===K.sources[w].type&&(K.sources[w].url?r.push(m(D,w,c(B,K.sources[w].url),void 0,z)):K.sources[w].tiles&&r.push(m(D,w,K.sources[w],B,z)));yield Promise.all(r)});return E.apply(this,arguments)}function G(D,K,B,z,r,w){return C.apply(this,arguments)}function C(){C=u._asyncToGenerator(function*(D,K,B,z,r,w){B=B?h.removeTrailingSlash(B)+"/":h.appBaseUrl;if(K.hasOwnProperty("tileInfo"))var x=K;else{var t={xmin:-2.0037507067161843E7,ymin:-2.0037507067161843E7,
xmax:2.0037507067161843E7,ymax:2.0037507067161843E7,spatialReference:{wkid:102100}},A=78271.51696400007,L=2.958287637957775E8,F=[],O=K.hasOwnProperty("minzoom")?parseFloat(K.minzoom):0,Q=K.hasOwnProperty("maxzoom")?parseFloat(K.maxzoom):22;for(let R=0;R<=Q;R++)R>=O&&F.push({level:R,scale:L,resolution:A}),A/=2,L/=2;for(x of K.tiles)n(c(B,x));x={capabilities:"TilesOnly",initialExtent:t,fullExtent:t,minScale:0,maxScale:0,tiles:K.tiles,tileInfo:{rows:512,cols:512,dpi:96,format:"pbf",origin:{x:-2.0037508342787E7,
y:2.0037508342787E7},lods:F,spatialReference:{wkid:102100}}}}t=new d(r,B,x);if(!z&&D.primarySourceName in D.sourceNameToSource){A=D.sourceNameToSource[D.primarySourceName];if(!A.isCompatibleWith(t))return Promise.resolve();null!=t.fullExtent&&(null!=A.fullExtent?A.fullExtent.union(t.fullExtent):A.fullExtent=t.fullExtent.clone());A.tileInfo.lods.length<t.tileInfo.lods.length&&(A.tileInfo=t.tileInfo)}z?(D.sourceBase=B,D.source=K,D.validatedSource=x,D.primarySourceName=r,D.sourceUrl&&n(D.sourceUrl)):
n(B);D.sourceNameToSource[r]=t;if(!D.style)return null==K.defaultStyles?Promise.reject():"string"===typeof K.defaultStyles?m(D,"",c(B,K.defaultStyles,"root.json"),void 0,w):m(D,"",K.defaultStyles,c(B,"root.json"),w)});return C.apply(this,arguments)}const N=q.defaults&&q.defaults.io.corsEnabledServers;l.loadMetadata=function(D,K){return f.apply(this,arguments)};Object.defineProperty(l,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/style/VectorTileSource":function(){define("../../../../../core/lang ../../../../../core/urlUtils ../../../../../geometry/Extent ../../../../../layers/support/serviceTileInfoProperty ../../../../../layers/support/TilemapCache ../TileIndex".split(" "),
function(l,u,q,b,g,h){return function(){function d(n,c,m){this.tileMapURL="";this.fullExtent=this.tileIndex=this.capabilities=this.tileInfo=this.parsedUrl=this.tilemapCache=null;this.name=n;if(this.sourceUrl=c)this.parsedUrl=u.urlToObject(this.sourceUrl);const y=this.parsedUrl.path,J=this.parsedUrl.query?"?"+u.objectToQuery(this.parsedUrl.query):"";n=l.clone(m);const E=n.tiles;c&&E.forEach((N,D)=>{u.isAbsolute(N)||(E[D]=u.join(y,N)+J)});this.tileServers=E;m.tileMap&&(this.tileMapURL=u.join(c,m.tileMap));
var G=m.capabilities&&m.capabilities.split(",").map(N=>N.toLowerCase().trim());c=!!m.exportTilesAllowed;G=!!G&&-1!==G.indexOf("tilemap");const C=c&&m.hasOwnProperty("maxExportTilesCount")?m.maxExportTilesCount:0;this.capabilities={operations:{supportsExportTiles:c,supportsTileMap:G},exportTiles:c?{maxExportTilesCount:+C}:null};this.tileInfo=b.readServiceTileInfo(n.tileInfo,n,null,{ignoreMinMaxLOD:!0});G&&(this.type="vector-tile",this.tilemapCache=new g.TilemapCache({layer:this}),this.tileIndex=new h(this.tilemapCache));
this.fullExtent=q.fromJSON(m.fullExtent)}var f=d.prototype;f.getRefKey=function(n,c){return this.tileIndex?this.tileIndex.dataKey(n,c):Promise.resolve(n)};f.getSourceTileUrl=function(n,c,m){let y=this.tileServers[c%this.tileServers.length];return y=y.replace(/\{z\}/gi,n.toString()).replace(/\{y\}/gi,c.toString()).replace(/\{x\}/gi,m.toString())};f.isCompatibleWith=function(n){var c=this.tileInfo;n=n.tileInfo;if(!c.spatialReference.equals(n.spatialReference)||!c.origin.equals(n.origin)||Math.round(c.dpi)!==
Math.round(n.dpi))return!1;c=c.lods;n=n.lods;const m=Math.min(c.length,n.length);for(let y=0;y<m;y++){const J=c[y],E=n[y];if(J.level!==E.level||Math.round(J.scale)!==Math.round(E.scale))return!1}return!0};return d}()})},"esri/views/2d/engine/vectorTiles/TileIndex":function(){define(["../../../../core/promiseUtils","../../../../layers/support/TilemapCache","../../tiling/TileKey"],function(l,u,q){return function(){function b(h){if(h instanceof u.TilemapCache)this._tilemapCache=h;else if(h&&"index"in
h)this._tilemap=h.index;else throw Error("Invalid tilemap!");}var g=b.prototype;g.dataKey=function(h,d){if(this._tilemapCache){const {level:f,row:n,col:c}=h,m=new q(h);return this._tilemapCache.fetchAvailabilityUpsample(f,n,c,m,d).then(()=>{m.world=h.world;return m}).catch(y=>{if(l.isAbortError(y))throw y;return null})}return this._getIndexedDataKey(h)};g.forEach=function(h,d,f,n,c){this._callback=c;this._maxLevel=d+h;this._forEach(this._tilemap,d,f,n)};g._forEach=function(h,d,f,n){0!==h&&(this._callback(d,
f,n),d!==this._maxLevel&&"object"===typeof h&&(this._forEach(h[0],d+1,2*f,2*n),this._forEach(h[1],d+1,2*f,2*n+1),this._forEach(h[2],d+1,2*f+1,2*n),this._forEach(h[3],d+1,2*f+1,2*n+1)))};g._getIndexedDataKey=function(h){const d=[h];if(0>h.level||0>h.row||0>h.col||0<h.row>>h.level||0<h.col>>h.level)return Promise.resolve(null);for(;0!==h.level;)h=new q(h.level-1,h.row>>1,h.col>>1,h.world),d.push(h);h=this._tilemap;let f=d.pop(),n,c;if(1===h)return Promise.resolve(f);for(;d.length;)if(n=d.pop(),c=(n.col&
1)+((n.row&1)<<1),h){if(0===h[c]){f=null;break}if(1===h[c]){f=n;break}f=n;h=h[c]}return Promise.resolve(f)};return b}()})},"esri/views/2d/tiling/TileKey":function(){define(["../../../chunks/_rollupPluginBabelHelpers","../../../core/ObjectPool"],function(l,u){let q=function(){function b(h,d,f,n){this.set(h,d,f,n)}b.getId=function(h,d,f,n){return"object"===typeof h?`${h.level}/${h.row}/${h.col}/${h.world}`:`${h}/${d}/${f}/${n}`};var g=b.prototype;g.acquire=function(h,d,f,n){this.set(h,d,f,n)};g.contains=
function(h){const d=h.level-this.level;return this.row===h.row>>d&&this.col===h.col>>d&&this.world===h.world};g.equals=function(h){return this.level===h.level&&this.row===h.row&&this.col===h.col&&this.world===h.world};g.clone=function(){return new b(this)};g.release=function(){this.world=this.col=this.row=this.level=0};g.set=function(h,d,f,n){if(null==h)this.world=this.col=this.row=this.level=0;else if("object"===typeof h)this.level=h.level||0,this.row=h.row||0,this.col=h.col||0,this.world=h.world||
0;else if("string"===typeof h){const [c,m,y,J]=h.split("/");this.level=parseFloat(c);this.row=parseFloat(m);this.col=parseFloat(y);this.world=parseFloat(J)}else this.level=+h,this.row=+d,this.col=+f,this.world=+n||0;return this};g.toString=function(){return`${this.level}/${this.row}/${this.col}/${this.world}`};g.getParentKey=function(){return 0>=this.level?null:new b(this.level-1,this.row>>1,this.col>>1,this.world)};g.getChildKeys=function(){const h=this.level+1,d=this.row<<1,f=this.col<<1,n=this.world;
return[new b(h,d,f,n),new b(h,d,f+1,n),new b(h,d+1,f,n),new b(h,d+1,f+1,n)]};g.compareRowMajor=function(h){return this.row<h.row?-1:this.row>h.row?1:this.col<h.col?-1:this.col>h.col?1:0};l._createClass(b,[{key:"key",get:function(){return this}},{key:"id",get:function(){return this.toString()},set:function(h){this.set(h)}},{key:"hash",get:function(){return(this.world&3)<<30|(this.col&4095)<<22|(this.row&4095)<<8|this.level&63}}]);return b}();q.pool=new u(q,null,null,25,50);return q})},"esri/views/2d/engine/vectorTiles/SchemaHelper":function(){define(["../../../../layers/support/LOD",
"../../../../layers/support/TileInfo"],function(l,u){return function(){function q(g,h){this.lockedSchemaPixelSize=g;this.isGCS=h}var b=q.prototype;b.getLevelRowColumn=function(g){return this.isGCS?[g[0],g[1]>>1,g[2]>>1]:256===this.lockedSchemaPixelSize&&0<g[0]?[g[0]-1,g[1]>>1,g[2]>>1]:g};b.adjustLevel=function(g){return this.isGCS?g:256===this.lockedSchemaPixelSize?0<g?g-1:0:g};b.getShift=function(g,h){let d=0,f=0;if(256===this.lockedSchemaPixelSize||this.isGCS)g[2]%2&&(d=h),g[1]%2&&(f=h);return[d,
f]};b.getScale=function(g){if(this.isGCS){if(512===this.lockedSchemaPixelSize)return 4}else if(256===this.lockedSchemaPixelSize&&0===g)return 1;return 2};q.create256x256CompatibleTileInfo=function(g){if(!g)return null;if(256===g.size[0]&&256===g.size[1])return g;const h=g.spatialReference.isGeographic,d=[],f=g.lods.length;for(let n=0;n<f;n++){const c=g.lods[n];d.push(new l({level:c.level,scale:c.scale,resolution:h?c.resolution:2*c.resolution}))}return new u({size:[256,256],dpi:g.dpi,format:g.format,
compressionQuality:g.compressionQuality,origin:g.origin,spatialReference:g.spatialReference,lods:d})};q.create512x512CompatibleTileInfo=function(g){if(!g||256===g.size[0]||256===g.size[1])return null;const h=[],d=g.lods.length;for(let f=0;f<d;f++){const n=g.lods[f];h.push(new l({level:n.level,scale:n.scale,resolution:.5*n.resolution}))}return new u({size:[512,512],dpi:g.dpi,format:g.format,compressionQuality:g.compressionQuality,origin:g.origin,spatialReference:g.spatialReference,lods:h})};return q}()})},
"esri/views/2d/engine/vectorTiles/tileInfoUtils":function(){define(["exports","../../../../layers/support/TileInfo"],function(l,u){l.areSchemasOverlapping=function(q,b){if(q===b)return!0;if(!q&&null!=b||null!=q&&!b||!q.spatialReference.equals(b.spatialReference)||q.dpi!==b.dpi)return!1;var g=q.origin;const h=b.origin;if(1E-6<=Math.abs(g.x-h.x)||1E-6<=Math.abs(g.y-h.y))return!1;q.lods[0].scale>b.lods[0].scale?(g=q,q=b):g=b;for(b=g.lods[0].scale;b>=q.lods[q.lods.length-1].scale-1E-6;b/=2)if(1E-6>Math.abs(b-
q.lods[0].scale))return!0;return!1};l.unionTileInfos=function(q,b){if(q===b)return q;if(!q&&null!=b)return b;if(null!=q&&!b)return q;const g=q.size[0],h=q.format,d=q.dpi,f={x:q.origin.x,y:q.origin.y},n=q.spatialReference.toJSON();var c=q.lods[0].scale>b.lods[0].scale?q.lods[0]:b.lods[0];q=(q.lods[q.lods.length-1].scale<=b.lods[b.lods.length-1].scale?q.lods[q.lods.length-1]:b.lods[b.lods.length-1]).scale;b=[];let m=c.scale;c=c.resolution;let y=0;for(;m>q;)b.push({level:y,resolution:c,scale:m}),y++,
m/=2,c/=2;return new u({size:[g,g],dpi:d,format:h||"pbf",origin:f,lods:b,spatialReference:n})};Object.defineProperty(l,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/style/StyleRepository":function(){define(["./StyleLayer"],function(l){return function(){function u(b,g){this._style=b;this.backgroundBucketIds=[];this._uidToLayer=new Map;this._layerByName={};this._runningId=0;b.layers||(b.layers=[]);this.version=parseFloat(b.version);this.sprite=g?g.spriteUrl:b.sprite;this.glyphs=g?g.glyphsUrl:
b.glyphs;if(this.layers=b.layers.map((h,d,f)=>this._create(h,d,f)))for(g=0;g<this.layers.length;g++)b=this.layers[g],this._layerByName[b.id.toLowerCase()]=b,this._uidToLayer.set(b.uid,b),0===b.type&&this.backgroundBucketIds.push(b.id);this._identifyRefLayers()}var q=u.prototype;q.isPainterDataDriven=function(b){return(b=this._layerByName[b.toLowerCase()])?b.isPainterDataDriven():!1};q.getStyleLayerId=function(b){return b>=this.layers.length?null:this.layers[b].id};q.getStyleLayerByUID=function(b){b=
this._uidToLayer.get(b);return null!=b?b:null};q.getStyleLayerIndex=function(b){return(b=this._layerByName[b.toLowerCase()])?this.layers.indexOf(b):-1};q.setStyleLayer=function(b,g){if(b&&b.id){var h=this._style;null!=g&&g>=this.layers.length&&(g=this.layers.length-1);var d=!0,f;if(f=this._layerByName[b.id.toLowerCase()]){const n=this.layers.indexOf(f);g||(g=n);g===n?(d=!1,f=u._recreateLayer(b,f),this.layers[g]=f,h.layers[g]=b):(this.layers.splice(n,1),h.layers.splice(n,1),f=this._create(b,g,this.layers),
this.layers.splice(g,0,f),h.layers.splice(g,0,b))}else f=this._create(b,g,this.layers),!g||g>=this.layers.length?(this.layers.push(f),h.layers.push(b)):(this.layers.splice(g,0,f),h.layers.splice(g,0,b));this._layerByName[b.id.toLowerCase()]=f;this._uidToLayer.set(f.uid,f);d&&this._recomputeZValues();this._identifyRefLayers()}};q.getStyleLayer=function(b){return(b=this._layerByName[b.toLowerCase()])?{type:b.typeName,id:b.id,source:b.source,"source-layer":b.sourceLayer,minzoom:b.minzoom,maxzoom:b.maxzoom,
filter:b.filter,layout:b.layout,paint:b.paint}:null};q.deleteStyleLayer=function(b){const g=this._layerByName[b.toLowerCase()];g&&(delete this._layerByName[b.toLowerCase()],this._uidToLayer.delete(g.uid),b=this.layers.indexOf(g),this.layers.splice(b,1),this._style.layers.splice(b,1),this._recomputeZValues(),this._identifyRefLayers())};q.getLayerById=function(b){return this._layerByName[b.toLowerCase()]};q.getLayoutProperties=function(b){return(b=this._layerByName[b.toLowerCase()])?b.layout:null};
q.getPaintProperties=function(b){return(b=this._layerByName[b.toLowerCase()])?b.paint:null};q.setPaintProperties=function(b,g){if(b=this._layerByName[b.toLowerCase()]){var h=u._recreateLayer({type:b.typeName,id:b.id,source:b.source,"source-layer":b.sourceLayer,minzoom:b.minzoom,maxzoom:b.maxzoom,filter:b.filter,layout:b.layout,paint:g},b),d=this.layers.indexOf(b);this.layers[d]=h;this._style.layers[d].paint=g;this._layerByName[b.id.toLowerCase()]=h;this._uidToLayer.set(b.uid,h)}};q.setLayoutProperties=
function(b,g){if(b=this._layerByName[b.toLowerCase()]){var h=u._recreateLayer({type:b.typeName,id:b.id,source:b.source,"source-layer":b.sourceLayer,minzoom:b.minzoom,maxzoom:b.maxzoom,filter:b.filter,layout:g,paint:b.paint},b),d=this.layers.indexOf(b);this.layers[d]=h;this._style.layers[d].layout=g;this._layerByName[b.id.toLowerCase()]=h;this._uidToLayer.set(b.uid,h)}};q.setStyleLayerVisibility=function(b,g){if(b=this._layerByName[b.toLowerCase()]){var h=b.layout||{};h.visibility=g;g=u._recreateLayer({type:b.typeName,
id:b.id,source:b.source,"source-layer":b.sourceLayer,minzoom:b.minzoom,maxzoom:b.maxzoom,filter:b.filter,layout:h,paint:b.paint},b);var d=this.layers.indexOf(b);this.layers[d]=g;this._style.layers[d].layout=h;this._layerByName[b.id.toLowerCase()]=g;this._uidToLayer.set(b.uid,g)}};q.getStyleLayerVisibility=function(b){var g;b=this._layerByName[b.toLowerCase()];if(!b)return"none";b=b.layout;return null!=(g=null==b?void 0:b.visibility)?g:"visible"};q._recomputeZValues=function(){const b=this.layers,
g=1/(b.length+1);for(let h=0;h<b.length;h++)b[h].z=1-(1+h)*g};q._identifyRefLayers=function(){const b=[],g=[];let h=0;for(const m of this.layers){const y=m.layout;if(1===m.type){var d,f=m,n=m.source+"|"+m.sourceLayer;n+=null!=(d="|"+(null==y?void 0:y.visibility))?d:"";n+="|"+m.minzoom;n+="|"+m.maxzoom;n+="|"+JSON.stringify(m.filter);if(f.hasDataDrivenFill||f.hasDataDrivenOutline)n+="|"+h;b.push({key:n,layer:m})}else if(2===m.type){var c;f=m;n=m.source+"|"+m.sourceLayer;n+=null!=(c="|"+(null==y?void 0:
y.visibility))?c:"";n+="|"+m.minzoom;n+="|"+m.maxzoom;n+="|"+JSON.stringify(m.filter);n+="|"+(void 0!==y?y["line-cap"]:"");n+="|"+(void 0!==y?y["line-join"]:"");f.hasDataDrivenLine&&(n+="|"+h);g.push({key:n,layer:m})}++h}this._assignRefLayers(b);this._assignRefLayers(g)};q._assignRefLayers=function(b){b.sort((c,m)=>c.key<m.key?-1:c.key>m.key?1:0);let g,h;const d=b.length;for(let c=0;c<d;c++){const m=b[c];if(m.key===g)m.layer.refLayerId=h;else if(g=m.key,h=m.layer.id,1===m.layer.type){if(!m.layer.getPaintProperty("fill-outline-color"))for(var f=
c+1;f<d;f++){var n=b[f];if(n.key===g){if(n.layer.getPaintProperty("fill-outline-color")){b[c]=n;b[f]=m;h=n.layer.id;break}}else break}}else if(2===m.layer.type)for(f=m.layer,n=c+1;n<d;n++){const y=b[n];if(y.key!==g)break;const J=y.layer;if(f.canUseThinTessellation&&!J.canUseThinTessellation||!f.canUseThinTessellation&&(J.getPaintProperty("line-pattern")||J.getPaintProperty("line-dasharray")))f=J,b[c]=y,b[n]=m,h=y.layer.id}}};q._create=function(b,g,h){g=1-1/(h.length+1)*(1+g);h=this._runningId++;switch(b.type){case "background":return new l.BackgroundStyleLayer(0,
b,g,h);case "fill":return new l.FillStyleLayer(1,b,g,h);case "line":return new l.LineStyleLayer(2,b,g,h);case "symbol":return new l.SymbolStyleLayer(3,b,g,h);case "raster":throw Error("Unsupported vector tile raster layer");case "circle":return new l.CircleStyleLayer(4,b,g,h)}throw Error("Unknown vector tile layer");};u._recreateLayer=function(b,g){switch(b.type){case "background":return new l.BackgroundStyleLayer(0,b,g.z,g.uid);case "fill":return new l.FillStyleLayer(1,b,g.z,g.uid);case "line":return new l.LineStyleLayer(2,
b,g.z,g.uid);case "symbol":return new l.SymbolStyleLayer(3,b,g.z,g.uid);case "raster":throw Error("Unsupported vector tile raster layer");case "circle":return new l.CircleStyleLayer(4,b,g.z,g.uid)}};return u}()})},"esri/views/2d/engine/vectorTiles/style/StyleLayer":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../shaders/VTLBackgroundMaterial ../shaders/VTLCircleMaterial ../shaders/VTLFillMaterial ../shaders/VTLLineMaterial ../shaders/VTLSymbolMaterial ./Filter ./StyleDefinition ./StyleProperty ../../webgl/definitions".split(" "),
function(l,u,q,b,g,h,d,f,n,c,m){let y=function(){function B(r,w,x,t){this.type=r;this.typeName=w.type;this.id=w.id;this.source=w.source;this.sourceLayer=w["source-layer"];this.minzoom=w.minzoom;this.maxzoom=w.maxzoom;this.filter=w.filter;this.layout=w.layout;this.paint=w.paint;this.z=x;this.uid=t;switch(r){case 0:this._layoutDefinition=n.StyleDefinition.backgroundLayoutDefinition;this._paintDefinition=n.StyleDefinition.backgroundPaintDefinition;break;case 1:this._layoutDefinition=n.StyleDefinition.fillLayoutDefinition;
this._paintDefinition=n.StyleDefinition.fillPaintDefinition;break;case 2:this._layoutDefinition=n.StyleDefinition.lineLayoutDefinition;this._paintDefinition=n.StyleDefinition.linePaintDefinition;break;case 3:this._layoutDefinition=n.StyleDefinition.symbolLayoutDefinition;this._paintDefinition=n.StyleDefinition.symbolPaintDefinition;break;case 4:this._layoutDefinition=n.StyleDefinition.circleLayoutDefinition,this._paintDefinition=n.StyleDefinition.circlePaintDefinition}this._layoutProperties=this._parseLayout(this.layout);
this._paintProperties=this._parsePaint(this.paint)}var z=B.prototype;z.getFeatureFilter=function(){return void 0!==this._featureFilter?this._featureFilter:this._featureFilter=f.createFilter(this.filter)};z.getLayoutProperty=function(r){return this._layoutProperties[r]};z.getPaintProperty=function(r){return this._paintProperties[r]};z.getLayoutValue=function(r,w,x){let t;const A=this._layoutProperties[r];A&&(t=A.getValue(w,x));void 0===t&&(t=this._layoutDefinition[r]["default"]);return t};z.getPaintValue=
function(r,w,x){let t;const A=this._paintProperties[r];A&&(t=A.getValue(w,x));void 0===t&&(t=this._paintDefinition[r]["default"]);return t};z.isPainterDataDriven=function(){const r=this._paintProperties;if(r)for(const w in r)if(r[w].isDataDriven)return!0;return!1};z._parseLayout=function(r){const w={};for(const x in r){const t=this._layoutDefinition[x];t&&(w[x]=new c(t,r[x]))}return w};z._parsePaint=function(r){const w={};for(const x in r){const t=this._paintDefinition[x];t&&(w[x]=new c(t,r[x]))}return w};
z.computeAttributesKey=function(r,w,x,t){let A=0,L=0;for(const F of w){w=3;if(!F||F!==t){const {isLayout:O,isOptional:Q}=x[F];w=O?this.getLayoutProperty(F):this.getPaintProperty(F);w=null!=w&&w.interpolator?2:null!=w&&w.isDataDriven?1:Q&&!w?3:0}L|=w<<A;A+=2}return L<<3|r};return B}(),J=function(B){function z(r,w,x,t){r=B.call(this,r,w,x,t)||this;r.backgroundMaterial=new q.VTLBackgroundMaterial(r.computeAttributesKey(0,q.VTLBackgroundMaterial.ATTRIBUTES,q.VTLBackgroundMaterial.ATTRIBUTES_INFO));return r}
u._inheritsLoose(z,B);return z}(y),E=function(B){function z(r,w,x,t){r=B.call(this,r,w,x,t)||this;w=r.getPaintProperty("fill-color");x=r.getPaintProperty("fill-opacity");t=r.getPaintProperty("fill-pattern");r.hasDataDrivenColor=null==w?void 0:w.isDataDriven;r.hasDataDrivenOpacity=null==x?void 0:x.isDataDriven;r.hasDataDrivenFill=r.hasDataDrivenColor||r.hasDataDrivenOpacity||(null==t?void 0:t.isDataDriven);x=r.getPaintProperty("fill-outline-color");r.outlineUsesFillColor=!x;r.hasDataDrivenOutlineColor=
null==x?void 0:x.isDataDriven;r.hasDataDrivenOutline=x?x.isDataDriven:w?w.isDataDriven:!1;r.hasDataDrivenOutline=(x?r.hasDataDrivenOutlineColor:r.hasDataDrivenColor)||r.hasDataDrivenOpacity;r.fillMaterial=new g.VTLFillMaterial(r.computeAttributesKey(1,g.VTLFillMaterial.ATTRIBUTES,g.VTLFillMaterial.ATTRIBUTES_INFO));r.outlineMaterial=new g.VTLOutlineMaterial(r.computeAttributesKey(2,r.outlineUsesFillColor?g.VTLOutlineMaterial.ATTRIBUTES_FILL:g.VTLOutlineMaterial.ATTRIBUTES_OUTLINE,r.outlineUsesFillColor?
g.VTLOutlineMaterial.ATTRIBUTES_INFO_FILL:g.VTLOutlineMaterial.ATTRIBUTES_INFO_OUTLINE),r.outlineUsesFillColor);return r}u._inheritsLoose(z,B);return z}(y),G=function(B){function z(r,w,x,t){var A,L,F,O,Q,R,V,U,W;r=B.call(this,r,w,x,t)||this;w=r.getPaintProperty("line-pattern");r.lineMaterial=new h.VTLLineMaterial(r.computeAttributesKey(3,h.VTLLineMaterial.ATTRIBUTES,h.VTLLineMaterial.ATTRIBUTES_INFO,w?"line-dasharray":""));r.hasDataDrivenLine=(null==(A=r.getPaintProperty("line-blur"))?void 0:A.isDataDriven)||
(null==(L=r.getPaintProperty("line-color"))?void 0:L.isDataDriven)||(null==(F=r.getPaintProperty("line-gap-width"))?void 0:F.isDataDriven)||(null==(O=r.getPaintProperty("line-offset"))?void 0:O.isDataDriven)||(null==(Q=r.getPaintProperty("line-opacity"))?void 0:Q.isDataDriven)||(null==(R=r.getPaintProperty("line-pattern"))?void 0:R.isDataDriven)||(null==(V=r.getPaintProperty("line-dasharray"))?void 0:V.isDataDriven)||(null==(U=r.getLayoutProperty("line-cap"))?void 0:U.isDataDriven)||(null==(W=r.getPaintProperty("line-width"))?
void 0:W.isDataDriven);r.canUseThinTessellation=!1;!r.hasDataDrivenLine&&(A=r.getPaintProperty("line-width"),!A||"number"===typeof A&&.5*A<m.THIN_LINE_HALF_WIDTH_THRESHOLD)&&(A=r.getPaintProperty("line-offset"),!A||"number"===typeof A&&0===A)&&(r.canUseThinTessellation=!0);return r}u._inheritsLoose(z,B);z.prototype.getDashKey=function(r,w){switch(w){case 0:w="Butt";break;case 1:w="Round";break;case 2:w="Square";break;default:w="Butt"}return`dasharray-[${r.toString()}]-${w}`};return z}(y),C=function(B){function z(r,
w,x,t){var A,L,F,O,Q,R,V,U,W,ca,da,ea;r=B.call(this,r,w,x,t)||this;r.iconMaterial=new d.VTLIconMaterial(r.computeAttributesKey(4,d.VTLIconMaterial.ATTRIBUTES,d.VTLIconMaterial.ATTRIBUTES_INFO));r.textMaterial=new d.VTLTextMaterial(r.computeAttributesKey(6,d.VTLTextMaterial.ATTRIBUTES,d.VTLTextMaterial.ATTRIBUTES_INFO));r.hasDataDrivenIcon=(null==(A=r.getPaintProperty("icon-color"))?void 0:A.isDataDriven)||(null==(L=r.getPaintProperty("icon-halo-blur"))?void 0:L.isDataDriven)||(null==(F=r.getPaintProperty("icon-halo-color"))?
void 0:F.isDataDriven)||(null==(O=r.getPaintProperty("icon-halo-width"))?void 0:O.isDataDriven)||(null==(Q=r.getPaintProperty("icon-opacity"))?void 0:Q.isDataDriven)||(null==(R=r.getLayoutProperty("icon-size"))?void 0:R.isDataDriven);r.hasDataDrivenText=(null==(V=r.getPaintProperty("text-color"))?void 0:V.isDataDriven)||(null==(U=r.getPaintProperty("text-halo-blur"))?void 0:U.isDataDriven)||(null==(W=r.getPaintProperty("text-halo-color"))?void 0:W.isDataDriven)||(null==(ca=r.getPaintProperty("text-halo-width"))?
void 0:ca.isDataDriven)||(null==(da=r.getPaintProperty("text-opacity"))?void 0:da.isDataDriven)||(null==(ea=r.getLayoutProperty("text-size"))?void 0:ea.isDataDriven);return r}u._inheritsLoose(z,B);return z}(y),N=function(B){function z(r,w,x,t){r=B.call(this,r,w,x,t)||this;r.circleMaterial=new b.VTLCircleMaterial(r.computeAttributesKey(5,b.VTLCircleMaterial.ATTRIBUTES,b.VTLCircleMaterial.ATTRIBUTES_INFO));return r}u._inheritsLoose(z,B);return z}(y),D=function(){function B(z,r,w){var x,t,A,L,F;this.allowOverlap=
z.getLayoutValue("icon-allow-overlap",r);this.ignorePlacement=z.getLayoutValue("icon-ignore-placement",r);this.keepUpright=z.getLayoutValue("icon-keep-upright",r);this.optional=z.getLayoutValue("icon-optional",r);this.rotationAlignment=z.getLayoutValue("icon-rotation-alignment",r);2===this.rotationAlignment&&(this.rotationAlignment=w?0:1);w=z.getLayoutProperty("icon-anchor");null!=(x=w)&&x.isDataDriven?this._anchorProp=w:this.anchor=z.getLayoutValue("icon-anchor",r);w=z.getLayoutProperty("icon-offset");
null!=(t=w)&&t.isDataDriven?this._offsetProp=w:this.offset=z.getLayoutValue("icon-offset",r);w=z.getLayoutProperty("icon-padding");null!=(A=w)&&A.isDataDriven?this._paddingProp=w:this.padding=z.getLayoutValue("icon-padding",r);w=z.getLayoutProperty("icon-rotate");null!=(L=w)&&L.isDataDriven?this._rotateProp=w:this.rotate=z.getLayoutValue("icon-rotate",r);w=z.getLayoutProperty("icon-size");null!=(F=w)&&F.isDataDriven?this._sizeProp=w:this.size=z.getLayoutValue("icon-size",r)}B.prototype.update=function(z,
r){this._anchorProp&&(this.anchor=this._anchorProp.getValue(z,r));this._offsetProp&&(this.offset=this._offsetProp.getValue(z,r));this._paddingProp&&(this.padding=this._paddingProp.getValue(z,r));this._rotateProp&&(this.rotate=this._rotateProp.getValue(z,r));this._sizeProp&&(this.size=this._sizeProp.getValue(z,r))};return B}(),K=function(){function B(z,r,w){var x,t,A,L,F,O,Q,R,V,U,W;this.allowOverlap=z.getLayoutValue("text-allow-overlap",r);this.ignorePlacement=z.getLayoutValue("text-ignore-placement",
r);this.keepUpright=z.getLayoutValue("text-keep-upright",r);this.optional=z.getLayoutValue("text-optional",r);this.rotationAlignment=z.getLayoutValue("text-rotation-alignment",r);2===this.rotationAlignment&&(this.rotationAlignment=w?0:1);w=z.getLayoutProperty("text-anchor");null!=(x=w)&&x.isDataDriven?this._anchorProp=w:this.anchor=z.getLayoutValue("text-anchor",r);w=z.getLayoutProperty("text-justify");null!=(t=w)&&t.isDataDriven?this._justifyProp=w:this.justify=z.getLayoutValue("text-justify",r);
w=z.getLayoutProperty("text-letter-spacing");null!=(A=w)&&A.isDataDriven?this._letterSpacingProp=w:this.letterSpacing=z.getLayoutValue("text-letter-spacing",r);w=z.getLayoutProperty("text-line-height");null!=(L=w)&&L.isDataDriven?this._lineHeightProp=w:this.lineHeight=z.getLayoutValue("text-line-height",r);w=z.getLayoutProperty("text-max-angle");null!=(F=w)&&F.isDataDriven?this._maxAngleProp=w:this.maxAngle=z.getLayoutValue("text-max-angle",r);w=z.getLayoutProperty("text-max-width");null!=(O=w)&&
O.isDataDriven?this._maxWidthProp=w:this.maxWidth=z.getLayoutValue("text-max-width",r);w=z.getLayoutProperty("text-offset");null!=(Q=w)&&Q.isDataDriven?this._offsetProp=w:this.offset=z.getLayoutValue("text-offset",r);w=z.getLayoutProperty("text-padding");null!=(R=w)&&R.isDataDriven?this._paddingProp=w:this.padding=z.getLayoutValue("text-padding",r);w=z.getLayoutProperty("text-rotate");null!=(V=w)&&V.isDataDriven?this._rotateProp=w:this.rotate=z.getLayoutValue("text-rotate",r);w=z.getLayoutProperty("text-size");
null!=(U=w)&&U.isDataDriven?this._sizeProp=w:this.size=z.getLayoutValue("text-size",r);w=z.getLayoutProperty("text-writing-mode");null!=(W=w)&&W.isDataDriven?this._writingModeProp=w:this.writingMode=z.getLayoutValue("text-writing-mode",r)}B.prototype.update=function(z,r){this._anchorProp&&(this.anchor=this._anchorProp.getValue(z,r));this._justifyProp&&(this.justify=this._justifyProp.getValue(z,r));this._letterSpacingProp&&(this.letterSpacing=this._letterSpacingProp.getValue(z,r));this._lineHeightProp&&
(this.lineHeight=this._lineHeightProp.getValue(z,r));this._maxAngleProp&&(this.maxAngle=this._maxAngleProp.getValue(z,r));this._maxWidthProp&&(this.maxWidth=this._maxWidthProp.getValue(z,r));this._offsetProp&&(this.offset=this._offsetProp.getValue(z,r));this._paddingProp&&(this.padding=this._paddingProp.getValue(z,r));this._rotateProp&&(this.rotate=this._rotateProp.getValue(z,r));this._sizeProp&&(this.size=this._sizeProp.getValue(z,r));this._writingModeProp&&(this.writingMode=this._writingModeProp.getValue(z,
r))};return B}();l.BackgroundStyleLayer=J;l.CircleStyleLayer=N;l.FillStyleLayer=E;l.IconLayout=D;l.LineStyleLayer=G;l.StyleLayer=y;l.SymbolStyleLayer=C;l.TextLayout=K;Object.defineProperty(l,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/VTLBackgroundMaterial":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","./VTLMaterial"],function(l,u,q){q=function(b){function g(d){return b.call(this,d)||this}u._inheritsLoose(g,b);var h=g.prototype;h.geometryInfo=
function(){return g.GEOMETRY_LAYOUT};h.opacityInfo=function(){return null};h.attributes=function(){return g.ATTRIBUTES};h.attributesInfo=function(){return g.ATTRIBUTES_INFO};return g}(q.VTLMaterial);q.ATTRIBUTES=[];q.GEOMETRY_LAYOUT=[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}];q.ATTRIBUTES_INFO={};l.VTLBackgroundMaterial=q;Object.defineProperty(l,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/VTLMaterial":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers",
"../../../../../core/maybe","../MemoryBuffer"],function(l,u,q,b){let g=function(){function f(c){this._locations=new Map;this._key=c}var n=f.prototype;n.defines=function(){return[]};n.getStride=function(){this._layoutInfo||this._buildAttributesInfo();return this._stride};n.getAttributeLocations=function(){0===this._locations.size&&this._buildAttributesInfo();return this._locations};n.getLayoutInfo=function(){this._layoutInfo||this._buildAttributesInfo();return this._layoutInfo};n.getEncodingInfos=
function(){this._propertyEncodingInfo||this._buildAttributesInfo();return this._propertyEncodingInfo};n.getUniforms=function(){this._uniforms||this._buildAttributesInfo();return this._uniforms};n.getShaderHeader=function(){this._shaderHeader||this._buildAttributesInfo();return this._shaderHeader};n.getShaderMain=function(){this._shaderMain||this._buildAttributesInfo();return this._shaderMain};n.setDataUniforms=function(c,m,y,J,E){var G=this.getUniforms();for(const C of G){const {name:N,type:D,getValue:K}=
C;G=K(y,m,J,E);if(null!==G)switch(D){case "float":c.setUniform1f(N,G);break;case "vec2":c.setUniform2fv(N,G);break;case "vec4":c.setUniform4fv(N,G)}}};n.encodeAttributes=function(c,m,y,J){const E=this.attributesInfo(),G=this.getEncodingInfos(),C=[];let N=0,D=0;for(const z of Object.keys(G)){var K,B=G[z];const {type:r,precisionFactor:w,isLayout:x}=E[z],t=x?y.getLayoutProperty(z):y.getPaintProperty(z),A=null==(K=t.interpolator)?void 0:K.getInterpolationRange(m);let L=0;for(const F of B){const {offset:O,
bufferElementsToAdd:Q}=F;if(0<Q){for(B=0;B<Q;B++)C.push(0);N+=D;D=F.bufferElementsToAdd}B=null!=J?J:t.getValue(A?A[L]:m,c);switch(r){case 0:case 1:C[N]|=this._encodeByte(B*(w||1),8*O);break;case 2:case 3:C[N]|=this._encodeShort(B*(w||1),8*O);break;case 4:case 5:C[N]|=this._encodeByte(B*(w||1),8*O);C[N]|=this._encodeByte(B*(w||1),8*O+8);break;case 6:case 7:C[N]|=this._encodeShort(B*(w||1),8*O);C[N]|=this._encodeShort(B*(w||1),8*O+16);break;case 8:case 9:C[N]|=this._encodeByte(B*(w||1),8*O);C[N]|=this._encodeByte(B*
(w||1),8*O+8);C[N]|=this._encodeByte(B*(w||1),8*O+16);C[N]|=this._encodeByte(B*(w||1),8*O+24);break;case 10:C[N]=this._encodeColor(B);break;case 11:case 12:this._encodePattern(N,C,B);break;default:throw Error("Unsupported encoding type");}L++}}return C};n.getAtributeState=function(c){const m=3+2*c;c=0|this._bit(m);return c|=this._bit(m+1)<<1};n._buildAttributesInfo=function(){const c=[],m={};var y={},J=-1;const E=this.attributesInfo();var G=this.attributes();let C=-1;for(const B of G){C++;G=this.getAtributeState(C);
if(0===G||3===G)continue;var N=E[B];const z=[];m[B]=z;N=N.type;for(let r=0;r<G;r++){const {dataType:w,bytesPerElement:x,count:t,normalized:A}=f._encodingInfo[N],L=x*t;let F=y[w];var D=0;!F||4<F.count+t?(J++,F={dataIndex:J,count:0,offset:0},4!==t&&(y[w]=F),c.push({location:-1,name:"a_data_"+J,count:t,type:w,normalized:A}),D=Math.ceil(Math.max(L/4,1))):(D=c[F.dataIndex],D.count+=t,D=Math.ceil(Math.max(D.count*x/4,1))-Math.ceil(Math.max(F.offset/4,1)));z.push({dataIndex:F.dataIndex,offset:F.offset,bufferElementsToAdd:D});
F.offset+=L;F.count+=t}}for(const B of c)switch(B.type){case 5120:case 5121:B.count=4;case 5122:case 5123:B.count+=B.count%2}this._buildVertexBufferLayout(c);y=0;J=this._layoutInfo.geometry;for(var K of J)this._locations.set(K.name,y++);if(K=this._layoutInfo.opacity)for(const B of K)this._locations.set(B.name,y++);this._buildShaderInfo(c,m);this._propertyEncodingInfo=m};n._buildVertexBufferLayout=function(c){const m={};var y=this.geometryInfo();let J=y[0].stride;if(0===c.length)m.geometry=y;else{const E=
[];let G=J;for(const C of c)J+=h(C.type)*C.count;for(const C of y)y={...C},y.stride=J,E.push(y);for(const C of c)E.push({name:C.name,count:C.count,type:C.type,offset:G,stride:J,normalized:C.normalized||!1,divisor:0}),G+=h(C.type)*C.count;m.geometry=E}this.opacityInfo()&&(m.opacity=this.opacityInfo());this._layoutInfo=m;this._stride=J};n._buildShaderInfo=function(c,m){let y="\n",J="\n";const E=[];for(var G of c)y+=`attribute ${this._getType(G.count)} ${G.name};\n`;var C=this.attributes();c=this.attributesInfo();
G=-1;for(const K of C){G++;const {name:B,type:z,precisionFactor:r,isLayout:w}=c[K];C=r&&1!==r?` * ${1/r}`:"";const {bytesPerElement:x,count:t}=f._encodingInfo[z];var N=A=>`a_data_${A.dataIndex}${d(t,A.offset,x)}`;switch(this.getAtributeState(G)){case 0:C=this._getType(t);var D=`u_${B}`;E.push({name:D,type:C,getValue:(A,L,F,O)=>{F=w?A.getLayoutValue(K,L):A.getPaintValue(K,L);if(11===z){A=A.getDashKey(F,A.getLayoutValue("line-cap",L));O=O.getMosaicItemPosition(A,!1);if(q.isNone(O))return null;const {tl:Q,
br:R}=O;return[Q[0],R[1],R[0],Q[1]]}if(12===z){O=O.getMosaicItemPosition(F,-1===K.indexOf("line-"));if(q.isNone(O))return null;const {tl:Q,br:R}=O;return[Q[0],R[1],R[0],Q[1]]}return 10===z?(O=F[3],[O*F[0],O*F[1],O*F[2],O]):F}});y+=`uniform ${C} ${D};\n`;J+=`${C} ${B} = ${D};\n`;break;case 1:D=N(m[K][0]);J+=`${this._getType(t)} ${B} = ${D}${C};\n`;break;case 2:{D=`u_t_${B}`;E.push({name:D,type:"float",getValue:(L,F,O,Q)=>(w?L.getLayoutProperty(K):L.getPaintProperty(K)).interpolator.interpolationUniformValue(O,
F)});y+=`uniform float ${D};\n`;const A=N(m[K][0]);N=N(m[K][1]);J+=`${this._getType(t)} ${B} = mix(${A}${C}, ${N}${C}, ${D});\n`}}}this._shaderHeader=y;this._shaderMain=J;this._uniforms=E};n._bit=function(c){return(this._key&1<<c)>>c};n._getType=function(c){switch(c){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4"}throw Error("Invalid count");};n._encodeColor=function(c){const m=255*c[3];return b.i8888to32(c[0]*m,c[1]*m,c[2]*m,m)};n._encodePattern=function(c,m,y){if(y&&
y.rect){var J=y.rect,E=y.width;y=y.height;m[c]=this._encodeShort(J.x+2,0);m[c]|=this._encodeShort(J.y+2+y,16);m[c+1]=this._encodeShort(J.x+2+E,0);m[c+1]|=this._encodeShort(J.y+2,16)}};n._encodeByte=function(c,m){return(c&255)<<m};n._encodeShort=function(c,m){return(c&65535)<<m};u._createClass(f,[{key:"key",get:function(){return this._key}},{key:"type",get:function(){return this._key&7}}]);return f}();g._encodingInfo={[0]:{dataType:5120,bytesPerElement:1,count:1,normalized:!1},[1]:{dataType:5121,bytesPerElement:1,
count:1,normalized:!1},[2]:{dataType:5122,bytesPerElement:2,count:1,normalized:!1},[3]:{dataType:5123,bytesPerElement:2,count:1,normalized:!1},[4]:{dataType:5120,bytesPerElement:1,count:2,normalized:!1},[5]:{dataType:5121,bytesPerElement:1,count:2,normalized:!1},[6]:{dataType:5122,bytesPerElement:2,count:2,normalized:!1},[7]:{dataType:5123,bytesPerElement:2,count:2,normalized:!1},[8]:{dataType:5120,bytesPerElement:1,count:4,normalized:!1},[9]:{dataType:5121,bytesPerElement:1,count:4,normalized:!1},
[10]:{dataType:5121,bytesPerElement:1,count:4,normalized:!0},[11]:{dataType:5123,bytesPerElement:2,count:4,normalized:!1},[12]:{dataType:5123,bytesPerElement:2,count:4,normalized:!1}};const h=f=>{switch(f){case 5126:return 4;case 5124:return 4;case 5125:return 4;case 5122:return 2;case 5123:return 2;case 5120:return 1;case 5121:return 1}},d=(f,n,c)=>{n/=c;if(1===f)switch(n){case 0:return".x";case 1:return".y";case 2:return".z";case 3:return".w"}else if(2===f)switch(n){case 0:return".xy";case 1:return".yz";
case 2:return".zw"}else if(3===f)switch(n){case 0:return".xyz";case 1:return".yzw"}return""};l.VTLMaterial=g;Object.defineProperty(l,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/MemoryBuffer":function(){define(["../../../../chunks/_rollupPluginBabelHelpers"],function(l){return function(){function u(b){this._array=[];0>=b&&console.error("strideInBytes must be positive!");this._stride=b}var q=u.prototype;q.reset=function(){this.array.length=0};q.toBuffer=function(){return(new Uint32Array(this._array)).buffer};
u.i1616to32=function(b,g){return 65535&b|g<<16};u.i8888to32=function(b,g,h,d){return b&255|(g&255)<<8|(h&255)<<16|d<<24};u.i8816to32=function(b,g,h){return b&255|(g&255)<<8|h<<16};l._createClass(u,[{key:"array",get:function(){return this._array}},{key:"index",get:function(){return 4*this._array.length/this._stride}},{key:"itemSize",get:function(){return this._stride}},{key:"sizeInBytes",get:function(){return 4*this._array.length}}]);return u}()})},"esri/views/2d/engine/vectorTiles/shaders/VTLCircleMaterial":function(){define(["exports",
"../../../../../chunks/_rollupPluginBabelHelpers","./VTLMaterial"],function(l,u,q){q=function(b){function g(d){return b.call(this,d)||this}u._inheritsLoose(g,b);var h=g.prototype;h.geometryInfo=function(){return g.GEOMETRY_LAYOUT};h.opacityInfo=function(){return null};h.attributes=function(){return g.ATTRIBUTES};h.attributesInfo=function(){return g.ATTRIBUTES_INFO};return g}(q.VTLMaterial);q.ATTRIBUTES="circle-radius circle-color circle-opacity circle-stroke-width circle-stroke-color circle-stroke-opacity circle-blur".split(" ");
q.GEOMETRY_LAYOUT=[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}];q.ATTRIBUTES_INFO={"circle-radius":{name:"radius",type:1},"circle-color":{name:"color",type:10},"circle-opacity":{name:"opacity",type:1,precisionFactor:100},"circle-stroke-width":{name:"stroke_width",type:1,precisionFactor:4},"circle-stroke-color":{name:"stroke_color",type:10},"circle-stroke-opacity":{name:"stroke_opacity",type:1,precisionFactor:100},"circle-blur":{name:"blur",type:1,precisionFactor:32}};
l.VTLCircleMaterial=q;Object.defineProperty(l,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/VTLFillMaterial":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","./VTLMaterial"],function(l,u,q){let b=function(g){function h(f){return g.call(this,f)||this}u._inheritsLoose(h,g);var d=h.prototype;d.geometryInfo=function(){return h.GEOMETRY_LAYOUT};d.opacityInfo=function(){return null};d.attributes=function(){return h.ATTRIBUTES};d.attributesInfo=function(){return h.ATTRIBUTES_INFO};
return h}(q.VTLMaterial);b.ATTRIBUTES=["fill-color","fill-opacity","fill-pattern"];b.GEOMETRY_LAYOUT=[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}];b.ATTRIBUTES_INFO={"fill-color":{name:"color",type:10},"fill-opacity":{name:"opacity",type:1,precisionFactor:100},"fill-pattern":{name:"tlbr",type:12,isOptional:!0}};q=function(g){function h(f,n){f=g.call(this,f)||this;f.usefillColor=n;return f}u._inheritsLoose(h,g);var d=h.prototype;d.geometryInfo=function(){return h.GEOMETRY_LAYOUT};
d.opacityInfo=function(){return null};d.attributes=function(){return this.usefillColor?h.ATTRIBUTES_FILL:h.ATTRIBUTES_OUTLINE};d.attributesInfo=function(){return this.usefillColor?h.ATTRIBUTES_INFO_FILL:h.ATTRIBUTES_INFO_OUTLINE};return h}(q.VTLMaterial);q.ATTRIBUTES_OUTLINE=["fill-outline-color","fill-opacity"];q.ATTRIBUTES_FILL=["fill-color","fill-opacity"];q.GEOMETRY_LAYOUT=[{name:"a_pos",count:2,type:5122,offset:0,stride:8,normalized:!1,divisor:0},{name:"a_offset",count:2,type:5120,offset:4,stride:8,
normalized:!1,divisor:0},{name:"a_xnormal",count:2,type:5120,offset:6,stride:8,normalized:!1,divisor:0}];q.ATTRIBUTES_INFO_OUTLINE={"fill-outline-color":{name:"color",type:10},"fill-opacity":{name:"opacity",type:1,precisionFactor:100}};q.ATTRIBUTES_INFO_FILL={"fill-color":{name:"color",type:10},"fill-opacity":{name:"opacity",type:1,precisionFactor:100}};l.VTLFillMaterial=b;l.VTLOutlineMaterial=q;Object.defineProperty(l,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/VTLLineMaterial":function(){define(["exports",
"../../../../../chunks/_rollupPluginBabelHelpers","./VTLMaterial"],function(l,u,q){q=function(b){function g(d){return b.call(this,d)||this}u._inheritsLoose(g,b);var h=g.prototype;h.geometryInfo=function(){return g.GEOMETRY_LAYOUT};h.opacityInfo=function(){return null};h.attributes=function(){return g.ATTRIBUTES};h.attributesInfo=function(){return g.ATTRIBUTES_INFO};return g}(q.VTLMaterial);q.ATTRIBUTES="line-blur line-color line-gap-width line-offset line-opacity line-width line-pattern line-dasharray".split(" ");
q.GEOMETRY_LAYOUT=[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_extrude_offset",count:4,type:5120,offset:4,stride:16,normalized:!1,divisor:0},{name:"a_dir_normal",count:4,type:5120,offset:8,stride:16,normalized:!1,divisor:0},{name:"a_accumulatedDistance",count:2,type:5123,offset:12,stride:16,normalized:!1,divisor:0}];q.ATTRIBUTES_INFO={"line-width":{name:"width",type:1,precisionFactor:2},"line-gap-width":{name:"gap_width",type:1,precisionFactor:2},"line-offset":{name:"offset",
type:0,precisionFactor:2},"line-color":{name:"color",type:10},"line-opacity":{name:"opacity",type:1,precisionFactor:100},"line-blur":{name:"blur",type:1,precisionFactor:4},"line-pattern":{name:"tlbr",type:12,isOptional:!0},"line-dasharray":{name:"tlbr",type:11,isOptional:!0}};l.VTLLineMaterial=q;Object.defineProperty(l,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/VTLSymbolMaterial":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","./VTLMaterial"],
function(l,u,q){const b=[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:16,normalized:!1,divisor:0},{name:"a_texAngleRange",count:4,type:5121,offset:8,stride:16,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:16,normalized:!1,divisor:0}],g=[{name:"a_opacityInfo",count:1,type:5121,offset:0,stride:1,normalized:!1,divisor:0}];let h=function(d){function f(c){return d.call(this,c)||this}
u._inheritsLoose(f,d);var n=f.prototype;n.geometryInfo=function(){return b};n.opacityInfo=function(){return g};n.attributes=function(){return f.ATTRIBUTES};n.attributesInfo=function(){return f.ATTRIBUTES_INFO};return f}(q.VTLMaterial);h.ATTRIBUTES="icon-color icon-opacity icon-halo-blur icon-halo-color icon-halo-width icon-size".split(" ");h.ATTRIBUTES_INFO={"icon-color":{name:"color",type:10},"icon-opacity":{name:"opacity",type:1,precisionFactor:100},"icon-halo-color":{name:"halo_color",type:10},
"icon-halo-width":{name:"halo_width",type:1,precisionFactor:4},"icon-halo-blur":{name:"halo_blur",type:1,precisionFactor:4},"icon-size":{name:"size",type:1,precisionFactor:32,isLayout:!0}};q=function(d){function f(c){return d.call(this,c)||this}u._inheritsLoose(f,d);var n=f.prototype;n.geometryInfo=function(){return b};n.opacityInfo=function(){return g};n.attributes=function(){return f.ATTRIBUTES};n.attributesInfo=function(){return f.ATTRIBUTES_INFO};return f}(q.VTLMaterial);q.ATTRIBUTES="text-color text-opacity text-halo-blur text-halo-color text-halo-width text-size".split(" ");
q.ATTRIBUTES_INFO={"text-color":{name:"color",type:10},"text-opacity":{name:"opacity",type:1,precisionFactor:100},"text-halo-color":{name:"halo_color",type:10},"text-halo-width":{name:"halo_width",type:1,precisionFactor:4},"text-halo-blur":{name:"halo_blur",type:1,precisionFactor:4},"text-size":{name:"size",type:1,isLayout:!0}};l.VTLIconMaterial=h;l.VTLTextMaterial=q;Object.defineProperty(l,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/style/Filter":function(){define(["../expression/expression",
"../expression/types"],function(l,u){return function(){function q(b){this._expression=b}q.prototype.filter=function(b,g){if(!this._expression)return!0;try{return this._expression.evaluate(b,g)}catch(h){return console.log(h.message),!0}};q.createFilter=function(b){if(!b)return null;this.isLegacyFilter(b)&&(b=this.convertLegacyFilter(b));try{const g=l.createExpression(b,null,u.BooleanType);return new q(g)}catch(g){return console.log(g.message),null}};q.isLegacyFilter=function(b){if(!Array.isArray(b)||
0===b.length)return!0;switch(b[0]){case "\x3d\x3d":case "!\x3d":case "\x3e":case "\x3c":case "\x3e\x3d":case "\x3c\x3d":return 3===b.length&&"string"===typeof b[1]&&!Array.isArray(b[2]);case "in":return 3<=b.length&&"string"===typeof b[1]&&!Array.isArray(b[2]);case "!in":return!0;case "any":case "all":for(let g=1;g<b.length;g++)if(!this.isLegacyFilter(b[1]))return!1;return!0;case "none":return!0;case "has":return 2===b.length&&("$id"===b[1]||"$type"===b[1]);case "!has":return!0;default:return!1}};
q.convertLegacyFilter=function(b){if(!Array.isArray(b)||0===b.length)return!0;const g=b[0];if(1===b.length)return"any"!==g;switch(g){case "\x3d\x3d":return q.convertComparison("\x3d\x3d",b[1],b[2]);case "!\x3d":return q.negate(q.convertComparison("\x3d\x3d",b[1],b[2]));case "\x3e":case "\x3c":case "\x3e\x3d":case "\x3c\x3d":return q.convertComparison(g,b[1],b[2]);case "in":return q.convertIn(b[1],b.slice(2));case "!in":return q.negate(q.convertIn(b[1],b.slice(2)));case "any":case "all":case "none":return q.convertCombining(g,
b.slice(1));case "has":return q.convertHas(b[1]);case "!has":return q.negate(q.convertHas(b[1]));default:throw Error("Unexpected legacy filter.");}};q.convertComparison=function(b,g,h){switch(g){case "$type":return[b,["geometry-type"],h];case "$id":return[b,["id"],h];default:return[b,["get",g],h]}};q.convertIn=function(b,g){switch(b){case "$type":return["in",["geometry-type"],["literal",g]];case "$id":return["in",["id"],["literal",g]];default:return["in",["get",b],["literal",g]]}};q.convertHas=function(b){switch(b){case "$type":return!0;
case "$id":return["has-id"];default:return["has",b]}};q.convertCombining=function(b,g){return[b].concat(g.map(this.convertLegacyFilter))};q.negate=function(b){return["!",b]};return q}()})},"esri/views/2d/engine/vectorTiles/expression/expression":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../Color ../../../../../core/colorUtils ../../../unitBezier ../GeometryUtils ./types".split(" "),function(l,u,q,b,g,h,d){function f(k,a,e){var p=typeof k;if("string"===
p||"boolean"===p||"number"===p||null===k){if(e)switch(e.kind){case "string":"string"!==p&&(k=fa.toString(k));break;case "number":"number"!==p&&(k=fa.toNumber(k));break;case "color":k=fa.toColor(k)}k=["literal",k]}if(!Array.isArray(k)||0===k.length)throw Error("Expression must be a non empty array");p=k[0];if("string"!==typeof p)throw Error("First element of expression must be a string");const v=oa[p];if(void 0===v)throw Error(`Invalid expression operator "${p}"`);if(!v)throw Error(`Unimplemented expression operator "${p}"`);
return v.parse(k,a,e)}let n=function(){function k(e){this.parent=e;this.vars={}}var a=k.prototype;a.add=function(e,p){this.vars[e]=p};a.get=function(e){return this.vars[e]?this.vars[e]:this.parent?this.parent.get(e):null};return k}(),c=function(){function k(){this.type=d.ValueType}k.parse=function(a){if(1<a.length)throw Error('"id" does not expect arguments');return new k};k.prototype.evaluate=function(a,e){return null==a?void 0:a.id};return k}(),m=function(){function k(){this.type=d.StringType}k.parse=
function(a){if(1<a.length)throw Error('"geometry-type" does not expect arguments');return new k};k.prototype.evaluate=function(a,e){if(!a)return null;switch(a.type){case 1:return"Point";case 2:return"LineString";case 3:return"Polygon";default:return null}};return k}(),y=function(){function k(){this.type=d.ObjectType}k.parse=function(a){if(1<a.length)throw Error('"properties" does not expect arguments');return new k};k.prototype.evaluate=function(a,e){return null==a?void 0:a.values};return k}(),J=
function(){function k(){this.type=d.NumberType}k.parse=function(a){if(1<a.length)throw Error('"zoom" does not expect arguments');return new k};k.prototype.evaluate=function(a,e){return e};return k}(),E=function(){function k(a,e,p){this.lhs=a;this.rhs=e;this.compare=p;this.type=d.BooleanType}k.parse=function(a,e,p){if(3!==a.length&&4!==a.length)throw Error(`"${a[0]}" expects 2 or 3 arguments`);if(4===a.length)throw Error(`"${a[0]}" collator not supported`);return new k(f(a[1],e),f(a[2],e),p)};k.prototype.evaluate=
function(a,e){return this.compare(this.lhs.evaluate(a,e),this.rhs.evaluate(a,e))};return k}(),G=function(k){function a(){return k.apply(this,arguments)||this}u._inheritsLoose(a,k);a.parse=function(e,p){return E.parse(e,p,(v,H)=>v===H)};return a}(E),C=function(k){function a(){return k.apply(this,arguments)||this}u._inheritsLoose(a,k);a.parse=function(e,p){return E.parse(e,p,(v,H)=>v!==H)};return a}(E),N=function(k){function a(){return k.apply(this,arguments)||this}u._inheritsLoose(a,k);a.parse=function(e,
p){return E.parse(e,p,(v,H)=>v<H)};return a}(E),D=function(k){function a(){return k.apply(this,arguments)||this}u._inheritsLoose(a,k);a.parse=function(e,p){return E.parse(e,p,(v,H)=>v<=H)};return a}(E),K=function(k){function a(){return k.apply(this,arguments)||this}u._inheritsLoose(a,k);a.parse=function(e,p){return E.parse(e,p,(v,H)=>v>H)};return a}(E),B=function(k){function a(){return k.apply(this,arguments)||this}u._inheritsLoose(a,k);a.parse=function(e,p){return E.parse(e,p,(v,H)=>v>=H)};return a}(E),
z=function(){function k(a){this.arg=a;this.type=d.BooleanType}k.parse=function(a,e){if(2!==a.length)throw Error('"!" expects 1 argument');return new k(f(a[1],e))};k.prototype.evaluate=function(a,e){return!this.arg.evaluate(a,e)};return k}(),r=function(){function k(a){this.args=a;this.type=d.BooleanType}k.parse=function(a,e){const p=[];for(let v=1;v<a.length;v++)p.push(f(a[v],e));return new k(p)};k.prototype.evaluate=function(a,e){for(const p of this.args)if(!p.evaluate(a,e))return!1;return!0};return k}(),
w=function(){function k(a){this.args=a;this.type=d.BooleanType}k.parse=function(a,e){const p=[];for(let v=1;v<a.length;v++)p.push(f(a[v],e));return new k(p)};k.prototype.evaluate=function(a,e){for(const p of this.args)if(p.evaluate(a,e))return!0;return!1};return k}(),x=function(){function k(a){this.args=a;this.type=d.BooleanType}k.parse=function(a,e){const p=[];for(let v=1;v<a.length;v++)p.push(f(a[v],e));return new k(p)};k.prototype.evaluate=function(a,e){for(const p of this.args)if(p.evaluate(a,
e))return!1;return!0};return k}(),t=function(){function k(a,e,p){this.type=a;this.args=e;this.fallback=p}k.parse=function(a,e,p){if(4>a.length)throw Error('"case" expects at least 3 arguments');if(1===a.length%2)throw Error('"case" expects an odd number of arguments');let v;const H=[];for(let P=1;P<a.length-1;P+=2){const X=f(a[P],e),S=f(a[P+1],e,p);v||(v=S.type);H.push({condition:X,output:S})}a=f(a[a.length-1],e,p);v||(v=a.type);return new k(v,H,a)};k.prototype.evaluate=function(a,e){for(const p of this.args)if(p.condition.evaluate(a,
e))return p.output.evaluate(a,e);return this.fallback.evaluate(a,e)};return k}(),A=function(){function k(a,e){this.type=a;this.args=e}k.parse=function(a,e){if(2>a.length)throw Error('"coalesce" expects at least 1 argument');let p;const v=[];for(let H=1;H<a.length;H++){const P=f(a[H],e);p||(p=P.type);v.push(P)}return new k(p,v)};k.prototype.evaluate=function(a,e){for(const p of this.args){const v=p.evaluate(a,e);if(null!==v)return v}return null};return k}(),L=function(){function k(a,e,p,v,H){this.type=
a;this.input=e;this.labels=p;this.outputs=v;this.fallback=H}k.parse=function(a,e){if(3>a.length)throw Error('"match" expects at least 3 arguments');if(0===a.length%2)throw Error('"case" expects an even number of arguments');let p;const v=f(a[1],e),H=[],P={};let X;for(let ba=2;ba<a.length-1;ba+=2){var S=a[ba];Array.isArray(S)||(S=[S]);for(const ha of S){S=typeof ha;if("string"!==S&&"number"!==S)throw Error('"match" requires string or number literal as labels');if(!X)X=S;else if(S!==X)throw Error('"match" requires labels to have the same type');
P[ha]=H.length}S=f(a[ba+1],e);p||(p=S.type);H.push(S)}return new k(p,v,P,H,f(a[a.length-1],e))};k.prototype.evaluate=function(a,e){const p=this.input.evaluate(a,e);return(this.outputs[this.labels[p]]||this.fallback).evaluate(a,e)};return k}(),F=function(){function k(e,p,v,H,P){this.operator=e;this.type=p;this.interpolation=v;this.input=H;this.stops=P}k.parse=function(e,p,v){const H=e[0];if(5>e.length)throw Error(`"${H}" expects at least 4 arguments`);const P=e[1];if(!Array.isArray(P)||0===P.length)throw Error(`"${P}" is not a valid interpolation`);
switch(P[0]){case "linear":if(1!==P.length)throw Error("Linear interpolation cannot have parameters");break;case "exponential":if(2!==P.length||"number"!==typeof P[1])throw Error("Exponential interpolation requires one numeric argument");break;case "cubic-bezier":if(5!==P.length)throw Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1");for(var X=1;5>X;X++){var S=P[X];if("number"!==typeof S||0>S||1<S)throw Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1");
}break;default:throw Error(`"${e[0]}" unknown interpolation type "${P[0]}"`);}if(1!==e.length%2)throw Error(`"${H}" expects an even number of arguments`);X=f(e[2],p,d.NumberType);let ba;"interpolate-hcl"===H||"interpolate-lab"===H?ba=d.ColorType:v&&"value"!==v.kind&&(ba=v);v=[];for(S=3;S<e.length;S+=2){const ha=e[S];if("number"!==typeof ha)throw Error(`"${H}" requires stop inputs as literal numbers`);if(v.length&&v[v.length-1][0]>=ha)throw Error(`"${H}" requires strictly ascending stop inputs`);const pa=
f(e[S+1],p,ba);ba||(ba=pa.type);v.push([ha,pa])}if(ba&&ba!==d.ColorType&&ba!==d.NumberType&&("array"!==ba.kind||ba.itemType!==d.NumberType))throw Error(`"${H}" cannot interpolate type ${d.typeToString(ba)}`);return new k(H,ba,P,X,v)};var a=k.prototype;a.evaluate=function(e,p){var v=this.stops;if(1===v.length)return v[0][1].evaluate(e,p);var H=this.input.evaluate(e,p);if(H<=v[0][0])return v[0][1].evaluate(e,p);if(H>=v[v.length-1][0])return v[v.length-1][1].evaluate(e,p);let P=0;for(;++P<v.length&&
!(H<v[P][0]););const X=k.interpolationRatio(this.interpolation,H,v[P-1][0],v[P][0]);H=v[P-1][1].evaluate(e,p);const S=v[P][1].evaluate(e,p);if("interpolate"===this.operator){if("array"===this.type.kind&&Array.isArray(H)&&Array.isArray(S))return H.map((ba,ha)=>h.interpolate(ba,S[ha],X));if("color"===this.type.kind&&H instanceof q&&S instanceof q)return H=new q(H),e=new q(S),new q([h.interpolate(H.r,e.r,X),h.interpolate(H.g,e.g,X),h.interpolate(H.b,e.b,X),h.interpolate(H.a,e.a,X)]);if("number"===this.type.kind&&
"number"===typeof H&&"number"===typeof S)return h.interpolate(H,S,X);throw Error(`"${this.operator}" cannot interpolate type ${d.typeToString(this.type)}`);}if("interpolate-hcl"===this.operator)return e=b.toLCH(H),p=b.toLCH(S),v=p.h-e.h,e=b.toRGB({h:e.h+X*(180<v||-180>v?v-360*Math.round(v/360):v),c:h.interpolate(e.c,p.c,X),l:h.interpolate(e.l,p.l,X)}),new q({a:h.interpolate(H.a,S.a,X),...e});if("interpolate-lab"===this.operator)return e=b.toLAB(H),p=b.toLAB(S),e=b.toRGB({l:h.interpolate(e.l,p.l,X),
a:h.interpolate(e.a,p.a,X),b:h.interpolate(e.b,p.b,X)}),new q({a:h.interpolate(H.a,S.a,X),...e});throw Error(`Unexpected operator "${this.operator}"`);};a.interpolationUniformValue=function(e,p){const v=this.stops;if(1===v.length||e>=v[v.length-1][0])return 0;let H=0;for(;++H<v.length&&!(e<v[H][0]););return k.interpolationRatio(this.interpolation,p,v[H-1][0],v[H][0])};a.getInterpolationRange=function(e){const p=this.stops;if(1===p.length)return e=p[0][0],[e,e];var v=p[p.length-1][0];if(e>=v)return[v,
v];for(v=0;++v<p.length&&!(e<p[v][0]););return[p[v-1][0],p[v][0]]};k.interpolationRatio=function(e,p,v,H){let P=0;"linear"===e[0]?P=k.exponentialInterpolationRatio(p,1,v,H):"exponential"===e[0]?P=k.exponentialInterpolationRatio(p,e[1],v,H):"cubic-bezier"===e[0]&&(P=g.unitBezier(e[1],e[2],e[3],e[4])(k.exponentialInterpolationRatio(p,1,v,H),1E-5));0>P?P=0:1<P&&(P=1);return P};k.exponentialInterpolationRatio=function(e,p,v,H){H-=v;if(0===H)return 0;e-=v;return 1===p?e/H:(p**e-1)/(p**H-1)};return k}(),
O=function(){function k(a,e,p){this.type=a;this.input=e;this.stops=p}k.parse=function(a,e){if(5>a.length)throw Error('"step" expects at least 4 arguments');if(1!==a.length%2)throw Error('"step" expects an even number of arguments');const p=f(a[1],e,d.NumberType);let v;const H=[];H.push([-Infinity,f(a[2],e)]);for(let P=3;P<a.length;P+=2){const X=a[P];if("number"!==typeof X)throw Error('"step" requires stop inputs as literal numbers');if(H.length&&H[H.length-1][0]>=X)throw Error('"step" requires strictly ascending stop inputs');
const S=f(a[P+1],e);v||(v=S.type);H.push([X,S])}return new k(v,p,H)};k.prototype.evaluate=function(a,e){const p=this.stops;if(1===p.length)return p[0][1].evaluate(a,e);const v=this.input.evaluate(a,e);let H=0;for(;++H<p.length&&!(v<p[H][0]););return this.stops[H-1][1].evaluate(a,e)};return k}(),Q=function(){function k(a,e){this.type=a;this.output=e}k.parse=function(a,e,p){if(4>a.length)throw Error('"let" expects at least 3 arguments');if(1===a.length%2)throw Error('"let" expects an odd number of arguments');
const v=new n(e);for(let H=1;H<a.length-1;H+=2){const P=a[H];if("string"!==typeof P)throw Error(`"let" requires a string to define variable names - found ${P}`);v.add(P,f(a[H+1],e))}a=f(a[a.length-1],v,p);return new k(a.type,a)};k.prototype.evaluate=function(a,e){return this.output.evaluate(a,e)};return k}(),R=function(){function k(a,e){this.type=a;this.output=e}k.parse=function(a,e,p){if(2!==a.length||"string"!==typeof a[1])throw Error('"var" requires just one literal string argument');e=e.get(a[1]);
if(!e)throw Error(`${a[1]} must be defined before being used in a "var" expression`);return new k(p||d.ValueType,e)};k.prototype.evaluate=function(a,e){return this.output.evaluate(a,e)};return k}(),V=function(){function k(a,e,p){this.type=a;this.index=e;this.array=p}k.parse=function(a,e){if(3!==a.length)throw Error('"at" expects 2 arguments');const p=f(a[1],e,d.NumberType);a=f(a[2],e);return new k(a.type.itemType,p,a)};k.prototype.evaluate=function(a,e){const p=this.index.evaluate(a,e);a=this.array.evaluate(a,
e);if(0>p||p>=a.length)throw Error('"at" index out of bounds');if(p!==Math.floor(p))throw Error('"at" index must be an integer');return a[p]};return k}(),U=function(){function k(a,e){this.key=a;this.obj=e;this.type=d.ValueType}k.parse=function(a,e){let p;switch(a.length){case 2:return p=f(a[1],e),new k(p);case 3:return p=f(a[1],e),a=f(a[2],e),new k(p,a);default:throw Error('"get" expects 1 or 2 arguments');}};k.prototype.evaluate=function(a,e){const p=this.key.evaluate(a,e);return this.obj?this.obj.evaluate(a,
e)[p]:null==a?void 0:a.values[p]};return k}(),W=function(){function k(a,e){this.key=a;this.obj=e;this.type=d.BooleanType}k.parse=function(a,e){let p;switch(a.length){case 2:return p=f(a[1],e),new k(p);case 3:return p=f(a[1],e),a=f(a[2],e),new k(p,a);default:throw Error('"has" expects 1 or 2 arguments');}};k.prototype.evaluate=function(a,e){const p=this.key.evaluate(a,e);return this.obj?(a=this.obj.evaluate(a,e),p in a):!(null==a||!a.values[p])};return k}(),ca=function(){function k(a,e){this.key=a;
this.vals=e;this.type=d.BooleanType}k.parse=function(a,e){if(3!==a.length)throw Error('"in" expects 2 arguments');return new k(f(a[1],e),f(a[2],e))};k.prototype.evaluate=function(a,e){const p=this.key.evaluate(a,e);return-1!==this.vals.evaluate(a,e).indexOf(p)};return k}(),da=function(){function k(a,e,p){this.item=a;this.array=e;this.from=p;this.type=d.NumberType}k.parse=function(a,e){if(3>a.length||4<a.length)throw Error('"index-of" expects 3 or 4 arguments');const p=f(a[1],e),v=f(a[2],e);return 4===
a.length?(a=f(a[3],e,d.NumberType),new k(p,v,a)):new k(p,v)};k.prototype.evaluate=function(a,e){const p=this.item.evaluate(a,e),v=this.array.evaluate(a,e);if(this.from){a=this.from.evaluate(a,e);if(a!==Math.floor(a))throw Error('"index-of" index must be an integer');return v.indexOf(p,a)}return v.indexOf(p)};return k}(),ea=function(){function k(a){this.arg=a;this.type=d.NumberType}k.parse=function(a,e){if(2!==a.length)throw Error('"length" expects 2 arguments');a=f(a[1],e);return new k(a)};k.prototype.evaluate=
function(a,e){a=this.arg.evaluate(a,e);if("string"===typeof a||Array.isArray(a))return a.length;throw Error('"length" expects string or array');};return k}(),Y=function(){function k(a,e,p,v){this.type=a;this.array=e;this.from=p;this.to=v}k.parse=function(a,e){if(3>a.length||4<a.length)throw Error('"slice" expects 2 or 3 arguments');const p=f(a[1],e),v=f(a[2],e,d.NumberType);if(v.type!==d.NumberType)throw Error('"slice" index must return a number');if(4===a.length){a=f(a[3],e,d.NumberType);if(a.type!==
d.NumberType)throw Error('"slice" index must return a number');return new k(p.type,p,v,a)}return new k(p.type,p,v)};k.prototype.evaluate=function(a,e){const p=this.array.evaluate(a,e);if(!Array.isArray(p)&&"string"!==typeof p)throw Error('"slice" input must be an array or a string');const v=this.from.evaluate(a,e);if(0>v||v>=p.length)throw Error('"slice" index out of bounds');if(v!==Math.floor(v))throw Error('"slice" index must be an integer');if(this.to){a=this.to.evaluate(a,e);if(0>a||a>=p.length)throw Error('"slice" index out of bounds');
if(a!==Math.floor(a))throw Error('"slice" index must be an integer');return p.slice(v,a)}return p.slice(v)};return k}(),I=function(){function k(){this.type=d.BooleanType}k.parse=function(a){if(1!==a.length)throw Error('"has-id" expects no arguments');return new k};k.prototype.evaluate=function(a,e){return a&&void 0!==a.id};return k}(),M=function(){function k(a,e){this.args=a;this.calculate=e;this.type=d.NumberType}k.parse=function(a,e,p){a=a.slice(1).map(v=>f(v,e));return new k(a,p)};k.prototype.evaluate=
function(a,e){let p;this.args&&(p=this.args.map(v=>v.evaluate(a,e)));return this.calculate(p)};return k}(),T=function(k){function a(){return k.apply(this,arguments)||this}u._inheritsLoose(a,k);a.parse=function(e,p){switch(e.length){case 2:return M.parse(e,p,v=>-v[0]);case 3:return M.parse(e,p,v=>v[0]-v[1]);default:throw Error('"-" expects 1 or 2 arguments');}};return a}(M),Z=function(k){function a(){return k.apply(this,arguments)||this}u._inheritsLoose(a,k);a.parse=function(e,p){return M.parse(e,
p,v=>{let H=1;for(const P of v)H*=P;return H})};return a}(M),ia=function(k){function a(){return k.apply(this,arguments)||this}u._inheritsLoose(a,k);a.parse=function(e,p){if(3===e.length)return M.parse(e,p,v=>v[0]/v[1]);throw Error('"/" expects 2 arguments');};return a}(M),ka=function(k){function a(){return k.apply(this,arguments)||this}u._inheritsLoose(a,k);a.parse=function(e,p){if(3===e.length)return M.parse(e,p,v=>v[0]%v[1]);throw Error('"%" expects 2 arguments');};return a}(M),la=function(k){function a(){return k.apply(this,
arguments)||this}u._inheritsLoose(a,k);a.parse=function(e,p){if(3===e.length)return M.parse(e,p,v=>v[0]**v[1]);throw Error('"^" expects 1 or 2 arguments');};return a}(M),ma=function(k){function a(){return k.apply(this,arguments)||this}u._inheritsLoose(a,k);a.parse=function(e,p){return M.parse(e,p,v=>{let H=0;for(const P of v)H+=P;return H})};return a}(M),aa=function(){function k(a,e){this.args=a;this.calculate=e;this.type=d.NumberType}k.parse=function(a,e){const p=a.slice(1).map(v=>f(v,e));return new k(p,
k.ops[a[0]])};k.prototype.evaluate=function(a,e){let p;this.args&&(p=this.args.map(v=>v.evaluate(a,e)));return this.calculate(p)};return k}();aa.ops={abs:k=>Math.abs(k[0]),acos:k=>Math.acos(k[0]),asin:k=>Math.asin(k[0]),atan:k=>Math.atan(k[0]),ceil:k=>Math.ceil(k[0]),cos:k=>Math.cos(k[0]),e:()=>Math.E,floor:k=>Math.floor(k[0]),ln:k=>Math.log(k[0]),ln2:()=>Math.LN2,log10:k=>Math.log(k[0])/Math.LN10,log2:k=>Math.log(k[0])/Math.LN2,max:k=>Math.max(...k),min:k=>Math.min(...k),pi:()=>Math.PI,round:k=>
Math.round(k[0]),sin:k=>Math.sin(k[0]),sqrt:k=>Math.sqrt(k[0]),tan:k=>Math.tan(k[0])};let qa=function(){function k(a){this.args=a;this.type=d.StringType}k.parse=function(a,e){return new k(a.slice(1).map(p=>f(p,e)))};k.prototype.evaluate=function(a,e){return this.args.map(p=>p.evaluate(a,e)).join("")};return k}(),na=function(){function k(a,e){this.arg=a;this.calculate=e;this.type=d.StringType}k.parse=function(a,e){if(2!==a.length)throw Error(`${a[0]} expects 1 argument`);e=f(a[1],e);return new k(e,
k.ops[a[0]])};k.prototype.evaluate=function(a,e){return this.calculate(this.arg.evaluate(a,e))};return k}();na.ops={downcase:k=>k.toLowerCase(),upcase:k=>k.toUpperCase()};let ra=function(){function k(e){this.args=e;this.type=d.ColorType}k.parse=function(e,p){if(4!==e.length)throw Error('"rgb" expects 3 arguments');e=e.slice(1).map(v=>f(v,p));return new k(e)};var a=k.prototype;a.evaluate=function(e,p){const v=this._validate(this.args[0].evaluate(e,p)),H=this._validate(this.args[1].evaluate(e,p));e=
this._validate(this.args[2].evaluate(e,p));return new q({r:v,g:H,b:e})};a._validate=function(e){if("number"!==typeof e||0>e||255<e)throw Error(`${e}: invalid color component`);return Math.round(e)};return k}(),sa=function(){function k(e){this.args=e;this.type=d.ColorType}k.parse=function(e,p){if(5!==e.length)throw Error('"rgba" expects 4 arguments');e=e.slice(1).map(v=>f(v,p));return new k(e)};var a=k.prototype;a.evaluate=function(e,p){const v=this._validate(this.args[0].evaluate(e,p)),H=this._validate(this.args[1].evaluate(e,
p)),P=this._validate(this.args[2].evaluate(e,p));e=this._validateAlpha(this.args[3].evaluate(e,p));return new q({r:v,g:H,b:P,a:e})};a._validate=function(e){if("number"!==typeof e||0>e||255<e)throw Error(`${e}: invalid color component`);return Math.round(e)};a._validateAlpha=function(e){if("number"!==typeof e||0>e||1<e)throw Error(`${e}: invalid alpha color component`);return e};return k}(),ta=function(){function k(a){this.color=a;this.type=d.arrayType(d.NumberType,4)}k.parse=function(a,e){if(2!==
a.length)throw Error('"to-rgba" expects 1 argument');a=f(a[1],e);return new k(a)};k.prototype.evaluate=function(a,e){return(new q(this.color.evaluate(a,e))).toRgba()};return k}(),ja=function(){function k(a,e){this.type=a;this.args=e}k.parse=function(a,e){var p=a[0];if(2>a.length)throw Error(`${p} expects at least one argument`);let v=1,H;if("array"===p){if(2<a.length){switch(a[1]){case "string":H=d.StringType;break;case "number":H=d.NumberType;break;case "boolean":H=d.BooleanType;break;default:throw Error('"array" type argument must be string, number or boolean');
}v++}else H=d.ValueType;if(3<a.length){var P=a[2];if(null!==P&&("number"!==typeof P||0>P||P!==Math.floor(P)))throw Error('"array" length argument must be a positive integer literal');v++}H=d.arrayType(H,P)}else switch(p){case "string":H=d.StringType;break;case "number":H=d.NumberType;break;case "boolean":H=d.BooleanType;break;case "object":H=d.ObjectType}for(p=[];v<a.length;v++)P=f(a[v],e),p.push(P);return new k(H,p)};k.prototype.evaluate=function(a,e){let p;for(const v of this.args){const H=v.evaluate(a,
e);p=d.getType(H);if(d.matchType(p,this.type))return H}throw Error(`Expected ${d.typeToString(this.type)} but got ${d.typeToString(p)}`);};return k}(),fa=function(){function k(a,e){this.type=a;this.args=e}k.parse=function(a,e){var p=a[0];const v=k.types[p];if(v===d.BooleanType||v===d.StringType){if(2!==a.length)throw Error(`${p} expects one argument`);}else if(2>a.length)throw Error(`${p} expects at least one argument`);p=[];for(let H=1;H<a.length;H++){const P=f(a[H],e);p.push(P)}return new k(v,p)};
k.prototype.evaluate=function(a,e){if(this.type===d.BooleanType)return!!this.args[0].evaluate(a,e);if(this.type===d.StringType)return d.valueToString(this.args[0].evaluate(a,e));if(this.type===d.NumberType){for(const v of this.args){var p=Number(v.evaluate(a,e));if(!isNaN(p))return p}return null}if(this.type===d.ColorType){for(p of this.args)try{const v=k.toColor(p.evaluate(a,e));if(v instanceof q)return v}catch{}return null}};k.toBoolean=function(a){return!!a};k.toString=function(a){return d.valueToString(a)};
k.toNumber=function(a){const e=Number(a);if(isNaN(e))throw Error(`"${a}" is not a number`);return e};k.toColor=function(a){if(a instanceof q)return a;if("string"===typeof a){const e=q.fromString(a);if(e)return e;throw Error(`"${a}" is not a color`);}if(Array.isArray(a))return q.fromArray(a);throw Error(`"${a}" is not a color`);};return k}();fa.types={"to-boolean":d.BooleanType,"to-color":d.ColorType,"to-number":d.NumberType,"to-string":d.StringType};let ua=function(){function k(a){this.val=a;this.type=
d.getType(a)}k.parse=function(a){if(2!==a.length)throw Error('"literal" expects 1 argument');return new k(a[1])};k.prototype.evaluate=function(a,e){return this.val};return k}(),va=function(){function k(a){this.arg=a;this.type=d.StringType}k.parse=function(a,e){if(2!==a.length)throw Error('"typeof" expects 1 argument');return new k(f(a[1],e))};k.prototype.evaluate=function(a,e){return d.typeToString(d.getType(this.arg.evaluate(a,e)))};return k}();const oa={array:ja,boolean:ja,collator:null,format:null,
image:null,literal:ua,number:ja,"number-format":null,object:ja,string:ja,"to-boolean":fa,"to-color":fa,"to-number":fa,"to-string":fa,typeof:va,accumulated:null,"feature-state":null,"geometry-type":m,id:c,"line-progress":null,properties:y,at:V,get:U,has:W,in:ca,"index-of":da,length:ea,slice:Y,"!":z,"!\x3d":C,"\x3c":N,"\x3c\x3d":D,"\x3d\x3d":G,"\x3e":K,"\x3e\x3d":B,all:r,any:w,case:t,coalesce:A,match:L,within:null,interpolate:F,"interpolate-hcl":F,"interpolate-lab":F,step:O,let:Q,var:R,concat:qa,downcase:na,
"is-supported-script":null,"resolved-locale":null,upcase:na,rgb:ra,rgba:sa,"to-rgba":ta,"-":T,"*":Z,"/":ia,"%":ka,"^":la,"+":ma,abs:aa,acos:aa,asin:aa,atan:aa,ceil:aa,cos:aa,e:aa,floor:aa,ln:aa,ln2:aa,log10:aa,log2:aa,max:aa,min:aa,pi:aa,round:aa,sin:aa,sqrt:aa,tan:aa,zoom:J,"heatmap-density":null,"has-id":I,none:x};l.ALL=r;l.ANY=w;l.Add=ma;l.Assert=ja;l.At=V;l.Calculate=aa;l.Case=t;l.Coalesce=A;l.Coerce=fa;l.Concat=qa;l.Div=ia;l.EQ=G;l.GE=B;l.GT=K;l.GeomType=m;l.Get=U;l.Has=W;l.HasID=I;l.ID=c;l.In=
ca;l.IndexOf=da;l.Interpolate=F;l.LE=D;l.LT=N;l.Length=ea;l.Let=Q;l.Literal=ua;l.Match=L;l.Mod=ka;l.Mul=Z;l.NE=C;l.NONE=x;l.NOT=z;l.Pow=la;l.Properties=y;l.Rgb=ra;l.Rgba=sa;l.Slice=Y;l.Step=O;l.String=na;l.Sub=T;l.ToRgba=ta;l.TypeOf=va;l.Var=R;l.Zoom=J;l.createExpression=f;l.ops=oa;Object.defineProperty(l,"__esModule",{value:!0})})},"esri/core/colorUtils":function(){define(["exports"],function(l){function u(c,m){const y=[];let J,E;if(c[0].length!==m.length)throw"dimensions do not match";const G=c.length,
C=c[0].length;let N=0;for(J=0;J<G;J++){for(E=N=0;E<C;E++)N+=c[J][E]*m[E];y.push(N)}return y}function q(c){c=[c.r/255,c.g/255,c.b/255].map(m=>.04045>=m?m/12.92:((m+.055)/1.055)**2.4);c=u(f,c);return{x:100*c[0],y:100*c[1],z:100*c[2]}}function b(c){c=u(n,[c.x/100,c.y/100,c.z/100]).map(m=>Math.min(1,Math.max(.0031308>=m?12.92*m:1.055*m**(1/2.4)-.055,0)));return{r:Math.round(255*c[0]),g:Math.round(255*c[1]),b:Math.round(255*c[2])}}function g(c){c=[c.x/95.047,c.y/100,c.z/108.883].map(m=>m>(6/29)**3?m**
(1/3):1/3*(29/6)**2*m+4/29);return{l:116*c[1]-16,a:500*(c[0]-c[1]),b:200*(c[1]-c[2])}}function h(c){const m=c.l;c=[(m+16)/116+c.a/500,(m+16)/116,(m+16)/116-c.b/200].map(y=>y>6/29?y**3:3*(6/29)**2*(y-4/29));return{x:95.047*c[0],y:100*c[1],z:108.883*c[2]}}function d(c){if("r"in c&&"g"in c&&"b"in c)return c;if("l"in c&&"c"in c&&"h"in c){var m=c.c;var y=c.h;m={l:c.l,a:m*Math.cos(y),b:m*Math.sin(y)};return b(h(m))}if("l"in c&&"a"in c&&"b"in c)return b(h(c));if("x"in c&&"y"in c&&"z"in c)return b(c);if("h"in
c&&"s"in c&&"v"in c){{y=(c.h+360)%360/60;m=c.v/100*255;c=c.s/100*m;const J=c*(1-Math.abs(y%2-1));switch(Math.floor(y)){case 0:y={r:c,g:J,b:0};break;case 1:y={r:J,g:c,b:0};break;case 2:y={r:0,g:c,b:J};break;case 3:y={r:0,g:J,b:c};break;case 4:y={r:J,g:0,b:c};break;case 5:case 6:y={r:c,g:0,b:J};break;default:y={r:0,g:0,b:0}}y.r=Math.round(y.r+m-c);y.g=Math.round(y.g+m-c);y.b=Math.round(y.b+m-c);m=y}return m}return c}const f=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],n=[[3.2406,-1.5372,
-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];l.darken=function(c,m){c=g(q(c));c.l*=1-m;return b(h(c))};l.toHSV=function(c){if("h"in c&&"s"in c&&"v"in c)return c;var m=d(c);{c=m.r;const y=m.g,J=m.b;m=Math.max(c,y,J);const E=m-Math.min(c,y,J);c=0===E?0:m===c?(y-J)/E%6:m===y?(J-c)/E+2:(c-y)/E+4;0>c&&(c+=6);c={h:60*c,s:100*(0===E?0:E/m),v:100/255*m}}return c};l.toLAB=function(c){return"l"in c&&"a"in c&&"b"in c?c:g(q(d(c)))};l.toLCH=function(c){if(!("l"in c&&"c"in c&&"h"in c)){{var m=g(q(d(c)));
c=m.l;var y=m.a;const J=m.b;m=Math.sqrt(y*y+J*J);y=Math.atan2(J,y);y=0<y?y:y+2*Math.PI;c={l:c,c:m,h:y}}}return c};l.toRGB=d;l.toXYZ=function(c){return"x"in c&&"y"in c&&"z"in c?c:q(d(c))};Object.defineProperty(l,"__esModule",{value:!0})})},"esri/views/2d/unitBezier":function(){define(["exports"],function(l){function u(g,h,d,f){function n(C,N){var D;let K,B;K=C;for(D=0;8>D;D++){B=((y*K+m)*K+c)*K-C;if(Math.abs(B)<N)return K;var z=(3*y*K+2*m)*K+c;if(1E-6>Math.abs(z))break;K-=B/z}z=0;D=1;K=C;if(K<z)return z;
if(K>D)return D;for(;z<D;){B=((y*K+m)*K+c)*K;if(Math.abs(B-C)<N)break;C>B?z=K:D=K;K=.5*(D-z)+z}return K}const c=3*g,m=3*(d-g)-c,y=1-c-m,J=3*h,E=3*(f-h)-J,G=1-J-E;return function(C,N=1E-6){C=n(C,N);return((G*C+E)*C+J)*C}}const q=/^cubic-bezier\((.*)\)/,b={};b.ease=u(.25,.1,.25,1);b.linear=u(0,0,1,1);b.easeIn=b["ease-in"]=u(.42,0,1,1);b.easeOut=b["ease-out"]=u(0,0,.58,1);b.easeInOut=b["ease-in-out"]=u(.42,0,.58,1);l.easingFunctions=b;l.parse=function(g){let h=b[g]||null;!h&&(g=q.exec(g))&&(g=g[1].split(",").map(d=>
parseFloat(d.trim())),4!==g.length||g.some(d=>isNaN(d))||(h=u.apply(u,g)));return h};l.unitBezier=u;Object.defineProperty(l,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/GeometryUtils":function(){define(["exports"],function(l){function u(f,n){f%=n;return 0<=f?f:f+n}const q=Number.POSITIVE_INFINITY,b=Math.PI,g=128/b,h=256/360,d=1/Math.LN2;l.C_256_TO_RAD=b/128;l.C_2PI=2*b;l.C_DEG_TO_256=h;l.C_DEG_TO_RAD=b/180;l.C_INFINITY=q;l.C_PI=b;l.C_PI_BY_2=b/2;l.C_RAD_TO_256=g;l.C_SQRT2=1.414213562;
l.C_SQRT2_INV=1/1.414213562;l.between=function(f,n,c){return f>=n&&f<=c||f>=c&&f<=n};l.degToByte=function(f){return u(f*h,256)};l.interpolate=function(f,n,c){return f*(1-c)+n*c};l.log2=function(f){return Math.log(f)*d};l.positiveMod=u;l.radToByte=function(f){return u(f*g,256)};l.sqr=function(f){return f*f};Object.defineProperty(l,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/expression/types":function(){define(["exports","../../../../../Color"],function(l,u){function q(G,C){return{kind:"array",
itemType:G,n:C}}function b(G){if("array"===G.kind){const C=b(G.itemType);return"number"===typeof G.n?`array<${C}, ${G.n}>`:"value"===G.itemType.kind?"array":`array<${C}>`}return G.kind}function g(G){if(null===G)return d;if("string"===typeof G)return n;if("boolean"===typeof G)return c;if("number"===typeof G)return f;if(G instanceof u)return m;if(Array.isArray(G)){let C;for(const N of G){const D=g(N);if(!C)C=D;else if(C!==D){C=J;break}}return q(C||J,G.length)}return"object"===typeof G?y:J}function h(G,
C){if("array"===C.kind)return"array"===G.kind&&(0===G.n&&"value"===G.itemType.kind||h(G.itemType,C.itemType))&&("number"!==typeof C.n||C.n===G.n);if("value"===C.kind)for(const N of E)if(h(G,N))return!0;return C.kind===G.kind}const d={kind:"null"},f={kind:"number"},n={kind:"string"},c={kind:"boolean"},m={kind:"color"},y={kind:"object"},J={kind:"value"},E=[d,f,n,c,m,y,q(J)];l.BooleanType=c;l.ColorType=m;l.NullType=d;l.NumberType=f;l.ObjectType=y;l.StringType=n;l.ValueType=J;l.arrayType=q;l.getType=
g;l.matchType=h;l.typeToString=b;l.valueToString=function(G){if(null===G)return"";const C=typeof G;return"string"===C?G:"number"===C||"boolean"===C?String(G):G instanceof u?G.toString():JSON.stringify(G)};Object.defineProperty(l,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/style/StyleDefinition":function(){define(["exports"],function(l){let u=function(){};u.backgroundLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:0}};u.fillLayoutDefinition={visibility:{type:"enum",
values:["visible","none"],default:0}};u.lineLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:0},"line-cap":{type:"enum",values:["butt","round","square"],default:0},"line-join":{type:"enum",values:["bevel","round","miter"],default:2},"line-miter-limit":{type:"number",default:2},"line-round-limit":{type:"number",default:1.05}};u.symbolLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:0},"symbol-avoid-edges":{type:"boolean",default:!1},"symbol-placement":{type:"enum",
values:["point","line","line-center"],default:0},"symbol-sort-key":{type:"number",default:-1},"symbol-spacing":{type:"number",minimum:1,default:250},"icon-allow-overlap":{type:"boolean",default:!1},"icon-anchor":{type:"enum",values:"center left right top bottom top-left top-right bottom-left bottom-right".split(" "),default:0},"icon-ignore-placement":{type:"boolean",default:!1},"icon-image":{type:"string"},"icon-keep-upright":{type:"boolean",default:!1},"icon-offset":{type:"array",value:"number",
length:2,default:[0,0]},"icon-optional":{type:"boolean",default:!1},"icon-padding":{type:"number",minimum:0,default:2},"icon-rotate":{type:"number",default:0},"icon-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:2},"icon-size":{type:"number",minimum:0,default:1},"text-allow-overlap":{type:"boolean",default:!1},"text-anchor":{type:"enum",values:"center left right top bottom top-left top-right bottom-left bottom-right".split(" "),default:0},"text-field":{type:"string"},"text-font":{type:"array",
value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"]},"text-ignore-placement":{type:"boolean",default:!1},"text-justify":{type:"enum",values:["auto","left","center","right"],default:2},"text-keep-upright":{type:"boolean",default:!0},"text-letter-spacing":{type:"number",default:0},"text-line-height":{type:"number",default:1.2},"text-max-angle":{type:"number",minimum:0,default:45},"text-max-width":{type:"number",minimum:0,default:10},"text-offset":{type:"array",value:"number",length:2,
default:[0,0]},"text-optional":{type:"boolean",default:!1},"text-padding":{type:"number",minimum:0,default:2},"text-rotate":{type:"number",default:0},"text-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:2},"text-size":{type:"number",minimum:0,default:16},"text-transform":{type:"enum",values:["none","uppercase","lowercase"],default:0},"text-writing-mode":{type:"array",value:"enum",values:["horizontal","vertical"],default:[0]}};u.circleLayoutDefinition={visibility:{type:"enum",
values:["visible","none"],default:0}};u.backgroundPaintDefinition={"background-color":{type:"color",default:[0,0,0,1]},"background-opacity":{type:"number",minimum:0,maximum:1,default:1},"background-pattern":{type:"string"}};u.fillPaintDefinition={"fill-antialias":{type:"boolean",default:!0},"fill-color":{type:"color",default:[0,0,0,1]},"fill-opacity":{type:"number",minimum:0,maximum:1,default:1},"fill-outline-color":{type:"color",default:[0,0,0,0]},"fill-pattern":{type:"string"},"fill-translate":{type:"array",
value:"number",length:2,default:[0,0]},"fill-translate-anchor":{type:"enum",values:["map","viewport"],default:0}};u.linePaintDefinition={"line-blur":{type:"number",minimum:0,default:0},"line-color":{type:"color",default:[0,0,0,1]},"line-dasharray":{type:"array",value:"number",default:[]},"line-gap-width":{type:"number",minimum:0,default:0},"line-offset":{type:"number",default:0},"line-opacity":{type:"number",minimum:0,maximum:1,default:1},"line-pattern":{type:"string"},"line-translate":{type:"array",
value:"number",length:2,default:[0,0]},"line-translate-anchor":{type:"enum",values:["map","viewport"],default:0},"line-width":{type:"number",minimum:0,default:1}};u.symbolPaintDefinition={"icon-color":{type:"color",default:[0,0,0,1]},"icon-halo-blur":{type:"number",minimum:0,default:0},"icon-halo-color":{type:"color",default:[0,0,0,0]},"icon-halo-width":{type:"number",minimum:0,default:0},"icon-opacity":{type:"number",minimum:0,maximum:1,default:1},"icon-translate":{type:"array",value:"number",length:2,
default:[0,0]},"icon-translate-anchor":{type:"enum",values:["map","viewport"],default:0},"text-color":{type:"color",default:[0,0,0,1]},"text-halo-blur":{type:"number",minimum:0,default:0},"text-halo-color":{type:"color",default:[0,0,0,0]},"text-halo-width":{type:"number",minimum:0,default:0},"text-opacity":{type:"number",minimum:0,maximum:1,default:1},"text-translate":{type:"array",value:"number",length:2,default:[0,0]},"text-translate-anchor":{type:"enum",values:["map","viewport"],default:0}};u.rasterPaintDefinition=
{"raster-opacity":{type:"number",minimum:0,maximum:1,default:1},"raster-hue-rotate":{type:"number",default:0},"raster-brightness-min":{type:"number",minimum:0,maximum:1,default:0},"raster-brightness-max":{type:"number",minimum:0,maximum:1,default:1},"raster-saturation":{type:"number",minimum:-1,maximum:1,default:0},"raster-contrast":{type:"number",minimum:-1,maximum:1,default:0},"raster-fade-duration":{type:"number",minimum:0,default:300}};u.circlePaintDefinition={"circle-blur":{type:"number",minimum:0,
default:0},"circle-color":{type:"color",default:[0,0,0,1]},"circle-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-radius":{type:"number",minimum:0,default:5},"circle-stroke-color":{type:"color",default:[0,0,0,1]},"circle-stroke-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-stroke-width":{type:"number",minimum:0,default:0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0]},"circle-translate-anchor":{type:"enum",values:["map","viewport"],default:0}};
l.StyleDefinition=u;Object.defineProperty(l,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/style/StyleProperty":function(){define(["../../../../../Color","../GeometryUtils","../expression/expression","../expression/types"],function(l,u,q,b){return function(){function g(d,f){this.isDataDriven=!1;this.interpolator=null;switch(d.type){case "number":var n=!0;break;case "color":n=!0;break;case "array":n="number"===d.value;break;default:n=!1}null==f&&(f=d.default);if(Array.isArray(f)&&0<
f.length&&q.ops[f[0]]){n={number:b.NumberType,color:b.ColorType,string:b.StringType,boolean:b.BooleanType,enum:b.StringType};try{var c="array"===d.type?b.arrayType(n[d.value]||b.ValueType,d.length):n[d.type];const m=q.createExpression(f,null,c);this.getValue=this._buildExpression(m,d);this.isDataDriven=!0;m instanceof q.Interpolate&&m.input instanceof q.Zoom&&(this.interpolator=m)}catch(m){console.log(m.message),this.getValue=this._buildSimple(d.default)}}else{n&&"interval"===f.type&&(n=!1);if(c=
f&&f.stops&&0<f.stops.length)for(const m of f.stops)m[1]=this._validate(m[1],d);if(this.isDataDriven=f?!!f.property:!1)if(void 0!==f.default&&(f.default=this._validate(f.default,d)),c)switch(f.type){case "identity":this.getValue=this._buildIdentity(f,d);break;case "categorical":this.getValue=this._buildCategorical(f,d);break;default:this.getValue=n?this._buildInterpolate(f,d):this._buildInterval(f,d)}else this.getValue=this._buildIdentity(f,d);else c?this.getValue=n?this._buildZoomInterpolate(f):
this._buildZoomInterval(f):(f=this._validate(f,d),this.getValue=this._buildSimple(f))}}var h=g.prototype;h._validate=function(d,f){if("number"===f.type){if(d<f.minimum)return f.minimum;if(d>f.maximum)return f.maximum}else"color"===f.type?d=g._parseColor(d):"enum"===f.type?"string"===typeof d&&(d=f.values.indexOf(d)):"array"===f.type&&"enum"===f.value?d=d.map(n=>"string"===typeof d?f.values.indexOf(n):n):"string"===f.type&&(d=b.valueToString(d));return d};h._buildSimple=function(d){return()=>d};h._buildExpression=
function(d,f){return(n,c)=>{try{const m=d.evaluate(c,n);return void 0===m?f.default:this._validate(m,f)}catch(m){return console.log(m.message),f.default}}};h._buildIdentity=function(d,f){return(n,c)=>{let m;c&&(m=c.values[d.property]);void 0!==m&&(m=this._validate(m,f));return null!=m?m:void 0!==d.default?d.default:f.default}};h._buildCategorical=function(d,f){return(n,c)=>{let m;c&&(m=c.values[d.property]);m=this._categorical(m,d.stops);return void 0!==m?m:void 0!==d.default?d.default:f.default}};
h._buildInterval=function(d,f){return(n,c)=>{let m;c&&(m=c.values[d.property]);return"number"===typeof m?this._interval(m,d.stops):void 0!==d.default?d.default:f.default}};h._buildInterpolate=function(d,f){return(n,c)=>{let m;c&&(m=c.values[d.property]);return"number"===typeof m?this._interpolate(m,d.stops,d.base||1):void 0!==d.default?d.default:f.default}};h._buildZoomInterpolate=function(d){return f=>this._interpolate(f,d.stops,d.base||1)};h._buildZoomInterval=function(d){return f=>this._interval(f,
d.stops)};h._categorical=function(d,f){const n=f.length;for(let c=0;c<n;c++)if(f[c][0]===d)return f[c][1]};h._interval=function(d,f){const n=f.length;let c=0;for(let m=0;m<n;m++)if(f[m][0]<=d)c=m;else break;return f[c][1]};h._interpolate=function(d,f,n){const c=f.length;for(let J=0;J<c;J++){const E=f[J];if(E[0]<=d)var m=E;else{var y=E;break}}if(m&&y){f=y[0]-m[0];d-=m[0];n=1===n?d/f:(n**d-1)/(n**f-1);if(Array.isArray(m[1])){m=m[1];y=y[1];d=[];for(f=0;f<m.length;f++)d.push(u.interpolate(m[f],y[f],n));
return d}return u.interpolate(m[1],y[1],n)}if(m)return m[1];if(y)return y[1]};g._isEmpty=function(d){for(const f in d)if(d.hasOwnProperty(f))return!1;return!0};g._parseColor=function(d){if(Array.isArray(d))return d;"string"===typeof d&&(d=new l(d));if(d instanceof l&&!this._isEmpty(d))return l.toUnitRGBA(d)};return g}()})},"esri/views/2d/engine/webgl/definitions":function(){define(["exports"],function(l){l.ANGLE_FACTOR_256=256/360;l.ATTRIBUTE_DATA_ANIMATION=1;l.ATTRIBUTE_DATA_DD0=3;l.ATTRIBUTE_DATA_DD1=
3;l.ATTRIBUTE_DATA_FILTER_FLAGS=0;l.ATTRIBUTE_DATA_VV=2;l.ATTRIBUTE_STORE_TEXTURE_SIZE=1024;l.AVERAGE_GLYPH_MOSAIC_ITEM={metrics:{width:15,height:17,left:0,top:-7,advance:14}};l.BUFFER_DATA_MINIMUM_SIZE=128;l.BUFFER_DATA_POOL_SIZE=4;l.COLLISION_BOX_PADDING=16;l.COLLISION_BUCKET_SIZE=128;l.COLLISION_EARLY_REJECT_BUCKET_SIZE=16;l.COLLISION_MAX_ZOOM_DELTA=1;l.COLLISION_PLACEMENT_PADDING=8;l.COLLISION_TILE_BOX_SIZE=4;l.DEBUG_LABELS=!1;l.DISPLAY_RECORD_INT_PER_ELEMENT=8;l.DOT_DENSITY_MAX_FIELDS=8;l.EFFECT_FLAG_0=
4;l.ENABLE_EARLY_LABEL_DISCARD=!1;l.EXTRUDE_SCALE=64;l.FILTER_FLAG_0=2;l.GLYPH_SIZE=24;l.HEURISTIC_GLYPHS_PER_FEATURE=10;l.HEURISTIC_GLYPHS_PER_LINE=50;l.HIGHLIGHT_FLAG=1;l.HITTEST_SEARCH_SIZE=6;l.MAGIC_LABEL_LINE_HEIGHT=29;l.MAX_FILTERS=2;l.MAX_GPU_UPLOADS_PER_FRAME=2;l.MIN_MAX_ZOOM_PRECISION_FACTOR=10;l.NAN_MAGIC_NUMBER=1E-30;l.PATCH_PIXEL_BUFFER_ALLOC_SIZE=500;l.PICTURE_FILL_COLOR=4294967295;l.RASTER_TILE_SIZE=256;l.SPRITE_PADDING=2;l.TEXTURE_BINDING_ATTRIBUTE_DATA_0=1;l.TEXTURE_BINDING_ATTRIBUTE_DATA_1=
2;l.TEXTURE_BINDING_ATTRIBUTE_DATA_2=3;l.TEXTURE_BINDING_ATTRIBUTE_DATA_3=4;l.TEXTURE_BINDING_BITMAP=0;l.TEXTURE_BINDING_GLYPH_ATLAS=0;l.TEXTURE_BINDING_HIGHLIGHT_0=5;l.TEXTURE_BINDING_HIGHLIGHT_1=6;l.TEXTURE_BINDING_RENDERER_0=5;l.TEXTURE_BINDING_RENDERER_1=6;l.TEXTURE_BINDING_SPRITE_ATLAS=0;l.TEXT_PLACEMENT_PADDING=8;l.THIN_LINE_HALF_WIDTH_THRESHOLD=1.05;l.TILE_SIZE=512;l.VTL_HIGH_RES_CUTOFF=1.15;l.VTL_TEXTURE_BINDING_UNIT_GLYPHS=6;l.VTL_TEXTURE_BINDING_UNIT_SPRITES=5;l.WEBGL_MAX_INNER_STOPS=6;
l.WEBGL_MAX_STOPS=8;Object.defineProperty(l,"__esModule",{value:!0})})},"esri/views/webgl/capabilities":function(){define(["../../core/maybe","./context-util"],function(l,u){function q(){const g={available:!1,version:0,majorPerformanceCaveat:!1,maxTextureSize:0,supportsHighPrecisionFragment:!1,supportsVertexShaderSamplers:!1,supportsElementIndexUint:!1,supportsStandardDerivatives:!1,supportsInstancedArrays:!1,supportsTextureFloat:!1,supportsColorBufferFloat:!1};var h=document.createElement("canvas");
if(!h)return g;var d=u.createContext(h,1,{failIfMajorPerformanceCaveat:!0});l.isNone(d)&&(d=u.createContext(h,1),l.isSome(d)&&(g.majorPerformanceCaveat=!0));if(l.isNone(d))return g;h=d.getParameter(d.VERSION);if(!h)return g;if(h=h.match(/^WebGL\s+([\d.]*)/)){h=parseFloat(h[1]);g.available=.94<=h;if(h=d.getShaderPrecisionFormat(d.FRAGMENT_SHADER,d.HIGH_FLOAT))g.supportsHighPrecisionFragment=0<h.precision;g.supportsVertexShaderSamplers=0<d.getParameter(d.MAX_VERTEX_TEXTURE_IMAGE_UNITS);g.supportsElementIndexUint=
null!==d.getExtension("OES_element_index_uint");g.supportsStandardDerivatives=null!==d.getExtension("OES_standard_derivatives");g.supportsInstancedArrays=null!==d.getExtension("ANGLE_instanced_arrays");g.supportsTextureFloat=null!==d.getExtension("OES_texture_float");g.supportsColorBufferFloat=null!==d.getExtension("WEBGL_color_buffer_float")&&null!==d.getExtension("EXT_float_blend")}g.maxTextureSize=d.getParameter(d.MAX_TEXTURE_SIZE);(d=document.createElement("canvas"))?(d=u.createContext(d,2),d=
l.isSome(d)?!0:!1):d=!1;g.version=d?2:1;return g}let b;return function(){b||(b=q());return b}})},"esri/views/webgl/context-util":function(){define(["exports","../../core/maybe"],function(l,u){function q(g,h,d={}){h=1===h?["webgl","experimental-webgl","webkit-3d","moz-webgl"]:["webgl2"];let f=null;for(const n of h){try{f=g.getContext(n,d)}catch(c){}if(f)break}return f}function b(g,h){(g=g.parentNode)&&(g.innerHTML='\x3ctable style\x3d"background-color: #8CE; width: 100%; height: 100%;"\x3e\x3ctr\x3e\x3ctd align\x3d"center"\x3e\x3cdiv style\x3d"display: table-cell; vertical-align: middle;"\x3e\x3cdiv style\x3d""\x3e'+
h+"\x3c/div\x3e\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e")}l.createContext=q;l.createContextOrErrorHTML=function(g,h,d={}){if(!window.WebGLRenderingContext)return b(g,'This page requires a browser that supports WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org"\x3eClick here to upgrade your browser.\x3c/a\x3e'),null;h=q(g,h,d);return u.isNone(h)?(b(g,'It doesn\'t appear your computer can support WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org/troubleshooting/"\x3eClick here for more information.\x3c/a\x3e'),
null):h};Object.defineProperty(l,"__esModule",{value:!0})})},"*noref":1}});
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../request ../core/Error ../core/global ../core/lang ../core/MultiOriginJSONSupport ../core/promiseUtils ../core/urlUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/has ../core/Logger ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../core/accessorSupport/decorators/writer ../geometry/Extent ../geometry/SpatialReference ./Layer ./mixins/ArcGISCachedService ./mixins/ArcGISService ./mixins/BlendLayer ./mixins/OperationalLayer ./mixins/PortalLayer ./mixins/ScaleRangeLayer ./support/imageUtils ./support/SpriteSource ./support/TileInfo ./support/TilemapCache ./support/vectorTileLayerLoader ../portal/support/jsonContext ../views/2d/engine/vectorTiles/SchemaHelper ../views/2d/engine/vectorTiles/tileInfoUtils ../views/2d/engine/vectorTiles/style/StyleRepository ../views/webgl/capabilities".split(" "),function(l,
u,q,b,g,h,d,f,n,c,m,y,J,E,G,C,N,D,K,B,z,r,w,x,t,A,L,F,O,Q,R,V,U,W,ca){d=function(da){function ea(...I){I=da.call(this,...I)||this;I._spriteSourceMap=new Map;I.currentStyleInfo=null;I.style=null;I.isReference=null;I.operationalLayerType="VectorTileLayer";I.type="vector-tile";I.url=null;I.symbolCollisionBoxesVisible=!1;return I}l._inheritsLoose(ea,da);var Y=ea.prototype;Y.normalizeCtorArgs=function(I,M){return"string"===typeof I?{url:I,...M}:I};Y.destroy=function(){this._spriteSourceMap.clear()};Y.prefetchResources=
function(){var I=l._asyncToGenerator(function*(M){yield this.loadSpriteSource(g.devicePixelRatio||1,M)});return function(M){return I.apply(this,arguments)}}();Y.load=function(I){var M=this;const T=this.loadFromPortal({supportedTypes:["Vector Tile Service"],supportsData:!1},I).catch(f.throwIfAbortError).then(l._asyncToGenerator(function*(){if(M.portalItem&&M.portalItem.id){var Z=`${M.portalItem.itemUrl}/resources/styles/root.json`;(yield q(Z,{...I,query:{f:"json"}})).data&&M.read({url:Z},R.createForItem(M.portalItem))}})).catch(f.throwIfAbortError).then(()=>
this._loadStyle(I));this.addResolvingPromise(T);return Promise.resolve(this)};Y.writeStyleUrl=function(I,M){I&&n.isProtocolRelative(I)&&(I=`https:${I}`);M.styleUrl=I};Y.readVersion=function(I,M){return M.version?parseFloat(M.version):parseFloat(M.currentVersion)};Y.loadSpriteSource=function(){var I=l._asyncToGenerator(function*(M=1,T){if(!this._spriteSourceMap.has(M)){var Z=ca();Z=new L(this.styleRepository.sprite,M,Z.maxTextureSize,this.currentStyleInfo.spriteFormat);yield Z.load(T);this._spriteSourceMap.set(M,
Z)}return Promise.resolve(this._spriteSourceMap.get(M))});return function(){return I.apply(this,arguments)}}();Y.loadStyle=function(){var I=l._asyncToGenerator(function*(M,T){const Z=M||this.style||this.url;if(this._loadingPromise&&"string"===typeof Z&&this.url===Z&&!f.isAborted(this._abortController))return this._loadingPromise;(M=this._abortController)&&M.abort();const ia=f.createAbortController();this._loadingPromise=new Promise((ka,la)=>{const ma={signal:ia.signal};this._spriteSourceMap.clear();
this._getSourceAndStyle(Z,ma).then(ka,la);f.onAbort(T,()=>{ia.abort()})});this._abortController=ia;return this._loadingPromise});return function(M,T){return I.apply(this,arguments)}}();Y.getStyleLayerId=function(I){return this.styleRepository.getStyleLayerId(I)};Y.getStyleLayerIndex=function(I){return this.styleRepository.getStyleLayerIndex(I)};Y.getPaintProperties=function(I){return h.clone(this.styleRepository.getPaintProperties(I))};Y.setPaintProperties=function(I,M){const T=this.styleRepository.isPainterDataDriven(I);
this.styleRepository.setPaintProperties(I,M);const Z=this.styleRepository.isPainterDataDriven(I);this.emit("paint-change",{layer:I,paint:M,isDataDriven:T||Z})};Y.getStyleLayer=function(I){return h.clone(this.styleRepository.getStyleLayer(I))};Y.setStyleLayer=function(I,M){this.styleRepository.setStyleLayer(I,M);this.emit("style-layer-change",{layer:I,index:M})};Y.deleteStyleLayer=function(I){this.styleRepository.deleteStyleLayer(I);this.emit("delete-style-layer",{layer:I})};Y.getLayoutProperties=
function(I){return h.clone(this.styleRepository.getLayoutProperties(I))};Y.setLayoutProperties=function(I,M){this.styleRepository.setLayoutProperties(I,M);this.emit("layout-change",{layer:I,layout:M})};Y.setStyleLayerVisibility=function(I,M){this.styleRepository.setStyleLayerVisibility(I,M);this.emit("style-layer-visibility-change",{layer:I,visibility:M})};Y.getStyleLayerVisibility=function(I){return this.styleRepository.getStyleLayerVisibility(I)};Y.getTileUrl=function(I,M,T){let Z=this.tileServers[M%
this.tileServers.length];return Z=Z.replace(/\{z\}/gi,I.toString()).replace(/\{y\}/gi,M.toString()).replace(/\{x\}/gi,T.toString())};Y.write=function(I,M){return M&&M.origin&&!this.styleUrl?(M.messages&&M.messages.push(new b("vectortilelayer:unsupported",`VectorTileLayer (${this.title}, ${this.id}) with style defined by JSON only are not supported`,{layer:this})),null):da.prototype.write.call(this,I,M)};Y._getSourceAndStyle=function(){var I=l._asyncToGenerator(function*(M,T){if(!M)throw Error("invalid style!");
T=yield Q.loadMetadata(M,T);"webp"!==T.spriteFormat||(yield A.checkWebPSupport("lossy"))||(T.spriteFormat="png");this._set("currentStyleInfo",{...T});"string"===typeof M?(this.url=M,this.style=null):(this.url=null,this.style=M);this._set("sourceNameToSource",T.sourceNameToSource);this._set("primarySourceName",T.primarySourceName);this._set("styleRepository",new W(T.style,T));this.read(T.layerDefinition,{origin:"service"});this.emit("load-style",{})});return function(M,T){return I.apply(this,arguments)}}();
Y._getDefaultAttribution=function(I){var M=I.match(/^https?:\/\/(?:basemaps|basemapsbeta|basemapsdev)(?:-api)?\.arcgis\.com(\/[^\/]+)?\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/vectortileserver/i);I="OpenStreetMap_v2 OpenStreetMap_Daylight_v2 OpenStreetMap_Export_v2 OpenStreetMap_FTS_v2 OpenStreetMap_GCS_v2 World_Basemap World_Basemap_v2 World_Basemap_Export_v2 World_Basemap_GCS_v2 World_Basemap_WGS84 World_Contours_v2".split(" ");if(M){var T=M[2]&&M[2].toLowerCase();if(T){M=M[1]||"";for(const Z of I)if(-1<
Z.toLowerCase().indexOf(T))return n.normalize(`//static.arcgis.com/attribution/Vector${M}/${Z}`)}}};Y._getPrimarySource=function(){return this.sourceNameToSource&&this.primarySourceName in this.sourceNameToSource?this.sourceNameToSource[this.primarySourceName]:null};Y._loadStyle=function(){var I=l._asyncToGenerator(function*(M){return this._loadingPromise?this._loadingPromise:this.loadStyle(null,M)});return function(M){return I.apply(this,arguments)}}();l._createClass(ea,[{key:"attributionDataUrl",
get:function(){var I=this.currentStyleInfo;return(I=I&&I.serviceUrl&&n.urlToObject(I.serviceUrl))?this._getDefaultAttribution(I.path):null}},{key:"capabilities",get:function(){const I=this._getPrimarySource();return I?I.capabilities:{operations:{supportsExportTiles:!1,supportsTileMap:!1},exportTiles:null}}},{key:"fullExtent",get:function(){const I=this._getPrimarySource();return I?I.fullExtent:null}},{key:"parsedUrl",get:function(){return this.serviceUrl?n.urlToObject(this.serviceUrl):null}},{key:"serviceUrl",
get:function(){return this.currentStyleInfo&&this.currentStyleInfo.serviceUrl||null}},{key:"spatialReference",get:function(){return this.tileInfo&&this.tileInfo.spatialReference||null}},{key:"styleUrl",get:function(){return this.currentStyleInfo&&this.currentStyleInfo.styleUrl||null}},{key:"tileIndexType",get:function(){const I=this._getPrimarySource();return I?I.type:""}},{key:"tileIndexUrl",get:function(){const I=this._getPrimarySource();return I?I.tileMapURL:""}},{key:"tileInfo",get:function(){var I;
const M=[];for(var T in this.sourceNameToSource)M.push(this.sourceNameToSource[T]);T=(null==(I=this._getPrimarySource())?void 0:I.tileInfo)||new F;if(1<M.length)for(I=0;I<M.length;I++)U.areSchemasOverlapping(T,M[I].tileInfo)&&(T=U.unionTileInfos(T,M[I].tileInfo));return T}},{key:"tilemapCache",get:function(){const I=this._getPrimarySource();return I?I.capabilities.operations.supportsTileMap?I.tilemapCache:null:null}},{key:"tileServers",get:function(){const I=this._getPrimarySource();return I?I.tileServers:
[]}},{key:"compatibleTileInfo256",get:function(){return V.create256x256CompatibleTileInfo(this.tileInfo)}},{key:"compatibleTileInfo512",get:function(){return V.create512x512CompatibleTileInfo(this.tileInfo)}}]);return ea}(r.BlendLayer(t.ScaleRangeLayer(B.ArcGISCachedService(z.ArcGISService(w.OperationalLayer(x.PortalLayer(d.MultiOriginJSONMixin(K))))))));u.__decorate([c.property({readOnly:!0})],d.prototype,"attributionDataUrl",null);u.__decorate([c.property({type:["show","hide"]})],d.prototype,"listMode",
void 0);u.__decorate([c.property({readOnly:!0,dependsOn:["sourceNameToSource","primarySourceName"],json:{read:!1}})],d.prototype,"capabilities",null);u.__decorate([c.property({readOnly:!0})],d.prototype,"currentStyleInfo",void 0);u.__decorate([c.property({json:{read:!1},readOnly:!0,type:N})],d.prototype,"fullExtent",null);u.__decorate([c.property()],d.prototype,"style",void 0);u.__decorate([c.property({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],d.prototype,
"isReference",void 0);u.__decorate([c.property({type:["VectorTileLayer"]})],d.prototype,"operationalLayerType",void 0);u.__decorate([c.property({readOnly:!0})],d.prototype,"parsedUrl",null);u.__decorate([c.property({readOnly:!0})],d.prototype,"serviceUrl",null);u.__decorate([c.property({type:D,readOnly:!0})],d.prototype,"spatialReference",null);u.__decorate([c.property({readOnly:!0})],d.prototype,"styleRepository",void 0);u.__decorate([c.property({readOnly:!0})],d.prototype,"sourceNameToSource",void 0);
u.__decorate([c.property({readOnly:!0})],d.prototype,"primarySourceName",void 0);u.__decorate([c.property({type:String,readOnly:!0,json:{write:{ignoreOrigin:!0},origins:{"web-document":{write:{ignoreOrigin:!0,isRequired:!0}}}}})],d.prototype,"styleUrl",null);u.__decorate([C.writer(["portal-item","web-document"],"styleUrl")],d.prototype,"writeStyleUrl",null);u.__decorate([c.property({json:{read:!1},readOnly:!0})],d.prototype,"tileIndexType",null);u.__decorate([c.property({json:{read:!1},readOnly:!0})],
d.prototype,"tileIndexUrl",null);u.__decorate([c.property({json:{read:!1,origins:{service:{read:!1}}},readOnly:!0,type:F})],d.prototype,"tileInfo",null);u.__decorate([c.property({json:{read:!1},readOnly:!0,type:O.TilemapCache})],d.prototype,"tilemapCache",null);u.__decorate([c.property({json:{read:!1},readOnly:!0})],d.prototype,"tileServers",null);u.__decorate([c.property({json:{read:!1},readOnly:!0,value:"vector-tile"})],d.prototype,"type",void 0);u.__decorate([c.property({json:{origins:{"web-document":{read:{source:"styleUrl"}},
"portal-item":{read:{source:"url"}}},write:!1,read:!1}})],d.prototype,"url",void 0);u.__decorate([c.property({readOnly:!0})],d.prototype,"version",void 0);u.__decorate([E.reader("version",["version","currentVersion"])],d.prototype,"readVersion",null);u.__decorate([c.property({readOnly:!0})],d.prototype,"compatibleTileInfo256",null);u.__decorate([c.property({readOnly:!0})],d.prototype,"compatibleTileInfo512",null);u.__decorate([c.property({type:Boolean})],d.prototype,"symbolCollisionBoxesVisible",
void 0);return d=u.__decorate([G.subclass("esri.layers.VectorTileLayer")],d)});