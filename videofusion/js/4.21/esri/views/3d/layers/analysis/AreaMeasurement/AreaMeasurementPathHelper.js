// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.21/esri/copyright.txt for details.
//>>built
define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../geometry ../../../../../core/Evented ../../../../../core/Handles ../../../../../core/maybe ../../../../../core/watchUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/has ../../../../../core/accessorSupport/ensureType ../../../../../core/Logger ../../../../../core/accessorSupport/decorators/subclass ../../../../../geometry/support/aaBoundingRect ../../../../interactive/coordinateHelper ../../../../interactive/editGeometry/EditGeometry ../../../../interactive/editGeometry/EditGeometryOperations ../../../../../geometry/Point".split(" "),
function(f,n,g,B,u,v,e,w,k,C,D,E,x,m,y,p,q,z){f.AreaMeasurement3DPathHelper=function(r){function l(a={}){a=r.call(this,a)||this;a._handles=new v;a._version=0;a._internalGeometryChange=!1;a._extent=m.empty();return a}n._inheritsLoose(l,r);var d=l.prototype;d.destroy=function(){this._handles=e.destroyMaybe(this._handles)};d._initialize=function(a,b){this._handles.removeAll();this._handles.add(w.init(a,"geometry",()=>this._updateEditGeometryFromModelGeometry(a,b),!0));this._makeDirty(!0)};d._makeDirty=
function(a=!1){this.notifyChange("isValidPolygon");this.notifyChange("initialized");this.notifyChange("extent");a&&this.notifyChange("numVertices")};d._updateEditGeometryFromModelGeometry=function(a,b){this._version++;this._internalGeometryChange||(this._handles.remove("EditGeometry"),e.isSome(a.geometry)?this._editGeometryOperations=q.EditGeometryOperations.fromGeometry(a.geometry,b.state.viewingMode):this._editGeometryOperations=new q.EditGeometryOperations(new p.EditGeometry("polygon",y.createCoordinateHelper(!0,
!1,b.spatialReference),b.state.viewingMode)),this._makeDirty(!0),this.emit("change",{type:"change"}),this._handles.add(this.editGeometry.on("change",c=>{this._makeDirty(null!=c.addedVertices||null!=c.removedVertices);this._internalGeometryChange=!0;a.geometry=0<this.numVertices?this.editGeometry.geometry:null;this._internalGeometryChange=!1}),"EditGeometry"))};d.getVertex=function(a){if(!this.initialized||0===this.editGeometry.components.length||0===this.editGeometry.components[0].vertices.length)return null;
const b=this.editGeometry.components[0].vertices[0];let c=b;do{if(c.index===a)return c;c=c.rightEdge.rightVertex}while(c!==b&&null!=c);return null};d.getVertexPositionAsPoint=function(a){return this.editGeometry.coordinateHelper.vectorToPoint(a.pos)};d.getVertexPositionAsPointFromIndex=function(a){return this.editGeometry.coordinateHelper.vectorToPoint(this.getVertex(a).pos)};d.forEachVertex=function(a){this.initialized&&0<this.editGeometry.components.length&&this.editGeometry.components[0].iterateVertices(a)};
d.forEachVertexPosition=function(a){const b=this.editGeometry.coordinateHelper;this.forEachVertex((c,h)=>{b.vectorToPoint(c.pos,t);a(t,h)})};d.clear=function(){e.isSome(this.areaMeasurement)&&(this.areaMeasurement.geometry=null)};d.add=function(a){if(!this.initialized)return null;if(0===this.editGeometry.components.length){const b=e.unwrap(this.view);this.editGeometry.components.push(new p.Component(b.spatialReference,b.state.viewingMode))}a=this._editGeometryOperations.appendVertex(this.editGeometry.coordinateHelper.pointToVector(a));
this.emit("change",{type:"change"});return a};d.close=function(){if(!this.initialized||0===this.editGeometry.components.length)return null;const a=this._editGeometryOperations.closeComponent(this.editGeometry.components[0]);this.emit("change",{type:"change"});return a};d.ensureContains=function(a,b=""){let c=!1;this.editGeometry.components.forEach(h=>{h.iterateVertices(A=>{A===a&&(c=!0)})});if(!c)throw Error(`vertex doesnt exist ${b}`);return c};d.setVertexPosition=function(a,b){if(!this.initialized)return null;
a=this._editGeometryOperations.setVertexPosition(a,this.editGeometry.coordinateHelper.pointToVector(b));this.emit("change",{type:"change"});return a};d.equals=function(a){if(this.numVertices!==a.numVertices)return!1;let b=!0;this.forEachVertexPosition((c,h)=>{h=a.getVertexPositionAsPointFromIndex(h);c.equals(h)||(b=!1)});return b?!0:!1};n._createClass(l,[{key:"areaMeasurement",set:function(a){this._set("areaMeasurement",a);e.isSome(a)&&e.isSome(this.view)&&this._initialize(a,this.view)}},{key:"view",
set:function(a){this._set("view",a);e.isSome(a)&&e.isSome(this.areaMeasurement)&&this._initialize(this.areaMeasurement,a)}},{key:"initialized",get:function(){return e.isSome(this.areaMeasurement)&&e.isSome(this.view)}},{key:"version",get:function(){return this._version}},{key:"isValidPolygon",get:function(){return this.initialized&&0<this.editGeometry.components.length&&this.editGeometry.components[0].isClosed()}},{key:"extent",get:function(){if(this.initialized&&0<this.editGeometry.components.length&&
0<this.editGeometry.components[0].vertices.length){const a=m.empty(this._extent);this.forEachVertex(b=>{m.expandPointInPlace(a,b.pos)});return a}return null}},{key:"spatialReference",get:function(){return this.initialized?this.editGeometry.coordinateHelper.spatialReference:null}},{key:"editGeometry",get:function(){return this._editGeometryOperations.data}},{key:"vertices",get:function(){const a=[];this.forEachVertex(b=>{a.push(b)});return a}},{key:"numVertices",get:function(){return this.initialized&&
0<this.editGeometry.components.length?this.editGeometry.components[0].vertices.length:0}},{key:"lastPoint",get:function(){if(this.initialized&&0<this.editGeometry.components.length){const a=this.editGeometry.components[0].getLastVertex();if(e.isSome(a))return this.editGeometry.coordinateHelper.vectorToPoint(a.pos)}return null}}]);return l}(u.EventedAccessor);g.__decorate([k.property({value:null})],f.AreaMeasurement3DPathHelper.prototype,"areaMeasurement",null);g.__decorate([k.property({value:null})],
f.AreaMeasurement3DPathHelper.prototype,"view",null);g.__decorate([k.property()],f.AreaMeasurement3DPathHelper.prototype,"isValidPolygon",null);g.__decorate([k.property()],f.AreaMeasurement3DPathHelper.prototype,"extent",null);g.__decorate([k.property()],f.AreaMeasurement3DPathHelper.prototype,"spatialReference",null);g.__decorate([k.property()],f.AreaMeasurement3DPathHelper.prototype,"numVertices",null);f.AreaMeasurement3DPathHelper=g.__decorate([x.subclass("esri.views.3d.interactive.graphics.AreaMeasurement3D.AreaMeasurement3DPathHelper")],
f.AreaMeasurement3DPathHelper);const t=new z;Object.defineProperty(f,"__esModule",{value:!0})});