// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.21/esri/copyright.txt for details.
//>>built
define("require exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../core/shaderLibrary/Slice.glsl ../core/shaderLibrary/attributes/PathVertexPosition.glsl ../core/shaderLibrary/attributes/VertexNormal.glsl ../core/shaderLibrary/shading/MultipassTerrainTest.glsl ../core/shaderLibrary/shading/ReadShadowMap.glsl ../core/shaderLibrary/util/View.glsl ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/OrderIndependentTransparency ../lib/Program ../lib/StencilUtils ../../../../chunks/Path.glsl ../../../webgl/renderState".split(" "),
function(w,m,t,g,x,y,z,A,B,n,e,p,f,q,C,u,D,r){const v=new Map([["position",0],["profileRight",1],["profileUp",2],["profileVertexAndNormal",3],["featureValue",4]]);p=function(k){function h(){return k.apply(this,arguments)||this}t._inheritsLoose(h,k);var c=h.prototype;c.initializeProgram=function(b){var a=h.shader.get();const d=this.configuration;a=a.build({OITEnabled:0===d.transparencyPassType,output:d.output,viewingMode:b.viewingMode,slicePlaneEnabled:d.slicePlaneEnabled,sliceHighlightDisabled:!1,
sliceEnabledForVertexPrograms:!1,receiveShadows:d.receiveShadows,vvSize:d.vvSize,vvColor:d.vvColor,vvInstancingEnabled:!0,vvOpacity:d.vvOpacity,pbrMode:0,useCustomDTRExponentForWater:!1,receiveAmbientOcclusion:d.receiveSSAO,doubleSidedMode:d.doubleSidedMode,multipassTerrainEnabled:d.multipassTerrainEnabled,cullAboveGround:d.cullAboveGround});return new C.Program(b.rctx,a,v)};c.bindPass=function(b,a){var d,l;n.bindProjectionMatrix(this.program,a.camera.projectionMatrix);this.program.setUniform3fv("size",
b.size);a.multipassTerrainEnabled&&(this.program.setUniform2fv("cameraNearFar",a.camera.nearFar),this.program.setUniform2fv("inverseViewport",a.inverseViewport),A.bindMultipassTerrainTexture(this.program,a));0!==this.configuration.output&&7!==this.configuration.output||this.program.setUniform1f("opacity",b.opacity);0===this.configuration.output?(a.lighting.setUniforms(this.program,!1),this.program.setUniform3fv("ambient",b.ambient),this.program.setUniform3fv("diffuse",b.diffuse),this.program.setUniform3fv("specular",
b.specular),this.program.setUniform1f("opacity",b.opacity)):1!==this.configuration.output&&3!==this.configuration.output||n.bindNearFar(this.program,a.camera.nearFar);y.setVVUniforms(this.program,b);null==(d=a.shadowMap)?void 0:d.bind(this.program);null==(l=a.ssaoHelper)?void 0:l.bind(this.program,a.camera)};c.bindDraw=function(b){n.bindView(this.program,b);x.bindSliceUniformsWithOrigin(this.program,this.configuration,b);this.program.rebindTextures();0!==this.configuration.output&&7!==this.configuration.output||
n.bindCameraPosition(this.program,b.origin,b.camera.viewInverseTransposeMatrix);0===this.configuration.output&&B.bindReadShadowMapView(this.program,b);2===this.configuration.output&&z.VertexNormal.bindUniforms(this.program,b.camera.viewInverseTransposeMatrix)};c.setPipelineState=function(b){const a=this.configuration,d=3===b,l=2===b;return r.makePipelineState({blending:0!==a.output&&7!==a.output||!a.transparent?null:d?q.blendingDefault:q.OITBlending(b),culling:(a.slicePlaneEnabled?!1:!a.transparent&&
0!==a.doubleSidedMode)&&r.frontFaceCullingParams,depthTest:{func:q.OITDepthTest(b)},depthWrite:d||l?r.defaultDepthWriteParams:null,colorWrite:r.defaultColorWriteParams,stencilWrite:a.sceneHasOcludees?u.stencilWriteMaskOn:null,stencilTest:a.sceneHasOcludees?u.stencilBaseAllZerosParams:null,polygonOffset:d||l?null:q.OITPolygonOffset})};c.initializePipeline=function(){return this.setPipelineState(this.configuration.transparencyPassType)};return h}(p.ShaderTechnique);p.shader=new e.ReloadableShaderModule(D.PathShader,
()=>new Promise(function(k,h){w(["../shaders/Path.glsl"],k,h)}));e=function(k){function h(){var c=k.apply(this,arguments)||this;c.output=0;c.doubleSidedMode=0;c.receiveShadows=!1;c.receiveSSAO=!1;c.vvSize=!1;c.vvColor=!1;c.vvOpacity=!1;c.slicePlaneEnabled=!1;c.transparent=!1;c.sceneHasOcludees=!1;c.transparencyPassType=3;c.multipassTerrainEnabled=!1;c.cullAboveGround=!1;return c}t._inheritsLoose(h,k);return h}(f.ShaderTechniqueConfiguration);g.__decorate([f.parameter({count:8})],e.prototype,"output",
void 0);g.__decorate([f.parameter({count:3})],e.prototype,"doubleSidedMode",void 0);g.__decorate([f.parameter()],e.prototype,"receiveShadows",void 0);g.__decorate([f.parameter()],e.prototype,"receiveSSAO",void 0);g.__decorate([f.parameter()],e.prototype,"vvSize",void 0);g.__decorate([f.parameter()],e.prototype,"vvColor",void 0);g.__decorate([f.parameter()],e.prototype,"vvOpacity",void 0);g.__decorate([f.parameter()],e.prototype,"slicePlaneEnabled",void 0);g.__decorate([f.parameter()],e.prototype,
"transparent",void 0);g.__decorate([f.parameter()],e.prototype,"sceneHasOcludees",void 0);g.__decorate([f.parameter({count:4})],e.prototype,"transparencyPassType",void 0);g.__decorate([f.parameter()],e.prototype,"multipassTerrainEnabled",void 0);g.__decorate([f.parameter()],e.prototype,"cullAboveGround",void 0);m.PathTechnique=p;m.PathTechniqueConfiguration=e;m.pathVertexAttributeLocations=v;Object.defineProperty(m,"__esModule",{value:!0})});