// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.21/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/2d/layers/LayerView2D":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Collection ../../../core/collectionUtils ../../../core/watchUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../engine/Container ../../layers/support/ClipArea ../../layers/support/ClipRect ../../layers/support/Geometry ../../layers/support/Path".split(" "),
function(t,v,n,q,u,B,w,H,G,x,D,Q,L,M,N,V){const I=q.ofType({key:"type",base:L,typeMap:{rect:M,path:V,geometry:N}});t.LayerView2DMixin=z=>{z=function(F){function S(){var E=F.apply(this,arguments)||this;E.clips=new I;E.moving=!1;E.attached=!1;E.lastUpdateId=-1;E.updateRequested=!1;return E}v._inheritsLoose(S,F);var R=S.prototype;R.initialize=function(){var E;this.container||(this.container=new Q.Container);this.container.fadeTransitionEnabled=!0;this.container.opacity=0;this.container.clips=this.clips;
this.handles.add([B.init(this,"suspended",d=>{this.container&&(this.container.visible=!d);this.view&&!d&&this.updateRequested&&this.view.requestUpdate()},!0),B.init(this,["layer.opacity","container"],()=>{if(this.container){var d,a;this.container.opacity=null!=(d=null==(a=this.layer)?void 0:a.opacity)?d:1}},!0),B.init(this,["layer.blendMode"],d=>{this.container&&(this.container.blendMode=d)},!0),B.init(this,["layer.effect"],d=>{this.container&&(this.container.effect=d)},!0),this.clips.on("change",
()=>{this.container.clips=this.clips;this.notifyChange("clips")})]);null!=(E=this.view)&&E.whenLayerView?this.view.whenLayerView(this.layer).then(d=>{d!==this||this.attached||this.destroyed||(this.attach(),this.requestUpdate(),this.attached=!0)},()=>{}):this.when().then(()=>{this.attached||this.destroyed||(this.attach(),this.requestUpdate(),this.attached=!0)},()=>{})};R.destroy=function(){this.attached&&(this.detach(),this.attached=!1);this.handles.remove("initialize");this.updateRequested=!1};R.isVisibleAtScale=
function(E){var d=!0,a=this.layer;const b=a.minScale;a=a.maxScale;if(null!=b&&null!=a){d=!b;let c=!a;!d&&E<=b&&(d=!0);!c&&E>=a&&(c=!0);d=d&&c}return d};R.requestUpdate=function(){this.destroyed||this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestUpdate())};R.processUpdate=function(E){this.isFulfilled()&&!this.isResolved()?this.updateRequested=!1:(this._set("updateParameters",E),this.updateRequested&&!this.suspended&&(this.updateRequested=!1,this.update(E)))};R.isUpdating=
function(){return!1};R.isRendering=function(){return!1};R.canResume=function(){return F.prototype.canResume.call(this)?this.isVisibleAtScale(this.view.scale):!1};v._createClass(S,[{key:"updating",get:function(){return!this.attached||!this.suspended&&(this.updateRequested||this.isUpdating())}}]);return S}(z);n.__decorate([w.property({type:I,set(F){F=u.referenceSetter(F,this._get("clips"),I);this._set("clips",F)}})],z.prototype,"clips",void 0);n.__decorate([w.property()],z.prototype,"moving",void 0);
n.__decorate([w.property()],z.prototype,"attached",void 0);n.__decorate([w.property()],z.prototype,"container",void 0);n.__decorate([w.property()],z.prototype,"suspended",void 0);n.__decorate([w.property({readOnly:!0})],z.prototype,"updateParameters",void 0);n.__decorate([w.property()],z.prototype,"updateRequested",void 0);n.__decorate([w.property()],z.prototype,"updating",null);n.__decorate([w.property()],z.prototype,"view",void 0);return z=n.__decorate([D.subclass("esri.views.2d.layers.LayerView2D")],
z)};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/layers/support/ClipArea":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/accessorSupport/decorators/subclass".split(" "),function(t,v,n,q,u,B,w,H){n=function(G){function x(){return G.apply(this,arguments)||this}t._inheritsLoose(x,
G);return x}(n.JSONSupport);return n=v.__decorate([H.subclass("esri.views.layers.support.ClipArea")],n)})},"esri/views/layers/support/ClipRect":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ./ClipArea".split(" "),function(t,v,n,q,u,B,w,H){var G;q=G=function(x){function D(){var Q=
x.apply(this,arguments)||this;Q.type="rect";Q.left=null;Q.right=null;Q.top=null;Q.bottom=null;return Q}t._inheritsLoose(D,x);D.prototype.clone=function(){return new G({left:this.left,right:this.right,top:this.top,bottom:this.bottom})};t._createClass(D,[{key:"version",get:function(){return(this._get("version")||0)+1}}]);return D}(H);v.__decorate([n.property({type:[Number,String],json:{write:!0}})],q.prototype,"left",void 0);v.__decorate([n.property({type:[Number,String],json:{write:!0}})],q.prototype,
"right",void 0);v.__decorate([n.property({type:[Number,String],json:{write:!0}})],q.prototype,"top",void 0);v.__decorate([n.property({type:[Number,String],json:{write:!0}})],q.prototype,"bottom",void 0);v.__decorate([n.property({readOnly:!0})],q.prototype,"version",null);return q=G=v.__decorate([w.subclass("esri.views.layers.support.ClipRect")],q)})},"esri/views/layers/support/Geometry":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../../../geometry/Geometry ../../../geometry/support/jsonUtils ./ClipArea ../../../geometry/Extent ../../../geometry/Polygon".split(" "),
function(t,v,n,q,u,B,w,H,G,x,D,Q,L){var M;n={base:G,key:"type",typeMap:{extent:Q,polygon:L}};D=M=function(N){function V(){var I=N.apply(this,arguments)||this;I.type="geometry";I.geometry=null;return I}t._inheritsLoose(V,N);V.prototype.clone=function(){return new M({geometry:this.geometry.clone()})};t._createClass(V,[{key:"version",get:function(){return(this._get("version")||0)+1}}]);return V}(D);v.__decorate([q.property({types:n,json:{read:x.fromJSON,write:!0}})],D.prototype,"geometry",void 0);v.__decorate([q.property({readOnly:!0})],
D.prototype,"version",null);return D=M=v.__decorate([H.subclass("esri.views.layers.support.Geometry")],D)})},"esri/views/layers/support/Path":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ./ClipArea".split(" "),function(t,v,n,q,u,B,w,H){q=function(G){function x(){var D=G.apply(this,
arguments)||this;D.type="path";D.path=[];return D}t._inheritsLoose(x,G);t._createClass(x,[{key:"version",get:function(){return(this._get("version")||0)+1}}]);return x}(H);v.__decorate([n.property({type:[[[Number]]],json:{write:!0}})],q.prototype,"path",void 0);v.__decorate([n.property({readOnly:!0})],q.prototype,"version",null);return q=v.__decorate([w.subclass("esri.views.layers.support.Path")],q)})},"esri/views/2d/layers/imagery/ImageryGraphicsView2D":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../Graphic ../../../../request ../../../../core/Accessor ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/screenUtils ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/enumeration ../../../../core/accessorSupport/decorators/subclass ../../../../geometry/Extent ../../../../layers/support/rasterFunctions/rasterProjectionHelper ../../../../layers/support/rasterFunctions/vectorFieldUtils ../../../../support/GraphicsCollection ../../engine/Container ../graphics/GraphicContainer ../graphics/GraphicsView2D".split(" "),
function(t,v,n,q,u,B,w,H,G,x,D,Q,L,M,N,V,I,z,F,S,R){const E=B.getLogger("esri.views.2d.layers.imagery.ImageryGraphicsView2D");u=function(d){function a(){var c=d.apply(this,arguments)||this;c.attached=!1;c.container=new F.Container;c.updateRequested=!1;c._graphicsView=null;c._projectFullExtentPromise=null;c._dataParameters={exportParametersVersion:0,extents:[],tileResolution:0,time:""};c.type="Graphics";c._graphics=new z["default"];c._updateGraphics=H.debounce(function(){var e=t._asyncToGenerator(function*(g,
f){if(g.stationary){var h=g.state;h=new N({xmin:h.extent.xmin,ymin:h.extent.ymin,xmax:h.extent.xmax,ymax:h.extent.ymax,spatialReference:h.spatialReference});var [l,p]=g.state.size,k={};k.timeExtent=c.timeExtent;k.requestAsImageElement=!1;k.signal=f;null==c._projectFullExtentPromise&&(c._projectFullExtentPromise=c._getProjectedFullExtent(h.spatialReference));f="vector-field"===c.layer.renderer.type?c.layer.renderer.symbolTileSize:50;var m=yield c._projectFullExtentPromise,{extent:r,resolution:y,width:O,
height:C}=I.snapImageToSymbolTile(h,l,p,f,m);h=yield c.layer.fetchImage(r,O,C,k);k=c.layer.renderer;if("vector-field"===k.type){f=h.pixelData.pixelBlock;m=k.sizeVariables[0];!w.isSome(f)||m.minDataValue&&m.maxDataValue||(m.minDataValue=f.statistics[0].minValue,m.maxDataValue=f.statistics[0].maxValue);c._pixelData={extent:r,pixelBlock:f};const T=r.clone().normalize();f={exportParametersVersion:c.layer.exportImageServiceParameters.version,extents:T,tileResolution:y,time:JSON.stringify(c.timeExtent||
"")};const A=c._canReuseVectorFieldData(f)?c._dataParameters.extents:[];h=yield k.getGraphicsFromPixelData(h.pixelData,"vector-uv"===c.layer.rasterInfo.dataType,A);A.length?(k=c._graphics.items.filter(K=>w.isSome(K.geometry)&&A.some(P=>P.intersects(K.geometry))&&!T.some(P=>P.intersects(K.geometry))),c._graphics.removeMany(k),c._graphics.addMany(h)):c._graphics.set("items",h);c._graphicsView.update(g);c._dataParameters=f}}});return function(g,f){return e.apply(this,arguments)}}());return c}t._inheritsLoose(a,
d);var b=a.prototype;b.destroy=function(){this.attached&&(this.detach(),this.attached=!1);this.updateRequested=!1};b.update=function(c){this._updateGraphics(c).catch(e=>{H.isAbortError(e)||E.error(e)})};b.hitTest=function(c,e){c=this.view.toMap(G.createScreenPoint(c,e));return Promise.resolve(new n({attributes:{},geometry:c,layer:this.layer}))};b.attach=function(){this._graphicsView=new R({view:this.view,graphics:this._graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new S(this.view.featuresTilingScheme)});
this.attached=!0};b.detach=function(){this._graphics.destroy();this._graphicsView.destroy();this.container.removeChild(this._graphicsView.container);this._graphicsView=null};b.install=function(c){this.container.addChild(this._graphicsView.container);c.addChild(this.container)};b.uninstall=function(c){this.container.removeChild(this._graphicsView.container);c.removeChild(this.container)};b.isUpdating=function(){return this._graphicsView.updating||this.updateRequested};b.getPixelData=function(){return this.updating?
null:this._pixelData};b.redraw=function(){};b.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.view.requestUpdate())};b._getProjectedFullExtent=function(){var c=t._asyncToGenerator(function*(e){try{return yield V.projectExtent(this.layer.fullExtent,e)}catch(g){try{const f=(yield q(this.layer.url,{query:{option:"footprints",outSR:e.wkid||JSON.stringify(e.toJSON()),f:"json"}})).data.featureCollection.layers[0].layerDefinition.extent;return f?N.fromJSON(f):null}catch{return null}}});
return function(e){return c.apply(this,arguments)}}();b._canReuseVectorFieldData=function(c){const e=this._dataParameters.exportParametersVersion===c.exportParametersVersion,g=this._dataParameters.time===c.time,f=.01>Math.abs(this._dataParameters.tileResolution-c.tileResolution)/c.tileResolution,h=this._dataParameters.extents.some(l=>c.extents.some(p=>l.intersects(p)));return e&&g&&f&&h};t._createClass(a,[{key:"updating",get:function(){return!this.attached||this.isUpdating()}}]);return a}(u);v.__decorate([x.property()],
u.prototype,"attached",void 0);v.__decorate([x.property()],u.prototype,"container",void 0);v.__decorate([x.property()],u.prototype,"layer",void 0);v.__decorate([x.property()],u.prototype,"timeExtent",void 0);v.__decorate([x.property()],u.prototype,"view",void 0);v.__decorate([x.property()],u.prototype,"updateRequested",void 0);v.__decorate([x.property()],u.prototype,"updating",null);v.__decorate([L.enumeration({graphics:"Graphics"})],u.prototype,"type",void 0);return u=v.__decorate([M.subclass("esri.views.2d.layers.imagery.ImageryGraphicsView2D")],
u)})},"esri/layers/support/rasterFunctions/rasterProjectionHelper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../geometry ../../../core/Error ../../../core/maybe ../../../core/unitUtils ../../../geometry/projection ../../../geometry/support/webMercatorUtils ../../../geometry/Extent ../../../geometry/Point".split(" "),function(t,v,n,q,u,B,w,H,G,x){function D(){D=v._asyncToGenerator(function*(){if(w.isLoaded()||!w.isSupported())return null;yield w.load()});return D.apply(this,
arguments)}function Q(a,b,c,e=null){if(a.spatialReference.equals(b))return a;const g=E(a.spatialReference,b);if(g&&!w.isLoaded())throw new q("rasterprojectionhelper-projectResolution","projection engine is not loaded");c=c.center;a=new G({xmin:c.x-a.x/2,xmax:c.x+a.x/2,ymin:c.y-a.y/2,ymax:c.y+a.y/2,spatialReference:a.spatialReference});b=g?w.project(a,b,e):H.project(a,b);return u.isNone(b)?null:{x:b.xmax-b.xmin,y:b.ymax-b.ymin}}function L(a,b=.01){return B.getMetersPerUnitForSR(a)?b/B.getMetersPerUnitForSR(a):
0}function M(a,b,c=null,e=!0){const g=a.spatialReference;if(g.equals(b))return a;let f=H.project(a,b);if(u.isNone(f)){if(!w.isLoaded())throw new q("rasterprojectionhelper-projectResolution","projection engine is not loaded");f=w.project(a,b,c)}if(e&&b.isGeographic){const [h,l]=F(g,!0);(b=L(g))&&null!=h&&null!=l&&(Math.abs(a.x-h)<b&&5E-4>Math.abs(180-f.x)?f.x-=360:Math.abs(a.x-l)<b&&5E-4>Math.abs(180+f.x)&&(f.x+=360))}return f}function N(a){const b=z(a[0].spatialReference);if(2>a.length||!u.isSome(b))return a[0];
let {xmin:c,xmax:e,ymin:g,ymax:f}=a[0];for(let h=1;h<a.length;h++){const l=a[h];e=l.xmax+b*h;g=Math.min(g,l.ymin);f=Math.max(f,l.ymax)}return new G({xmin:c,xmax:e,ymin:g,ymax:f,spatialReference:a[0].spatialReference})}function V(a,b,c=null,e=!0){if(a.spatialReference.equals(b))return a;const g=R(a),f=z(a.spatialReference,!0);if(!u.isSome(f)||0===g)return I(a,b,c,e);a=a.clone().normalize().map(h=>I(h,b,c,e));return N(a)}function I(a,b,c=null,e=!0){const g=a.spatialReference;if(g.equals(b))return a;
if(E(g,b)&&!w.isLoaded())throw new q("rasterprojectionhelper-projectExtent","projection engine is not loaded");let f=H.project(a,b);u.isNone(f)&&(f=w.project(a,b,c));let [h,l]=F(g,!0);f&&e&&g.isWebMercator&&b.isGeographic&&null!=h&&null!=l&&(.001>Math.abs(a.xmin-h)&&1E3<Math.abs(l-a.xmax)&&5E-4>Math.abs(180-f.xmax)&&(f.xmin=-180,e=[],e.push(new x(a.xmax,a.ymin,g)),e.push(new x(a.xmax,(a.ymin+a.ymax)/2,g)),e.push(new x(a.xmax,a.ymax,g)),e=e.map(p=>M(p,b,c)).filter(p=>!isNaN(null==p?void 0:p.x)).map(p=>
p.x),f.xmax=Math.max.apply(null,e)),.001>Math.abs(a.xmax-l)&&1E3<Math.abs(h-a.xmin)&&5E-4>Math.abs(180+f.xmin)&&(f.xmax=180,e=[],e.push(new x(a.xmin,a.ymin,g)),e.push(new x(a.xmin,(a.ymin+a.ymax)/2,g)),e.push(new x(a.xmin,a.ymax,g)),a=e.map(p=>M(p,b,c)).filter(p=>!isNaN(null==p?void 0:p.x)).map(p=>p.x),f.xmin=Math.min.apply(null,a)));[h,l]=F(b,!0);(a=L(b))&&null!=h&&null!=l&&(Math.abs(f.xmin-h)<a&&(f.xmin=h),Math.abs(f.xmax-l)<a&&(f.xmax=l));return f}function z(a,b=!1){return a.isWebMercator?2*(b?
2.0037508342787E7:2.0037508342788905E7):a.wkid&&a.isGeographic?360:2*d[a.wkid]||null}function F(a,b=!1){const c=[];a=z(a,b);u.isSome(a)&&(c.push(-a/2),c.push(a/2));return c}function S(a,b,c,e){a=(a-b)/c;0!==a-Math.floor(a)?a=Math.floor(a):e&&--a;return a}function R(a,b=!1){const c=z(a.spatialReference);if(!u.isSome(c))return 0;const e=b?0:-(c/2);b=S(a.xmax,e,c,!0);a=S(a.xmin,e,c,!1);return b-a}const E=function(a,b){const c=(a.isWGS84||a.isWebMercator)&&(b.isWGS84||b.isWebMercator);return!(a.equals(b)||
c)},d={3395:2.0037508342789244E7,3410:1.7334193943686873E7,3832:3339584.723798206,3857:2.0037508342788905E7,3975:1.7367530445161372E7,4087:2.0037508342789244E7,4088:2.0015108787169147E7,6933:1.7367530445161372E7,8858:7396237.374497803,8859:2465412.4581659334,32662:2.0037508342789244E7,53001:2.001508679602057E7,53002:1.000754339801029E7,53003:2.001508679602057E7,53004:2.001508679602057E7,53016:1.4152803599503474E7,53017:1.7333573624304302E7,53025:7276828.3848298555,53031:1.0384677558821043E7,53034:2.001508679602057E7,
53036:7389443.187332862,53037:2463147.729110953,53079:2.0015114352186374E7,53080:2.0015114352186374E7,54001:2.0037508342789244E7,54002:1.0018754171394624E7,54003:2.0037508342789244E7,54004:2.0037508342789244E7,54016:1.4168658027268292E7,54017:1.736753044516137E7,54025:7311399.09166516,54031:1.0396310810074743E7,54034:2.0037508342789244E7,54050:808820.9223376509,54053:1920897.3915568967,54079:2.0037508342789244E7,54080:2.0037508342789244E7,54100:2.0037508342789244E7,54101:2.0037508342789244E7,102038:4297258.582585486,
102299:5013965.117483125};t.computeProjectedScales=function(a,b,c=512,e=!0){const {extent:g,spatialReference:f,pixelSize:h}=a,l=Q(new x({x:h.x,y:h.y,spatialReference:f}),b,g);if(null==l)return{projectedPixelSize:null,scales:null,srcResolutions:null,isCustomTilingScheme:!1};var p=(l.x+l.y)/2,k=B.getMetersPerUnitForSR(b);p=p*k*96*39.37;const m=b.isGeographic?256/c*2.958287637958547E8:256/c*5.91657527591555E8;c="vector-magdir"===a.dataType||"vector-uv"===a.dataType;const r=V(g,b);c||e&&(b.isGeographic||
b.isWebMercator)&&(c=0>r.xmin*r.xmax);e=p;if(c)e=m,a=b.isGeographic?1.341104507446289E-6:.29858214164761665,k=96*a*k*39.37,b=Q(new x({x:a,y:a,spatialReference:{wkid:b.isGeographic?4326:3857}}),f,r),b.x*=e/k,b.y*=e/k;else{b={x:h.x,y:h.y};a=Math.ceil(Math.log(Math.min(a.width,a.height)/32)/Math.LN2);for(k=0;e<.5005*m&&k<a;)k++,e*=2,b.x*=2,b.y*=2;1.001>=Math.max(e,m)/Math.min(e,m)&&(e=m)}a=[e];k=[{x:b.x,y:b.y}];for(p=Math.min(70.5310735,p)/1.001;e>=p;)e/=2,b.x/=2,b.y/=2,a.push(e),k.push({x:b.x,y:b.y});
return{projectedPixelSize:l,scales:a,srcResolutions:k,isCustomTilingScheme:!c}};t.defaultGridSpacing=32;t.getDefaultDatumTransformationForDataset=function(a,b,c){if(!E(a.spatialReference,b))return null;if(!w.isLoaded())throw new q("rasterprojectionhelper-projectResolution","projection engine is not loaded");return c?w.getTransformation(b,a.spatialReference,a):w.getTransformation(a.spatialReference,b,a)};t.getProjectionOffsetGrid=function(a,b,c,e=null,g=null,f=!1,h=[32,32]){if(E(a.spatialReference,
b.spatialReference)&&!w.isLoaded())throw new q("rasterprojectionhelper-projectResolution","projection engine is not loaded");if(!(a&&b&&c))return null;const {xmin:l,ymin:p,xmax:k,ymax:m}=a;var r=a.spatialReference,y=b.spatialReference,O=z(y);f=f||"gcs-shift"===(null==g?void 0:g.type);var C=h[0]*c.x,T=h[1]*c.y;c=Math.ceil((k-l)/C-.1/h[0])+1;a=Math.ceil((m-p)/T-.1/h[1])+1;const A=[];let K=!1;for(var P=0;P<c;P++){var U=[];for(var J=0;J<a;J++){var W=new x({x:l+C*P,y:m-T*J,spatialReference:r});W=M(W,y,
e);g&&(W=g.inverseTransform(W));U.push(W);0<P&&f&&W&&X[J]&&u.isSome(O)&&W.x<X[J].x&&(W.x+=O);W?(A.push((W.x-b.xmin)/(b.xmax-b.xmin)),A.push((b.ymax-W.y)/(b.ymax-b.ymin))):(A.push(NaN),A.push(NaN),K=!0)}var X=U}b=[Math.abs((A[0]+A[4]+A[4*c]+A[4*c+4])/4-A[2*a+2]),Math.abs((A[1]+A[5]+A[4*a+1]+A[4*a+5])/4-A[2*a+3])];e=new Float32Array((c-1)*(a-1)*12);g=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]);f=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(X=0;X<c-1;X++){for(r=0;r<a-1;r++){U=X*a*2+2*r;C=A[U];y=A[U+1];
var Y=A[U+2],Z=A[U+3];U+=2*a;T=A[U];O=A[U+1];P=A[U+2];U=A[U+3];J=0;W=12*(r*(c-1)+X);for(let aa=0;3>aa;aa++)e[W++]=g[J++]*C+g[J++]*Y+g[J++]*P;J=0;for(Y=0;3>Y;Y++)e[W++]=g[J++]*y+g[J++]*Z+g[J++]*U;J=0;for(Z=0;3>Z;Z++)e[W++]=f[J++]*C+f[J++]*T+f[J++]*P;J=0;for(C=0;3>C;C++)e[W++]=f[J++]*y+f[J++]*O+f[J++]*U}if(K)for(r=0;r<e.length;r++)isNaN(e[r])&&(e[r]=-1)}return{offsets:A,error:b,coefficients:e,spacing:h,size:[c-1,a-1]}};t.getRasterDatasetAlignmentInfo=function(a){const b=a.storageInfo.origin.x,c=z(a.spatialReference,
!0);if(!u.isSome(c))return{originX:b,halfWorldWidth:null,pyramidsInfo:null};const e=c/2,{nativePixelSize:g,storageInfo:f,extent:h}=a,{maximumPyramidLevel:l,blockWidth:p,pyramidScalingFactor:k}=f;let m=g.x;const r=[];a=u.isSome(a.transform)&&"gcs-shift"===a.transform.type;const y=b+e,O=a?c-b:e-b;for(let C=0;C<=l;C++){const T=(h.xmax-b)/m/p,A=(c/2-b)/m/p;r.push({resolutionX:m,blockWidth:p,datsetColumnCount:0===T-Math.floor(T)?T:Math.ceil(T),worldColumnCountFromOrigin:0===A-Math.floor(A)?A:Math.ceil(A),
leftMargin:Math.round(y/m)%p,rightPadding:(p-Math.round(O/m)%p)%p,originColumnOffset:Math.floor(y/m/p)});m*=k}return{originX:b,halfWorldWidth:e,pyramidsInfo:r,hasGCSSShiftTransform:a}};t.getWorldWrapCount=R;t.load=function(){return D.apply(this,arguments)};t.projectExtent=V;t.projectPoint=M;t.projectResolution=Q;t.snapExtent=function(a){a=a.clone().normalize();return 1===a.length?a[0]:N(a)};t.snapPyramid=function(a,b,c){const {storageInfo:e,pixelSize:g}=b;let f=!1;var {pyramidResolutions:h}=e;if(u.isSome(h)&&
h.length){a=(a.x+a.y)/2;var l=h[h.length-1];l=(l.x+l.y)/2;var p=(g.x+g.y)/2;if(a<=p)var k=0;else if(a>=l)k=h.length,f=8<a/l;else{l=p;for(let m=1;m<=h.length;m++){p=(h[m-1].x+h[m-1].y)/2;if(a<=p){a===p?k=m:"down"===c?(k=m-1,f=8<a/l):k="up"===c?m:a-l>p-a||2<a/l?m:m-1;break}l=p}}c=0===k?g:h[k-1];return{pyramidLevel:k,pyramidResolution:new x({x:c.x,y:c.y,spatialReference:b.spatialReference}),excessiveReading:f}}k=Math.log(a.x/g.x)/Math.LN2;a=Math.log(a.y/g.y)/Math.LN2;h=b.storageInfo.maximumPyramidLevel||
0;k="down"===c?Math.floor(Math.min(k,a)):"up"===c?Math.ceil(Math.max(k,a)):Math.round((k+a)/2);0>k?k=0:k>h&&(f=k>h+3,k=h);c=2**k;b=new x({x:c*b.nativePixelSize.x,y:c*b.nativePixelSize.y,spatialReference:b.spatialReference});return{pyramidLevel:k,pyramidResolution:b,excessiveReading:f}};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/layers/support/rasterFunctions/vectorFieldUtils":function(){define(["exports","../../../core/jsonMap","../../../core/maybe","../PixelBlock","./pixelUtils"],
function(t,v,n,q,u){function B(d,a){return N.get(d)/N.get(a)||1}function w(d,a="geographic"){const [b,c]=d;d=Math.sqrt(b*b+c*c);let e=Math.atan2(c,b)*V;e=(360+e)%360;"geographic"===a&&(e=(450-e)%360);return[d,e]}function H(d,a="geographic"){let b=d[1];"geographic"===a&&(b=(450-b)%360);b%=360;d=d[0];return[d*Math.cos(b/V),d*Math.sin(b/V)]}function G(d=0,a=Math.PI,b=!0){b&&(a=(2*Math.PI-a)%(2*Math.PI));var c=b?-1:1;b=5*c;const e=20*c,g=25*c;c*=2;let [f,h]=[5,0-e],[l,p]=[f+2,h],[k,m]=[l-0,p+c],[r,y]=
[-5,0-g],[O,C]=[r+0,y-c];d=Math.ceil(d/5);let T=Math.floor(d/10);d-=8*T;const A=[],K=[];for(let ba=0;ba<d/2;ba++,T--){0>=T&&1===d%2&&ba===(d-1)/2&&(r=0,O=r+0,y=(y+h)/2,C=y-c);const [ha,ia]=x(r,y,a,45);if(0<T){const [ca,da]=x(l,y,a,45),[ea,fa]=x(f,h,a,45);A.push(ca);A.push(da);A.push(ha);A.push(ia);A.push(ea);A.push(fa)}else{const [ca,da]=x(l,p,a,45),[ea,fa]=x(k,m,a,45),[ja,ka]=x(O,C,a,45);K.push(ha);K.push(ia);K.push(ja);K.push(ka);K.push(ea);K.push(fa);K.push(ca);K.push(da)}y+=b;h+=b;p+=b;m+=b;C+=
b}const [P,U]=x(5,0+e,a,45),[J,W]=x(7,0+e,a,45),[X,Y]=x(5,0-g,a,45),[Z,aa]=x(7,0-g,a,45);return{pennants:A,barbs:K,shaft:[P,U,J,W,X,Y,Z,aa]}}function x(d,a,b,c=1){return[Math.sqrt(d*d+a*a)/c,(2*Math.PI+(2*Math.PI+Math.atan2(a,d))%(2*Math.PI)-b)%(2*Math.PI)]}function D(d,a,b,c){b=B(c||"knots",b);for(c=1;c<a.length;c++)if(c===a.length-1){if(d<a[c]*b)break}else if(d<=a[c]*b)break;return Math.min(c-1,a.length-2)}function Q(d,a,b,c,e){let g=0;switch(a){case "beaufort_kn":g=D(d,F,"knots",b);break;case "beaufort_km":g=
D(d,F,"kilometer-per-hour",b);break;case "beaufort_ft":g=D(d,F,"feet-per-second",b);break;case "beaufort_m":g=D(d,F,"meter-per-second",b);break;case "classified_arrow":g=D(d,e,c,b);break;case "ocean_current_m":g=D(d,S,"meter-per-second",b);break;case "ocean_current_kn":g=D(d,R,"knots",b)}return g}function L(d,a){const {style:b,inputUnit:c,outputUnit:e,breakValues:g}=a;a=I.fromJSON(c);const f=I.fromJSON(e);let h=0,l=0;const {width:p,height:k,mask:m}=d,r=d.pixels[0];d=d.pixels[1];var y=m?m.filter(A=>
0<A).length:p*k;const O=new Float32Array(42*y);y=new Uint32Array(15*y);for(let A=0;A<k;A++)for(let K=0;K<p;K++){var C=A*p+K;if(!m||m[A*p+K]){var T;const P=null!=(T=(d[C]+360)%360/180*Math.PI)?T:2*Math.PI*Math.random(),U=Q(r[C],b,a,f,g);for(let J=0;J<z.length;J+=2)O[h++]=(K+.5)/p,O[h++]=(A+.5)/k,O[h++]=z[J],O[h++]=z[J+1]+P,O[h++]=U,O[h++]=r[C];C=7*(h/42-1);y[l++]=C;y[l++]=C+1;y[l++]=C+2;y[l++]=C+0;y[l++]=C+4;y[l++]=C+3;y[l++]=C+0;y[l++]=C+2;y[l++]=C+3;y[l++]=C+2;y[l++]=C+5;y[l++]=C+3;y[l++]=C+5;y[l++]=
C+6;y[l++]=C+3}}return{vertexData:O,indexData:y}}function M(d,a){let b=0,c=0;const {width:e,height:g,mask:f}=d;d=d.pixels[0];const h=[],l=[];a="wind_speed"===a.style?5:Number.MAX_VALUE;for(let k=0;k<g;k++)for(let m=0;m<e;m++){var p=k*e+m;if((!f||f[k*e+m])&&d[p]<a){for(let r=0;4>r;r++)h[b++]=(m+.5)/e,h[b++]=(k+.5)/g,h[b++]=2>r?-.5:.5,h[b++]=0===r%2?-.5:.5,h[b++]=0,h[b++]=d[p];p=4*(b/24-1);l[c++]=p;l[c++]=p+1;l[c++]=p+2;l[c++]=p+1;l[c++]=p+2;l[c++]=p+3}}return{vertexData:new Float32Array(h),indexData:new Uint32Array(l)}}
const N=new Map;N.set("meter-per-second",1);N.set("kilometer-per-hour",.277778);N.set("knots",.514444);N.set("feet-per-second",.3048);N.set("mile-per-hour",.44704);const V=180/Math.PI,I=new v.JSONMap({esriMetersPerSecond:"meter-per-second",esriKilometersPerHour:"kilometer-per-hour",esriKnots:"knots",esriFeetPerSecond:"feet-per-second",esriMilesPerHour:"mile-per-hour"}),z=function(d=0,a=0,b=Math.PI,c=!0){c&&(b=(2*Math.PI-b)%(2*Math.PI));c=c?-1:1;const e=-7*c,g=-2*c,f=-16*c,[h,l]=x(0,a+13*c,b,29),[p,
k]=x(d-5.5,a+e,b,29),[m,r]=x(d+5.5,a+e,b,29),[y,O]=x(d-1.5,a+g,b,29),[C,T]=x(d+1.5,a+g,b,29),[A,K]=x(d-1.5,a+f,b,29),[P,U]=x(d+1.5,a+f,b,29);return[h,l,p,k,y,O,C,T,m,r,A,K,P,U]}(0,0,0),F=[0,1,3,6,10,16,21,27,33,40,47,55,63],S=[0,.5,1,1.5,2],R=[0,.25,.5,1,1.5,2,2.5,3,3.5,4],E=[];t.convertVectorFieldData=function(d,a,b="geographic",c=1){if(!u.isValidPixelBlock(d))return d;const {pixels:e,width:g,height:f}=d;var h=g*f;const l=e[0],p=e[1],k=q.createEmptyBand(d.pixelType,h);h=q.createEmptyBand(d.pixelType,
h);let m=0;for(let r=0;r<f;r++)for(let y=0;y<g;y++)"vector-uv"===a?([k[m],h[m]]=w([l[m],p[m]],b),k[m]*=c):([k[m],h[m]]=H([l[m],p[m]],b),k[m]*=c,h[m]*=c),m++;d=new q({pixelType:d.pixelType,width:d.width,height:d.height,mask:d.mask,validPixelCount:d.validPixelCount,maskIsAlpha:d.maskIsAlpha,pixels:[k,h]});d.updateStatistics();return d};t.convertVectorFieldUnit=function(d,a,b=1){if(1===b||!u.isValidPixelBlock(d))return d;d=d.clone();const {pixels:c,width:e,height:g}=d,f=c[0],h=c[1];let l=0;for(let p=
0;p<g;p++)for(let k=0;k<e;k++)"vector-uv"===a?(f[l]*=b,h[l]*=b):f[l]*=b,l++;d.updateStatistics();return d};t.createVFMesh=function(d,a){if("simple_scalar"===a.style)var b=M(d,a);else if("wind_speed"===a.style){{if(0===E.length)for(var c=0;30>c;c++)E.push(G(5*c,0));a=I.fromJSON(a.inputUnit);a=B(a,"knots");const {width:h,height:l,mask:p}=d;c=d.pixels[0];d=d.pixels[1];const k=[],m=[];let r=0,y=0;for(let O=0;O<l;O++)for(let C=0;C<h;C++){var e=O*h+C,g=c[e]*a;if((!p||p[O*h+C])&&5<=g){const T=null!=(b=(d[e]+
360)%360/180*Math.PI)?b:2*Math.PI*Math.random(),{pennants:A,barbs:K,shaft:P}=E[Math.min(Math.floor(g/5),29)];if(0===A.length+K.length)continue;e=k.length/6;const U=(C+.5)/h,J=(O+.5)/l;for(var f=0;f<A.length;f+=2)k[r++]=U,k[r++]=J,k[r++]=A[f],k[r++]=A[f+1]+T,k[r++]=0,k[r++]=g;for(f=0;f<K.length;f+=2)k[r++]=U,k[r++]=J,k[r++]=K[f],k[r++]=K[f+1]+T,k[r++]=0,k[r++]=g;for(f=0;f<P.length;f+=2)k[r++]=U,k[r++]=J,k[r++]=P[f],k[r++]=P[f+1]+T,k[r++]=0,k[r++]=g;for(g=0;g<A.length/6;g++)m[y++]=e,m[y++]=e+1,m[y++]=
e+2,e+=3;for(g=0;g<K.length/8;g++)m[y++]=e,m[y++]=e+1,m[y++]=e+2,m[y++]=e+1,m[y++]=e+2,m[y++]=e+3,e+=4;m[y++]=e+0;m[y++]=e+1;m[y++]=e+2;m[y++]=e+1;m[y++]=e+3;m[y++]=e+2;e+=4}}b={vertexData:new Float32Array(k),indexData:new Uint32Array(m)}}}else b=L(d,a);return b};t.createVFMeshScalar=M;t.getUnitConversionFactor=B;t.sampleVectorField=function(d,a,b,c=[0,0],e=.5){const {width:g,height:f,mask:h}=d,[l,p]=d.pixels,[k,m]=c;d=Math.round((g-k)/b);c=Math.round((f-m)/b);var r=d*c;const y=new Float32Array(r),
O=new Float32Array(r);r=new Uint8Array(r);a="vector-uv"===a;for(let T=0;T<c;T++)for(let A=0;A<d;A++){let K=0;const P=T*d+A,U=Math.max(0,T*b+m),J=Math.max(0,A*b+k),W=Math.min(f,U+b),X=Math.min(g,J+b);for(let Y=U;Y<W;Y++)for(let Z=J;Z<X;Z++){var C=Y*g+Z;if(!h||h[C]){K++;C=a?[l[C],p[C]]:[l[C],(360+p[C])%360];const [aa,ba]=a?C:H(C);y[P]+=aa;O[P]+=ba}}if(K>=(W-U)*(X-J)*(1-e)){r[P]=1;const [Y,Z]=w([y[P]/K,O[P]/K]);y[P]=Y;O[P]=Z}else r[P]=0,y[P]=0,O[P]=0}b=new q({width:d,height:c,pixels:[y,O],mask:r});b.updateStatistics();
return b};t.snapImageToSymbolTile=function(d,a,b,c,e){if(!n.isSome(e)||!e.spatialReference.equals(d.spatialReference))return{extent:d,width:a,height:b,resolution:d.width/a};const g=e.xmin;e=e.ymax;c=Math.max(c||0,30);a=((d.xmax-d.xmin)/Math.ceil(1/c*a)+(d.ymax-d.ymin)/Math.ceil(1/c*b))/2;d.xmin=g+Math.floor((d.xmin-g)/a)*a;d.xmax=g+Math.ceil((d.xmax-g)/a)*a;d.ymin=e+Math.floor((d.ymin-e)/a)*a;d.ymax=e+Math.ceil((d.ymax-e)/a)*a;return{extent:d,width:Math.round(d.width/a),height:Math.round(d.height/
a),resolution:a}};t.unitKebabDict=I;t.uvComponentToVector=w;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/layers/imagery/ImageryView2D":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../Graphic ../../../../core/Accessor ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/screenUtils ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/enumeration ../../../../core/accessorSupport/decorators/subclass ../../../../layers/support/rasterFunctions/pixelUtils ../../engine/BitmapContainer ../../engine/Container ../../engine/ImageryBitmapSource ../support/ExportStrategy".split(" "),
function(t,v,n,q,u,B,w,H,G,x,D,Q,L,M,N,V,I,z){const F=u.getLogger("esri.views.2d.layers.imagery.ImageryView2D");q=function(S){function R(){var d=S.apply(this,arguments)||this;d.attached=!1;d.container=new V.Container;d.updateRequested=!1;d.type="Imagery";d._bitmapView=null;return d}t._inheritsLoose(R,S);var E=R.prototype;E.destroy=function(){this.attached&&(this.detach(),this.attached=!1);this.updateRequested=!1};E.update=function(d){this.strategy.update(d).catch(a=>{w.isAbortError(a)||F.error(a)})};
E.detach=function(){this.strategy.destroy();this._bitmapView.removeAllChildren();this.container.removeAllChildren()};E.hitTest=function(d,a){d=this.view.toMap(H.createScreenPoint(d,a));return Promise.resolve(new n({attributes:{},geometry:d,layer:this.layer}))};E.attach=function(){const d=10<=this.layer.version,a=10.1<=this.layer.version?this.layer.imageMaxHeight:2048,b=10.1<=this.layer.version?this.layer.imageMaxWidth:2048;this._bitmapView=new N.BitmapContainer;this.strategy=new z({container:this._bitmapView,
imageNormalizationSupported:d,imageMaxHeight:a,imageMaxWidth:b,fetchSource:this._fetchImage.bind(this),requestUpdate:()=>this.requestUpdate()});this.attached=!0};E.install=function(d){this.container.addChild(this._bitmapView);d.addChild(this.container)};E.uninstall=function(d){this.container.removeChild(this._bitmapView);d.removeChild(this.container)};E.redraw=function(){this.strategy.updateExports(d=>{d.source instanceof HTMLImageElement?d.requestRender():this.layer.applyRenderer({pixelBlock:d.source.pixelBlock}).then(a=>
{const b=d.source;b.pixelBlock=a.pixelBlock;b.filter=c=>this.layer.applyFilter(c);this.container.requestRender()})})};E.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.view.requestUpdate())};E.isUpdating=function(){return this.strategy.updating||this.updateRequested};E.getPixelData=function(){if(this.updating)return null;var d=this.strategy.bitmaps;if(1===d.length&&d[0].source)return{extent:d[0].source.extent,pixelBlock:d[0].source.originalPixelBlock};if(1<d.length){const a=
this.view.extent;d=d.map(b=>b.source).filter(b=>b.extent&&b.extent.intersects(a)).map(b=>({extent:b.extent,pixelBlock:b.originalPixelBlock}));d=M.mosaicPixelData(d,a);return B.isSome(d)?{extent:d.extent,pixelBlock:d.pixelBlock}:null}return null};E._fetchImage=function(d,a,b,c){c=c||{};c.timeExtent=this.timeExtent;c.requestAsImageElement=!0;return this.layer.fetchImage(d,a,b,c).then(e=>e.imageElement?e.imageElement:this.layer.applyRenderer(e.pixelData,{signal:c.signal}).then(g=>{g=new I(g.pixelBlock,
g.extent.clone(),e.pixelData.pixelBlock);g.filter=f=>this.layer.applyFilter(f);return g}))};t._createClass(R,[{key:"updating",get:function(){return!this.attached||this.isUpdating()}}]);return R}(q);v.__decorate([G.property()],q.prototype,"attached",void 0);v.__decorate([G.property()],q.prototype,"container",void 0);v.__decorate([G.property()],q.prototype,"layer",void 0);v.__decorate([G.property()],q.prototype,"strategy",void 0);v.__decorate([G.property()],q.prototype,"timeExtent",void 0);v.__decorate([G.property()],
q.prototype,"view",void 0);v.__decorate([G.property()],q.prototype,"updateRequested",void 0);v.__decorate([G.property()],q.prototype,"updating",null);v.__decorate([Q.enumeration({imagery:"Imagery"})],q.prototype,"type",void 0);return q=v.__decorate([L.subclass("esri.views.2d.layers.imagery.ImageryView2D")],q)})},"esri/views/2d/layers/support/ExportStrategy":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/Accessor ../../../../core/promiseUtils ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/accessorSupport/ensureType ../../../../core/Logger ../../../../core/accessorSupport/decorators/subclass ../../../../geometry/Extent ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/spatialReferenceUtils ../../../../layers/support/TileInfo ../../viewStateUtils ../../engine/Bitmap ../../tiling/TileInfoView ../../tiling/TileKey".split(" "),
function(t,v,n,q,u,B,w,H,G,x,D,Q,L,M,N,V,I){const z=D.create(),F=[0,0],S=new I(0,0,0,0);n=function(R){function E(a){var b=R.call(this,a)||this;b._imagePromise=null;b.bitmaps=[];b.hidpi=!1;b.imageMaxWidth=2048;b.imageMaxHeight=2048;b.imageRotationSupported=!1;b.imageNormalizationSupported=!1;b.update=q.debounce(function(){var c=t._asyncToGenerator(function*(e,g){if(!e.stationary||b.destroyed)return null;const f=e.state;var h=Q.getInfo(f.spatialReference);e=b.hidpi?e.pixelRatio:1;var l=b.imageNormalizationSupported&&
f.worldScreenWidth&&f.worldScreenWidth<f.size[0];l?(F[0]=f.worldScreenWidth,F[1]=f.size[1]):b.imageRotationSupported?(F[0]=f.size[0],F[1]=f.size[1]):M.getOuterSize(F,f);h=h&&(f.extent.xmin<h.valid[0]||f.extent.xmax>h.valid[1]);h=!b.imageNormalizationSupported&&h;const p=b.imageRotationSupported?f.rotation:0;Math.floor(F[0]*e)>b.imageMaxWidth||Math.floor(F[1]*e)>b.imageMaxHeight||h?(l=Math.min(b.imageMaxWidth,b.imageMaxHeight),h&&(l=Math.min(f.worldScreenWidth,l)),b._imagePromise=b._tiledExport(f,
l,p,e,g)):b._imagePromise=b._singleExport(f,F,l?f.paddedViewState.center:f.center,f.resolution,p,e,g);return b._imagePromise.then(function(){var k=t._asyncToGenerator(function*(m){b._imagePromise=null;if(!b.destroyed){b.bitmaps=null!=m?m:[];for(const r of b.container.children)m.includes(r)||r.fadeOut().then(()=>{r.remove()});for(const r of m)b.container.addChild(r),r.fadeIn()}});return function(m){return k.apply(this,arguments)}}()).catch(k=>{b._imagePromise=null;throw k;})});return function(e,g){return c.apply(this,
arguments)}}(),5E3);return b}t._inheritsLoose(E,R);var d=E.prototype;d.destroy=function(){this.bitmaps=[]};d.updateExports=function(a){for(const b of this.container.children){if(!b.visible||!b.stage)break;a(b);b.invalidateTexture();b.requestRender()}};d._export=function(){var a=t._asyncToGenerator(function*(b,c,e,g,f,h){e=yield this.fetchSource(b,Math.floor(c*f),Math.floor(e*f),{rotation:g,pixelRatio:f,signal:h});e=new N.Bitmap(e,"additive");e.x=b.xmin;e.y=b.ymax;e.resolution=b.width/c;e.rotation=
g;e.pixelRatio=f;return e});return function(b,c,e,g,f,h){return a.apply(this,arguments)}}();d._singleExport=function(){var a=t._asyncToGenerator(function*(b,c,e,g,f,h,l){M.getBBox(z,e,g,c);b=new x(z[0],z[1],z[2],z[3],b.spatialReference);return[yield this._export(b,c[0],c[1],f,h,l)]});return function(b,c,e,g,f,h,l){return a.apply(this,arguments)}}();d._tiledExport=function(a,b,c,e,g){var f=L.create({size:b,spatialReference:a.spatialReference,scales:[a.scale]});const h=new V(f);f=h.getTileCoverage(a);
if(!f)return null;const l=[];f.forEach((p,k,m,r)=>{S.set(p,k,m,r);h.getTileBounds(z,S);p=new x(z[0],z[1],z[2],z[3],a.spatialReference);l.push(this._export(p,b,b,c,e,g))});return Promise.all(l)};t._createClass(E,[{key:"updating",get:function(){return!this.destroyed&&null!==this._imagePromise}}]);return E}(n);v.__decorate([u.property()],n.prototype,"_imagePromise",void 0);v.__decorate([u.property()],n.prototype,"bitmaps",void 0);v.__decorate([u.property()],n.prototype,"container",void 0);v.__decorate([u.property()],
n.prototype,"fetchSource",void 0);v.__decorate([u.property()],n.prototype,"hidpi",void 0);v.__decorate([u.property()],n.prototype,"imageMaxWidth",void 0);v.__decorate([u.property()],n.prototype,"imageMaxHeight",void 0);v.__decorate([u.property()],n.prototype,"imageRotationSupported",void 0);v.__decorate([u.property()],n.prototype,"imageNormalizationSupported",void 0);v.__decorate([u.property()],n.prototype,"requestUpdate",void 0);v.__decorate([u.property()],n.prototype,"updating",null);return n=v.__decorate([G.subclass("esri.views.2d.layers.support.ExportStrategy")],
n)})},"esri/views/2d/viewStateUtils":function(){define(["exports"],function(t){const v=Math.PI/180;t.bboxIntersects=function(n,q){const [u,B,w,H]=n,[G,x,D,Q]=q;return!(u>D||w<G||B>Q||H<x)};t.getBBox=function(n,q,u,B){const [w,H]=q,[G,x]=B;q=.5*u;n[0]=w-q*G;n[1]=H-q*x;n[2]=w+q*G;n[3]=H+q*x;return n};t.getOuterSize=function(n,q){var u=q.rotation*v;const B=Math.abs(Math.cos(u));u=Math.abs(Math.sin(u));const [w,H]=q.size;n[0]=Math.round(H*u+w*B);n[1]=Math.round(H*B+w*u);return n};t.snapToPixel=function(n,
q,u){const {resolution:B,size:w}=u;n[0]=B*(Math.round(q[0]/B)+w[0]%2*.5);n[1]=B*(Math.round(q[1]/B)+w[1]%2*.5);return n};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/layers/ImageryLayerView":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Error ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/accessorSupport/decorators/subclass ../../geometry/Point ../../layers/support/commonProperties ../../rest/support/Query ./support/popupUtils".split(" "),
function(t,v,n,q,u,B,w,H,G,x,D,Q,L,M){w=N=>{N=function(V){function I(){var F=V.apply(this,arguments)||this;F.view=null;return F}v._inheritsLoose(I,V);var z=I.prototype;z.fetchPopupFeatures=function(){var F=v._asyncToGenerator(function*(S,R){const {layer:E}=this;if(!S)throw new q("imagerylayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:E});var {popupEnabled:d}=E;const a=M.getFetchPopupTemplate(E,R);if(!d||!u.isSome(a))throw new q("imagerylayerview:fetchPopupFeatures","Missing required popupTemplate or popupEnabled",
{popupEnabled:d,popupTemplate:a});const b=yield a.getRequiredFields();d=new L;d.timeExtent=this.timeExtent;d.geometry=S;d.outFields=b;d.outSpatialReference=S.spatialReference;S=this.view.resolution;S="2d"===this.view.type?new D(S,S,this.view.spatialReference):new D(.5*S,.5*S,this.view.spatialReference);const {returnTopmostRaster:c,showNoDataRecords:e}=a.layerOptions||{returnTopmostRaster:!0,showNoDataRecords:!1};R={returnDomainValues:!0,returnTopmostRaster:c,pixelSize:S,showNoDataRecords:e,signal:u.isSome(R)?
R.signal:null};return E.queryVisibleRasters(d,R).then(g=>g)});return function(S,R){return F.apply(this,arguments)}}();z.canResume=function(){var F;return!V.prototype.canResume.call(this)||null!=(F=this.timeExtent)&&F.isEmpty?!1:!0};return I}(N);n.__decorate([B.property()],N.prototype,"layer",void 0);n.__decorate([B.property()],N.prototype,"suspended",void 0);n.__decorate([B.property(Q.combinedViewLayerTimeExtentProperty)],N.prototype,"timeExtent",void 0);n.__decorate([B.property()],N.prototype,"view",
void 0);return N=n.__decorate([x.subclass("esri.views.layers.ImageryLayerView")],N)};t.ImageryLayerView=w;t["default"]=w;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/layers/support/popupUtils":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../core/maybe","../../../layers/support/fieldUtils"],function(t,v,n,q){function u(){u=v._asyncToGenerator(function*(B,w=B.popupTemplate){if(!n.isSome(w))return[];const H=yield w.getRequiredFields(B.fieldsIndex);
({lastEditInfoEnabled:w}=w);const {objectIdField:G,typeIdField:x,globalIdField:D,relationships:Q}=B;if(H.includes("*"))return["*"];w=w?yield q.getFeatureEditFields(B):[];const L=q.fixFields(B.fieldsIndex,[...H,...w]);x&&L.push(x);L&&G&&B.fieldsIndex.has(G)&&-1===L.indexOf(G)&&L.push(G);L&&D&&B.fieldsIndex.has(D)&&-1===L.indexOf(D)&&L.push(D);Q&&Q.forEach(M=>{({keyField:M}=M);L&&M&&B.fieldsIndex.has(M)&&-1===L.indexOf(M)&&L.push(M)});return L});return u.apply(this,arguments)}t.getFetchPopupTemplate=
function(B,w){return B.popupTemplate?B.popupTemplate:n.isSome(w)&&w.defaultPopupTemplateEnabled&&n.isSome(B.defaultPopupTemplate)?B.defaultPopupTemplate:null};t.getRequiredFields=function(B){return u.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/layers/RefreshableLayerView":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Logger ../../core/promiseUtils ../../core/watchUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(t,v,n,q,u,B,w,H,G,x){H=D=>{D=function(Q){function L(){return Q.apply(this,arguments)||this}v._inheritsLoose(L,Q);L.prototype.initialize=function(){this.handles.add(B.on(this,"layer","refresh",()=>{this.doRefresh().catch(M=>{u.isAbortError(M)||q.getLogger(this.declaredClass).error(M)})}),"RefreshableLayerView")};return L}(D);n.__decorate([w.property()],D.prototype,"layer",void 0);return D=n.__decorate([x.subclass("esri.layers.mixins.RefreshableLayerView")],D)};t.RefreshableLayerView=H;t["default"]=
H;Object.defineProperty(t,"__esModule",{value:!0})})},"*noref":1}});
define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/watchUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ./LayerView2D ./imagery/ImageryGraphicsView2D ./imagery/ImageryView2D ../../layers/ImageryLayerView ../../layers/LayerView ../../layers/RefreshableLayerView".split(" "),function(t,v,n,q,u,B,w,H,G,x,D,Q,L,M){u=function(N){function V(){var z=
N.apply(this,arguments)||this;z._exportImageVersion=-1;return z}t._inheritsLoose(V,N);var I=V.prototype;I.initialize=function(){this.handles.add([n.init(this,["layer.blendMode","layer.effects"],z=>{this.subview&&(this.subview.container.blendMode=z)},!0),n.init(this,["layer.effect"],z=>{this.subview&&(this.subview.container.effect=z)},!0)])};I.hitTest=function(z,F){return this.suspended||!this.subview?Promise.resolve(null):this.subview.hitTest(z,F)};I.update=function(z){var F;null==(F=this.subview)?
void 0:F.update(z)};I.attach=function(){this.layer.increaseRasterJobHandlerUsage();this._setSubView();this.handles.add([n.init(this,"layer.exportImageServiceParameters.version",z=>{this._exportImageVersion!==z&&(this._exportImageVersion=z,this.requestUpdate())}),this.watch("timeExtent",()=>{this.subview.timeExtent=this.timeExtent;this.requestUpdate()}),this.layer.on("redraw",()=>this.subview.redraw()),n.watch(this.layer,"renderer",()=>this._setSubView())],"imagerylayerview-update")};I.detach=function(){this.layer.decreaseRasterJobHandlerUsage();
this.subview.destroy();this.handles.remove("imagerylayerview-update");this._exportImageVersion=-1};I.moveStart=function(){};I.viewChange=function(){};I.moveEnd=function(){this.requestUpdate()};I.doRefresh=function(){var z=t._asyncToGenerator(function*(){this.requestUpdate()});return function(){return z.apply(this,arguments)}}();I.isUpdating=function(){return!this.subview||!this.suspended&&this.subview.isUpdating()};I._setSubView=function(){var z;let F="Imagery";"vector-field"===(null==(z=this.layer.renderer)?
void 0:z.type)&&"lerc"===this.layer.format&&(F="Graphics");if(!this.subview||this.subview.type!==F){var S,R;null==(S=this.subview)?void 0:S.uninstall(this.container);null==(R=this.subview)?void 0:R.destroy();this.subview="Imagery"===F?new D({layer:this.layer,view:this.view,timeExtent:this.timeExtent}):new x({layer:this.layer,view:this.view,timeExtent:this.timeExtent});this.subview.attach();this.subview.install(this.container);this.subview.container.blendMode=this.layer.blendMode;this.subview.container.effect=
this.layer.effect}this.requestUpdate()};t._createClass(V,[{key:"pixelData",get:function(){return this.updating?null:this.subview.getPixelData()}},{key:"updating",get:function(){return!(this.subview&&!this.subview.updating)}}]);return V}(Q.ImageryLayerView(M.RefreshableLayerView(G.LayerView2DMixin(L))));v.__decorate([q.property()],u.prototype,"pixelData",null);v.__decorate([q.property({readOnly:!0})],u.prototype,"updating",null);v.__decorate([q.property()],u.prototype,"subview",void 0);return u=v.__decorate([H.subclass("esri.views.2d.layers.ImageryLayerView2D")],
u)});