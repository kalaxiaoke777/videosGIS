// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.21/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/2d/engine/Stage":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/Error ../../../core/events ../../../core/has ../../../core/maybe ../../../core/scheduling ../../../core/watchUtils ../../../chunks/common ../../../chunks/mat2d ../../../chunks/mat2df64 ../../../chunks/mat3f32 ../../../chunks/vec2 ../../../chunks/vec2f64 ../../webgl/BufferObject ../../webgl/FramebufferObject ../../webgl/checkWebGLError ../../webgl/enums ../../../chunks/builtins ../../webgl/programUtils ../../webgl/RenderingContext ../../webgl/Texture ../../webgl/VertexArrayObject ../../webgl/context-util ./Container ./TransformState ./webgl/enums ./webgl/Painter ./webgl/Profiler ./webgl/WebGLDriverTest ./webgl/shaders/StencilPrograms ../support/Timeline ../../support/screenshotUtils".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c,q,n,a,f,d,k,l,g,t,r,w,v,z,u,y,D,G,H,J,K,L){d=function(M){function N(I,O){var Q=M.call(this)||this;Q._trash=new Set;Q._clipData=new Float32Array(8);Q._upperLeft=n.create();Q._upperRight=n.create();Q._lowerLeft=n.create();Q._lowerRight=n.create();Q._mat2=e.create();Q._clipRendererInitialized=!1;Q._supersampleScreenshots=!0;Q._renderRemainingTime=0;Q._lastFrameRenderTime=0;Q.renderRequested=!1;Q.stage=F._assertThisInitialized(Q);Q._stationary=!0;const {canvas:T=document.createElement("canvas"),
alpha:V=!0,stencil:aa=!0,supersampleScreenshots:Z=!0,contextOptions:R={}}=O;Q._canvas=T;const S=v.createContextOrErrorHTML(T,1,{alpha:V,antialias:!1,depth:!0,stencil:aa});Q.context=new t(x.isSome(S)?S:null,R);Q.painter=new D(Q.context,F._assertThisInitialized(Q));B("esri-2d-profiler")&&(Q._debugOutput=document.createElement("div"),Q._debugOutput.setAttribute("style","margin: 24px 64px; position: absolute; color: red;"),I.appendChild(Q._debugOutput));Q._renderParameters={drawPhase:0,state:u.createTransformState(Q.state),
pixelRatio:window.devicePixelRatio,stationary:!1,globalOpacity:1,blendMode:null,deltaTime:-1,time:0,inFadeTransition:!1,effects:null,context:Q.context,painter:Q.painter,timeline:O.timeline||new K.Timeline,renderingOptions:O.renderingOptions,requireFBO:!1,driverTestResult:H.testWebGLDriver(Q.context),profiler:new G.Profiler(Q.context,Q._debugOutput),dataUploadCounter:0};Q._taskHandle=m.addFrameTask({render:U=>Q.renderFrame(U)});Q._taskHandle.pause();Q._supersampleScreenshots=Z;Q._lostWebGLContextHandle=
C.on(T,"webglcontextlost",()=>{Q.emit("webgl-error",{error:new E("webgl-context-lost")})});T.setAttribute("style","width: 100%; height:100%; display:block;");I.appendChild(T);return Q}F._inheritsLoose(N,M);var P=N.prototype;P.destroy=function(){this.removeAllChildren();this._emptyTrash();this._taskHandle.remove();this._boundFBO=this._taskHandle=null;this._clipFBO&&(this._clipFBO.dispose(),this._clipFBO=null);this._clipVAO&&(this._clipVAO.dispose(),this._clipVBO=this._clipVAO=null);this._clipStencilProgram&&
(this._clipStencilProgram.dispose(),this._clipStencilProgram=null);this._lostWebGLContextHandle&&(this._lostWebGLContextHandle.remove(),this._lostWebGLContextHandle=null);this._canvas.parentNode&&this._canvas.parentNode.removeChild(this._canvas);this._debugOutput&&this._debugOutput.parentNode&&this._debugOutput.parentNode.removeChild(this._debugOutput);this.highlightOptions=null;this.painter.dispose();this.context.dispose();this._canvas=null};P.trashDisplayObject=function(I){this._trash.add(I);this.requestRender()};
P.untrashDisplayObject=function(I){return this._trash.delete(I)};P.requestRender=function(){this._renderRemainingTime=2E3;this.renderRequested||(this.renderRequested=!0,this.emit("will-render"),this._taskHandle.resume())};P.renderFrame=function(I){this._renderRemainingTime-=this._lastFrameRenderTime?I.time-this._lastFrameRenderTime:0;0>=this._renderRemainingTime&&this._taskHandle.pause();this._lastFrameRenderTime=I.time;this.renderRequested=!1;this._renderParameters.state=u.createTransformState(this._state);
this._renderParameters.stationary=this.stationary;this._renderParameters.pixelRatio=window.devicePixelRatio;this._renderParameters.globalOpacity=1;this._renderParameters.time=I.time;this._renderParameters.deltaTime=I.deltaTime;this._renderParameters.effects=null;this.processRender(this._renderParameters);this._emptyTrash();this.emit("post-render")};P._createTransforms=function(){return{dvs:c.create()}};P.renderChildren=function(I){for(const O of this.children)O.beforeRender(I);this._renderChildren(this.children,
I);for(const O of this.children)O.afterRender(I)};P._renderChildren=function(I,O){const Q=this.context;O.profiler.recordStart("drawLayers");O.dataUploadCounter=0;this._beforeRenderChildren(O);O.drawPhase=y.WGLDrawPhase.MAP;this.painter.beforeRenderLayers(Q,this.background);for(const T of I)T.processRender(O);this.painter.renderLayers(Q);O.drawPhase=y.WGLDrawPhase.HIGHLIGHT;this.painter.beforeRenderLayers(Q);for(const T of I)T.processRender(O);this.painter.renderLayers(Q);if(this._isLabelDrawPhaseRequired(I)){O.drawPhase=
y.WGLDrawPhase.LABEL;this.painter.beforeRenderLayers(Q);for(const T of I)T.processRender(O);this.painter.renderLayers(Q)}if(B("esri-tiles-debug")){O.drawPhase=y.WGLDrawPhase.DEBUG;this.painter.beforeRenderLayers(Q);for(const T of I)T.processRender(O);this.painter.renderLayers(Q)}O.profiler.recordEnd("drawLayers");this._afterRenderChildren()};P._beforeRenderChildren=function(I){const {context:O}=this,{state:Q,pixelRatio:T}=I;O.enforceState();O.setClearDepth(1);O.setClearColor(0,0,0,0);O.clear(O.gl.COLOR_BUFFER_BIT|
O.gl.DEPTH_BUFFER_BIT);const {size:V,rotation:aa}=Q;var Z=Math.round(V[0]*T);I=Math.round(V[1]*T);this._boundFBO=O.getBoundFramebufferObject();if(Q.spatialReference&&(Q.spatialReference._isWrappable?Q.spatialReference._isWrappable():Q.spatialReference.isWrappable)){var R=h.toRadian(aa),S=Math.abs(Math.cos(R)),U=Math.abs(Math.sin(R)),X=Math.round(Q.worldScreenWidth);if(Math.round(Z*S+I*U)<=X)this._clipFrame=!1;else{this._clipFBO&&this._clipFBO.width===Z&&this._clipFBO.height===I||(this._clipFBO=new f(O,
{colorTarget:0,depthStencilTarget:3,width:Z,height:I}));var fa=(this.state.padding.left-this.state.padding.right)/2,ea=(this.state.padding.bottom-this.state.padding.top)/2,ha=.5*Z,W=.5*I,Y=1/Z,ba=1/I;X=.5*X*T;var ca=.5*(Z*U+I*S);Z=this._upperLeft;S=this._upperRight;U=this._lowerLeft;var da=this._lowerRight;q.set(Z,-X,-ca);q.set(S,X,-ca);q.set(U,-X,ca);q.set(da,X,ca);b.identity(this._mat2);b.translate(this._mat2,this._mat2,[ha+fa,W+ea]);0!==aa&&b.rotate(this._mat2,this._mat2,R);q.transformMat2d(Z,
Z,this._mat2);q.transformMat2d(S,S,this._mat2);q.transformMat2d(U,U,this._mat2);q.transformMat2d(da,da,this._mat2);R=this._clipData;R.set([2*U[0]*Y-1,2*(I-U[1])*ba-1,2*da[0]*Y-1,2*(I-da[1])*ba-1,2*Z[0]*Y-1,2*(I-Z[1])*ba-1,2*S[0]*Y-1,2*(I-S[1])*ba-1]);this._clipRendererInitialized||this._initializeClipRenderer(O);this._clipVBO.setData(R);this._boundFBO=O.getBoundFramebufferObject();O.bindFramebuffer(this._clipFBO);O.setDepthWriteEnabled(!0);O.setStencilWriteMask(255);O.setClearColor(0,0,0,0);O.setClearDepth(1);
O.setClearStencil(0);O.clear(O.gl.COLOR_BUFFER_BIT|O.gl.DEPTH_BUFFER_BIT|O.gl.STENCIL_BUFFER_BIT);O.setDepthWriteEnabled(!1);this._clipFrame=!0}}else this._clipFrame=!1};P._afterRenderChildren=function(){const I=this.context;I.logIno();if(this._clipFrame&&this._clipRendererInitialized){I.bindFramebuffer(this._boundFBO);this._boundFBO=null;I.bindVAO(this._clipVAO);I.useProgram(this._clipStencilProgram);I.setDepthWriteEnabled(!1);I.setDepthTestEnabled(!1);I.setStencilTestEnabled(!0);I.setBlendingEnabled(!1);
I.setColorMask(!1,!1,!1,!1);I.setStencilOp(7680,7680,7681);I.setStencilWriteMask(255);I.setStencilFunction(519,1,255);I.drawElements(4,6,5123,0);I.bindVAO();I.setColorMask(!0,!0,!0,!0);if(null!=this.background){const {r:O,g:Q,b:T,a:V}=this.background.color;I.setClearColor(V*O/255,V*Q/255,V*T/255,V)}else I.setClearColor(0,0,0,0);I.clear(I.gl.COLOR_BUFFER_BIT);I.setBlendingEnabled(!0);I.setStencilFunction(514,1,255);this.painter.blitTexture(I,this._clipFBO.colorTexture,9728,1);I.setStencilTestEnabled(!1)}};
P.doRender=function(I){const O=this.context,{state:Q,pixelRatio:T}=I;this._resizeCanvas(I);this.context.enforceState();O.setViewport(0,0,T*Q.size[0],T*Q.size[1]);O.setDepthWriteEnabled(!0);O.setStencilWriteMask(255);M.prototype.doRender.call(this,I)};P.takeScreenshot=function(){var I=F._asyncToGenerator(function*(O,Q){var T=L.screenshotSuperSampleSettings(O,this._supersampleScreenshots,this._state.padding);const {framebufferWidth:V,framebufferHeight:aa}=T;var Z=this.context,R=O.layers;let S=this.children;
var U=this._state.clone();if(null!=O.rotation){var X=U.viewpoint;U.viewpoint.rotation=O.rotation;U.viewpoint=X}U={...this._renderParameters,drawPhase:null,globalOpacity:1,stationary:!0,state:u.createTransformState(U),pixelRatio:T.pixelRatio,time:Date.now(),deltaTime:0,blendMode:null,effects:null,inFadeTransition:!1};0<R.length&&(S=[],R.forEach(ea=>{const ha=Q.find(W=>W.layer.id===ea.id);ha&&"container"in ha&&ha.container&&S.push(ha.container)}));const fa=new f(Z,{colorTarget:0,depthStencilTarget:3,
width:V,height:aa});R=Z.getBoundFramebufferObject();X=Z.getViewport();Z.bindFramebuffer(fa);Z.setViewport(0,0,V,aa);this._renderChildren(S,U);T=this._readbackScreenshot(T);Z.bindFramebuffer(R);Z.setViewport(X.x,X.y,X.width,X.height);this.requestRender();Z=this._ensureScreenshotEncodeCanvas();return L.encodeResult(T,O,Z,{flipY:!0,premultipliedAlpha:!0})});return function(O,Q){return I.apply(this,arguments)}}();P._ensureScreenshotEncodeCanvas=function(){this._screenshotEncodeCanvas||(this._screenshotEncodeCanvas=
document.createElement("canvas"));return this._screenshotEncodeCanvas};P._readbackScreenshot=function(I){const {framebufferWidth:O,framebufferHeight:Q,region:T,resample:V}=I;I=this.context.gl;if(V){var aa=L.createEmptyImageData(O,Q,this._ensureScreenshotEncodeCanvas());I.readPixels(0,0,O,Q,6408,5121,new Uint8Array(aa.data.buffer));I=L.createEmptyImageData(T.width,T.height,this._ensureScreenshotEncodeCanvas());return L.resampleHermite(aa,I,!0,V.region.x,Q-(V.region.y+V.region.height),V.region.width,
V.region.height)}aa=L.createEmptyImageData(T.width,T.height,this._ensureScreenshotEncodeCanvas());I.readPixels(T.x,Q-(T.y+T.height),T.width,T.height,6408,5121,new Uint8Array(aa.data.buffer));return aa};P._resizeCanvas=function(I){const O=this._canvas,Q=O.style,{state:{size:T},pixelRatio:V}=I;I=T[0];const aa=T[1],Z=Math.round(I*V),R=Math.round(aa*V);if(O.width!==Z||O.height!==R)O.width=Z,O.height=R;Q.width=I+"px";Q.height=aa+"px"};P._initializeClipRenderer=function(I){if(this._clipRendererInitialized)return!0;
const O=J.stencil.attributes,Q=g.createProgram(I,J.stencil);if(!Q)return!1;const T=a.createVertex(I,35040,32);var V=new Uint16Array([0,1,2,2,1,3]);V=a.createIndex(I,35044,V);I=new w(I,O,{geometry:[{name:"a_pos",count:2,type:5126,offset:0,stride:8,normalized:!1,divisor:0}]},{geometry:T},V);this._clipStencilProgram=Q;this._clipVBO=T;this._clipVAO=I;return this._clipRendererInitialized=!0};P._emptyTrash=function(){for(;0<this._trash.size;){const I=Array.from(this._trash);this._trash.clear();for(const O of I)O.processDetach()}};
P._isLabelDrawPhaseRequired=function(I){let O=!1;for(const Q of I){if(!(Q instanceof z.Container)){O=O||!1;break}if(Q.hasLabels)return!0;O=O||this._isLabelDrawPhaseRequired(Q.children)}return O};F._createClass(N,[{key:"background",get:function(){return this._background},set:function(I){this._background=I;this.requestRender()}},{key:"highlightOptions",get:function(){return this._highlightOptions},set:function(I){this._highlightOptionsHandle&&(this._highlightOptionsHandle.remove(),this._highlightOptionsHandle=
null);if(this._highlightOptions=I)this._highlightOptionsHandle=p.init(this._highlightOptions,"version",()=>{this.painter.setHighlightOptions(I);this.requestRender()})}},{key:"renderingOptions",get:function(){return this._renderingOptions},set:function(I){this._renderingOptions=I;this.requestRender()}},{key:"state",get:function(){return this._state},set:function(I){this._state=I;this.requestRender()}},{key:"stationary",get:function(){return this._stationary},set:function(I){this._stationary!==I&&(this._stationary=
I,this.requestRender())}}]);return N}(z.Container);A.EXTRA_RENDER_TIME=2E3;A.Stage=d;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/Container":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/has ../../../chunks/mat3f32 ../../../layers/effects/EffectList ./DisplayObject".split(" "),function(A,F,E,C,B,x){const m=E("mapview-transitions-duration");E=function(p){function h(){var e=p.apply(this,arguments)||this;e._childrenSet=new Set;e._needsSort=
!1;e.children=[];e._effectList=null;return e}F._inheritsLoose(h,p);var b=h.prototype;b.updateTransitionProperties=function(e,c){p.prototype.updateTransitionProperties.call(this,e,c);this._effectList&&(this._effectList.transitionStep(e,c),this._effectList.transitioning&&this.requestRender())};b.doRender=function(e){e=this.createRenderParams(e);this.renderChildren(e)};b.addChild=function(e){return this.addChildAt(e,this.children.length)};b.addChildAt=function(e,c=this.children.length){if(!e||this.contains(e))return e;
this._needsSort=!0;const q=e.parent;q&&q!==this&&q.removeChild(e);c>=this.children.length?this.children.push(e):this.children.splice(c,0,e);this._childrenSet.add(e);e.parent=this;e.stage=this.stage;this!==this.stage&&(e.clips=this.clips);this.requestRender();return e};b.contains=function(e){return this._childrenSet.has(e)};b.removeAllChildren=function(){this._childrenSet.clear();this._needsSort=!0;for(const e of this.children)this!==this.stage&&(e.clips=null),e.stage=null,e.parent=null;this.children.length=
0};b.removeChild=function(e){return this.contains(e)?this.removeChildAt(this.children.indexOf(e)):e};b.removeChildAt=function(e){if(0>e||e>=this.children.length)return null;this._needsSort=!0;e=this.children.splice(e,1)[0];this._childrenSet.delete(e);this!==this.stage&&(e.clips=null);e.stage=null;e.parent=null;return e};b.sortChildren=function(e){this._needsSort&&(this.children.sort(e),this._needsSort=!1)};b._createTransforms=function(){return{dvs:C.create()}};b.onAttach=function(){p.prototype.onAttach.call(this);
const e=this.stage;for(const c of this.children)c.stage=e};b.onDetach=function(){p.prototype.onDetach.call(this);for(const e of this.children)e.stage=null};b.renderChildren=function(e){for(const c of this.children)c.beforeRender(e);for(const c of this.children)c.processRender(e);for(const c of this.children)c.afterRender(e)};b.createRenderParams=function(e){return{...e,blendMode:this.blendMode,effects:this.computedEffects,globalOpacity:e.globalOpacity*this.computedOpacity,inFadeTransition:this.inFadeTransition}};
F._createClass(h,[{key:"blendMode",get:function(){return this._blendMode},set:function(e){this._blendMode=e;this.requestRender()}},{key:"clips",get:function(){return this._clips},set:function(e){this._clips=e;this.children.forEach(c=>c.clips=e)}},{key:"computedEffects",get:function(){var e,c;return null!=(e=null==(c=this._effectList)?void 0:c.effects)?e:null}},{key:"effect",get:function(){var e,c;return null!=(e=null==(c=this._effectList)?void 0:c.effect)?e:""},set:function(e){if(this._effectList||
e)this._effectList||(this._effectList=new B["default"](m)),this._effectList.effect=e,this.requestRender()}}]);return h}(x.DisplayObject);A.Container=E;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/layers/effects/EffectList":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../colorUtils ../../core/Error ../../core/lang ../../core/Logger ./effects ./parser".split(" "),function(A,F,E,C,B,x,m,p){function h(f){if(!f)return[];if("string"===typeof f){var d=p.parse(f);return d.error?
d.error:[{scale:-1,effects:d.effects}]}d=[];for(var k of f){if(!isFinite(k.scale)||0>=k.scale)return new C("effect:invalid-scale","scale must be finite and greater than 0",{stop:k});f=p.parse(k.value);if(f.error)return f.error;d.push({scale:k.scale,effects:f.effects})}d.sort((l,g)=>g.effects.length-l.effects.length);for(k=0;k<d.length-1;k++){if(!e(d[k].effects,d[k+1].effects))return new C("effect:interpolation-impossible","Cannot interpolate by scale between 2 lists of mixed effects",{a:d[k].effects,
b:d[k+1].effects});c(d[k].effects,d[k+1].effects)}d.sort((l,g)=>g.scale-l.scale);return d}function b(f){switch(f.type){case "grayscale":case "sepia":case "invert":return new m.ColorMatrixEffect(f.type,0);case "saturate":case "brightness":case "contrast":return new m.ColorMatrixEffect(f.type,1);case "opacity":return new m.OpacityEffect(1);case "hue-rotate":return new m.HueRotateEffect(0);case "blur":return new m.BlurEffect(0);case "drop-shadow":return new m.DropShadowEffect(0,0,0,[...E.getNamedColor("transparent")]);
case "bloom":return new m.BloomEffect(0,0,0)}}function e(f,d){const k=f.length>d.length?f:d;return(f.length>d.length?d:f).every((l,g)=>l.type===k[g].type)}function c(f,d){const k=f.length>d.length?f:d;f=f.length>d.length?d:f;for(d=f.length;d<k.length;d++)f.push(b(k[d]))}function q(f,d,k){var l,g,t,r;return null!=(l=f[0])&&l.effects&&null!=(g=d[0])&&g.effects?(-1===(null==(t=f[0])?void 0:t.scale)||-1===(null==(r=d[0])?void 0:r.scale))&&(1<f.length||1<d.length)&&0>=k?!1:e(f[0].effects,d[0].effects):
!0}function n(f,d,k){var l,g;const t=f.length>d.length?f:d;f=f.length>d.length?d:f;const r=f[f.length-1];d=null!=(l=null==r?void 0:r.scale)?l:k;l=null!=(g=null==r?void 0:r.effects)?g:[];for(g=f.length;g<t.length;g++)f.push({scale:d,effects:[...l]});for(g=0;g<t.length;g++)f[g].scale=-1===f[g].scale?k:f[g].scale,t[g].scale=-1===t[g].scale?k:t[g].scale,c(f[g].effects,t[g].effects)}let a=function(){function f(k=200){this.duration=k;this._final=this._to=this._from=null;this._current=[];this._time=0;this._effect=
"";this._effects=[];this._scale=0}var d=f.prototype;d.transitionStep=function(k,l){this._applyTimeTransition(k);this._updateForScale(l)};d._transitionTo=function(k){0<this.scale&&q(this._current,k,this.scale)?(this._final=k,this._to=B.clone(k),n(this._current,this._to,this.scale),this._from=B.clone(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=k);this._effects=this._current[0]?B.clone(this._current[0].effects):[]};d._applyTimeTransition=function(k){if(this._to){this._time+=
k;k=Math.min(1,this._time/this.duration);for(let g=0;g<this._current.length;g++){const t=this._current[g],r=this._from[g],w=this._to[g];var l=r.scale;t.scale=l+(w.scale-l)*k;for(l=0;l<t.effects.length;l++)t.effects[l].interpolate(r.effects[l],w.effects[l],k)}1===k&&(this._current=this._final,this._effects=this._current[0]?B.clone(this._current[0].effects):[],this._from=this._to=this._final=null)}};d._updateForScale=function(k){if(0!==this._current.length){this._scale=k;var l=this._current,g=this._current.length-
1,t,r=1;if(1===l.length||k>=l[0].scale)var w=t=l[0].effects;else if(k<=l[g].scale)w=t=l[g].effects;else for(let v=0;v<g;v++){const z=l[v],u=l[v+1];if(z.scale>=k&&u.scale<=k){r=(k-z.scale)/(u.scale-z.scale);t=z.effects;w=u.effects;break}}for(k=0;k<this._effects.length;k++)this._effects[k].interpolate(t[k],w[k],r)}};F._createClass(f,[{key:"effect",get:function(){return this._effect},set:function(k){k=k||"";if(this._effect!==k){this._effect=k;var l=h(k);Array.isArray(l)?this._transitionTo(l):(this._transitionTo([]),
x.getLogger("esri.views.layers.effects.EffectList").warn("Invalid Effect",{effect:k,error:l}))}}},{key:"hasEffects",get:function(){return this.transitioning||!!this._effects.length}},{key:"effects",get:function(){return this._effects}},{key:"scale",get:function(){return this._scale}},{key:"transitioning",get:function(){return null!==this._to}}]);return f}();A.canInterpolateEffectStops=q;A.canInterpolateEffects=e;A.convertEffectToStops=h;A["default"]=a;A.normalizeEffectStops=n;A.normalizeEffects=c;
Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/DisplayObject":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/Evented ../../../core/has ../../../core/maybe ../../../core/promiseUtils".split(" "),function(A,F,E,C,B,x){const m=1/C("mapview-transitions-duration");E=function(p){function h(){var e=p.apply(this,arguments)||this;e._fadeOutResolver=null;e._fadeInResolver=null;e._clips=null;e.computedVisible=!0;e.computedOpacity=1;e.fadeTransitionEnabled=
!1;e.inFadeTransition=!1;e._isReady=!1;e._opacity=1;e._stage=null;e._visible=!0;return e}F._inheritsLoose(h,p);var b=h.prototype;b._getTransforms=function(){B.isNone(this._transforms)&&(this._transforms=this._createTransforms());return this._transforms};b.fadeIn=function(){if(this._fadeInResolver)return this._fadeInResolver.promise;this._fadeOutResolver&&(this._fadeOutResolver(),this._fadeOutResolver=null);this.computedOpacity=0;this.fadeTransitionEnabled=!0;this._fadeInResolver=x.createResolver();
this.requestRender();return this._fadeInResolver.promise};b.fadeOut=function(){if(this._fadeOutResolver)return this._fadeOutResolver.promise;this._fadeInResolver&&(this._fadeInResolver(),this._fadeInResolver=null);this.fadeTransitionEnabled=!0;this._fadeOutResolver=x.createResolver();this.requestRender();return this._fadeOutResolver.promise};b.beforeRender=function(e){this.updateTransitionProperties(e.deltaTime,e.state.scale)};b.afterRender=function(e){this._fadeInResolver&&this.computedOpacity===
this.opacity?(this._fadeInResolver(),this._fadeInResolver=null):this._fadeOutResolver&&0===this.computedOpacity&&(this._fadeOutResolver(),this._fadeOutResolver=null)};b.remove=function(){var e;null==(e=this.parent)?void 0:e.removeChild(this)};b.setTransform=function(e){};b.processRender=function(e){this.stage&&this.computedVisible&&this.doRender(e)};b.requestRender=function(){this.stage&&this.stage.requestRender()};b.processDetach=function(){this.onDetach();this.emit("detach")};b.updateTransitionProperties=
function(e,c){if(this.fadeTransitionEnabled){c=this._fadeOutResolver||!this.visible?0:this.opacity;const q=this.computedOpacity;q===c?this.computedVisible=this.visible:(e*=m,this.computedOpacity=q>c?Math.max(c,q-e):Math.min(c,q+e),this.computedVisible=0<this.computedOpacity,e=c===this.computedOpacity,this.inFadeTransition=!e,e||this.requestRender())}else this.computedOpacity=this.opacity,this.computedVisible=this.visible};b.onAttach=function(){};b.onDetach=function(){};b.doRender=function(e){};b.ready=
function(){this._isReady||(this._isReady=!0,this.emit("isReady"),this.requestRender())};F._createClass(h,[{key:"clips",get:function(){return this._clips},set:function(e){this._clips=e;this.requestRender()}},{key:"isReady",get:function(){return this._isReady}},{key:"opacity",get:function(){return this._opacity},set:function(e){this._opacity!==e&&(this._opacity=Math.min(1,Math.max(e,0)),this.requestRender())}},{key:"stage",get:function(){return this._stage},set:function(e){if(this._stage!==e){var c=
this._stage;(this._stage=e)?this._stage.untrashDisplayObject(this)||(this.onAttach(),this.emit("attach")):c.trashDisplayObject(this)}}},{key:"transforms",get:function(){return this._getTransforms()}},{key:"visible",get:function(){return this._visible},set:function(e){this._visible!==e&&(this._visible=e,this.requestRender())}}]);return h}(E);A.DisplayObject=E;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/TransformState":function(){define(["exports","../../../chunks/vec2",
"../../../chunks/vec2f64","../viewpointUtils"],function(A,F,E,C){A.createTransformState=function(B){if(!B)return null;const x=B.inverseTransform,m=B.transform,p=B.transformNoRotation,h=B.pixelRatio,b=[B.size[0],B.size[1]],e=B.viewpoint.targetGeometry,c=E.fromValues(e.x,e.y);return{version:B.id,displayMat3:B.displayMat3.slice(),displayViewMat3:B.displayViewMat3.slice(),viewMat2d:B.viewMat2d.slice(),extent:B.extent.toJSON(),resolution:B.resolution,rotation:B.rotation,size:b,scale:B.scale,center:[e.x,
e.y],spatialReference:B.spatialReference,pixelRatio:h,viewpoint:B.viewpoint,worldScreenWidth:B.worldScreenWidth,toMap(q,n){return F.transformMat2d(q,n,x)},toScreen(q,n){return F.transformMat2d(q,n,m)},toScreenNoRotation(q,n){return F.transformMat2d(q,n,p)},getScreenTransform:(q,n)=>{C.getMatrix(q,c,b,n,0,h);return q}}};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/enums":function(){define(["exports"],function(A){A.WGLGeometryType=void 0;(function(F){F[F.FILL=0]="FILL";
F[F.LINE=1]="LINE";F[F.MARKER=2]="MARKER";F[F.TEXT=3]="TEXT";F[F.LABEL=4]="LABEL"})(A.WGLGeometryType||(A.WGLGeometryType={}));A.WGLGeometryTransactionStatus=void 0;(function(F){F[F.SUCCEEDED=0]="SUCCEEDED";F[F.FAILED_OUT_OF_MEMORY=1]="FAILED_OUT_OF_MEMORY"})(A.WGLGeometryTransactionStatus||(A.WGLGeometryTransactionStatus={}));A.WGLDrawPhase=void 0;(function(F){F[F.NONE=0]="NONE";F[F.MAP=1]="MAP";F[F.LABEL=2]="LABEL";F[F.LABEL_ALPHA=4]="LABEL_ALPHA";F[F.HITTEST=8]="HITTEST";F[F.HIGHLIGHT=16]="HIGHLIGHT";
F[F.CLIP=32]="CLIP";F[F.DEBUG=64]="DEBUG";F[F.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"})(A.WGLDrawPhase||(A.WGLDrawPhase={}));A.VVType=void 0;(function(F){F[F.SIZE=0]="SIZE";F[F.COLOR=1]="COLOR";F[F.OPACITY=2]="OPACITY";F[F.ROTATION=3]="ROTATION"})(A.VVType||(A.VVType={}));A.WGLVVFlag=void 0;(function(F){F[F.NONE=0]="NONE";F[F.OPACITY=1]="OPACITY";F[F.COLOR=2]="COLOR";F[F.ROTATION=4]="ROTATION";F[F.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE";F[F.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS";F[F.SIZE_FIELD_STOPS=
32]="SIZE_FIELD_STOPS";F[F.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"})(A.WGLVVFlag||(A.WGLVVFlag={}));A.WGLVVTarget=void 0;(function(F){F[F.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE";F[F.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE";F[F.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE";F[F.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"})(A.WGLVVTarget||(A.WGLVVTarget={}));A.MosaicType=void 0;(function(F){F[F.SPRITE=0]="SPRITE";F[F.GLYPH=1]="GLYPH"})(A.MosaicType||(A.MosaicType={}));
Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/Painter":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../webgl/BufferObject ../../../webgl/FramebufferObject ../../../../core/has ../../../webgl/checkWebGLError ../../../webgl/enums ../../../../chunks/builtins ../../../webgl/Renderbuffer ../../../webgl/renderState ../../../webgl/Texture ../../../webgl/VertexArrayObject ../brushes ../vectorTiles/shaders/VTLMaterialManager ./BitBlitRenderer ./enums ./MaterialManager ./TextureManager ./effects/AnimationEffect ./effects/BlendEffect ./effects/FeatureEffect ./effects/HighlightEffect ./effects/HittestEffect ./effects/post-processing/EffectManager ./painter/RenderPass".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c,q,n,a,f,d,k,l,g,t,r,w,v,z){function u(D,G,H){return 1!==H||F.isSome(D)&&"normal"!==D||F.isSome(G)&&0<G.length}const y={[f.WGLGeometryType.FILL]:q.brushes.fill,[f.WGLGeometryType.LINE]:q.brushes.line,[f.WGLGeometryType.MARKER]:q.brushes.marker,[f.WGLGeometryType.TEXT]:q.brushes.text};return function(){function D(H,J){this.context=H;this._blitRenderer=new a.BitBlitRenderer;this._brushCache=new Map;this._vtlMaterialManager=new n;this._blendEffect=new g.BlendEffect;this.effects=
{highlight:new r,hittest:new w.HittestEffect,integrate:new l.AnimationEffect,insideEffect:new t.FeatureEffect("inside"),outsideEffect:new t.FeatureEffect("outside")};this.materialManager=new d(H);this.textureManager=new k(J);this._effectsManager=new v.EffectManager(J)}var G=D.prototype;G.getRenderTarget=function(){return this._renderTarget};G.setRenderTarget=function(H){this._renderTarget=H};G.getFbos=function(H,J){if(H!==this._lastWidth||J!==this._lastHeight){this._lastWidth=H;this._lastHeight=J;
if(this._fbos){for(var K in this._fbos)this._fbos[K].resize(H,J);return this._fbos}K={target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:H,height:J};const L={colorTarget:0,depthStencilTarget:3};this._stencilBuf=H=new h(this.context,{width:H,height:J,internalFormat:34041});this._fbos={output:new C(this.context,L,K,H),blend:new C(this.context,L,K,H),effect0:new C(this.context,L,K,H)}}return this._fbos};G.getSharedStencilBuffer=function(){return this._stencilBuf};G.beforeRenderLayers=
function(H,J=null){const {width:K,height:L}=H.getViewport();this._prevFBO=H.getBoundFramebufferObject();const M=this.getFbos(K,L);H.bindFramebuffer(M.output);H.setColorMask(!0,!0,!0,!0);H.setDepthWriteEnabled(!0);if(F.isSome(J)){const {r:N,g:P,b:I,a:O}=J.color;H.setClearColor(O*N/255,O*P/255,O*I/255,O)}else H.setClearColor(0,0,0,0);H.setClearDepth(1);H.clear(H.gl.COLOR_BUFFER_BIT|H.gl.DEPTH_BUFFER_BIT);H.setDepthWriteEnabled(!1)};G.beforeRenderLayer=function(H,J,K){const {context:L,blendMode:M,effects:N,
requireFBO:P}=H;P||u(M,N,K)?(L.bindFramebuffer(this._fbos.blend),L.setColorMask(!0,!0,!0,!0),L.setClearColor(0,0,0,0),L.setDepthWriteEnabled(!0),L.setClearDepth(1),L.clear(L.gl.COLOR_BUFFER_BIT|L.gl.DEPTH_BUFFER_BIT),L.setDepthWriteEnabled(!1)):(H=this._getOutputFBO(),L.bindFramebuffer(H));L.setDepthWriteEnabled(!1);L.setDepthTestEnabled(!1);L.setStencilTestEnabled(!0);L.setClearStencil(J);L.setStencilWriteMask(255);L.clear(L.gl.STENCIL_BUFFER_BIT)};G.compositeLayer=function(H,J){const {context:K,
blendMode:L,effects:M,requireFBO:N}=H;if(N||u(L,M,J)){F.isSome(M)&&0<M.length&&H.drawPhase===f.WGLDrawPhase.MAP&&this._applyEffects(H,M);var P=this._getOutputFBO();K.bindFramebuffer(P);K.setStencilTestEnabled(!1);K.setStencilWriteMask(0);K.setBlendingEnabled(!0);K.setBlendFunctionSeparate(1,771,1,771);K.setColorMask(!0,!0,!0,!0);P=F.isSome(L)?L:"normal";this._blendEffect.draw(H,this._fbos.blend.colorTexture,9728,P,J)}};G.renderLayers=function(H){H.bindFramebuffer(this._prevFBO);if(this._fbos){var J=
this._getOutputFBO();H.setStencilTestEnabled(!1);H.setStencilWriteMask(0);this.blitTexture(H,J.colorTexture,9728)}};G.dispose=function(){this.materialManager.dispose();this.textureManager.dispose();this._blitRenderer&&(this._blitRenderer.dispose(),this._blitRenderer=null);this._brushCache&&(this._brushCache.forEach(H=>H.dispose()),this._brushCache.clear(),this._brushCache=null);if(this._fbos)for(const H in this._fbos)this._fbos[H]&&this._fbos[H].dispose();if(this.effects)for(const H in this.effects)this.effects[H]&&
this.effects[H].dispose();this._vtlMaterialManager&&(this._vtlMaterialManager.dispose(),this._vtlMaterialManager=null);this._prevFBO=null};G.getGeometryBrush=function(H){H=y[H];let J=this._brushCache.get(H);void 0===J&&(J=new H,this._brushCache.set(H,J));return this._brushCache.get(H)};G.renderObject=function(H,J,K,L){K=q.brushes[K];if(!K)return null;let M=this._brushCache.get(K);void 0===M&&(M=new K,this._brushCache.set(K,M));M.prepareState(H,J,L);M.draw(H,J,L)};G.renderObjects=function(H,J,K,L){K=
q.brushes[K];if(!K)return null;let M=this._brushCache.get(K);void 0===M&&(M=new K,this._brushCache.set(K,M));M.drawMany(H,J,L)};G.registerRenderPass=function(H){const J=H.brushes.map(K=>{this._brushCache.has(K)||this._brushCache.set(K,new K);return this._brushCache.get(K)});return new z(J,H)};G.setHighlightOptions=function(H){this.effects.highlight.setHighlightOptions(H)};G.blitTexture=function(H,J,K,L=1){H.setBlendingEnabled(!0);H.setBlendFunctionSeparate(1,771,1,771);H.setColorMask(!0,!0,!0,!0);
this._blitRenderer.render(H,J,K,L)};G.getPostProcessingEffects=function(H){return this._effectsManager.getPostProcessingEffects(H)};G._getOutputFBO=function(){return null!=this._renderTarget?this._renderTarget:this._fbos.output};G._applyEffects=function(H,J){const {context:K}=H;J=this._effectsManager.getPostProcessingEffects(J);for(const {postProcessingEffect:L,effect:M}of J)K.bindFramebuffer(this._fbos.blend),L.draw(H,this._fbos.blend,M)};A._createClass(D,[{key:"vectorTilesMaterialManager",get:function(){return this._vtlMaterialManager}}]);
return D}()})},"esri/views/2d/engine/brushes":function(){define("exports ./webgl/brushes/BrushBitmap ./webgl/brushes/BrushClip ./webgl/brushes/WGLBrushInfo ./webgl/brushes/WGLBrushStencil ./webgl/brushes/WGLBrushVTLBackground ./webgl/brushes/WGLBrushVTLCircle ./webgl/brushes/WGLBrushVTLFill ./webgl/brushes/WGLBrushVTLLine ./webgl/brushes/WGLBrushVTLSymbol ./webgl/brushes/WGLGeometryBrushFill ./webgl/brushes/WGLGeometryBrushLabel ./webgl/brushes/WGLGeometryBrushLine ./webgl/brushes/WGLGeometryBrushMarker ./webgl/brushes/WGLGeometryBrushText ./webgl/brushes/raster/BrushRasterBitmap ./webgl/brushes/raster/BrushVectorField".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c,q,n,a,f,d){const k={vtlBackground:x.WGLBrushVTLBackground,vtlFill:p.WGLBrushVTLFill,vtlLine:h.WGLBrushVTLLine,vtlCircle:m.WGLBrushVTLCircle,vtlSymbol:b.WGLBrushVTLSymbol};A.brushes={marker:n,line:q,fill:e,text:a,label:c,clip:E,stencil:B,bitmap:F,raster:f,rasterVF:d,tileInfo:C,vtlBackground:x.WGLBrushVTLBackground,vtlFill:p.WGLBrushVTLFill,vtlLine:h.WGLBrushVTLLine,vtlCircle:m.WGLBrushVTLCircle,vtlSymbol:b.WGLBrushVTLSymbol};A.vtlBrushes=k;Object.defineProperty(A,"__esModule",
{value:!0})})},"esri/views/2d/engine/webgl/brushes/BrushBitmap":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../definitions","../VertexStream","./WGLBrush"],function(A,F,E,C){const B={nearest:{defines:[],samplingMode:9728,mips:!1},bilinear:{defines:[],samplingMode:9729,mips:!1},bicubic:{defines:["bicubic"],samplingMode:9729,mips:!1},trilinear:{defines:[],samplingMode:9987,mips:!0}};return function(x){function m(){var h=x.apply(this,arguments)||this;h._desc={vsPath:"raster/bitmap",
fsPath:"raster/bitmap",attributes:new Map([["a_position",0],["a_texcoord",1]])};return h}A._inheritsLoose(m,x);var p=m.prototype;p.dispose=function(){this._quad&&this._quad.dispose()};p.prepareState=function({context:h},b){h.setBlendingEnabled(!0);"additive"===b.blendFunction?h.setBlendFunctionSeparate(1,1,1,1):h.setBlendFunctionSeparate(1,771,1,771);h.setColorMask(!0,!0,!0,!0);h.setStencilWriteMask(0);h.setStencilTestEnabled(!0);h.setStencilFunction(514,b.stencilRef,255)};p.draw=function(h,b){const {context:e,
renderingOptions:c,painter:q}=h;if(b.source){h.timeline.begin(this.name);this._quad||(this._quad=new E(e,[0,0,1,0,0,1,1,1]));if("dynamic"===c.samplingMode){({state:f}=h);var n=b.resolution/b.pixelRatio/f.resolution,a=Math.round(h.pixelRatio)!==h.pixelRatio;n=1.05<n||.95>n;var f=f.rotation||n||a||b.isSourceScaled||b.rotation?B.bilinear:B.nearest}else f=B[c.samplingMode];a=q.materialManager.getProgram(h,this._desc,f.defines);var {coordScale:d,computedOpacity:k,transforms:l}=b;b.setSamplingProfile(f);
b.bind(h.context,F.TEXTURE_BINDING_BITMAP);e.useProgram(a);a.setUniformMatrix3fv("u_dvsMat3",l.dvs);a.setUniform1i("u_texture",F.TEXTURE_BINDING_BITMAP);a.setUniform2fv("u_coordScale",d);a.setUniform1f("u_opacity",k);this._quad.draw();h.timeline.end(this.name)}};return m}(C)})},"esri/views/2d/engine/webgl/definitions":function(){define(["exports"],function(A){A.ANGLE_FACTOR_256=256/360;A.ATTRIBUTE_DATA_ANIMATION=1;A.ATTRIBUTE_DATA_DD0=3;A.ATTRIBUTE_DATA_DD1=3;A.ATTRIBUTE_DATA_FILTER_FLAGS=0;A.ATTRIBUTE_DATA_VV=
2;A.ATTRIBUTE_STORE_TEXTURE_SIZE=1024;A.AVERAGE_GLYPH_MOSAIC_ITEM={metrics:{width:15,height:17,left:0,top:-7,advance:14}};A.BUFFER_DATA_MINIMUM_SIZE=128;A.BUFFER_DATA_POOL_SIZE=4;A.COLLISION_BOX_PADDING=16;A.COLLISION_BUCKET_SIZE=128;A.COLLISION_EARLY_REJECT_BUCKET_SIZE=16;A.COLLISION_MAX_ZOOM_DELTA=1;A.COLLISION_PLACEMENT_PADDING=8;A.COLLISION_TILE_BOX_SIZE=4;A.DEBUG_LABELS=!1;A.DISPLAY_RECORD_INT_PER_ELEMENT=8;A.DOT_DENSITY_MAX_FIELDS=8;A.EFFECT_FLAG_0=4;A.ENABLE_EARLY_LABEL_DISCARD=!1;A.EXTRUDE_SCALE=
64;A.FILTER_FLAG_0=2;A.GLYPH_SIZE=24;A.HEURISTIC_GLYPHS_PER_FEATURE=10;A.HEURISTIC_GLYPHS_PER_LINE=50;A.HIGHLIGHT_FLAG=1;A.HITTEST_SEARCH_SIZE=6;A.MAGIC_LABEL_LINE_HEIGHT=29;A.MAX_FILTERS=2;A.MAX_GPU_UPLOADS_PER_FRAME=2;A.MIN_MAX_ZOOM_PRECISION_FACTOR=10;A.NAN_MAGIC_NUMBER=1E-30;A.PATCH_PIXEL_BUFFER_ALLOC_SIZE=500;A.PICTURE_FILL_COLOR=4294967295;A.RASTER_TILE_SIZE=256;A.SPRITE_PADDING=2;A.TEXTURE_BINDING_ATTRIBUTE_DATA_0=1;A.TEXTURE_BINDING_ATTRIBUTE_DATA_1=2;A.TEXTURE_BINDING_ATTRIBUTE_DATA_2=3;
A.TEXTURE_BINDING_ATTRIBUTE_DATA_3=4;A.TEXTURE_BINDING_BITMAP=0;A.TEXTURE_BINDING_GLYPH_ATLAS=0;A.TEXTURE_BINDING_HIGHLIGHT_0=5;A.TEXTURE_BINDING_HIGHLIGHT_1=6;A.TEXTURE_BINDING_RENDERER_0=5;A.TEXTURE_BINDING_RENDERER_1=6;A.TEXTURE_BINDING_SPRITE_ATLAS=0;A.TEXT_PLACEMENT_PADDING=8;A.THIN_LINE_HALF_WIDTH_THRESHOLD=1.05;A.TILE_SIZE=512;A.VTL_HIGH_RES_CUTOFF=1.15;A.VTL_TEXTURE_BINDING_UNIT_GLYPHS=6;A.VTL_TEXTURE_BINDING_UNIT_SPRITES=5;A.WEBGL_MAX_INNER_STOPS=6;A.WEBGL_MAX_STOPS=8;Object.defineProperty(A,
"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/VertexStream":function(){define("../../../webgl/BufferObject ../../../webgl/FramebufferObject ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../webgl/checkWebGLError ../../../webgl/enums ../../../../chunks/builtins ../../../webgl/renderState ../../../webgl/Texture ../../../webgl/VertexArrayObject".split(" "),function(A,F,E,C,B,x,m,p,h,b){return function(){function e(q,n){this.rctx=q;this._vertexBuffer=A.createVertex(q,
35044,new Uint16Array(n));this._vao=new b(q,new Map([["a_position",0]]),{geometry:[{name:"a_position",count:2,type:5122,offset:0,stride:4,normalized:!1}]},{geometry:this._vertexBuffer});this._count=n.length/2}var c=e.prototype;c.bind=function(){this._vao.bind()};c.unbind=function(){this._vao.unbind()};c.dispose=function(){this._vao.dispose(!1);this._vertexBuffer.dispose()};c.draw=function(){this.rctx.bindVAO(this._vao);this.rctx.drawArrays(5,0,this._count)};return e}()})},"esri/views/2d/engine/webgl/brushes/WGLBrush":function(){define(function(){return function(){function A(){this.name=
this.constructor.name||"UnnamedBrush"}var F=A.prototype;F.prepareState=function(E,C,B){};F.draw=function(E,C,B){};F.drawMany=function(E,C,B){for(const x of C)this.draw(E,x,B)};return A}()})},"esri/views/2d/engine/webgl/brushes/BrushClip":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../chunks/vec4f32 ../Utils ./WGLBrush ../shaders/BackgroundPrograms ../../../../webgl/programUtils".split(" "),function(A,F,E,C,B,x,m){return function(p){function h(){var e=
p.apply(this,arguments)||this;e._color=E.fromValues(0,1,0,1);return e}A._inheritsLoose(h,p);var b=h.prototype;b.dispose=function(){this._program&&this._program.dispose()};b.prepareState=function({context:e}){e.setStencilTestEnabled(!0);e.setBlendingEnabled(!1);e.setFaceCullingEnabled(!1);e.setColorMask(!1,!1,!1,!1);e.setStencilOp(7680,7680,7681);e.setStencilWriteMask(255);e.setStencilFunction(519,0,255)};b.draw=function(e,c){const {context:q,state:n}=e;e=C.createProgramDescriptor("clip",{geometry:[{location:0,
name:"a_pos",count:2,type:5122}]});c=c.getVAO(q,n,e.attributes,e.bufferLayouts);F.isNone(c.indexBuffer)||(this._program||(this._program=m.createProgram(q,x.background)),q.useProgram(this._program),this._program.setUniform2fv("u_coord_range",[1,1]),this._program.setUniform4fv("u_color",this._color),this._program.setUniformMatrix3fv("u_dvsMat3",n.displayMat3),q.bindVAO(c),q.drawElements(4,c.indexBuffer.size,5125,0),q.bindVAO())};return h}(B)})},"esri/chunks/vec4f32":function(){define(["exports"],function(A){function F(){return new Float32Array(4)}
function E(l){const g=new Float32Array(4);g[0]=l[0];g[1]=l[1];g[2]=l[2];g[3]=l[3];return g}function C(l,g,t,r){const w=new Float32Array(4);w[0]=l;w[1]=g;w[2]=t;w[3]=r;return w}function B(l,g){return new Float32Array(l,g,4)}function x(){return F()}function m(){return C(1,1,1,1)}function p(){return C(1,0,0,0)}function h(){return C(0,1,0,0)}function b(){return C(0,0,1,0)}function e(){return C(0,0,0,1)}const c=F(),q=m(),n=p(),a=h(),f=b(),d=e();var k=Object.freeze({__proto__:null,create:F,clone:E,fromValues:C,
createView:B,zeros:x,ones:m,unitX:p,unitY:h,unitZ:b,unitW:e,ZEROS:c,ONES:q,UNIT_X:n,UNIT_Y:a,UNIT_Z:f,UNIT_W:d});A.ONES=q;A.UNIT_W=d;A.UNIT_X=n;A.UNIT_Y=a;A.UNIT_Z=f;A.ZEROS=c;A.clone=E;A.create=F;A.createView=B;A.fromValues=C;A.ones=m;A.unitW=e;A.unitX=p;A.unitY=h;A.unitZ=b;A.vec4f32=k;A.zeros=x})},"esri/views/2d/engine/webgl/Utils":function(){define("exports ../../../../core/Error ../../../../core/Logger ../../../../core/mathUtils ../../../../core/screenUtils ./color ./enums ./SymbolProperties ../../../webgl/Texture".split(" "),
function(A,F,E,C,B,x,m,p,h){function b(L){const M={};for(const N of L)M[N.name]=N.strideInBytes;return M}function e(L){switch(L){case m.WGLGeometryType.MARKER:return y;case m.WGLGeometryType.FILL:return D;case m.WGLGeometryType.LINE:return G;case m.WGLGeometryType.TEXT:return H;case m.WGLGeometryType.LABEL:return J}}function c(L){switch(L%4){case 0:case 2:return 4;case 1:case 3:return 1}}function q(L){switch(L){case 5120:case 5121:return 1;case 5122:case 5123:return 2;case 5126:case 5124:case 5125:return 4}}
function n(L){const M={};for(const N in L){let P=0;M[N]=L[N].map(I=>{const O={...I,normalized:I.normalized||!1,divisor:I.divisor||0,offset:P,stride:0};P+=I.count*q(I.type);return O});M[N].forEach(I=>I.stride=P)}return M}const a=E.getLogger("esri.views.2d.engine.webgl.Utils");E=[{name:"geometry",strideInBytes:36,divisor:0}];const f=[{name:"geometry",strideInBytes:36,divisor:0}],d=[{name:"geometry",strideInBytes:12,divisor:0}],k=[{name:"geometry",strideInBytes:40,divisor:0}],l=[{name:"geometry",strideInBytes:36,
divisor:0}],g=[{name:"geometry",strideInBytes:36,divisor:0}],t=b(E),r=b(f),w=b(d),v=b(k),z=b(l),u=b(g),y=["geometry"],D=["geometry"],G=["geometry"],H=["geometry"],J=["geometry"],K=new Map;A.C_FILL_STRIDE_SPEC=r;A.C_FILL_STRIDE_SPEC_DD=w;A.C_FILL_VERTEX_DEF=f;A.C_FILL_VERTEX_DEF_DD=d;A.C_ICON_STRIDE_SPEC=t;A.C_ICON_VERTEX_DEF=E;A.C_LABEL_STRIDE_SPEC=u;A.C_LABEL_VERTEX_DEF=g;A.C_LINE_STRIDE_SPEC=v;A.C_LINE_VERTEX_DEF=k;A.C_TEXT_STRIDE_SPEC=z;A.C_TEXT_VERTEX_DEF=l;A.C_VBO_GEOMETRY="geometry";A.C_VBO_INFO=
{["geometry"]:35044};A.C_VBO_PERINSTANCE="per_instance";A.C_VBO_PERINSTANCE_VV="per_instance_vv";A.allocateTypedArrayBuffer=function(L,M){switch(M%4){case 0:case 2:return new Uint32Array(Math.floor(L*M/4));case 1:case 3:return new Uint8Array(L*M)}};A.allocateTypedArrayBufferwithData=function(L,M){switch(M%4){case 0:case 2:return new Uint32Array(L);case 1:case 3:return new Uint8Array(L)}};A.copyMeshData=function(L,M,N,P,I,O,Q){for(const aa in O){var T=O[aa].stride,V=c(T);const Z=O[aa].data,R=N[aa].data,
S=T*I.vertexCount/V,U=T*L/V;T=T*I.vertexFrom/V;for(V=0;V<S;++V)R[V+U]=Z[V+T]}N=I.indexCount;for(O=0;O<N;++O)P[O+M]=Q[O+I.indexFrom]-I.vertexFrom+L};A.createGeometryData=function(L,M){const N=[];for(let P=0;5>P;++P){const I=e(P),O={};for(const Q of I)O[Q]={data:M(P,Q)};N.push({data:L(P),buffers:O})}return N};A.createProgramDescriptor=(L,M)=>{if(!K.has(L)){const I=n(M);var N=I;var P={};for(const O in N){const Q=N[O];P[O]=Q.length?Q[0].stride:0}N=P;P=new Map;for(const O in M)for(const Q of M[O])P.set(Q.name,
Q.location);M=P;K.set(L,{strides:N,bufferLayouts:I,attributes:M})}return K.get(L)};A.createTextureFromTexelData=function(L,M){let N,P;C.isPowerOfTwo(M.width)&&C.isPowerOfTwo(M.height)?(N=!0,P=9987):(N=!1,P=9729);return new h(L,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,hasMipmap:N,samplingMode:P,wrapMode:33071,flipped:!0},M)};A.forEachGeometryType=function(L){L(m.WGLGeometryType.FILL);L(m.WGLGeometryType.LINE);L(m.WGLGeometryType.MARKER);L(m.WGLGeometryType.TEXT);L(m.WGLGeometryType.LABEL)};
A.geometryToMappedGeometry=function(L){return{vertexFrom:void 0,vertexTo:void 0,geometry:L}};A.getBytes=q;A.getCapType=function(L){switch(L){case "butt":return 0;case "round":return 1;case "square":return 2;default:return a.error(new F("mapview-invalid-type",`Cap type ${L} is not a valid option. Defaulting to round`)),1}};A.getJoinType=function(L){switch(L){case "miter":return 2;case "bevel":return 0;case "round":return 1;default:return a.error(new F("mapview-invalid-type",`Join type ${L} is not a valid option. Defaulting to round`)),
1}};A.getNamedBuffers=e;A.getPixelArrayCtor=function(L){switch(L){case 5121:return Uint8Array;case 32819:return Uint16Array;case 5126:return Float32Array;default:a.error(new F("webgl-utils",`Unable to handle type ${L}`))}};A.getPixelBytes=function(L){switch(L){case 5121:return 1;case 32819:return 2;case 5126:return 4;default:a.error(new F("webgl-utils",`Unable to handle type ${L}`))}};A.getStrides=function(L,M){switch(L){case m.WGLGeometryType.MARKER:return t;case m.WGLGeometryType.FILL:return M?
w:r;case m.WGLGeometryType.LINE:return v;case m.WGLGeometryType.TEXT:return z;case m.WGLGeometryType.LABEL:return u}};A.getTextProperties=function(L){return p.TextProperties.pool.acquire(L.color?x.copyAndPremultiply(L.color):[255,255,255,255],L.haloColor?x.copyAndPremultiply(L.haloColor):[255,255,255,255],B.pt2px(L.haloSize),B.pt2px(L.font.size),L.angle*Math.PI/180,L.xoffset/L.font.size,L.yoffset/L.font.size,"left"===L.horizontalAlignment?0:"right"===L.horizontalAlignment?1:.5,"top"===L.verticalAlignment?
0:"bottom"===L.verticalAlignment?1:.5)};A.getTransformParams=function(L){const {transform:M,hasZ:N,hasM:P}=L;return{transform:M,hasZ:N,hasM:P}};A.getVVType=function(L){switch(L){case "opacity":return m.VVType.OPACITY;case "color":return m.VVType.COLOR;case "rotation":return m.VVType.ROTATION;case "size":return m.VVType.SIZE;default:return a.error(`Cannot interpret unknown vv: ${L}`),null}};A.isDefined=function(L){return null!=L};A.isNumber=function(L){return"number"===typeof L};A.strideToPackingFactor=
c;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/color":function(){define(["exports","./number"],function(A,F){function E(x,m){Array.isArray(m)?(x[0]=m[0],x[1]=m[1],x[2]=m[2],x[3]=m[3]):(x[0]=m.r,x[1]=m.g,x[2]=m.b,x[3]=m.a);return x}function C(x,m=0,p=!1){const h=x[m+3];x[m+0]*=h;x[m+1]*=h;x[m+2]*=h;p||(x[m+3]*=255);return x}const B=[0,0,0,0];A.copyAndPremultiply=function(x){return C(E([],x))};A.premultiplyAlpha=C;A.premultiplyAlphaRGBA=function(x){if(!x)return 0;
const {r:m,g:p,b:h,a:b}=x;return F.i8888to32(m*b,p*b,h*b,255*b)};A.premultiplyAlphaRGBAArray=function(x){if(!x)return 0;const [m,p,h,b]=x;return F.i8888to32(b/255*m,b/255*p,b/255*h,b)};A.premultiplyAlphaUint32=function(x){C(E(B,x));return F.i8888to32(B[0],B[1],B[2],B[3])};A.white=[255,255,255,1];Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/number":function(){define(["exports"],function(A){function F(B,x,m){return Math.round(Math.max(Math.min(B,m),x))}const E=new Float32Array(1),
C=new Uint32Array(E.buffer);A.i16=function(B){return F(B,-32768,32767)};A.i1616to32=function(B,x){return 65535&B|x<<16};A.i32=function(B){return F(B,-2147483648,2147483647)};A.i8=function(B){return F(B,-128,127)};A.i8816to32=function(B,x,m){return B&255|(x&255)<<8|m<<16};A.i8888to32=function(B,x,m,p){return B&255|(x&255)<<8|(m&255)<<16|p<<24};A.numTo32=function(B){return B|0};A.toFloat32=function(B){C[0]=B;return E[0]};A.toUint32=function(B){E[0]=B;return C[0]};A.u16=function(B){return F(B,0,65535)};
A.u32=function(B){return F(B,0,4294967295)};A.u32to4Xu8=function(B){return[B&255,(B&65280)>>>8,(B&16711680)>>>16,(B&4278190080)>>>24]};A.u8=function(B){return F(B,0,255)};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/SymbolProperties":function(){define(["exports","../../../../core/ObjectPool"],function(A,F){let E=function(){function C(){this.color=[0,0,0,0];this.haloColor=[0,0,0,0];this.haloSize=0;this.size=12;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=
0}var B=C.prototype;B.acquire=function(x,m,p,h,b,e,c,q,n){this.color=x;this.haloColor=m;this.haloSize=p;this.size=h;this.angle=b;this.offsetX=e;this.offsetY=c;this.hAnchor=q;this.vAnchor=n};B.release=function(){this.color[0]=this.color[1]=this.color[2]=this.color[3]=0;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=this.size=this.haloSize=this.haloColor[0]=this.haloColor[1]=this.haloColor[2]=this.haloColor[3]=0};return C}();E.pool=new F(E);A.TextProperties=E;Object.defineProperty(A,
"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/shaders/BackgroundPrograms":function(){define(["exports","./sources/resolver"],function(A,F){F={shaders:{vertexShader:F.resolveIncludes("background/background.vert"),fragmentShader:F.resolveIncludes("background/background.frag")},attributes:new Map([["a_pos",0]])};A.background=F;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/shaders/sources/resolver":function(){define("exports ../../../../../webgl/BufferObject ../../../../../webgl/FramebufferObject ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/has ../../../../../webgl/checkWebGLError ../../../../../webgl/enums ../../../../../../chunks/builtins ../../../../../webgl/renderState ../../../../../webgl/Texture ../../../../../webgl/ShaderCompiler ../../../../../webgl/VertexArrayObject ./shaderRepository".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c,q){const n=new e(function(a){let f=q;a.split("/").forEach(d=>{f&&(f=f[d])});return f});A.resolveIncludes=function(a){return n.resolveIncludes(a)};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/shaders/sources/shaderRepository":function(){define(function(){return{background:{"background.frag":"uniform lowp vec4 u_color;\nvoid main() {\ngl_FragColor \x3d u_color;\n}","background.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump vec2 u_coord_range;\nuniform mediump float u_depth;\nvoid main() {\nvec3 v_pos \x3d u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0);\ngl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\n}"},
bitBlit:{"bitBlit.frag":"uniform lowp sampler2D u_tex;\nuniform lowp float u_opacity;\nvarying mediump vec2 v_uv;\nvoid main() {\nlowp vec4 color \x3d texture2D(u_tex, v_uv);\ngl_FragColor \x3d color *  u_opacity;\n}","bitBlit.vert":"attribute vec2 a_pos;\nattribute vec2 a_tex;\nvarying mediump vec2 v_uv;\nvoid main(void) {\ngl_Position \x3d vec4(a_pos, 0.0, 1.0);\nv_uv \x3d a_tex;\n}"},blend:{"blend.frag":"precision mediump float;\nuniform sampler2D u_layerTexture;\nuniform lowp float u_opacity;\nuniform lowp float u_inFadeOpacity;\n#ifndef NORMAL\nuniform sampler2D u_backbufferTexture;\n#endif\nvarying mediump vec2 v_uv;\nfloat rgb2v(in vec3 c) {\nreturn max(c.x, max(c.y, c.z));\n}\nvec3 rgb2hsv(in vec3 c) {\nvec4 K \x3d vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\nvec4 p \x3d c.g \x3c c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\nvec4 q \x3d c.r \x3c p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\nfloat d \x3d q.x - min(q.w, q.y);\nfloat e \x3d 1.0e-10;\nreturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n}\nvec3 hsv2rgb(in vec3 c) {\nvec4 K \x3d vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\nvec3 p \x3d abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\nreturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\nvec3 tint(in vec3 Cb, in vec3 Cs) {\nfloat vIn \x3d rgb2v(Cb);\nvec3 hsvTint \x3d rgb2hsv(Cs);\nvec3 hsvOut \x3d vec3(hsvTint.x, hsvTint.y, vIn * hsvTint.z);\nreturn hsv2rgb(hsvOut);\n}\nfloat overlay(in float Cb, in float Cs) {\nreturn (1.0 - step(0.5, Cs)) * (1.0 - 2.0 * (1.0 - Cs ) * (1.0 - Cb)) + step(0.5, Cs) * (2.0 * Cs * Cb);\n}\nfloat colorDodge(in float Cb, in float Cs) {\nreturn (Cb \x3d\x3d 0.0) ? 0.0 : (Cs \x3d\x3d 1.0) ? 1.0 : min(1.0, Cb / (1.0 - Cs));\n}\nfloat colorBurn(in float Cb, in float Cs) {\nreturn (Cb \x3d\x3d 1.0) ? 1.0 : (Cs \x3d\x3d 0.0) ? 0.0 : 1.0 - min(1.0, (1.0 - Cb) / Cs);\n}\nfloat hardLight(in float Cb, in float Cs) {\nreturn (1.0 - step(0.5, Cs)) * (2.0 * Cs * Cb) + step(0.5, Cs) * (1.0 - 2.0 * (1.0 - Cs) * (1.0 - Cb));\n}\nfloat reflectBlend(in float Cb, in float Cs) {\nreturn (Cs \x3d\x3d 1.0) ? Cs : min(Cb * Cb / (1.0 - Cs), 1.0);\n}\nfloat softLight(in float Cb, in float Cs) {\nif (Cs \x3c\x3d 0.5) {\nreturn Cb - (1.0 - 2.0 * Cs) * Cb * (1.0 - Cb);\n}\nif (Cb \x3c\x3d 0.25) {\nreturn Cb + (2.0 * Cs - 1.0) * Cb * ((16.0 * Cb - 12.0) * Cb + 3.0);\n}\nreturn Cb + (2.0 * Cs - 1.0) * (sqrt(Cb) - Cb);\n}\nfloat vividLight(in float Cb, in float Cs) {\nreturn (1.0 - step(0.5, Cs)) * colorBurn(Cb, 2.0 * Cs) + step(0.5, Cs) * colorDodge(Cb, (2.0 * (Cs - 0.5)));\n}\nfloat minv3(in vec3 c) {\nreturn min(min(c.r, c.g), c.b);\n}\nfloat maxv3(in vec3 c) {\nreturn max(max(c.r, c.g), c.b);\n}\nfloat lumv3(in vec3 c) {\nreturn dot(c, vec3(0.3, 0.59, 0.11));\n}\nfloat satv3(vec3 c) {\nreturn maxv3(c) - minv3(c);\n}\nvec3 clipColor(vec3 color) {\nfloat lum \x3d lumv3(color);\nfloat mincol \x3d minv3(color);\nfloat maxcol \x3d maxv3(color);\nif (mincol \x3c 0.0) {\ncolor \x3d lum + ((color - lum) * lum) / (lum - mincol);\n}\nif (maxcol \x3e 1.0) {\ncolor \x3d lum + ((color - lum) * (1.0 - lum)) / (maxcol - lum);\n}\nreturn color;\n}\nvec3 setLum(vec3 cbase, vec3 clum) {\nfloat lbase \x3d lumv3(cbase);\nfloat llum \x3d lumv3(clum);\nfloat ldiff \x3d llum - lbase;\nvec3 color \x3d cbase + vec3(ldiff);\nreturn clipColor(color);\n}\nvec3 setLumSat(vec3 cbase, vec3 csat, vec3 clum)\n{\nfloat minbase \x3d minv3(cbase);\nfloat sbase \x3d satv3(cbase);\nfloat ssat \x3d satv3(csat);\nvec3 color;\nif (sbase \x3e 0.0) {\ncolor \x3d (cbase - minbase) * ssat / sbase;\n} else {\ncolor \x3d vec3(0.0);\n}\nreturn setLum(color, clum);\n}\nvoid main() {\nvec4 src \x3d texture2D(u_layerTexture, v_uv);\n#ifdef NORMAL\ngl_FragColor \x3d src *  u_opacity;\n#else\nvec4 dst \x3d texture2D(u_backbufferTexture, v_uv);\nvec3 Cs \x3d src.a \x3d\x3d 0.0 ? src.rgb : vec3(src.rgb / src.a);\nvec3 Cb \x3d dst.a \x3d\x3d 0.0 ? dst.rgb : vec3(dst.rgb / dst.a);\nfloat as \x3d u_opacity * src.a;\nfloat ab \x3d dst.a;\n#ifdef DESTINATION_OVER\ngl_FragColor \x3d vec4(as * Cs * (1.0 - ab) + ab * Cb, as + ab - as * ab);\n#endif\n#ifdef SOURCE_IN\nvec4 color \x3d vec4(as * Cs * ab, as * ab);\nvec4 fadeColor \x3d (1.0 - u_opacity) * u_inFadeOpacity * vec4(ab * Cb, ab);\ngl_FragColor \x3d color + fadeColor;\n#endif\n#ifdef DESTINATION_IN\nvec4 color \x3d vec4(ab * Cb * as, ab * as);\nvec4 fadeColor \x3d (1.0 - u_opacity) * u_inFadeOpacity * vec4(ab * Cb, ab);\ngl_FragColor \x3d color + fadeColor;\n#endif\n#ifdef SOURCE_OUT\ngl_FragColor \x3d vec4(as * Cs * (1.0 - ab), as * (1.0 - ab));\n#endif\n#ifdef DESTINATION_OUT\ngl_FragColor \x3d vec4(ab * Cb * (1.0 - as), ab * (1.0 - as));\n#endif\n#ifdef SOURCE_ATOP\ngl_FragColor \x3d vec4(as * Cs * ab + ab * Cb * (1.0 - as), ab);\n#endif\n#ifdef DESTINATION_ATOP\ngl_FragColor \x3d vec4(as * Cs * (1.0 - ab) + ab * Cb * as, as);\n#endif\n#ifdef XOR\ngl_FragColor \x3d vec4(as * Cs * (1.0 - ab) + ab * Cb * (1.0 - as),\nas * (1.0 - ab) + ab * (1.0 - as));\n#endif\n#ifdef MULTIPLY\ngl_FragColor \x3d vec4(as * Cs * ab * Cb + (1.0 - ab) * as * Cs + (1.0 - as) * ab * Cb,\nas + ab * (1.0 - as));\n#endif\n#ifdef SCREEN\ngl_FragColor \x3d vec4((Cs + Cb - Cs * Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef OVERLAY\nvec3 f \x3d vec3(overlay(Cb.r, Cs.r), overlay(Cb.g, Cs.g), overlay(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef DARKEN\ngl_FragColor \x3d vec4(min(Cs, Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef LIGHTER\ngl_FragColor \x3d vec4(as * Cs + ab * Cb, as + ab);\n#endif\n#ifdef LIGHTEN\ngl_FragColor \x3d vec4(max(Cs, Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef COLOR_DODGE\nvec3 f \x3d vec3(colorDodge(Cb.r, Cs.r), colorDodge(Cb.g, Cs.g), colorDodge(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef COLOR_BURN\nvec3 f \x3d vec3(colorBurn(Cb.r, Cs.r), colorBurn(Cb.g, Cs.g), colorBurn(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef HARD_LIGHT\nvec3 f \x3d vec3(hardLight(Cb.r, Cs.r), hardLight(Cb.g, Cs.g), hardLight(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef SOFT_LIGHT\nvec3 f \x3d vec3(softLight(Cb.r, Cs.r), softLight(Cb.g, Cs.g), softLight(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef DIFFERENCE\ngl_FragColor \x3d vec4(abs(Cb - Cs) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef EXCLUSION\nvec3 f \x3d Cs + Cb - 2.0 * Cs * Cb;\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef INVERT\ngl_FragColor \x3d vec4((1.0 - Cb) * as * ab + Cb * ab * (1.0 - as), ab);\n#endif\n#ifdef VIVID_LIGHT\nvec3 f \x3d vec3(vividLight(Cb.r, Cs.r),\nvividLight(Cb.g, Cs.g),\nvividLight(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef HUE\nvec3 f \x3d setLumSat(Cs,Cb,Cb);\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef SATURATION\nvec3 f \x3d setLumSat(Cb,Cs,Cb);\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef COLOR\nvec3 f \x3d setLum(Cs,Cb);\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef LUMINOSITY\nvec3 f \x3d setLum(Cb,Cs);\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef PLUS\ngl_FragColor \x3d clamp(vec4(src.r + Cb.r, src.g + Cb.g, src.b + Cb.b, as + ab), 0.0, 1.0);\n#endif\n#ifdef MINUS\ngl_FragColor \x3d vec4(clamp(vec3(Cb.r - src.r, Cb.g - src.g, Cb.b - src.b), 0.0, 1.0), ab * as);\n#endif\n#ifdef AVERAGE\nvec3 f \x3d (Cb + Cs) / 2.0;\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef REFLECT\nvec3 f \x3d vec3(reflectBlend(Cb.r, Cs.r),\nreflectBlend(Cb.g, Cs.g),\nreflectBlend(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#endif\n}",
"blend.vert":"attribute vec2 a_position;\nvarying mediump vec2 v_uv;\nvoid main(void) {\ngl_Position \x3d vec4(a_position , 0.0, 1.0);\nv_uv \x3d (a_position + 1.0) / 2.0;\n}"},filtering:{"bicubic.glsl":"vec4 computeWeights(float v) {\nfloat b \x3d 1.0 / 6.0;\nfloat v2 \x3d v * v;\nfloat v3 \x3d v2 * v;\nfloat w0 \x3d b * (-v3 + 3.0 * v2 - 3.0 * v + 1.0);\nfloat w1 \x3d b * (3.0 * v3  - 6.0 * v2 + 4.0);\nfloat w2 \x3d b * (-3.0 * v3 + 3.0 * v2 + 3.0 * v + 1.0);\nfloat w3 \x3d b * v3;\nreturn vec4(w0, w1, w2, w3);\n}\nvec4 bicubicOffsetsAndWeights(float v) {\nvec4 w \x3d computeWeights(v);\nfloat g0 \x3d w.x + w.y;\nfloat g1 \x3d w.z + w.w;\nfloat h0 \x3d 1.0 - (w.y / g0) + v;\nfloat h1 \x3d 1.0 + (w.w / g1) - v;\nreturn vec4(h0, h1, g0, g1);\n}\nvec4 sampleBicubicBSpline(sampler2D sampler, vec2 coords, vec2 texSize) {\nvec2 eX \x3d vec2(1.0 / texSize.x, 0.0);\nvec2 eY \x3d vec2(0.0, 1.0 / texSize.y);\nvec2 texel \x3d coords * texSize - 0.5;\nvec3 hgX \x3d bicubicOffsetsAndWeights(fract(texel).x).xyz;\nvec3 hgY \x3d bicubicOffsetsAndWeights(fract(texel).y).xyz;\nvec2 coords10 \x3d coords + hgX.x * eX;\nvec2 coords00 \x3d coords - hgX.y * eX;\nvec2 coords11 \x3d coords10 + hgY.x * eY;\nvec2 coords01 \x3d coords00 + hgY.x * eY;\ncoords10 \x3d coords10 - hgY.y * eY;\ncoords00 \x3d coords00 - hgY.y * eY;\nvec4 color00 \x3d texture2D(sampler, coords00);\nvec4 color10 \x3d texture2D(sampler, coords10);\nvec4 color01 \x3d texture2D(sampler, coords01);\nvec4 color11 \x3d texture2D(sampler, coords11);\ncolor00 \x3d mix(color00, color01, hgY.z);\ncolor10 \x3d mix(color10, color11, hgY.z);\ncolor00 \x3d mix(color00, color10, hgX.z);\nreturn color00;\n}",
"bilinear.glsl":"vec4 sampleBilinear(sampler2D sampler, vec2 coords, vec2 texSize) {\nvec2 texelStart \x3d floor(coords * texSize);\nvec2 coord0 \x3d texelStart / texSize;\nvec2 coord1 \x3d (texelStart +  vec2(1.0, 0.0)) / texSize;\nvec2 coord2 \x3d (texelStart +  vec2(0.0, 1.0)) / texSize;\nvec2 coord3 \x3d (texelStart +  vec2(1.0, 1.0)) / texSize;\nvec4 color0 \x3d texture2D(sampler, coord0);\nvec4 color1 \x3d texture2D(sampler, coord1);\nvec4 color2 \x3d texture2D(sampler, coord2);\nvec4 color3 \x3d texture2D(sampler, coord3);\nvec2 blend \x3d fract(coords * texSize);\nvec4 color01 \x3d mix(color0, color1, blend.x);\nvec4 color23 \x3d mix(color2, color3, blend.x);\nvec4 color \x3d mix(color01, color23, blend.y);\n#ifdef NNEDGE\nfloat alpha \x3d floor(color0.a * color1.a * color2.a * color3.a + 0.5);\ncolor \x3d color * alpha + (1.0 - alpha) * texture2D(sampler, coords);\n#endif\nreturn color;\n}",
"epx.glsl":"vec4 sampleEPX(sampler2D sampler, float size, vec2 coords, vec2 texSize) {\nvec2 invSize \x3d 1.0 / texSize;\nvec2 texel \x3d coords * texSize;\nvec2 texel_i \x3d floor(texel);\nvec2 texel_frac \x3d fract(texel);\nvec4 colorP \x3d texture2D(sampler, texel_i * invSize);\nvec4 colorP1 \x3d vec4(colorP);\nvec4 colorP2 \x3d vec4(colorP);\nvec4 colorP3 \x3d vec4(colorP);\nvec4 colorP4 \x3d vec4(colorP);\nvec4 colorA \x3d texture2D(sampler, (texel_i - vec2(0.0, 1.0)) * invSize);\nvec4 colorB \x3d texture2D(sampler, (texel_i + vec2(1.0, 0.0)) * invSize);\nvec4 colorC \x3d texture2D(sampler, (texel_i - vec2(1.0, 0.0)) * invSize);\nvec4 colorD \x3d texture2D(sampler, (texel_i + vec2(0.0, 1.0)) * invSize);\nif (colorC \x3d\x3d colorA \x26\x26 colorC !\x3d colorD \x26\x26 colorA !\x3d colorB) {\ncolorP1 \x3d colorA;\n}\nif (colorA \x3d\x3d colorB \x26\x26 colorA !\x3d colorC \x26\x26 colorB !\x3d colorD) {\ncolorP2 \x3d colorB;\n}\nif (colorD \x3d\x3d colorC \x26\x26 colorD !\x3d colorB \x26\x26 colorC !\x3d colorA) {\ncolorP3 \x3d colorC;\n}\nif (colorB \x3d\x3d colorD \x26\x26 colorB !\x3d colorA \x26\x26 colorD !\x3d colorC) {\ncolorP4 \x3d colorD;\n}\nvec4 colorP12 \x3d mix(colorP1, colorP2, texel_frac.x);\nvec4 colorP34 \x3d mix(colorP1, colorP2, texel_frac.x);\nreturn mix(colorP12, colorP34, texel_frac.y);\n}"},
fx:{integrate:{"integrate.frag":"precision mediump float;\nuniform lowp sampler2D u_sourceTexture;\nuniform lowp sampler2D u_maskTexture;\nuniform mediump float u_zoomLevel;\nuniform highp float u_timeDelta;\nuniform highp float u_animationTime;\nvarying highp vec2 v_texcoord;\n#include \x3cmaterials/utils.glsl\x3e\nvoid main()\n{\n#ifdef DELTA\nvec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\nvec4 data0 \x3d texture2D(u_maskTexture, v_texcoord);\nfloat flags \x3d data0.r * 255.0;\nfloat groupMinZoom \x3d data0.g * 255.0;\nfloat isVisible \x3d getFilterBit(flags, 0);\nfloat wouldClip \x3d step(groupMinZoom, u_zoomLevel);\nfloat direction \x3d wouldClip * 1.0 + (1.0 - wouldClip) * -1.0;\nfloat dt \x3d u_timeDelta / max(u_animationTime, 0.0001);\nvec4 nextState \x3d vec4(texel + direction * dt);\ngl_FragColor \x3d  vec4(nextState);\n#elif defined(UPDATE)\nvec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\ngl_FragColor \x3d texel;\n#endif\n}",
"integrate.vert":"precision mediump float;\nattribute vec2 a_pos;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos;\ngl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}"}},highlight:{"blur.frag":"varying mediump vec2 v_texcoord;\nuniform mediump vec4 u_direction;\nuniform mediump mat4 u_channelSelector;\nuniform mediump float u_sigma;\nuniform sampler2D u_texture;\nmediump float gauss1(mediump vec2 dir) {\nreturn exp(-dot(dir, dir) / (2.0 * u_sigma * u_sigma));\n}\nmediump vec4 selectChannel(mediump vec4 sample) {\nreturn u_channelSelector * sample;\n}\nvoid accumGauss1(mediump float i, inout mediump float tot, inout mediump float weight) {\nmediump float w \x3d gauss1(i * u_direction.xy);\ntot +\x3d selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw))[3] * w;\nweight +\x3d w;\n}\nvoid main(void) {\nmediump float tot \x3d 0.0;\nmediump float weight \x3d 0.0;\naccumGauss1(-5.0, tot, weight);\naccumGauss1(-4.0, tot, weight);\naccumGauss1(-3.0, tot, weight);\naccumGauss1(-2.0, tot, weight);\naccumGauss1(-1.0, tot, weight);\naccumGauss1(0.0, tot, weight);\naccumGauss1(1.0, tot, weight);\naccumGauss1(2.0, tot, weight);\naccumGauss1(3.0, tot, weight);\naccumGauss1(4.0, tot, weight);\naccumGauss1(5.0, tot, weight);\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, tot / weight);\n}",
"highlight.frag":"varying mediump vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform mediump float u_sigma;\nuniform sampler2D u_shade;\nuniform mediump vec2 u_minMaxDistance;\nmediump float estimateDistance() {\nmediump float y \x3d texture2D(u_texture, v_texcoord)[3];\nconst mediump float y0 \x3d 0.5;\nmediump float m0 \x3d 1.0 / (sqrt(2.0 * 3.1415) * u_sigma);\nmediump float d \x3d (y - y0) / m0;\nreturn d;\n}\nmediump vec4 shade(mediump float d) {\nmediump float mappedDistance \x3d (d - u_minMaxDistance.x) / (u_minMaxDistance.y - u_minMaxDistance.x);\nmappedDistance \x3d clamp(mappedDistance, 0.0, 1.0);\nreturn texture2D(u_shade, vec2(mappedDistance, 0.5));\n}\nvoid main(void) {\nmediump float d \x3d estimateDistance();\ngl_FragColor \x3d shade(d);\n}",
"textured.vert":"attribute mediump vec2 a_position;\nattribute mediump vec2 a_texcoord;\nvarying mediump vec2 v_texcoord;\nvoid main(void) {\ngl_Position \x3d vec4(a_position, 0.0, 1.0);\nv_texcoord \x3d a_texcoord;\n}"},magnifier:{"magnifier.frag":"uniform lowp vec4 u_background;\nuniform mediump sampler2D u_readbackTexture;\nuniform mediump sampler2D u_maskTexture;\nuniform mediump sampler2D u_overlayTexture;\nuniform bool u_maskEnabled;\nuniform bool u_overlayEnabled;\nvarying mediump vec2 v_texCoord;\nconst lowp float barrelFactor \x3d 1.1;\nlowp vec2 barrel(lowp vec2 uv) {\nlowp vec2 uvn \x3d uv * 2.0 - 1.0;\nif (uvn.x \x3d\x3d 0.0 \x26\x26 uvn.y \x3d\x3d 0.0) {\nreturn vec2(0.5, 0.5);\n}\nlowp float theta \x3d atan(uvn.y, uvn.x);\nlowp float r \x3d pow(length(uvn), barrelFactor);\nreturn r * vec2(cos(theta), sin(theta)) * 0.5 + 0.5;\n}\nvoid main(void)\n{\nlowp vec4 color \x3d texture2D(u_readbackTexture, barrel(v_texCoord));\ncolor \x3d (color + (1.0 - color.a) * u_background);\nlowp float mask \x3d u_maskEnabled ? texture2D(u_maskTexture, v_texCoord).a : 1.0;\ncolor *\x3d mask;\nlowp vec4 overlayColor \x3d u_overlayEnabled ? texture2D(u_overlayTexture, v_texCoord) : vec4(0);\ngl_FragColor \x3d overlayColor + (1.0 - overlayColor.a) * color;\n}",
"magnifier.vert":"precision mediump float;\nattribute mediump vec2 a_pos;\nuniform mediump vec4 u_drawPos;\nvarying mediump vec2 v_texCoord;\nvoid main(void)\n{\nv_texCoord \x3d a_pos;\ngl_Position \x3d vec4(u_drawPos.xy + vec2(a_pos - 0.5) * u_drawPos.zw, 0.0, 1.0);\n}"},materials:{"attributeData.glsl":"uniform highp sampler2D u_attributeData0;\nuniform highp sampler2D u_attributeData1;\nuniform highp sampler2D u_attributeData2;\nuniform highp sampler2D u_attributeData3;\nuniform highp int u_attributeTextureSize;\nhighp vec2 getAttributeDataCoords(in highp vec4 id) {\nhighp vec4 texel \x3d unpackDisplayIdTexel(id);\nhighp float size \x3d float(u_attributeTextureSize);\nhighp float u32 \x3d float(int(texel.r) + int(texel.g) * 256 + int(texel.b) * 256 * 256 + int(texel.a) * 256 * 256 * 256);\nhighp float col \x3d mod(u32, size);\nhighp float row \x3d (u32 - col) / size;\nhighp float u \x3d col / size;\nhighp float v \x3d row / size;\nreturn vec2(u, v);\n}\nhighp vec4 getAttributeData0(in highp vec4 id) {\nvec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData0, coords);\n}\nhighp vec4 getAttributeData1(in highp vec4 id) {\nhighp vec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData1, coords);\n}\nhighp vec4 getAttributeData2(in highp vec4 id) {\nhighp vec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData2, coords);\n}\nhighp vec4 getAttributeData3(in highp vec4 id) {\nhighp vec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData3, coords);\n}\nfloat u88VVToFloat(in vec2 v) {\nbool isMagic \x3d v.x \x3d\x3d 255.0 \x26\x26 v.y \x3d\x3d 255.0;\nif (isMagic) {\nreturn NAN_MAGIC_NUMBER;\n}\nreturn (v.x + v.y * float(0x100)) - 32768.0;\n}",
"constants.glsl":"const float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float C_256_TO_RAD \x3d 3.14159265359 / 128.0;\nconst float SIGNED_BYTE_TO_UNSIGNED \x3d 128.0;\nconst float POSITION_PRECISION \x3d 1.0 / 8.0;\nconst float FILL_POSITION_PRECISION \x3d 1.0 / 1.0;\nconst float SOFT_EDGE_RATIO \x3d 1.0;\nconst float THIN_LINE_WIDTH_FACTOR \x3d 1.1;\nconst float THIN_LINE_HALF_WIDTH \x3d 1.0;\nconst float EXTRUDE_SCALE_PLACEMENT_PADDING \x3d 1.0 / 4.0;\nconst float OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float OUTLINE_SCALE \x3d 1.0 / 5.0;\nconst float SDF_FONT_SIZE \x3d 24.0;\nconst float MAX_SDF_DISTANCE \x3d 8.0;\nconst float PLACEMENT_PADDING \x3d 8.0;\nconst float EPSILON \x3d 0.0000001;\nconst int MAX_FILTER_COUNT \x3d 2;\nconst int ATTR_VV_SIZE \x3d 0;\nconst int ATTR_VV_COLOR \x3d 1;\nconst int ATTR_VV_OPACITY \x3d 2;\nconst int ATTR_VV_ROTATION \x3d 3;\nconst highp float NAN_MAGIC_NUMBER \x3d 1e-30;",
fill:{"common.glsl":"#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\n#endif\n#ifdef DOT_DENSITY\nuniform lowp vec4 u_isActive[ 2 ];\nuniform highp float u_dotValue;\nuniform highp float u_tileDotsOverArea;\nuniform highp float u_dotTextureDotCount;\nuniform mediump float u_tileZoomFactor;\n#endif\nvarying vec3 v_pos;\nvarying lowp float v_opacity;\nvarying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying highp float v_flags;\n#ifdef PATTERN\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef DOT_DENSITY\nvarying highp vec2 v_dotTextureCoords;\nvarying highp vec4 v_dotThresholds[ 2 ];\n#endif",
"fill.frag":"precision highp float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#ifdef PATTERN\nuniform lowp sampler2D u_texture;\n#endif\n#ifdef DOT_DENSITY\nuniform mediump mat4 u_dotColors[ 2 ];\nuniform sampler2D u_dotTextures[ 2 ];\nuniform vec4 u_dotBackgroundColor;\n#endif\nvoid main() {\n#ifdef ID\ngl_FragColor \x3d v_id;\n#elif defined(PATTERN)\nmediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\nmediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\nlowp vec4 color \x3d texture2D(u_texture, samplePos);\ngl_FragColor \x3d v_opacity * v_color * color;\n#elif defined(DOT_DENSITY) \x26\x26 !defined(HIGHLIGHT)\nvec4 textureThresholds0 \x3d texture2D(u_dotTextures[0], v_dotTextureCoords);\nvec4 textureThresholds1 \x3d texture2D(u_dotTextures[1], v_dotTextureCoords);\nvec4 difference0 \x3d v_dotThresholds[0] - textureThresholds0;\nvec4 difference1 \x3d v_dotThresholds[1] - textureThresholds1;\n#ifdef DD_DOT_BLENDING\nvec4 isPositive0 \x3d step(0.0, difference0);\nvec4 isPositive1 \x3d step(0.0, difference1);\nfloat weightSum \x3d dot(isPositive0, difference0) + dot(isPositive1, difference1);\nfloat lessThanEqZero \x3d step(weightSum, 0.0);\nfloat greaterThanZero \x3d 1.0 - lessThanEqZero ;\nfloat divisor \x3d (weightSum + lessThanEqZero);\nvec4 weights0 \x3d difference0 * isPositive0 / divisor;\nvec4 weights1 \x3d difference1 * isPositive1 / divisor;\nvec4 dotColor \x3d u_dotColors[0] * weights0 + u_dotColors[1] * weights1;\nvec4 preEffectColor \x3d greaterThanZero * dotColor + lessThanEqZero * u_dotBackgroundColor;\n#else\nfloat diffMax \x3d max(max4(difference0), max4(difference1));\nfloat lessThanZero \x3d step(diffMax, 0.0);\nfloat greaterOrEqZero \x3d 1.0 - lessThanZero;\nvec4 isMax0 \x3d step(diffMax, difference0);\nvec4 isMax1 \x3d step(diffMax, difference1);\nvec4 dotColor \x3d u_dotColors[0] * isMax0 + u_dotColors[1] * isMax1;\nvec4 preEffectColor \x3d greaterOrEqZero * dotColor + lessThanZero * u_dotBackgroundColor;\n#endif\ngl_FragColor \x3d preEffectColor;\n#else\ngl_FragColor \x3d v_opacity * v_color;\n#endif\n#ifdef HIGHLIGHT\ngl_FragColor.a \x3d 1.0;\n#endif\n}",
"fill.vert":"precision highp float;\n#ifdef DOT_DENSITY\nattribute float a_inverseArea;\nvec4 a_color \x3d vec4(0.0, 0.0, 0.0, 1.0);\nvec4 a_aux3 \x3d vec4(0.0);\nvec2 a_zoomRange \x3d vec2(0.0, 10000.0);\n#else\nattribute vec4 a_color;\nattribute vec4 a_tlbr;\nattribute vec4 a_aux1;\nattribute vec2 a_aux2;\nattribute vec4 a_aux3;\nattribute vec2 a_zoomRange;\n#endif\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#ifdef DOT_DENSITY\nvec4 dotThreshold(vec4 featureAttrOverFeatureArea, float dotValue, float tileDotsOverArea) {\nreturn featureAttrOverFeatureArea * (1.0 / dotValue)  * (1.0 / tileDotsOverArea);\n}\n#endif\nvoid main()\n{\nINIT;\nfloat a_bitSet \x3d a_aux3.a;\nv_color     \x3d getColor(a_color, a_bitSet, 0);\nv_opacity   \x3d getOpacity();\nv_id        \x3d norm(a_id);\nv_pos       \x3d u_dvsMat3 * vec3(a_pos * FILL_POSITION_PRECISION, 1.);\nv_flags     \x3d getFilterFlags();\n#ifdef PATTERN\nvec2 aux2 \x3d (1.0 / SIGNED_BYTE_TO_UNSIGNED) * a_aux2;\nfloat width \x3d u_pixelRatio * u_zoomFactor * a_aux1.x * aux2.x;\nfloat height \x3d u_pixelRatio * u_zoomFactor * a_aux1.y * aux2.y;\nfloat angle \x3d C_256_TO_RAD * a_aux3.z;\nfloat sinA \x3d sin(angle);\nfloat cosA \x3d cos(angle);\nmat3 patternMatrix \x3d mat3(cosA / width, sinA / height, 0,\n-sinA / width, cosA / height, 0,\n0,            0,             1);\nvec2 symbolOffset \x3d (a_aux1.zw - SIGNED_BYTE_TO_UNSIGNED) / vec2(width, height);\nv_tileTextureCoord \x3d (patternMatrix * vec3(a_pos * FILL_POSITION_PRECISION, 1.0)).xy - symbolOffset;\nv_tlbr \x3d a_tlbr / u_mosaicSize.xyxy;\n#elif defined(DOT_DENSITY)\nvec4 ddAttributeData0 \x3d getAttributeData2(a_id) * u_isActive[0] * a_inverseArea;\nvec4 ddAttributeData1 \x3d getAttributeData3(a_id) * u_isActive[1] * a_inverseArea;\nfloat size \x3d u_tileZoomFactor * 512.0 * 1.0 / u_pixelRatio;\nv_dotThresholds[0] \x3d dotThreshold(ddAttributeData0, u_dotValue, u_tileDotsOverArea);\nv_dotThresholds[1] \x3d dotThreshold(ddAttributeData1, u_dotValue, u_tileDotsOverArea);\nv_dotTextureCoords \x3d (a_pos * FILL_POSITION_PRECISION + 0.5) / size;\n#endif\ngl_Position \x3d vec4(clip(v_color, v_pos, v_flags, a_zoomRange), 1.0);\n}"},
icon:{"common.glsl":"uniform lowp vec2 u_mosaicSize;\nvarying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying highp vec4 v_sizeTex;\nvarying mediump vec3 v_pos;\nvarying highp float v_filters;\nvarying lowp float v_opacity;\n#ifdef SDF\nvarying lowp vec4 v_outlineColor;\nvarying mediump float v_outlineWidth;\nvarying mediump float v_distRatio;\nvarying mediump float v_overridingOutlineColor;\nvarying mediump float v_isThin;\n#endif","icon.frag":"precision mediump float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nuniform lowp sampler2D u_texture;\nvoid main()\n{\nvec2 v_size \x3d v_sizeTex.xy;\nvec2 v_tex  \x3d v_sizeTex.zw;\n#ifdef SDF\nlowp vec4 fillPixelColor \x3d v_color;\nfloat d \x3d 0.5 - rgba2float(texture2D(u_texture, v_tex));\nfloat size \x3d max(v_size.x, v_size.y);\nfloat dist \x3d d * size * SOFT_EDGE_RATIO * v_distRatio;\nfillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\nfloat outlineWidth \x3d v_outlineWidth;\n#ifdef HIGHLIGHT\noutlineWidth \x3d max(outlineWidth, 4.0 * v_isThin);\n#endif\nif (outlineWidth \x3e 0.25) {\nlowp vec4 outlinePixelColor \x3d v_overridingOutlineColor * v_color + (1.0 - v_overridingOutlineColor) * v_outlineColor;\nfloat clampedOutlineSize \x3d min(outlineWidth, size);\noutlinePixelColor *\x3d clamp(0.5 - abs(dist) + clampedOutlineSize * 0.5, 0.0, 1.0);\ngl_FragColor \x3d v_opacity * ((1.0 - outlinePixelColor.a) * fillPixelColor + outlinePixelColor);\n}\nelse {\ngl_FragColor \x3d v_opacity * fillPixelColor;\n}\n#else\nlowp vec4 texColor \x3d texture2D(u_texture, v_tex);\ngl_FragColor \x3d v_opacity * texColor * v_color;\n#endif\n#ifdef HIGHLIGHT\ngl_FragColor.a \x3d step(1.0 / 255.0, gl_FragColor.a);\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"icon.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_outlineColor;\nattribute vec4 a_sizeAndOutlineWidth;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nattribute vec2 a_bitSetAndDistRatio;\nattribute vec2 a_zoomRange;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nvec2 getMarkerSize(inout vec2 offset, inout vec2 baseSize, inout float outlineSize, in float referenceSize, in float bitSet) {\n#ifdef VV_SIZE\nfloat r \x3d getSize(baseSize.y) / referenceSize;\nbaseSize.xy *\x3d r;\noffset.xy *\x3d r;\nfloat scaleSymbolProportionally \x3d getBit(bitSet, 3);\noutlineSize *\x3d scaleSymbolProportionally * (r - 1.0) + 1.0;\n#endif\nreturn baseSize;\n}\nvec3 getOffset(in vec2 in_offset, float a_bitSet) {\nfloat isMapAligned \x3d getBit(a_bitSet, 0);\nvec3  offset       \x3d getRotation() * vec3(in_offset, 0.0);\nreturn getMatrix(isMapAligned) * offset;\n}\nvoid main()\n{\nINIT;\nvec2  a_size   \x3d a_sizeAndOutlineWidth.xy * a_sizeAndOutlineWidth.xy / 128.0;\nvec2  a_offset \x3d a_vertexOffset / 16.0;\nfloat a_outlineSize \x3d a_sizeAndOutlineWidth.z * a_sizeAndOutlineWidth.z / 128.0;\nfloat a_bitSet \x3d a_bitSetAndDistRatio.x;\nvec2 v_size \x3d getMarkerSize(a_offset, a_size, a_outlineSize, a_sizeAndOutlineWidth.w * a_sizeAndOutlineWidth.w / 128.0, a_bitSet);\nvec2 v_tex      \x3d a_texCoords / u_mosaicSize;\nv_color    \x3d getColor(a_color, a_bitSet, 1);\nv_opacity  \x3d getOpacity();\nv_id       \x3d norm(a_id);\nv_filters  \x3d getFilterFlags();\nv_pos      \x3d u_dvsMat3 * vec3(a_pos * POSITION_PRECISION, 1.0) + getOffset(a_offset, a_bitSet);\nv_sizeTex  \x3d vec4(v_size.xy, v_tex.xy);\n#ifdef SDF\nv_isThin   \x3d getBit(a_bitSet, 2);\n#ifdef VV_COLOR\nv_overridingOutlineColor \x3d v_isThin;\n#else\nv_overridingOutlineColor \x3d 0.0;\n#endif\nv_outlineWidth \x3d min(a_outlineSize, max(max(v_size.x, v_size.y) - 0.99, 0.0));\nv_outlineColor \x3d a_outlineColor;\nv_distRatio \x3d a_bitSetAndDistRatio.y / 126.0;\n#endif\ngl_Position \x3d vec4(clip(v_color, v_pos, v_filters, a_zoomRange), 1.0);\n}"},
label:{"common.glsl":"uniform mediump float u_zoomLevel;\nuniform mediump float u_mapRotation;\nuniform mediump float u_mapAligned;\nuniform mediump vec2 u_mosaicSize;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying mediump vec2 v_tex;\nvarying mediump vec4 v_color;\nvarying lowp vec4 v_animation;","label.frag":"#include \x3cmaterials/text/text.frag\x3e","label.vert":"precision highp float;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/text/common.glsl\x3e\nattribute vec4 a_color;\nattribute vec4 a_haloColor;\nattribute vec4 a_texAndSize;\nattribute vec4 a_refSymbolAndPlacementOffset;\nattribute vec4 a_glyphData;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nuniform float u_isHalo;\nuniform float u_mapRotation;\nuniform float u_mapAligned;\nfloat getZ(in float minZoom, in float maxZoom, in float angle) {\nfloat glyphAngle \x3d angle * 360.0 / 254.0;\nfloat mapAngle \x3d u_mapRotation * 360.0 / 254.0;\nfloat diffAngle \x3d min(360.0 - abs(mapAngle - glyphAngle), abs(mapAngle - glyphAngle));\nfloat z \x3d 0.0;\nz +\x3d u_mapAligned * (2.0 * (1.0 - step(minZoom, u_currentZoom)));\nz +\x3d u_mapAligned * 2.0 * step(90.0, diffAngle);\nz +\x3d 2.0 * (1.0 - step(u_currentZoom, maxZoom));\nreturn z;\n}\nvoid main()\n{\nINIT;\nfloat groupMinZoom    \x3d getMinZoom();\nfloat glyphMinZoom    \x3d a_glyphData.x;\nfloat glyphMaxZoom    \x3d a_glyphData.y;\nfloat glyphAngle      \x3d a_glyphData.z;\nfloat a_minZoom          \x3d max(groupMinZoom, glyphMinZoom);\nfloat a_placementPadding \x3d a_refSymbolAndPlacementOffset.x * EXTRUDE_SCALE_PLACEMENT_PADDING;\nvec2  a_placementDir     \x3d unpack_u8_nf32(a_refSymbolAndPlacementOffset.zw);\nfloat a_refSymbolSize    \x3d a_refSymbolAndPlacementOffset.y;\nfloat fontSize           \x3d a_texAndSize.z;\nfloat haloSize           \x3d a_texAndSize.w * OUTLINE_SCALE;\nvec2  vertexOffset \x3d a_vertexOffset * OFFSET_PRECISION;\nvec3  pos          \x3d vec3(a_pos * POSITION_PRECISION, 1.0);\nfloat z            \x3d getZ(a_minZoom, glyphMaxZoom, glyphAngle);\nfloat fontScale    \x3d fontSize / SDF_FONT_SIZE;\nfloat halfSize     \x3d getSize(a_refSymbolSize) / 2.0;\nfloat animation    \x3d pow(getAnimationState(), vec4(2.0)).r;\nv_color     \x3d animation * ((1.0 - u_isHalo) * a_color + (u_isHalo * a_haloColor));\nv_opacity   \x3d 1.0;\nv_tex       \x3d a_texCoords / u_mosaicSize;\nv_edgeDistanceOffset \x3d u_isHalo * haloSize / fontScale / MAX_SDF_DISTANCE;\nv_antialiasingWidth  \x3d 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\nvec2 placementOffset \x3d a_placementDir * (halfSize + a_placementPadding);\nvec3 glyphOffset     \x3d u_displayMat3 * vec3(vertexOffset + placementOffset, 0.0);\nvec3 v_pos           \x3d vec3((u_dvsMat3 * pos + glyphOffset).xy, z);\ngl_Position \x3d vec4(applyFilterLabels(v_color, v_pos, getFilterFlags()), 1.0);\n#ifdef DEBUG\nv_color \x3d vec4(a_color.rgb, z \x3d\x3d 0.0 ? 1.0 : 0.645);\n#endif\n}"},
line:{"common.glsl":"varying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying mediump vec2 v_normal;\nvarying mediump float v_lineHalfWidth;\nvarying lowp float v_opacity;\nvarying highp vec3 v_pos;\n#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\n#endif\n#if defined(PATTERN) || defined(SDF)\nvarying highp float v_accumulatedDistance;\n#endif","line.frag":"precision lowp float;\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\nuniform lowp float u_blur;\n#if defined(PATTERN) || defined(SDF)\nuniform sampler2D u_texture;\nuniform highp float u_pixelRatio;\n#endif\n#ifdef SDF\nconst float sdfPatternHalfWidth \x3d 15.5;\nuniform mediump float u_antialiasing;\n#endif\nvoid main()\n{\nmediump float thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(v_lineHalfWidth, THIN_LINE_HALF_WIDTH), 1.0);\nmediump float fragDist \x3d length(v_normal) * v_lineHalfWidth;\nlowp float alpha \x3d clamp(thinLineFactor * (v_lineHalfWidth - fragDist) / (u_blur + thinLineFactor - 1.0), 0.0, 1.0);\n#if defined(SDF) \x26\x26 !defined(HIGHLIGHT)\nmediump float lineHalfWidth \x3d v_lineHalfWidth;\nmediump float lineWidthRatio \x3d max(lineHalfWidth - 0.55 * u_antialiasing, 0.25) / sdfPatternHalfWidth;\nmediump float relativeTexX \x3d fract(u_pixelRatio * v_accumulatedDistance * 0.5 / (lineWidthRatio * v_patternSize.x));\nmediump float relativeTexY \x3d 0.5 + 0.25 * v_normal.y;\nmediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\nmediump float d \x3d rgba2float(texture2D(u_texture, texCoord)) - 0.5;\nfloat dist \x3d d * lineHalfWidth;\nlowp vec4 fillPixelColor \x3d v_opacity * alpha * clamp(0.5 - dist, 0.0, 1.0) * v_color;\ngl_FragColor \x3d fillPixelColor;\n#elif defined(PATTERN) \x26\x26 !defined(HIGHLIGHT)\nmediump float lineHalfWidth \x3d v_lineHalfWidth;\nmediump float adjustedPatternWidth \x3d v_patternSize.x * 2.0 * lineHalfWidth / v_patternSize.y;\nmediump float relativeTexX \x3d fract(u_pixelRatio * v_accumulatedDistance / adjustedPatternWidth);\nmediump float relativeTexY \x3d 0.5 + 0.5 * v_normal.y;\nmediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexY, relativeTexX));\nlowp vec4 color \x3d texture2D(u_texture, texCoord);\ngl_FragColor \x3d v_opacity * alpha * v_color * color;\n#else\ngl_FragColor \x3d v_opacity * alpha * v_color;\n#endif\n#ifdef HIGHLIGHT\ngl_FragColor.a \x3d step(1.0 / 255.0, gl_FragColor.a);\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"line.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistanceAndHalfWidth;\nattribute vec4 a_tlbr;\nattribute vec4 a_segmentDirection;\nattribute vec2 a_aux;\nattribute vec2 a_zoomRange;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\nconst float SCALE \x3d 1.0 / 31.0;\nconst float WIDTH_SCALE \x3d 1.0 / 1024.0;\nfloat getBaseLineHalfWidth(in float in_lineHalfWidth) {\n#ifdef VV_SIZE\nfloat referenceHalfWidth \x3d a_aux.x * WIDTH_SCALE;\nfloat lineWidth \x3d 2.0 * in_lineHalfWidth;\nreturn 0.5 * (in_lineHalfWidth / referenceHalfWidth) * getSize(lineWidth);\n#else\nreturn in_lineHalfWidth;\n#endif\n}\nfloat getLineHalfWidth(in float baseWidth, in float aa) {\nfloat halfWidth \x3d max(baseWidth + aa, 0.45) + 0.1 * aa;\n#ifdef HIGHLIGHT\nhalfWidth \x3d max(halfWidth, 2.0);\n#endif\nreturn halfWidth;\n}\nvec2 getDist(in vec2 offset, in float halfWidth) {\nfloat thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(halfWidth, THIN_LINE_HALF_WIDTH), 1.0);\nreturn thinLineFactor * halfWidth * offset * SCALE;\n}\nvoid main()\n{\nINIT;\nfloat a_bitSet          \x3d a_segmentDirection.w;\nfloat a_accumulatedDist \x3d a_accumulatedDistanceAndHalfWidth.x;\nfloat a_lineHalfWidth   \x3d a_accumulatedDistanceAndHalfWidth.y * WIDTH_SCALE;\nfloat aa                \x3d 0.5 * u_antialiasing;\nvec2  a_offset          \x3d a_offsetAndNormal.xy;\nfloat baseWidth \x3d getBaseLineHalfWidth(a_lineHalfWidth);\nfloat halfWidth \x3d getLineHalfWidth(baseWidth, aa);\nfloat z         \x3d 2.0 * step(baseWidth, 0.0);\nvec2  dist      \x3d getDist(a_offset, halfWidth);\nvec3  offset    \x3d u_displayViewMat3 * vec3(dist, 0.0);\nvec3  pos       \x3d u_dvsMat3 * vec3(a_pos * POSITION_PRECISION, 1.0) + offset;\nv_color         \x3d getColor(a_color, a_bitSet, 0);\nv_opacity       \x3d getOpacity();\nv_lineHalfWidth \x3d halfWidth;\nv_id            \x3d norm(a_id);\nv_normal        \x3d a_offsetAndNormal.zw * SCALE;\nv_pos           \x3d vec3(pos.xy, z);\n#ifdef PATTERN\nv_tlbr          \x3d a_tlbr / u_mosaicSize.xyxy;\nv_patternSize   \x3d vec2(a_tlbr.z - a_tlbr.x, a_tlbr.w - a_tlbr.y);\n#endif\n#if defined(PATTERN) || defined(SDF)\nv_accumulatedDistance \x3d a_accumulatedDist * u_zoomFactor + dot(SCALE * a_segmentDirection.xy, dist);\n#endif\ngl_Position \x3d vec4(clip(v_color, v_pos, getFilterFlags(), a_zoomRange), 1.0);\n}"},
text:{"common.glsl":"uniform highp vec2 u_mosaicSize;\nvarying highp vec4 v_id;\nvarying mediump vec3 v_pos;\nvarying lowp float v_opacity;\nvarying lowp vec4 v_color;\nvarying highp vec2 v_tex;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying lowp float v_transparency;","text.frag":"precision mediump float;\n#include \x3cmaterials/text/common.glsl\x3e\nuniform lowp sampler2D u_texture;\nvoid main()\n{\nfloat SDF_CUTOFF \x3d (2.0 / 8.0);\nfloat SDF_BASE_EDGE_DIST \x3d 1.0 - SDF_CUTOFF;\nlowp float dist \x3d texture2D(u_texture, v_tex).a;\nmediump float edge \x3d SDF_BASE_EDGE_DIST - v_edgeDistanceOffset;\n#ifdef HIGHLIGHT\nedge /\x3d 2.0;\n#endif\nlowp float aa \x3d v_antialiasingWidth;\nlowp float alpha \x3d smoothstep(edge - aa, edge + aa, dist);\ngl_FragColor \x3d alpha * v_color * v_opacity;\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"text.vert":"precision highp float;\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/text/common.glsl\x3e\nattribute vec4 a_color;\nattribute vec4 a_haloColor;\nattribute vec4 a_texFontSize;\nattribute vec4 a_aux;\nattribute vec2 a_zoomRange;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nuniform float u_isHalo;\nfloat getTextSize(in float baseSize, in float referenceSize) {\n#ifdef VV_SIZE\nreturn getSize(baseSize);\n#endif\nreturn baseSize;\n}\nvoid main()\n{\nINIT;\nfloat a_referenceSize \x3d a_aux.z * a_aux.z / 256.0;\nfloat a_bitSet        \x3d a_aux.w;\nfloat a_fontSize      \x3d a_texFontSize.z;\nvec2  a_offset        \x3d a_vertexOffset * OFFSET_PRECISION;\nvec3  in_pos        \x3d vec3(a_pos * POSITION_PRECISION, 1.0);\nfloat fontSize      \x3d getTextSize(a_fontSize, a_referenceSize);\nfloat scaleFactor   \x3d fontSize / a_fontSize;\nfloat fontScale     \x3d fontSize / SDF_FONT_SIZE;\nvec3  offset        \x3d getRotation() * vec3(scaleFactor * a_offset, 0.0);\nmat3  extrudeMatrix \x3d getBit(a_bitSet, 0) \x3d\x3d 1.0 ? u_displayViewMat3 : u_displayMat3;\nv_color   \x3d u_isHalo * a_haloColor + (1.0 - u_isHalo) * getColor(a_color, a_bitSet, 1);\nv_opacity \x3d getOpacity();\nv_id      \x3d norm(a_id);\nv_tex     \x3d a_texCoords / u_mosaicSize;\nv_pos     \x3d u_dvsMat3 * in_pos + extrudeMatrix * offset;\nv_edgeDistanceOffset \x3d u_isHalo * OUTLINE_SCALE * a_texFontSize.w / fontScale / MAX_SDF_DISTANCE;\nv_antialiasingWidth  \x3d 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\ngl_Position \x3d  vec4(clip(v_color, v_pos, getFilterFlags(), a_zoomRange), 1.0);\n}"},
"utils.glsl":"float rshift(in float u32, in int amount) {\nreturn floor(u32 / pow(2.0, float(amount)));\n}\nfloat getBit(in float bitset, in int bitIndex) {\nfloat offset \x3d pow(2.0, float(bitIndex));\nreturn mod(floor(bitset / offset), 2.0);\n}\nfloat getFilterBit(in float bitset, in int bitIndex) {\nreturn getBit(bitset, bitIndex + 1);\n}\nfloat getHighlightBit(in float bitset) {\nreturn getBit(bitset, 0);\n}\nhighp vec4 unpackDisplayIdTexel(in highp vec4 bitset) {\nfloat isAggregate \x3d getBit(bitset.a, 7);\nreturn (1.0 - isAggregate) * bitset + isAggregate * (vec4(bitset.rgba) - vec4(0.0, 0.0, 0.0, float(0x80)));\n}\nvec4 unpack(in float u32) {\nfloat r \x3d mod(rshift(u32, 0), 255.0);\nfloat g \x3d mod(rshift(u32, 8), 255.0);\nfloat b \x3d mod(rshift(u32, 16), 255.0);\nfloat a \x3d mod(rshift(u32, 24), 255.0);\nreturn vec4(r, g, b, a);\n}\nvec4 norm(in vec4 v) {\nreturn v /\x3d 255.0;\n}\nfloat max4(vec4 target) {\nreturn max(max(max(target.x, target.y), target.z), target.w);\n}\nvec2 unpack_u8_nf32(vec2 bytes) {\nreturn (bytes - 127.0) / 127.0;\n}",
"vcommon.glsl":"#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/attributeData.glsl\x3e\n#include \x3cmaterials/vv.glsl\x3e\nattribute vec2 a_pos;\nattribute highp vec4 a_id;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform highp float u_pixelRatio;\nuniform mediump float u_zoomFactor;\nuniform mediump float u_antialiasing;\nuniform mediump float u_currentZoom;\nvec4 VV_ADATA \x3d vec4(0.0);\nvoid loadVisualVariableData(inout vec4 target) {\n#ifdef OES_TEXTURE_FLOAT\ntarget.rgba \x3d getAttributeData2(a_id);\n#else\nvec4 data0 \x3d getAttributeData2(a_id);\nvec4 data1 \x3d getAttributeData3(a_id);\ntarget.r \x3d u88VVToFloat(data0.rg * 255.0);\ntarget.g \x3d u88VVToFloat(data0.ba * 255.0);\ntarget.b \x3d u88VVToFloat(data1.rg * 255.0);\ntarget.a \x3d u88VVToFloat(data1.ba * 255.0);\n#endif\n}\n#ifdef VV\n#define INIT loadVisualVariableData(VV_ADATA)\n#else\n#define INIT\n#endif\nvec4 getColor(in vec4 a_color, in float a_bitSet, int index) {\n#ifdef VV_COLOR\nfloat isColorLocked   \x3d getBit(a_bitSet, index);\nreturn getVVColor(VV_ADATA[ATTR_VV_COLOR], a_color, isColorLocked);\n#else\nreturn a_color;\n#endif\n}\nfloat getOpacity() {\n#ifdef VV_OPACITY\nreturn getVVOpacity(VV_ADATA[ATTR_VV_OPACITY]);\n#else\nreturn 1.0;\n#endif\n}\nfloat getSize(in float in_size) {\n#ifdef VV_SIZE\nreturn getVVSize(in_size, VV_ADATA[ATTR_VV_SIZE]);\n#else\nreturn in_size;\n#endif\n}\nmat3 getRotation() {\n#ifdef VV_ROTATION\nreturn getVVRotationMat3(mod(VV_ADATA[ATTR_VV_ROTATION], 360.0));\n#else\nreturn mat3(1.0);\n#endif\n}\nfloat getFilterFlags() {\n#ifdef IGNORES_SAMPLER_PRECISION\nreturn ceil(getAttributeData0(a_id).x * 255.0);\n#else\nreturn getAttributeData0(a_id).x * 255.0;\n#endif\n}\nvec4 getAnimationState() {\nreturn getAttributeData1(a_id);\n}\nfloat getMinZoom() {\nvec4 data0 \x3d getAttributeData0(a_id) * 255.0;\nreturn data0.g;\n}\nmat3 getMatrix(float isMapAligned) {\nreturn isMapAligned * u_displayViewMat3 + (1.0 - isMapAligned) * u_displayMat3;\n}\nvec3 clip(inout vec4 color, inout vec3 pos, in float filterFlags, in vec2 minMaxZoom) {\npos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 0));\n#ifdef INSIDE\npos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 1));\n#elif defined(OUTSIDE)\npos.z +\x3d 2.0 * getFilterBit(filterFlags, 1);\n#elif defined(HIGHLIGHT)\n#if !defined(HIGHLIGHT_ALL)\npos.z +\x3d 2.0 * (1.0 - getHighlightBit(filterFlags));\n#endif\n#endif\npos.z +\x3d 2.0 * (step(minMaxZoom.y, u_currentZoom) + (1.0 - step(minMaxZoom.x, u_currentZoom)));\nreturn pos;\n}\nvec3 applyFilterLabels(inout vec4 color, inout vec3 pos, in float filterFlags) {\npos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 0));\n#ifndef OUTSIDE_LABELS_VISIBLE\npos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 1));\n#endif\nreturn pos;\n}",
"vv.glsl":"#if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n#define VV_SIZE\n#endif\n#if defined(VV_COLOR) || defined(VV_SIZE) || defined(VV_OPACITY) || defined(VV_ROTATION)\n#define VV\n#endif\n#ifdef VV_COLOR\nuniform highp float u_vvColorValues[8];\nuniform vec4 u_vvColors[8];\n#endif\n#ifdef VV_SIZE_MIN_MAX_VALUE\nuniform highp vec4 u_vvSizeMinMaxValue;\n#endif\n#ifdef VV_SIZE_SCALE_STOPS\nuniform highp float u_vvSizeScaleStopsValue;\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nuniform highp float u_vvSizeFieldStopsValues[6];\nuniform float u_vvSizeFieldStopsSizes[6];\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nuniform highp float u_vvSizeUnitValueWorldToPixelsRatio;\n#endif\n#ifdef VV_OPACITY\nuniform highp float u_vvOpacityValues[8];\nuniform float u_vvOpacities[8];\n#endif\n#ifdef VV_ROTATION\nuniform lowp float u_vvRotationType;\n#endif\nbool isNan(float val) {\nreturn (val \x3d\x3d NAN_MAGIC_NUMBER);\n}\n#ifdef VV_SIZE_MIN_MAX_VALUE\nfloat getVVMinMaxSize(float sizeValue, float fallback) {\nif (isNan(sizeValue)) {\nreturn fallback;\n}\nfloat interpolationRatio \x3d (sizeValue  - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\ninterpolationRatio \x3d clamp(interpolationRatio, 0.0, 1.0);\nreturn u_vvSizeMinMaxValue.z + interpolationRatio * (u_vvSizeMinMaxValue.w - u_vvSizeMinMaxValue.z);\n}\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nconst int VV_SIZE_N \x3d 6;\nfloat getVVStopsSize(float sizeValue, float fallback) {\nif (isNan(sizeValue)) {\nreturn fallback;\n}\nif (sizeValue \x3c\x3d u_vvSizeFieldStopsValues[0]) {\nreturn u_vvSizeFieldStopsSizes[0];\n}\nfor (int i \x3d 1; i \x3c VV_SIZE_N; ++i) {\nif (u_vvSizeFieldStopsValues[i] \x3e\x3d sizeValue) {\nfloat f \x3d (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\nreturn mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\n}\n}\nreturn u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\n}\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nfloat getVVUnitValue(float sizeValue, float fallback) {\nif (isNan(sizeValue)) {\nreturn fallback;\n}\nreturn u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\n}\n#endif\n#ifdef VV_OPACITY\nconst int VV_OPACITY_N \x3d 8;\nfloat getVVOpacity(float opacityValue) {\nif (isNan(opacityValue)) {\nreturn 1.0;\n}\nif (opacityValue \x3c\x3d u_vvOpacityValues[0]) {\nreturn u_vvOpacities[0];\n}\nfor (int i \x3d 1; i \x3c VV_OPACITY_N; ++i) {\nif (u_vvOpacityValues[i] \x3e\x3d opacityValue) {\nfloat f \x3d (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\nreturn mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n}\n}\nreturn u_vvOpacities[VV_OPACITY_N - 1];\n}\n#endif\n#ifdef VV_ROTATION\nmat4 getVVRotation(float rotationValue) {\nif (isNan(rotationValue)) {\nreturn mat4(1, 0, 0, 0,\n0, 1, 0, 0,\n0, 0, 1, 0,\n0, 0, 0, 1);\n}\nfloat rotation \x3d rotationValue;\nif (u_vvRotationType \x3d\x3d 1.0) {\nrotation \x3d 90.0 - rotation;\n}\nfloat angle \x3d C_DEG_TO_RAD * rotation;\nfloat sinA \x3d sin(angle);\nfloat cosA \x3d cos(angle);\nreturn mat4(cosA, sinA, 0, 0,\n-sinA,  cosA, 0, 0,\n0,     0, 1, 0,\n0,     0, 0, 1);\n}\nmat3 getVVRotationMat3(float rotationValue) {\nif (isNan(rotationValue)) {\nreturn mat3(1, 0, 0,\n0, 1, 0,\n0, 0, 1);\n}\nfloat rotation \x3d rotationValue;\nif (u_vvRotationType \x3d\x3d 1.0) {\nrotation \x3d 90.0 - rotation;\n}\nfloat angle \x3d C_DEG_TO_RAD * -rotation;\nfloat sinA \x3d sin(angle);\nfloat cosA \x3d cos(angle);\nreturn mat3(cosA, -sinA, 0,\nsinA, cosA, 0,\n0,    0,    1);\n}\n#endif\n#ifdef VV_COLOR\nconst int VV_COLOR_N \x3d 8;\nvec4 getVVColor(float colorValue, vec4 fallback, float isColorLocked) {\nif (isNan(colorValue) || isColorLocked \x3d\x3d 1.0) {\nreturn fallback;\n}\nif (colorValue \x3c\x3d u_vvColorValues[0]) {\nreturn u_vvColors[0];\n}\nfor (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\nif (u_vvColorValues[i] \x3e\x3d colorValue) {\nfloat f \x3d (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\nreturn mix(u_vvColors[i-1], u_vvColors[i], f);\n}\n}\nreturn u_vvColors[VV_COLOR_N - 1];\n}\n#endif\nfloat getVVSize(in float size, in float vvSize)  {\n#ifdef VV_SIZE_MIN_MAX_VALUE\nreturn getVVMinMaxSize(vvSize, size);\n#elif defined(VV_SIZE_SCALE_STOPS)\nreturn u_vvSizeScaleStopsValue;\n#elif defined(VV_SIZE_FIELD_STOPS)\nfloat outSize \x3d getVVStopsSize(vvSize, size);\nreturn isNan(outSize) ? size : outSize;\n#elif defined(VV_SIZE_UNIT_VALUE)\nreturn getVVUnitValue(vvSize, size);\n#else\nreturn size;\n#endif\n}"},
"post-processing":{blit:{"blit.frag":"precision mediump float;\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\nvoid main() {\ngl_FragColor \x3d texture2D(u_texture, v_uv);\n}"},bloom:{composite:{"composite.frag":"precision mediump float;\nvarying vec2 v_uv;\nuniform sampler2D u_blurTexture1;\nuniform sampler2D u_blurTexture2;\nuniform sampler2D u_blurTexture3;\nuniform sampler2D u_blurTexture4;\nuniform sampler2D u_blurTexture5;\nuniform float u_bloomStrength;\nuniform float u_bloomRadius;\nuniform float u_bloomFactors[NUMMIPS];\nuniform vec3 u_bloomTintColors[NUMMIPS];\nfloat lerpBloomFactor(const in float factor) {\nfloat mirrorFactor \x3d 1.2 - factor;\nreturn mix(factor, mirrorFactor, u_bloomRadius);\n}\nvoid main() {\ngl_FragColor \x3d u_bloomStrength * (\nlerpBloomFactor(u_bloomFactors[0]) * vec4(u_bloomTintColors[0], 1.0) * texture2D(u_blurTexture1, v_uv) +\nlerpBloomFactor(u_bloomFactors[1]) * vec4(u_bloomTintColors[1], 1.0) * texture2D(u_blurTexture2, v_uv) +\nlerpBloomFactor(u_bloomFactors[2]) * vec4(u_bloomTintColors[2], 1.0) * texture2D(u_blurTexture3, v_uv) +\nlerpBloomFactor(u_bloomFactors[3]) * vec4(u_bloomTintColors[3], 1.0) * texture2D(u_blurTexture4, v_uv) +\nlerpBloomFactor(u_bloomFactors[4]) * vec4(u_bloomTintColors[4], 1.0) * texture2D(u_blurTexture5, v_uv)\n);\n}"},
gaussianBlur:{"gaussianBlur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nuniform vec2 u_direction;\nvarying vec2 v_uv;\n#define KERNEL_RADIUS RADIUS\n#define SIGMA RADIUS\nfloat gaussianPdf(in float x, in float sigma) {\nreturn 0.39894 * exp(-0.5 * x * x / ( sigma * sigma)) / sigma;\n}\nvoid main() {\nvec2 invSize \x3d 1.0 / u_texSize;\nfloat fSigma \x3d float(SIGMA);\nfloat weightSum \x3d gaussianPdf(0.0, fSigma);\nvec4 pixelColorSum \x3d texture2D(u_colorTexture, v_uv) * weightSum;\nfor (int i \x3d 1; i \x3c KERNEL_RADIUS; i ++) {\nfloat x \x3d float(i);\nfloat w \x3d gaussianPdf(x, fSigma);\nvec2 uvOffset \x3d u_direction * invSize * x;\nvec4 sample1 \x3d texture2D(u_colorTexture, v_uv + uvOffset);\nvec4 sample2 \x3d texture2D(u_colorTexture, v_uv - uvOffset);\npixelColorSum +\x3d (sample1 + sample2) * w;\nweightSum +\x3d 2.0 * w;\n}\ngl_FragColor \x3d pixelColorSum /weightSum;\n}"},
luminosityHighPass:{"luminosityHighPass.frag":"precision mediump float;\nuniform sampler2D u_texture;\nuniform vec3 u_defaultColor;\nuniform float u_defaultOpacity;\nuniform float u_luminosityThreshold;\nuniform float u_smoothWidth;\nvarying vec2 v_uv;\nvoid main() {\nvec4 texel \x3d texture2D(u_texture, v_uv);\nvec3 luma \x3d vec3(0.299, 0.587, 0.114);\nfloat v \x3d dot(texel.xyz, luma);\nvec4 outputColor \x3d vec4(u_defaultColor.rgb, u_defaultOpacity);\nfloat alpha \x3d smoothstep(u_luminosityThreshold, u_luminosityThreshold + u_smoothWidth, v);\ngl_FragColor \x3d mix(outputColor, texel, alpha);\n}"}},
blur:{gaussianBlur:{"gaussianBlur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nuniform vec2 u_direction;\nuniform float u_sigma;\nvarying vec2 v_uv;\n#define KERNEL_RADIUS RADIUS\nfloat gaussianPdf(in float x, in float sigma) {\nreturn 0.39894 * exp(-0.5 * x * x / ( sigma * sigma)) / sigma;\n}\nvoid main() {\nvec2 invSize \x3d 1.0 / u_texSize;\nfloat fSigma \x3d u_sigma;\nfloat weightSum \x3d gaussianPdf(0.0, fSigma);\nvec4 pixelColorSum \x3d texture2D(u_colorTexture, v_uv) * weightSum;\nfor (int i \x3d 1; i \x3c KERNEL_RADIUS; i ++) {\nfloat x \x3d float(i);\nfloat w \x3d gaussianPdf(x, fSigma);\nvec2 uvOffset \x3d u_direction * invSize * x;\nvec4 sample1 \x3d texture2D(u_colorTexture, v_uv + uvOffset);\nvec4 sample2 \x3d texture2D(u_colorTexture, v_uv - uvOffset);\npixelColorSum +\x3d (sample1 + sample2) * w;\nweightSum +\x3d 2.0 * w;\n}\ngl_FragColor \x3d pixelColorSum /weightSum;\n}"},
"radial-blur":{"radial-blur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nconst float sampleDist \x3d 1.0;\nconst float sampleStrength \x3d 2.2;\nvoid main(void) {\nfloat samples[10];\nsamples[0] \x3d -0.08;\nsamples[1] \x3d -0.05;\nsamples[2] \x3d -0.03;\nsamples[3] \x3d -0.02;\nsamples[4] \x3d -0.01;\nsamples[5] \x3d  0.01;\nsamples[6] \x3d  0.02;\nsamples[7] \x3d  0.03;\nsamples[8] \x3d  0.05;\nsamples[9] \x3d  0.08;\nvec2 dir \x3d 0.5 - v_uv;\nfloat dist \x3d sqrt(dir.x * dir.x + dir.y * dir.y);\ndir \x3d dir / dist;\nvec4 color \x3d texture2D(u_colorTexture,v_uv);\nvec4 sum \x3d color;\nfor (int i \x3d 0; i \x3c 10; i++) {\nsum +\x3d texture2D(u_colorTexture, v_uv + dir * samples[i] * sampleDist);\n}\nsum *\x3d 1.0 / 11.0;\nfloat t \x3d dist * sampleStrength;\nt \x3d clamp(t, 0.0, 1.0);\ngl_FragColor \x3d mix(color, sum, t);\n}"}},
dra:{"dra.frag":"precision mediump float;\nuniform sampler2D u_minColor;\nuniform sampler2D u_maxColor;\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\nvoid main() {\nvec4 minColor \x3d texture2D(u_minColor, vec2(0.5));\nvec4 maxColor \x3d texture2D(u_maxColor, vec2(0.5));\nvec4 color \x3d texture2D(u_texture, v_uv);\nvec3 minColorUnpremultiply \x3d minColor.rgb / minColor.a;\nvec3 maxColorUnpremultiply \x3d maxColor.rgb / maxColor.a;\nvec3 colorUnpremultiply \x3d color.rgb / color.a;\nvec3 range \x3d maxColorUnpremultiply - minColorUnpremultiply;\ngl_FragColor \x3d vec4(color.a * (colorUnpremultiply - minColorUnpremultiply) / range, color.a);\n}",
"min-max":{"min-max.frag":"#extension GL_EXT_draw_buffers : require\nprecision mediump float;\n#define CELL_SIZE 2\nuniform sampler2D u_minTexture;\nuniform sampler2D u_maxTexture;\nuniform vec2 u_srcResolution;\nuniform vec2 u_dstResolution;\nvarying vec2 v_uv;\nvoid main() {\nvec2 srcPixel \x3d floor(gl_FragCoord.xy) * float(CELL_SIZE);\nvec2 onePixel \x3d vec2(1.0) / u_srcResolution;\nvec2 uv \x3d (srcPixel + 0.5) / u_srcResolution;\nvec4 minColor \x3d vec4(1.0);\nvec4 maxColor \x3d vec4(0.0);\nfor (int y \x3d 0; y \x3c CELL_SIZE; ++y) {\nfor (int x \x3d 0; x \x3c CELL_SIZE; ++x) {\nvec2 offset \x3d uv + vec2(x, y) * onePixel;\nminColor \x3d min(minColor, texture2D(u_minTexture, offset));\nmaxColor \x3d max(maxColor, texture2D(u_maxTexture, offset));\n}\n}\ngl_FragData[0] \x3d minColor;\ngl_FragData[1] \x3d maxColor;\n}"}},
"drop-shadow":{composite:{"composite.frag":"precision mediump float;\nuniform sampler2D u_layerFBOTexture;\nuniform sampler2D u_blurTexture;\nuniform vec4 u_shadowColor;\nvarying vec2 v_uv;\nvoid main() {\nvec4 layerColor \x3d texture2D(u_layerFBOTexture, v_uv);\nvec4 blurColor \x3d texture2D(u_blurTexture, v_uv);\ngl_FragColor \x3d ((1.0 - layerColor.a) * blurColor.a * u_shadowColor + layerColor);\n}"},"drop-shadow.vert":"precision mediump float;\nattribute vec2 a_position;\nuniform highp mat3 u_displayViewMat3;\nuniform highp vec2 u_offset;\nvarying vec2 v_uv;\nvoid main() {\nvec3 offset \x3d u_displayViewMat3 * vec3(u_offset, 0.0);\ngl_Position \x3d vec4(a_position, 0.0, 1.0) + vec4(offset, 0.0);\nv_uv \x3d (a_position + 1.0) / 2.0;\n}"},
"edge-detect":{"frei-chen":{"frei-chen.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nvarying vec2 v_uv;\nvec2 texel \x3d vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[9];\nconst mat3 g0 \x3d mat3( 0.3535533845424652, 0, -0.3535533845424652, 0.5, 0, -0.5, 0.3535533845424652, 0, -0.3535533845424652 );\nconst mat3 g1 \x3d mat3( 0.3535533845424652, 0.5, 0.3535533845424652, 0, 0, 0, -0.3535533845424652, -0.5, -0.3535533845424652 );\nconst mat3 g2 \x3d mat3( 0, 0.3535533845424652, -0.5, -0.3535533845424652, 0, 0.3535533845424652, 0.5, -0.3535533845424652, 0 );\nconst mat3 g3 \x3d mat3( 0.5, -0.3535533845424652, 0, -0.3535533845424652, 0, 0.3535533845424652, 0, 0.3535533845424652, -0.5 );\nconst mat3 g4 \x3d mat3( 0, -0.5, 0, 0.5, 0, 0.5, 0, -0.5, 0 );\nconst mat3 g5 \x3d mat3( -0.5, 0, 0.5, 0, 0, 0, 0.5, 0, -0.5 );\nconst mat3 g6 \x3d mat3( 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.6666666865348816, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204 );\nconst mat3 g7 \x3d mat3( -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, 0.6666666865348816, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408 );\nconst mat3 g8 \x3d mat3( 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408 );\nvoid main() {\nG[0] \x3d g0,\nG[1] \x3d g1,\nG[2] \x3d g2,\nG[3] \x3d g3,\nG[4] \x3d g4,\nG[5] \x3d g5,\nG[6] \x3d g6,\nG[7] \x3d g7,\nG[8] \x3d g8;\nmat3 I;\nfloat cnv[9];\nvec3 sample;\nfor (float i \x3d 0.0; i \x3c 3.0; i++) {\nfor (float j \x3d 0.0; j \x3c 3.0; j++) {\nsample \x3d texture2D(u_colorTexture, v_uv + texel * vec2(i - 1.0,j - 1.0)).rgb;\nI[int(i)][int(j)] \x3d length(sample);\n}\n}\nfor (int i \x3d 0; i \x3c 9; i++) {\nfloat dp3 \x3d dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\ncnv[i] \x3d dp3 * dp3;\n}\nfloat M \x3d (cnv[0] + cnv[1]) + (cnv[2] + cnv[3]);\nfloat S \x3d (cnv[4] + cnv[5]) + (cnv[6] + cnv[7]) + (cnv[8] + M);\ngl_FragColor \x3d vec4(vec3(sqrt(M / S)), texture2D(u_colorTexture, v_uv).a);\n}"},
sobel:{"sobel.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nuniform vec2 u_texSize;\nvec2 texel \x3d vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[2];\nconst mat3 g0 \x3d mat3( 1.0, 2.0, 1.0, 0.0, 0.0, 0.0, -1.0, -2.0, -1.0 );\nconst mat3 g1 \x3d mat3( 1.0, 0.0, -1.0, 2.0, 0.0, -2.0, 1.0, 0.0, -1.0 );\nvoid main() {\nmat3 I;\nfloat cnv[2];\nvec3 sample;\nG[0] \x3d g0;\nG[1] \x3d g1;\nfor (float i \x3d 0.0; i \x3c 3.0; i++) {\nfor (float j \x3d 0.0; j \x3c 3.0; j++) {\nsample \x3d texture2D( u_colorTexture, v_uv + texel * vec2(i-1.0,j-1.0) ).rgb;\nI[int(i)][int(j)] \x3d length(sample);\n}\n}\nfor (int i \x3d 0; i \x3c 2; i++) {\nfloat dp3 \x3d dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\ncnv[i] \x3d dp3 * dp3;\n}\ngl_FragColor \x3d vec4(vec3(0.5 * sqrt(cnv[0] * cnv[0] + cnv[1] * cnv[1])), texture2D(u_colorTexture, v_uv).a);\n}"}},
"edge-enhance":{"edge-enhance.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nuniform vec2 u_texSize;\nvec2 texel \x3d vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[2];\nconst mat3 g0 \x3d mat3( 1.0, 0.0, -1.0, 1.0, 0.0, -1.0, 1.0, 0.0, -1.0 );\nconst mat3 g1 \x3d mat3( 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, -1.0, -1.0, -1.0 );\nvoid main() {\nmat3 I;\nfloat cnv[2];\nvec3 sample;\nG[0] \x3d g0;\nG[1] \x3d g1;\nfor (float i \x3d 0.0; i \x3c 3.0; i++) {\nfor (float j \x3d 0.0; j \x3c 3.0; j++) {\nsample \x3d texture2D( u_colorTexture, v_uv + texel * vec2(i-1.0,j-1.0) ).rgb;\nI[int(i)][int(j)] \x3d length(sample);\n}\n}\nfor (int i \x3d 0; i \x3c 2; i++) {\nfloat dp3 \x3d dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\ncnv[i] \x3d dp3 * dp3;\n}\nvec4 color \x3d texture2D(u_colorTexture, v_uv);\ngl_FragColor \x3d vec4(0.5 * sqrt(cnv[0] * cnv[0] + cnv[1] * cnv[1]) * color);\n}"},
filterEffect:{"filterEffect.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform mat4 u_coefficients;\nvarying vec2 v_uv;\nvoid main() {\nvec4 color \x3d texture2D(u_colorTexture, v_uv);\nvec4 rgbw \x3d u_coefficients * vec4(color.a \x3e 0.0 ? color.rgb / color.a : vec3(0.0), 1.0);\nfloat a \x3d color.a;\ngl_FragColor \x3d vec4(a * rgbw.rgb, a);\n}"},pp:{"pp.vert":"precision mediump float;\nattribute vec2 a_position;\nvarying vec2 v_uv;\nvoid main() {\ngl_Position \x3d vec4(a_position, 0.0, 1.0);\nv_uv \x3d (a_position + 1.0) / 2.0;\n}"}},
raster:{bitmap:{"bitmap.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform highp vec2 u_coordScale;\nuniform lowp float u_opacity;\n#include \x3cfiltering/bicubic.glsl\x3e\nvoid main() {\n#ifdef BICUBIC\nvec4 color \x3d sampleBicubicBSpline(u_texture, v_texcoord, u_coordScale);\n#else\nvec4 color \x3d texture2D(u_texture, v_texcoord);\n#endif\nfloat alpha \x3d u_opacity * color.a;\ngl_FragColor \x3d vec4(alpha * color.rgb, alpha);\n}","bitmap.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},
common:{"common.glsl":"uniform sampler2D u_image;\nuniform int u_bandCount;\nuniform bool u_isFloatTexture;\nuniform bool u_flipY;\nuniform float u_opacity;\nuniform int u_resampling;\nuniform vec2 u_srcImageSize;\n#ifdef APPLY_PROJECTION\n#include \x3craster/common/projection.glsl\x3e\n#endif\n#ifdef BICUBIC\n#include \x3cfiltering/bicubic.glsl\x3e\n#endif\n#ifdef BILINEAR\n#include \x3cfiltering/bilinear.glsl\x3e\n#endif\nvec2 getPixelLocation(vec2 coords) {\nvec2 targetLocation \x3d u_flipY ? vec2(coords.s, 1.0 - coords.t) : coords;\n#ifdef APPLY_PROJECTION\ntargetLocation \x3d projectPixelLocation(targetLocation);\n#endif\nreturn targetLocation;\n}\nbool isOutside(vec2 coords){\nif (coords.t\x3e1.00001 ||coords.t\x3c-0.00001 || coords.s\x3e1.00001 ||coords.s\x3c-0.00001) {\nreturn true;\n} else {\nreturn false;\n}\n}\nvec4 getPixel(vec2 pixelLocation) {\n#ifdef BICUBIC\nvec4 color \x3d sampleBicubicBSpline(u_image, pixelLocation, u_srcImageSize);\n#elif defined(BILINEAR)\nvec4 color \x3d sampleBilinear(u_image, pixelLocation, u_srcImageSize);\n#else\nvec4 color \x3d texture2D(u_image, pixelLocation);\n#endif\nreturn color;\n}",
"contrastBrightness.glsl":"uniform float u_contrastOffset;\nuniform float u_brightnessOffset;\nvec4 adjustContrastBrightness(vec4 currentPixel, bool isFloat) {\nvec4 pixelValue \x3d isFloat ? currentPixel * 255.0 : currentPixel;\nfloat maxI \x3d 255.0;\nfloat mid \x3d 128.0;\nfloat c \x3d u_contrastOffset;\nfloat b \x3d u_brightnessOffset;\nvec4 v;\nif (c \x3e 0.0 \x26\x26 c \x3c 100.0) {\nv \x3d (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) / (2.0 * (100.0 - c)) + mid;\n} else if (c \x3c\x3d 0.0 \x26\x26 c \x3e -100.0) {\nv \x3d (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) * (100.0 + c) / 20000.0 + mid;\n} else if (c \x3d\x3d 100.0) {\nv \x3d (200.0 * pixelValue - 100.0 * maxI + (maxI + 1.0) * (100.0 - c) + 2.0 * maxI * b);\nv \x3d (sign(v) + 1.0) / 2.0;\n} else if (c \x3d\x3d -100.0) {\nv \x3d vec4(mid, mid, mid, currentPixel.a);\n}\nreturn vec4(v.r / 255.0, v.g / 255.0, v.b / 255.0, currentPixel.a);\n}",
"projection.glsl":"uniform sampler2D u_transformGrid;\nuniform vec2 u_transformSpacing;\nuniform vec2 u_transformGridSize;\nuniform vec2 u_targetImageSize;\nvec2 projectPixelLocation(vec2 coords) {\nvec2 index_image \x3d floor(coords * u_targetImageSize);\nvec2 oneTransformPixel \x3d vec2(0.25 / u_transformGridSize.s, 1.0 / u_transformGridSize.t);\nvec2 index_transform \x3d floor(index_image / u_transformSpacing) / u_transformGridSize;\nvec2 pos \x3d fract((index_image + vec2(0.5, 0.5)) / u_transformSpacing);\nvec2 srcLocation;\nvec2 transform_location \x3d index_transform + oneTransformPixel * 0.5;\nif (pos.s \x3c\x3d pos.t) {\nvec4 ll_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s, transform_location.t));\nvec4 ll_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + oneTransformPixel.s, transform_location.t));\nsrcLocation.s \x3d dot(ll_abc.rgb, vec3(pos, 1.0));\nsrcLocation.t \x3d dot(ll_def.rgb, vec3(pos, 1.0));\n} else {\nvec4 ur_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s + 2.0 * oneTransformPixel.s, transform_location.t));\nvec4 ur_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + 3.0 * oneTransformPixel.s, transform_location.t));\nsrcLocation.s \x3d dot(ur_abc.rgb, vec3(pos, 1.0));\nsrcLocation.t \x3d dot(ur_def.rgb, vec3(pos, 1.0));\n}\nreturn srcLocation;\n}"},
hillshade:{"hillshade.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nuniform int u_hillshadeType;\nuniform float u_sinZcosAs[6];\nuniform float u_sinZsinAs[6];\nuniform float u_cosZs[6];\nuniform float u_weights[6];\nuniform vec2 u_factor;\nuniform float u_minValue;\nuniform float u_maxValue;\n#include \x3craster/lut/colorize.glsl\x3e\nfloat getNeighborHoodAlpha(float a, float b, float c, float d, float e, float f, float g, float h, float i){\nif (a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0 || a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0 || a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0) {\nreturn 0.0;\n}\nelse {\nreturn e;\n}\n}\nvec3 rgb2hsv(vec3 c) {\nvec4 K \x3d vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\nvec4 p \x3d c.g \x3c c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\nvec4 q \x3d c.r \x3c p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\nfloat d \x3d q.x - min(q.w, q.y);\nfloat e \x3d 1.0e-10;\nreturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n}\nvec3 hsv2rgb(vec3 c) {\nvec4 K \x3d vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\nvec3 p \x3d abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\nreturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\nvec4 overlay(float val, float minValue, float maxValue, float hillshade) {\nval \x3d clamp((val - minValue) / (maxValue - minValue), 0.0, 1.0);\nvec4 rgb \x3d colorize(vec4(val, val, val, 1.0), 255.0);\nvec3 hsv \x3d rgb2hsv(rgb.xyz);\nhsv.z \x3d hillshade;\nreturn vec4(hsv2rgb(hsv), 1.0) * rgb.a;\n}\nvoid main() {\nvec2 pixelLocation \x3d getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec4 currentPixel \x3d getPixel(pixelLocation);\nif (currentPixel.a \x3d\x3d 0.0) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec2 axy \x3d vec2(-1.0, -1.0);\nvec2 bxy \x3d vec2(0.0, -1.0);\nvec2 cxy \x3d vec2(1.0, -1.0);\nvec2 dxy \x3d vec2(-1.0, 0.0);\nvec2 fxy \x3d vec2(1.0, 0.0);\nvec2 gxy \x3d vec2(-1.0, 1.0);\nvec2 hxy \x3d vec2(0.0, 1.0);\nvec2 ixy \x3d vec2(1.0, 1.0);\nvec2 onePixel \x3d 1.0 / u_srcImageSize;\nif (pixelLocation.s \x3c onePixel.s) {\naxy[0] \x3d 1.0;\ndxy[0] \x3d 1.0;\ngxy[0] \x3d 1.0;\n}\nif (pixelLocation.t \x3c onePixel.t) {\naxy[1] \x3d 1.0;\nbxy[1] \x3d 1.0;\ncxy[1] \x3d 1.0;\n}\nif (pixelLocation.s \x3e 1.0 - onePixel.s) {\ncxy[0] \x3d -1.0;\nfxy[0] \x3d -1.0;\nixy[0] \x3d -1.0;\n}\nif (pixelLocation.t \x3e 1.0 - onePixel.t) {\ngxy[1] \x3d -1.0;\nhxy[1] \x3d -1.0;\nixy[1] \x3d -1.0;\n}\nvec4 va \x3d texture2D(u_image, pixelLocation + onePixel * axy);\nvec4 vb \x3d texture2D(u_image, pixelLocation + onePixel * bxy);\nvec4 vc \x3d texture2D(u_image, pixelLocation + onePixel * cxy);\nvec4 vd \x3d texture2D(u_image, pixelLocation + onePixel * dxy);\nvec4 ve \x3d texture2D(u_image, pixelLocation);\nvec4 vf \x3d texture2D(u_image, pixelLocation + onePixel * fxy);\nvec4 vg \x3d texture2D(u_image, pixelLocation + onePixel * gxy);\nvec4 vh \x3d texture2D(u_image, pixelLocation + onePixel * hxy);\nvec4 vi \x3d texture2D(u_image, pixelLocation + onePixel * ixy);\nfloat dzx \x3d (vc + 2.0 * vf + vi - va - 2.0 * vd - vg).r * u_factor.s;\nfloat dzy \x3d (vg + 2.0 * vh + vi - va - 2.0 * vb - vc).r * u_factor.t;\nfloat dzd \x3d sqrt(1.0 + dzx * dzx + dzy * dzy);\nfloat hillshade \x3d 0.0;\nif (u_hillshadeType \x3d\x3d 0){\nfloat cosDelta \x3d u_sinZsinAs[0] * dzy - u_sinZcosAs[0] * dzx;\nfloat z \x3d (u_cosZs[0] + cosDelta) / dzd;\nif (z \x3c 0.0)  z \x3d 0.0;\nhillshade \x3d z;\n} else {\nfor (int k \x3d 0; k \x3c 6; k++) {\nfloat cosDelta \x3d u_sinZsinAs[k] * dzy - u_sinZcosAs[k] * dzx;\nfloat z \x3d (u_cosZs[k] + cosDelta) / dzd;\nif (z \x3c 0.0) z \x3d 0.0;\nhillshade \x3d hillshade + z * u_weights[k];\nif (k \x3d\x3d 5) break;\n}\n}\nfloat alpha \x3d getNeighborHoodAlpha(va.a, vb.a, vc.a, vd.a, ve.a, vf.a, vg.a, vh.a, vi.a);\n#ifdef APPLY_COLORMAP\ngl_FragColor \x3d overlay(ve.r, u_minValue, u_maxValue, hillshade) * alpha * u_opacity;\n#else\ngl_FragColor \x3d vec4(hillshade, hillshade, hillshade, 1.0) * alpha * u_opacity;\n#endif\n}",
"hillshade.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},lut:{"colorize.glsl":"uniform sampler2D u_colormap;\nuniform float u_colormapOffset;\nuniform float u_colormapMaxIndex;\nvec4 colorize(vec4 currentPixel, float scaleFactor) {\nfloat clrIndex \x3d clamp(currentPixel.r * scaleFactor - u_colormapOffset, 0.0, u_colormapMaxIndex);\nvec2 clrPosition \x3d vec2((clrIndex + 0.5) / (u_colormapMaxIndex + 1.0), 0.0);\nvec4 color \x3d texture2D(u_colormap, clrPosition);\nvec4 result \x3d vec4(color.rgb, color.a * currentPixel.a);\nreturn result;\n}",
"lut.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\n#include \x3craster/lut/colorize.glsl\x3e\nvoid main() {\nvec2 pixelLocation \x3d getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec4 currentPixel \x3d getPixel(pixelLocation);\nvec4 result \x3d colorize(currentPixel, 1.0);\ngl_FragColor \x3d vec4(result.xyz, 1.0) * result.a * u_opacity;\n}","lut.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform highp float u_scale;\nuniform highp vec2 u_offset;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos * u_scale + u_offset;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},
magdir:{"magdir.frag":"precision mediump float;\nvarying vec4 v_color;\nuniform lowp float u_opacity;\nvoid main() {\ngl_FragColor \x3d v_color * u_opacity;\n}","magdir.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_vv;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform vec2 u_symbolSize;\nuniform vec2 u_symbolPercentRange;\nuniform vec2 u_dataRange;\nuniform float u_rotation;\nuniform vec4 u_colors[12];\nvarying vec4 v_color;\nvoid main()\n{\nfloat angle \x3d a_offset.y + u_rotation;\n#ifdef ROTATION_GEOGRAPHIC\nangle \x3d 3.14159265359 * 2.0 - angle - 3.14159265359 / 2.0;\n#endif\nvec2 offset \x3d vec2(cos(angle), sin(angle)) * a_offset.x;\n#ifdef DATA_RANGE\nfloat valuePercentage \x3d clamp((a_vv.y - u_dataRange.x) / (u_dataRange.y - u_dataRange.x), 0.0, 1.0);\nfloat sizeRatio \x3d u_symbolPercentRange.x + valuePercentage * (u_symbolPercentRange.y - u_symbolPercentRange.x);\nfloat sizePercentage \x3d clamp(sizeRatio, u_symbolPercentRange.x, u_symbolPercentRange.y);\n#else\nfloat sizePercentage \x3d (u_symbolPercentRange.x + u_symbolPercentRange.y) / 2.0;\n#endif\nvec2 pos \x3d a_pos + offset * sizePercentage * u_symbolSize;\nv_color \x3d u_colors[int(a_vv.x)];\ngl_Position \x3d vec4(u_dvsMat3 * vec3(pos * u_coordScale, 1.0), 1.0);\n}"},
reproject:{"reproject.frag":"precision mediump float;\nvarying vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nvoid main() {\nvec2 pixelLocation \x3d getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 1.0);\nreturn;\n}\nvec4 currentPixel \x3d getPixel(pixelLocation);\ngl_FragColor \x3d vec4(currentPixel.rgb, 1.0) * currentPixel.a * u_opacity;\n}","reproject.vert":"precision mediump float;\nattribute vec2 a_position;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_position;\ngl_Position \x3d vec4(2.0 * (a_position - 0.5), 0.0, 1.0);\n}"},
scalar:{"scalar.frag":"precision mediump float;\nuniform lowp float u_opacity;\nvarying vec2 v_pos;\nconst vec4 outlineColor \x3d vec4(0.2, 0.2, 0.2, 1.0);\nconst float outlineSize \x3d 0.02;\nconst float innerRadius \x3d 0.25;\nconst float outerRadius \x3d 0.42;\nconst float innerSquareLength \x3d 0.15;\nvoid main() {\nmediump float dist \x3d length(v_pos);\nmediump float fillalpha1 \x3d smoothstep(outerRadius, outerRadius + outlineSize, dist);\nfillalpha1 *\x3d (1.0-smoothstep(outerRadius + outlineSize, outerRadius + 0.1 + outlineSize, dist));\n#ifdef INNER_CIRCLE\nmediump float fillalpha2 \x3d smoothstep(innerRadius, innerRadius + outlineSize, dist);\nfillalpha2 *\x3d (1.0-smoothstep(innerRadius + outlineSize, innerRadius + 0.1 + outlineSize, dist));\n#else\nmediump float fillalpha2 \x3d (abs(v_pos.x) \x3c innerSquareLength ? 1.0 : 0.0) * (abs(v_pos.y) \x3c innerSquareLength ? 1.0 : 0.0);\n#endif\ngl_FragColor \x3d (fillalpha2 + fillalpha1) * outlineColor * u_opacity;\n}",
"scalar.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_vv;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform vec2 u_symbolSize;\nuniform vec2 u_symbolPercentRange;\nuniform vec2 u_dataRange;\nvarying vec2 v_pos;\nvoid main()\n{\n#ifdef DATA_RANGE\nfloat valuePercentage \x3d clamp((a_vv.y - u_dataRange.x) / (u_dataRange.y - u_dataRange.x), 0.0, 1.0);\nfloat sizeRatio \x3d u_symbolPercentRange.x + valuePercentage * (u_symbolPercentRange.y - u_symbolPercentRange.x);\nfloat sizePercentage \x3d clamp(sizeRatio, u_symbolPercentRange.x, u_symbolPercentRange.y);\n#else\nfloat sizePercentage \x3d (u_symbolPercentRange.x + u_symbolPercentRange.y) / 2.0;\n#endif\nvec2 size \x3d u_symbolSize * sizePercentage;\nvec2 pos \x3d a_pos + a_offset * size;\nv_pos \x3d a_offset;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(pos * u_coordScale, 1.0), 1.0);\n}"},
stretch:{"stretch.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nuniform float u_minCutOff[3];\nuniform float u_maxCutOff[3];\nuniform float u_minOutput;\nuniform float u_maxOutput;\nuniform float u_factor[3];\nuniform bool u_useGamma;\nuniform float u_gamma[3];\nuniform float u_gammaCorrection[3];\n#include \x3craster/lut/colorize.glsl\x3e\nfloat stretchOneValue(float val, float minCutOff, float maxCutOff, float minOutput, float maxOutput, float factor, bool useGamma, float gamma, float gammaCorrection) {\nif (val \x3e\x3d maxCutOff) {\nreturn maxOutput;\n} else if (val \x3c\x3d minCutOff) {\nreturn minOutput;\n}\nfloat stretchedVal;\nif (useGamma) {\nfloat tempf \x3d 1.0;\nfloat outRange \x3d maxOutput - minOutput;\nfloat relativeVal \x3d (val - minCutOff) / (maxCutOff - minCutOff);\nif (gamma \x3e 1.0) {\ntempf -\x3d pow(1.0 / outRange, relativeVal * gammaCorrection);\n}\nstretchedVal \x3d (tempf * outRange * pow(relativeVal, 1.0 / gamma) + minOutput) / 255.0;\n} else {\nstretchedVal \x3d minOutput + (val - minCutOff) * factor;\n}\nreturn stretchedVal;\n}\nvoid main() {\nvec2 pixelLocation \x3d getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec4 currentPixel \x3d getPixel(pixelLocation);\n#ifdef NOOP\ngl_FragColor \x3d vec4(currentPixel.rgb, 1.0) * currentPixel.a * u_opacity;\nreturn;\n#endif\nif (u_bandCount \x3d\x3d 1) {\nfloat grayVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\n#ifdef APPLY_COLORMAP\nvec4 result \x3d colorize(vec4(grayVal, grayVal, grayVal, 1.0), u_useGamma ? 255.0 : 1.0);\ngl_FragColor \x3d vec4(result.xyz, 1.0) * result.a * currentPixel.a * u_opacity;\n#else\ngl_FragColor \x3d vec4(grayVal, grayVal, grayVal, 1.0) * currentPixel.a * u_opacity;\n#endif\n} else {\nfloat redVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\nfloat greenVal \x3d stretchOneValue(currentPixel.g, u_minCutOff[1], u_maxCutOff[1], u_minOutput, u_maxOutput, u_factor[1], u_useGamma, u_gamma[1], u_gammaCorrection[1]);\nfloat blueVal \x3d stretchOneValue(currentPixel.b, u_minCutOff[2], u_maxCutOff[2], u_minOutput, u_maxOutput, u_factor[2], u_useGamma, u_gamma[2], u_gammaCorrection[2]);\ngl_FragColor \x3d vec4(redVal, greenVal, blueVal, 1.0) * currentPixel.a * u_opacity;\n}\n}",
"stretch.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform highp float u_scale;\nuniform highp vec2 u_offset;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos * u_scale + u_offset;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"}},stencil:{"stencil.frag":"void main() {\ngl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\n}","stencil.vert":"attribute vec2 a_pos;\nvoid main() {\ngl_Position \x3d vec4(a_pos, 0.0, 1.0);\n}"},
tileInfo:{"tileInfo.frag":"uniform mediump sampler2D u_texture;\nvarying mediump vec2 v_tex;\nvoid main(void) {\nlowp vec4 color \x3d texture2D(u_texture, v_tex);\ngl_FragColor \x3d 0.75 * color;\n}","tileInfo.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_coord_ratio;\nuniform mediump vec2 u_delta;\nuniform mediump vec2 u_dimensions;\nvarying mediump vec2 v_tex;\nvoid main() {\nmediump vec2 offset \x3d u_coord_ratio * vec2(u_delta + a_pos * u_dimensions);\nvec3 v_pos \x3d u_dvsMat3 * vec3(offset, 1.0);\ngl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\nv_tex \x3d a_pos;\n}"},
util:{"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n255.0 / (256.0),\n255.0 / (256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n);\nfloat rgba2float(vec4 rgba) {\nreturn dot(rgba, rgba2float_factors);\n}"}}})},"esri/views/2d/engine/webgl/brushes/WGLBrushInfo":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/vec4f32 ../../../../webgl/BufferObject ../../../../webgl/FramebufferObject ../../../../../core/has ../../../../webgl/checkWebGLError ../../../../webgl/enums ../../../../../chunks/builtins ../../../../webgl/programUtils ../../../../webgl/renderState ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ./WGLBrush ../shaders/BackgroundPrograms ../shaders/TileInfoPrograms".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c,q,n,a){return function(f){function d(){var l=f.apply(this,arguments)||this;l._color=F.fromValues(1,0,0,1);return l}A._inheritsLoose(d,f);var k=d.prototype;k.dispose=function(){this._outlineProgram&&(this._outlineProgram.dispose(),this._outlineProgram=null);this._tileInfoProgram&&(this._tileInfoProgram.dispose(),this._tileInfoProgram=null);this._outlineVertexArrayObject&&(this._outlineVertexArrayObject.dispose(),this._outlineVertexArrayObject=null);this._tileInfoVertexArrayObject&&
(this._tileInfoVertexArrayObject.dispose(),this._tileInfoVertexArrayObject=null);this._canvas=null};k.prepareState=function({context:l}){l.setBlendingEnabled(!0);l.setBlendFunctionSeparate(1,771,1,771);l.setColorMask(!0,!0,!0,!0);l.setStencilWriteMask(0);l.setStencilTestEnabled(!1)};k.draw=function(l,g){({context:l}=l);if(g.isReady){this._loadWGLResources(l);l.bindVAO(this._outlineVertexArrayObject);l.useProgram(this._outlineProgram);this._outlineProgram.setUniformMatrix3fv("u_dvsMat3",g.transforms.dvs);
this._outlineProgram.setUniform2f("u_coord_range",g.rangeX,g.rangeY);this._outlineProgram.setUniform1f("u_depth",0);this._outlineProgram.setUniform4fv("u_color",this._color);l.drawArrays(3,0,4);l.bindVAO();var t=this._getTexture(l,g);t&&(l.bindVAO(this._tileInfoVertexArrayObject),l.useProgram(this._tileInfoProgram),l.bindTexture(t,0),this._tileInfoProgram.setUniformMatrix3fv("u_dvsMat3",g.transforms.dvs),this._tileInfoProgram.setUniform1f("u_depth",0),this._tileInfoProgram.setUniform2f("u_coord_ratio",
g.rangeX/g.width,g.rangeY/g.height),this._tileInfoProgram.setUniform2f("u_delta",8,8),this._tileInfoProgram.setUniform2f("u_dimensions",t.descriptor.width,t.descriptor.height),l.drawArrays(5,0,4),l.bindVAO())}};k._loadWGLResources=function(l){if(!this._outlineProgram||!this._tileInfoProgram){var g=h.createProgram(l,n.background),t=h.createProgram(l,a.tileInfo),r={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},w=new Int8Array([0,0,1,0,1,1,0,1]);w=E.createVertex(l,
35044,w);w=new c(l,n.background.attributes,r,{geometry:w});var v=new Int8Array([0,0,1,0,0,1,1,1]);v=E.createVertex(l,35044,v);l=new c(l,a.tileInfo.attributes,r,{geometry:v});this._outlineProgram=g;this._tileInfoProgram=t;this._outlineVertexArrayObject=w;this._tileInfoVertexArrayObject=l}};k._getTexture=function(l,g){if(g.texture&&g.triangleCountReportedInDebug===g.triangleCount)return g.texture;g.triangleCountReportedInDebug=g.triangleCount;this._canvas||(this._canvas=document.createElement("canvas"),
this._canvas.setAttribute("id","canvas2d"),this._canvas.setAttribute("width","300"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));const t=g.triangleCount;let r=g.key.id;0<g.triangleCount&&(r+=`, ${t}`);const w=this._canvas,v=w.getContext("2d");v.font="24px sans-serif";v.textAlign="left";v.textBaseline="top";v.clearRect(0,0,300,32);1E5<t?(v.fillStyle="red",v.fillRect(0,0,300,32),v.fillStyle="black"):(v.clearRect(0,0,300,32),v.fillStyle="blue");v.fillText(r,
0,0);g.texture=new e(l,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071},w);return g.texture};return d}(q)})},"esri/views/2d/engine/webgl/shaders/TileInfoPrograms":function(){define(["exports","./sources/resolver"],function(A,F){F={shaders:{vertexShader:F.resolveIncludes("tileInfo/tileInfo.vert"),fragmentShader:F.resolveIncludes("tileInfo/tileInfo.frag")},attributes:new Map([["a_pos",0]])};A.tileInfo=F;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLBrushStencil":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/vec4f32 ../../../../webgl/BufferObject ../../../../webgl/FramebufferObject ../../../../../core/has ../../../../webgl/checkWebGLError ../../../../webgl/enums ../../../../../chunks/builtins ../../../../webgl/programUtils ../../../../webgl/renderState ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ./WGLBrush ../shaders/BackgroundPrograms".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c,q,n){return function(a){function f(){var k=a.apply(this,arguments)||this;k._color=F.fromValues(1,0,0,1);k._initialized=!1;return k}A._inheritsLoose(f,a);var d=f.prototype;d.dispose=function(){this._solidProgram&&(this._solidProgram.dispose(),this._solidProgram=null);this._solidVertexArrayObject&&(this._solidVertexArrayObject.dispose(),this._solidVertexArrayObject=null)};d.prepareState=function({context:k},l){k.setDepthWriteEnabled(!1);k.setDepthTestEnabled(!1);k.setStencilTestEnabled(!0);
k.setBlendingEnabled(!1);k.setColorMask(!1,!1,!1,!1);k.setStencilOp(7680,7680,7681);k.setStencilWriteMask(255);k.setStencilFunctionSeparate(1032,516,l.stencilRef,255)};d.draw=function(k,l){({context:k}=k);this._initialized||this._initialize(k);k.bindVAO(this._solidVertexArrayObject);k.useProgram(this._solidProgram);this._solidProgram.setUniformMatrix3fv("u_dvsMat3",l.transforms.dvs);this._solidProgram.setUniform2fv("u_coord_range",[l.rangeX,l.rangeY]);this._solidProgram.setUniform1f("u_depth",0);
this._solidProgram.setUniform4fv("u_color",this._color);k.drawArrays(5,0,4);k.bindVAO()};d._initialize=function(k){if(this._initialized)return!0;const l=h.createProgram(k,n.background);if(!l)return!1;var g=new Int8Array([0,0,1,0,0,1,1,1]);g=E.createVertex(k,35044,g);k=new c(k,n.background.attributes,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},{geometry:g});this._solidProgram=l;this._solidVertexArrayObject=k;return this._initialized=!0};return f}(q)})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLBackground":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../chunks/mat3f32 ../../../../../chunks/vec4f32 ../../../../webgl/BufferObject ../../../../webgl/FramebufferObject ../../../../../core/has ../../../../webgl/checkWebGLError ../../../../webgl/enums ../../../../../chunks/builtins ../../../../webgl/renderState ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ../definitions ../enums ../number ./WGLBrush".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c,q,n,a,f,d,k,l){p=function(g){function t(){var w=g.apply(this,arguments)||this;w._color=x.fromValues(1,0,0,1);w._patternMatrix=B.create();w._programOptions={id:!1,pattern:!1};return w}F._inheritsLoose(t,g);var r=t.prototype;r.dispose=function(){this._vao&&(this._vao.dispose(),this._vao=null)};r.drawMany=function(w,v){const {context:z,painter:u,styleLayerUID:y}=w;this._loadWGLResources(w);const D=w.displayLevel;var G=w.styleLayer,H=G.backgroundMaterial;const J=u.vectorTilesMaterialManager;
var K=G.getPaintValue("background-color",D);const L=G.getPaintValue("background-opacity",D),M=G.getPaintValue("background-pattern",D),N=void 0!==M,P=K[3]*L,I=w.spriteMosaic;let O,Q;const T=(window.devicePixelRatio|1)>f.VTL_HIGH_RES_CUTOFF?2:1;w=w.drawPhase===d.WGLDrawPhase.HITTEST;const V=this._programOptions;V.id=w;V.pattern=N;H=J.getMaterialProgram(z,H,V);z.bindVAO(this._vao);z.useProgram(H);if(N){K=I.getMosaicItemPosition(M,!0);if(C.isSome(K)){const {tl:aa,br:Z,page:R}=K;O=Z[0]-aa[0];Q=Z[1]-aa[1];
K=I.getPageSize(R);C.isSome(K)&&(I.bind(z,9729,R,f.VTL_TEXTURE_BINDING_UNIT_SPRITES),H.setUniform4f("u_tlbr",aa[0],aa[1],Z[0],Z[1]),H.setUniform2fv("u_mosaicSize",K),H.setUniform1i("u_texture",f.VTL_TEXTURE_BINDING_UNIT_SPRITES))}H.setUniform1f("u_opacity",L)}else this._color[0]=P*K[0],this._color[1]=P*K[1],this._color[2]=P*K[2],this._color[3]=P,H.setUniform4fv("u_color",this._color);H.setUniform1f("u_depth",G.z||0);w&&(G=k.u32to4Xu8(y+1),H.setUniform4fv("u_id",G));for(const aa of v)H.setUniform1f("u_coord_range",
aa.rangeX),H.setUniformMatrix3fv("u_dvsMat3",aa.transforms.dvs),N&&(G=T*aa.width*Math.max(2**(Math.round(D)-aa.key.level),1),v=G/E.nextPowerOfTwo(O),G/=E.nextPowerOfTwo(Q),this._patternMatrix[0]=v,this._patternMatrix[4]=G,H.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix)),z.setStencilFunction(514,aa.stencilRef,255),z.drawArrays(5,0,4)};r._loadWGLResources=function(w){if(!this._vao){var {context:v,styleLayer:z}=w;w=z.backgroundMaterial;var u=new Int8Array([0,0,1,0,0,1,1,1]);u=m.createVertex(v,
35044,u);this._vao=new a(v,w.getAttributeLocations(),w.getLayoutInfo(),{geometry:u})}};return t}(l);A.WGLBrushVTLBackground=p;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLCircle":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../enums ../number ./WGLBrush".split(" "),function(A,F,E,C,B,x){x=function(m){function p(){var b=m.apply(this,arguments)||this;b._programOptions={id:!1};return b}F._inheritsLoose(p,
m);var h=p.prototype;h.dispose=function(){};h.drawMany=function(b,e){const {context:c,displayLevel:q,requiredLevel:n,state:a,drawPhase:f,painter:d,spriteMosaic:k,styleLayerUID:l}=b;if(e.some(u=>{var y,D;return null!=(y=null==(D=u.layerData.get(l))?void 0:D.circleIndexCount)?y:!1})){b=b.styleLayer;var g=b.circleMaterial,t=d.vectorTilesMaterialManager,r=b.getPaintValue("circle-translate",q),w=b.getPaintValue("circle-translate-anchor",q),v=f===C.WGLDrawPhase.HITTEST,z=this._programOptions;z.id=v;t=t.getMaterialProgram(c,
g,z);c.useProgram(t);t.setUniformMatrix3fv("u_displayMat3",1===w?a.displayMat3:a.displayViewMat3);t.setUniform2fv("u_circleTranslation",r);t.setUniform1f("u_depth",b.z);t.setUniform1f("u_antialiasingWidth",1.2);r=-1;v&&(v=B.u32to4Xu8(l+1),t.setUniform4fv("u_id",v));for(const u of e)u.layerData.has(l)&&(u.key.level!==r&&(r=u.key.level,g.setDataUniforms(t,q,b,r,k)),e=u.layerData.get(l),e.circleIndexCount&&(e.prepareForRendering(c),v=e.circleVertexArrayObject,E.isNone(v)||(c.bindVAO(v),t.setUniformMatrix3fv("u_dvsMat3",
u.transforms.dvs),n!==u.key.level?c.setStencilFunction(514,u.stencilRef,255):c.setStencilFunction(516,255,255),c.drawElements(4,e.circleIndexCount,5125,Uint32Array.BYTES_PER_ELEMENT*e.circleIndexStart),u.triangleCount+=e.circleIndexCount/3)))}};return p}(x);A.WGLBrushVTLCircle=x;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLFill":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ../enums ../number ./WGLBrush".split(" "),
function(A,F,E,C,B,x,m){const p=1/65536;m=function(h){function b(){var c=h.apply(this,arguments)||this;c._fillProgramOptions={id:!1,pattern:!1};c._outlineProgramOptions={id:!1};return c}F._inheritsLoose(b,h);var e=b.prototype;e.dispose=function(){};e.drawMany=function(c,q){const {displayLevel:n,drawPhase:a,renderPass:f,spriteMosaic:d,styleLayerUID:k}=c;var l=!1;for(var g of q)if(g.layerData.has(k)){var t=g.layerData.get(k);if(0<t.fillIndexCount||0<t.outlineIndexCount){l=!0;break}}if(l){l=c.styleLayer;
var r=l.getPaintProperty("fill-pattern");t=(g=void 0!==r)&&r.isDataDriven;if(g&&!t){var w=r.getValue(n);w=d.getMosaicItemPosition(w,!0)}r=!g&&l.getPaintValue("fill-antialias",n);var v=!0,z=1;if(!g){var u=l.getPaintProperty("fill-color"),y=l.getPaintProperty("fill-opacity");null!=u&&u.isDataDriven||null!=y&&y.isDataDriven||(z=l.getPaintValue("fill-color",n),z=l.getPaintValue("fill-opacity",n)*z[3],1<=z&&(v=!1))}if(!v||"opaque"!==f){var D;a===B.WGLDrawPhase.HITTEST&&(D=x.u32to4Xu8(k+1));u=l.getPaintValue("fill-translate",
n);y=l.getPaintValue("fill-translate-anchor",n);(v||"translucent"!==f)&&this._drawFill(c,k,l,q,u,y,g,w,t,D);w=!l.hasDataDrivenOutlineColor&&l.outlineUsesFillColor&&1>z;r&&"opaque"!==f&&!w&&this._drawOutline(c,k,l,q,u,y,D)}}};e._drawFill=function(c,q,n,a,f,d,k,l,g,t){if(!k||g||!E.isNone(l)){var {context:r,displayLevel:w,state:v,drawPhase:z,painter:u,pixelRatio:y,spriteMosaic:D}=c;c=n.fillMaterial;var G=u.vectorTilesMaterialManager,H=y>C.VTL_HIGH_RES_CUTOFF?2:1,J=z===B.WGLDrawPhase.HITTEST,K=this._fillProgramOptions;
K.id=J;K.pattern=k;G=G.getMaterialProgram(r,c,K);r.useProgram(G);E.isSome(l)&&({page:l}=l,K=D.getPageSize(l),E.isSome(K)&&(D.bind(r,9729,l,C.VTL_TEXTURE_BINDING_UNIT_SPRITES),G.setUniform2fv("u_mosaicSize",K),G.setUniform1i("u_texture",C.VTL_TEXTURE_BINDING_UNIT_SPRITES)));G.setUniformMatrix3fv("u_displayMat3",1===d?v.displayMat3:v.displayViewMat3);G.setUniform2fv("u_fillTranslation",f);G.setUniform1f("u_depth",n.z+p);J&&G.setUniform4fv("u_id",t);f=-1;for(const L of a)if(L.layerData.has(q)&&(L.key.level!==
f&&(f=L.key.level,c.setDataUniforms(G,w,n,f,D)),a=L.layerData.get(q),a.fillIndexCount&&(a.prepareForRendering(r),d=a.fillVertexArrayObject,!E.isNone(d)))){r.bindVAO(d);G.setUniformMatrix3fv("u_dvsMat3",L.transforms.dvs);r.setStencilFunction(514,L.stencilRef,255);k&&G.setUniform1f("u_patternFactor",L.rangeX/(H*L.width*Math.max(2**(Math.round(w)-L.key.level),1)));if(g){d=a.patternMap;if(!d)continue;for(const [M,N]of d)d=D.getPageSize(M),E.isSome(d)&&(D.bind(r,9729,M,C.VTL_TEXTURE_BINDING_UNIT_SPRITES),
G.setUniform2fv("u_mosaicSize",d),G.setUniform1i("u_texture",C.VTL_TEXTURE_BINDING_UNIT_SPRITES),r.drawElements(4,N[1],5125,Uint32Array.BYTES_PER_ELEMENT*N[0]))}else r.drawElements(4,a.fillIndexCount,5125,Uint32Array.BYTES_PER_ELEMENT*a.fillIndexStart);L.triangleCount+=a.fillIndexCount/3}}};e._drawOutline=function(c,q,n,a,f,d,k){const {context:l,displayLevel:g,state:t,drawPhase:r,painter:w,pixelRatio:v,spriteMosaic:z}=c;c=n.outlineMaterial;var u=w.vectorTilesMaterialManager;const y=.75/v,D=r===B.WGLDrawPhase.HITTEST,
G=this._outlineProgramOptions;G.id=D;u=u.getMaterialProgram(l,c,G);l.useProgram(u);u.setUniformMatrix3fv("u_displayMat3",1===d?t.displayMat3:t.displayViewMat3);u.setUniform2fv("u_fillTranslation",f);u.setUniform1f("u_depth",n.z+p);u.setUniform1f("u_outline_width",y);D&&u.setUniform4fv("u_id",k);f=-1;for(const H of a)H.layerData.has(q)&&(H.key.level!==f&&(f=H.key.level,c.setDataUniforms(u,g,n,f,z)),a=H.layerData.get(q),a.prepareForRendering(l),a.outlineIndexCount&&(d=a.outlineVertexArrayObject,E.isNone(d)||
(l.bindVAO(d),u.setUniformMatrix3fv("u_dvsMat3",H.transforms.dvs),l.setStencilFunction(514,H.stencilRef,255),l.drawElements(4,a.outlineIndexCount,5125,Uint32Array.BYTES_PER_ELEMENT*a.outlineIndexStart),H.triangleCount+=a.outlineIndexCount/3)))};return b}(m);A.WGLBrushVTLFill=m;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLLine":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ../enums ../number ./WGLBrush".split(" "),
function(A,F,E,C,B,x,m){m=function(p){function h(){var e=p.apply(this,arguments)||this;e._programOptions={id:!1,pattern:!1,sdf:!1};return e}F._inheritsLoose(h,p);var b=h.prototype;b.dispose=function(){};b.drawMany=function(e,c){const {context:q,displayLevel:n,state:a,drawPhase:f,painter:d,pixelRatio:k,spriteMosaic:l,styleLayerUID:g}=e;if(c.some(L=>{var M,N;return null!=(M=null==(N=L.layerData.get(g))?void 0:N.lineIndexCount)?M:!1})){e=e.styleLayer;var t=e.lineMaterial,r=d.vectorTilesMaterialManager,
w=e.getPaintValue("line-translate",n),v=e.getPaintValue("line-translate-anchor",n),z=e.getPaintProperty("line-pattern"),u=void 0!==z,y=u&&z.isDataDriven;if(u&&!y){z=z.getValue(n);var D=l.getMosaicItemPosition(z)}var G;z=!1;if(!u){var H=e.getPaintProperty("line-dasharray");z=(G=void 0!==H)&&H.isDataDriven;G&&!z&&(D=H.getValue(n),D=e.getDashKey(D,e.getLayoutValue("line-cap",n)),D=l.getMosaicItemPosition(D))}H=1/k;var J=f===B.WGLDrawPhase.HITTEST,K=this._programOptions;K.id=J;K.pattern=u;K.sdf=G;G=r.getMaterialProgram(q,
t,K);q.useProgram(G);G.setUniformMatrix3fv("u_displayViewMat3",a.displayViewMat3);G.setUniformMatrix3fv("u_displayMat3",1===v?a.displayMat3:a.displayViewMat3);G.setUniform2fv("u_lineTranslation",w);G.setUniform1f("u_depth",e.z);G.setUniform1f("u_antialiasing",H);J&&(w=x.u32to4Xu8(g+1),G.setUniform4fv("u_id",w));D&&E.isSome(D)&&({page:w}=D,v=l.getPageSize(w),E.isSome(v)&&(l.bind(q,9729,w,C.VTL_TEXTURE_BINDING_UNIT_SPRITES),G.setUniform2fv("u_mosaicSize",v),G.setUniform1i("u_texture",C.VTL_TEXTURE_BINDING_UNIT_SPRITES)));
w=-1;for(const L of c)if(L.layerData.has(g)&&(L.key.level!==w&&(w=L.key.level,t.setDataUniforms(G,n,e,w,l)),G.setUniform1f("u_zoomFactor",2**(n-w)/k),c=L.layerData.get(g),c.lineIndexCount&&(c.prepareForRendering(q),v=c.lineVertexArrayObject,!E.isNone(v)))){q.bindVAO(v);G.setUniformMatrix3fv("u_dvsMat3",L.transforms.dvs);q.setStencilFunction(514,L.stencilRef,255);if(y||z){v=c.patternMap;if(!v)continue;for(const [M,N]of v)v=l.getPageSize(M),E.isSome(v)&&(l.bind(q,9729,M,C.VTL_TEXTURE_BINDING_UNIT_SPRITES),
G.setUniform2fv("u_mosaicSize",v),G.setUniform1i("u_texture",C.VTL_TEXTURE_BINDING_UNIT_SPRITES),q.drawElements(4,N[1],5125,Uint32Array.BYTES_PER_ELEMENT*N[0]))}else q.drawElements(4,c.lineIndexCount,5125,Uint32Array.BYTES_PER_ELEMENT*c.lineIndexStart);L.triangleCount+=c.lineIndexCount/3}}};return h}(m);A.WGLBrushVTLLine=m;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLSymbol":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../chunks/vec2f32 ../../vectorTiles/decluttering/config ../definitions ../enums ../GeometryUtils ../number ./WGLBrush".split(" "),
function(A,F,E,C,B,x,m,p,h,b){const e=1/65536;b=function(c){function q(){var a=c.apply(this,arguments)||this;a._iconProgramOptions={id:!1,sdf:!1};a._sdfProgramOptions={id:!1};a._spritesTextureSize=C.create();return a}F._inheritsLoose(q,c);var n=q.prototype;n.dispose=function(){};n.drawMany=function(a,f){const {drawPhase:d,styleLayerUID:k}=a,l=a.styleLayer;let g;d===m.WGLDrawPhase.HITTEST&&(g=h.u32to4Xu8(k+1));this._drawIcons(a,l,f,g);this._drawText(a,l,f,g)};n._drawIcons=function(a,f,d,k){const {context:l,
displayLevel:g,drawPhase:t,painter:r,spriteMosaic:w,state:v,styleLayerUID:z}=a,u=f.iconMaterial;var y=r.vectorTilesMaterialManager,D=!1;for(var G of d)if(G.layerData.has(z)){var H=G.layerData.get(z);if(0<H.iconPerPageElementsMap.size){D=!0;break}}if(D){D=f.getPaintValue("icon-translate",g);G=f.getPaintValue("icon-translate-anchor",g);var J=f.getLayoutValue("icon-rotation-alignment",g);2===J&&(J=0===f.getLayoutValue("symbol-placement",g)?1:0);var K=0===J;K=f.getLayoutValue("icon-keep-upright",g)&&
K;var L=H.isIconSDF;H=t===m.WGLDrawPhase.HITTEST;var M=this._iconProgramOptions;M.id=H;M.sdf=L;y=y.getMaterialProgram(l,u,M);l.useProgram(y);y.setUniformMatrix3fv("u_displayViewMat3",0===J?v.displayViewMat3:v.displayMat3);y.setUniformMatrix3fv("u_displayMat3",1===G?v.displayMat3:v.displayViewMat3);y.setUniform2fv("u_iconTranslation",D);y.setUniform1f("u_depth",f.z);y.setUniform1f("u_mapRotation",p.degToByte(v.rotation));y.setUniform1f("u_keepUpright",K?1:0);y.setUniform1f("u_level",10*g);y.setUniform1i("u_texture",
x.VTL_TEXTURE_BINDING_UNIT_SPRITES);y.setUniform1f("u_fadeDuration",B.FADE_DURATION/1E3);H&&y.setUniform4fv("u_id",k);k=-1;for(const N of d)if(N.layerData.has(z)&&(N.key.level!==k&&(k=N.key.level,u.setDataUniforms(y,g,f,k,w)),H=N.layerData.get(z),0!==H.iconPerPageElementsMap.size&&(H.prepareForRendering(l),H.updateOpacityInfo(),d=H.iconVertexArrayObject,!E.isNone(d)))){l.bindVAO(d);y.setUniformMatrix3fv("u_dvsMat3",N.transforms.dvs);y.setUniform1f("u_time",(performance.now()-H.lastOpacityUpdate)/
1E3);for(const [P,I]of H.iconPerPageElementsMap)this._renderIconRange(a,y,I,P,N)}}};n._renderIconRange=function(a,f,d,k,l){const {context:g,spriteMosaic:t}=a;this._spritesTextureSize[0]=t.getWidth(k)/4;this._spritesTextureSize[1]=t.getHeight(k)/4;f.setUniform2fv("u_mosaicSize",this._spritesTextureSize);t.bind(g,9729,k,x.VTL_TEXTURE_BINDING_UNIT_SPRITES);g.setStencilTestEnabled(!0);g.setStencilFunction(516,255,255);g.setStencilWriteMask(0);g.drawElements(4,d[1],5125,Uint32Array.BYTES_PER_ELEMENT*d[0]);
l.triangleCount+=d[1]/3};n._drawText=function(a,f,d,k){const {context:l,displayLevel:g,drawPhase:t,glyphMosaic:r,painter:w,pixelRatio:v,spriteMosaic:z,state:u,styleLayerUID:y}=a;a=f.textMaterial;const D=w.vectorTilesMaterialManager;var G=!1;for(var H of d)if(H.layerData.has(y)){var J=H.layerData.get(y);if(0<J.glyphPerPageElementsMap.size){G=!0;break}}if(G&&(J=f.getPaintProperty("text-opacity"),!J||J.isDataDriven||0!==J.getValue(g))){J=f.getPaintProperty("text-color");var K=!J||J.isDataDriven||0<J.getValue(g)[3];
J=f.getPaintProperty("text-halo-width");H=f.getPaintProperty("text-halo-color");var L=(!J||J.isDataDriven||0<J.getValue(g))&&(!H||H.isDataDriven||0<H.getValue(g)[3]);if(K||L){J=f.getLayoutValue("text-rotation-alignment",g);2===J&&(J=0===f.getLayoutValue("symbol-placement",g)?1:0);H=0===J;H=f.getLayoutValue("text-keep-upright",g)&&H;G=t===m.WGLDrawPhase.HITTEST;var M=.8*3/v;this._glyphTextureSize||(this._glyphTextureSize=C.fromValues(r.width/4,r.height/4));var N=f.getPaintValue("text-translate",g),
P=f.getPaintValue("text-translate-anchor",g),I=this._sdfProgramOptions;I.id=G;var O=D.getMaterialProgram(l,a,I);l.useProgram(O);O.setUniformMatrix3fv("u_displayViewMat3",0===J?u.displayViewMat3:u.displayMat3);O.setUniformMatrix3fv("u_displayMat3",1===P?u.displayMat3:u.displayViewMat3);O.setUniform2fv("u_textTranslation",N);O.setUniform1f("u_depth",f.z+e);O.setUniform2fv("u_mosaicSize",this._glyphTextureSize);O.setUniform1f("u_mapRotation",p.degToByte(u.rotation));O.setUniform1f("u_keepUpright",H?
1:0);O.setUniform1f("u_level",10*g);O.setUniform1i("u_texture",x.VTL_TEXTURE_BINDING_UNIT_GLYPHS);O.setUniform1f("u_antialiasingWidth",M);O.setUniform1f("u_fadeDuration",B.FADE_DURATION/1E3);G&&O.setUniform4fv("u_id",k);k=-1;for(const Q of d)Q.layerData.has(y)&&(Q.key.level!==k&&(k=Q.key.level,a.setDataUniforms(O,g,f,k,z)),J=Q.layerData.get(y),0!==J.glyphPerPageElementsMap.size&&(J.prepareForRendering(l),J.updateOpacityInfo(),d=J.textVertexArrayObject,E.isNone(d)||(l.bindVAO(d),O.setUniformMatrix3fv("u_dvsMat3",
Q.transforms.dvs),l.setStencilTestEnabled(!0),l.setStencilFunction(516,255,255),l.setStencilWriteMask(0),d=(performance.now()-J.lastOpacityUpdate)/1E3,O.setUniform1f("u_time",d),J.glyphPerPageElementsMap.forEach((T,V)=>{this._renderGlyphRange(l,T,V,r,O,L,K,Q)}))))}}};n._renderGlyphRange=function(a,f,d,k,l,g,t,r){k.bind(a,9729,d,x.VTL_TEXTURE_BINDING_UNIT_GLYPHS);g&&(l.setUniform1f("u_halo",1),a.drawElements(4,f[1],5125,Uint32Array.BYTES_PER_ELEMENT*f[0]),r.triangleCount+=f[1]/3);t&&(l.setUniform1f("u_halo",
0),a.drawElements(4,f[1],5125,Uint32Array.BYTES_PER_ELEMENT*f[0]),r.triangleCount+=f[1]/3)};return q}(b);A.WGLBrushVTLSymbol=b;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/decluttering/config":function(){define(["exports"],function(A){A.COLLISION_GRID_CELL_SIZE=32;A.DECLUTTER_BUDGET=1.5;A.DECLUTTER_TILES=!0;A.FADE_DURATION=200;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/GeometryUtils":function(){define(["exports"],function(A){function F(p,
h){p%=h;return 0<=p?p:p+h}const E=Number.POSITIVE_INFINITY,C=Math.PI,B=128/C,x=256/360,m=1/Math.LN2;A.C_256_TO_RAD=C/128;A.C_2PI=2*C;A.C_DEG_TO_256=x;A.C_DEG_TO_RAD=C/180;A.C_INFINITY=E;A.C_PI=C;A.C_PI_BY_2=C/2;A.C_RAD_TO_256=B;A.C_SQRT2=1.414213562;A.C_SQRT2_INV=1/1.414213562;A.between=function(p,h,b){return p>=h&&p<=b||p>=b&&p<=h};A.degToByte=function(p){return F(p*x,256)};A.interpolate=function(p,h,b){return p*(1-b)+h*b};A.log2=function(p){return Math.log(p)*m};A.positiveMod=F;A.radToByte=function(p){return F(p*
B,256)};A.sqr=function(p){return p*p};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushFill":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/RandomLCG ../../../../webgl/BufferObject ../../../../webgl/FramebufferObject ../../../../../core/has ../../../../webgl/checkWebGLError ../../../../webgl/enums ../../../../../chunks/builtins ../../../../webgl/renderState ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ../definitions ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c,q,n,a,f){return function(d){function k(){var g=d.apply(this,arguments)||this;g._dotTextureSize=0;g._dotTextures=null;g._dotSamplers=new Int32Array([c.TEXTURE_BINDING_RENDERER_0,c.TEXTURE_BINDING_RENDERER_1]);return g}A._inheritsLoose(k,d);var l=k.prototype;l.dispose=function(){this._disposeTextures()};l.getGeometryType=function(){return q.WGLGeometryType.FILL};l.drawGeometry=function(g,t,r,w){const {context:v,painter:z,rendererInfo:u,requiredLevel:y}=g;var D=f.FillMaterialKey.load(r.materialKey);
const {bufferLayouts:G,attributes:H}=n.createProgramDescriptor(D.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},...D.dotDensity?[]:[{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_tlbr",count:4,type:5123},{location:4,name:"a_aux1",count:4,type:5121},{location:5,name:"a_aux2",count:2,type:5123},{location:6,name:"a_aux3",count:4,type:5121},{location:7,name:"a_zoomRange",count:2,type:5123}],...D.dotDensity?[{location:2,
name:"a_inverseArea",count:1,type:5126}]:[]]});w=z.materialManager.getMaterialProgram(g,D,"materials/fill",H,w);v.useProgram(w);this._setSharedUniforms(w,g,t);D.textureBinding&&(z.textureManager.bindTextures(v,w,D),w.setUniform1f("u_zoomFactor",1/2**(y-t.key.level)/g.pixelRatio));D.vvColor&&(w.setUniform1fv("u_vvColorValues",u.vvColorValues),w.setUniform4fv("u_vvColors",u.vvColors));D.vvOpacity&&(w.setUniform1fv("u_vvOpacityValues",u.vvOpacityValues),w.setUniform1fv("u_vvOpacities",u.vvOpacities));
if(D.dotDensity){D=c.TILE_SIZE/u.ddDotSize;const J=D*window.devicePixelRatio*D*window.devicePixelRatio;t=1/2**(y-t.key.level);const K=1/t*(1/t);g=u.ddDotScale?g.state.scale/u.ddDotScale:1;w.setUniform1f("u_tileZoomFactor",t);w.setUniform1f("u_tileDotsOverArea",J/(c.TILE_SIZE*window.devicePixelRatio*c.TILE_SIZE*window.devicePixelRatio));w.setUniformMatrix4fv("u_dotColors",u.ddColors);w.setUniform4fv("u_isActive",u.ddActiveDots);w.setUniform4fv("u_dotBackgroundColor",u.ddBackgroundColor);w.setUniform1f("u_dotValue",
Math.max(1,u.ddDotValue*g*K));this._bindDotDensityTextures(v,w,u,D)}r.draw(v,G,H)};l._disposeTextures=function(){if(this._dotTextures){for(let g=0;g<this._dotTextures.length;g++)this._dotTextures[g].dispose();this._dotTextures=null}};l._bindDotDensityTextures=function(g,t,r,w){r=this._createDotDensityTextures(g,w,r.ddSeed);t.setUniform1iv("u_dotTextures",this._dotSamplers);for(t=0;t<r.length;t++)g.bindTexture(r[t],this._dotSamplers[t])};l._createDotDensityTextures=function(g,t,r){if(this._dotTextureSize!==
t||this._seed!==r)this._disposeTextures(),this._dotTextureSize=t,this._seed=r;null===this._dotTextures&&(r=new F(r),this._dotTextures=[this._allocDotDensityTexture(g,t,r),this._allocDotDensityTexture(g,t,r)]);return this._dotTextures};l._allocDotDensityTexture=function(g,t,r){const w=new Float32Array(t*t*4);for(let v=0;v<w.length;v++)w[v]=r.getFloat();return new b(g,{wrapMode:10497,pixelFormat:6408,dataType:5126,samplingMode:9728,width:t,height:t},w)};return k}(a)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrush":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers",
"../../../../../core/maybe","../definitions","./WGLBrush"],function(A,F,E,C){return function(B){function x(){return B.apply(this,arguments)||this}A._inheritsLoose(x,B);var m=x.prototype;m.prepareState=function({context:p},h,b){b=b&&-1!==b.indexOf("id");p.setBlendingEnabled(!b);p.setBlendFunctionSeparate(1,771,1,771);p.setColorMask(!0,!0,!0,!0);p.setStencilWriteMask(0);p.setStencilTestEnabled(!0);p.setStencilFunction(514,h.stencilRef,255)};m.draw=function(p,h,b){var e=this.getGeometryType();h.commit(p);
e=h.getGeometry(e);F.isNone(e)||(p.timeline.begin(this.name),p.attributeView.bindTextures(p.context),e.forEachCommand(c=>this.drawGeometry(p,h,c,b)))};m._setSharedUniforms=function(p,h,b){const {displayLevel:e,pixelRatio:c,state:q}=h;p.setUniform1f("u_pixelRatio",c);p.setUniformMatrix3fv("u_dvsMat3",b.transforms.dvs,!1,!0);p.setUniformMatrix3fv("u_displayViewMat3",q.displayViewMat3,!1,!0);p.setUniform1f("u_currentZoom",Math.round(e*E.MIN_MAX_ZOOM_PRECISION_FACTOR));p.setUniform1i("u_attributeTextureSize",
h.attributeView.size);p.setUniform1i("u_attributeData0",E.TEXTURE_BINDING_ATTRIBUTE_DATA_0);p.setUniform1i("u_attributeData1",E.TEXTURE_BINDING_ATTRIBUTE_DATA_1);p.setUniform1i("u_attributeData2",E.TEXTURE_BINDING_ATTRIBUTE_DATA_2);p.setUniform1i("u_attributeData3",E.TEXTURE_BINDING_ATTRIBUTE_DATA_3)};return x}(C)})},"esri/views/2d/engine/webgl/materialKey/MaterialKey":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/Error","../enums","../mesh/templates/meshUtils"],
function(A,F,E,C,B){function x(k,l=!1){const g=C.WGLVVFlag.SIZE_FIELD_STOPS|C.WGLVVFlag.SIZE_MINMAX_VALUE|C.WGLVVFlag.SIZE_SCALE_STOPS|C.WGLVVFlag.SIZE_UNIT_VALUE;k=(k&(C.WGLVVTarget.FIELD_TARGETS_OUTLINE|C.WGLVVTarget.MINMAX_TARGETS_OUTLINE|C.WGLVVTarget.SCALE_TARGETS_OUTLINE|C.WGLVVTarget.UNIT_TARGETS_OUTLINE))>>>4;return l?g&k:g&~k}function m(k){const l=x(k,!1);return k&(C.WGLVVFlag.COLOR|C.WGLVVFlag.OPACITY|C.WGLVVFlag.ROTATION|l)}let p=function(){function k(g){this._data=0;this._data=g}k.load=
function(g){const t=this.shared;t.data=g;return t};var l=k.prototype;l.setBit=function(g,t){g=1<<g;this._data=t?this._data|g:this._data&~g};l.bit=function(g){return(this._data&1<<g)>>g};l.setBits=function(g,t,r){for(let w=t,v=0;w<r;w++,v++)this.setBit(w,0!==(g&1<<v))};l.bits=function(g,t){let r=0;for(let w=g,v=0;w<t;w++,v++)r|=this.bit(w)<<v;return r};l.hasVV=function(){return!1};l.setVV=function(g,t){};l.getVariation=function(){return{mapAligned:this.mapAligned,pattern:this.pattern,sdf:this.sdf}};
l.getVariationHash=function(){return this._data&~(7&this.textureBinding)};F._createClass(k,[{key:"data",get:function(){return this._data},set:function(g){this._data=g}},{key:"geometryType",get:function(){return this.bits(8,11)},set:function(g){this.setBits(g,8,11)}},{key:"mapAligned",get:function(){return!!this.bit(20)},set:function(g){this.setBit(20,g)}},{key:"sdf",get:function(){return!!this.bit(11)},set:function(g){this.setBit(11,g)}},{key:"pattern",get:function(){return!!this.bit(12)},set:function(g){this.setBit(12,
g)}},{key:"textureBinding",get:function(){return this.bits(0,8)},set:function(g){this.setBits(g,0,8)}},{key:"geometryTypeString",get:function(){switch(this.geometryType){case C.WGLGeometryType.FILL:return"fill";case C.WGLGeometryType.MARKER:return"marker";case C.WGLGeometryType.LINE:return"line";case C.WGLGeometryType.TEXT:return"text";case C.WGLGeometryType.LABEL:return"label";default:throw new E(`Unable to handle unknown geometryType: ${this.geometryType}`);}}}]);return k}();p.shared=new p(0);const h=
k=>function(l){function g(){return l.apply(this,arguments)||this}F._inheritsLoose(g,l);var t=g.prototype;t.hasVV=function(){return l.prototype.hasVV.call(this)||this.vvSizeMinMaxValue||this.vvSizeScaleStops||this.vvSizeFieldStops||this.vvSizeUnitValue};t.setVV=function(r,w){l.prototype.setVV.call(this,r,w);r&=x(r,w);this.vvSizeMinMaxValue=!!(r&C.WGLVVFlag.SIZE_MINMAX_VALUE);this.vvSizeFieldStops=!!(r&C.WGLVVFlag.SIZE_FIELD_STOPS);this.vvSizeUnitValue=!!(r&C.WGLVVFlag.SIZE_UNIT_VALUE);this.vvSizeScaleStops=
!!(r&C.WGLVVFlag.SIZE_SCALE_STOPS)};F._createClass(g,[{key:"vvSizeMinMaxValue",get:function(){return 0!==this.bit(16)},set:function(r){this.setBit(16,r)}},{key:"vvSizeScaleStops",get:function(){return 0!==this.bit(17)},set:function(r){this.setBit(17,r)}},{key:"vvSizeFieldStops",get:function(){return 0!==this.bit(18)},set:function(r){this.setBit(18,r)}},{key:"vvSizeUnitValue",get:function(){return 0!==this.bit(19)},set:function(r){this.setBit(19,r)}}]);return g}(k),b=k=>function(l){function g(){return l.apply(this,
arguments)||this}F._inheritsLoose(g,l);var t=g.prototype;t.hasVV=function(){return l.prototype.hasVV.call(this)||this.vvRotation};t.setVV=function(r,w){l.prototype.setVV.call(this,r,w);this.vvRotation=!w&&!!(r&C.WGLVVFlag.ROTATION)};F._createClass(g,[{key:"vvRotation",get:function(){return 0!==this.bit(15)},set:function(r){this.setBit(15,r)}}]);return g}(k),e=k=>function(l){function g(){return l.apply(this,arguments)||this}F._inheritsLoose(g,l);var t=g.prototype;t.hasVV=function(){return l.prototype.hasVV.call(this)||
this.vvColor};t.setVV=function(r,w){l.prototype.setVV.call(this,r,w);this.vvColor=!w&&!!(r&C.WGLVVFlag.COLOR)};F._createClass(g,[{key:"vvColor",get:function(){return 0!==this.bit(13)},set:function(r){this.setBit(13,r)}}]);return g}(k),c=k=>function(l){function g(){return l.apply(this,arguments)||this}F._inheritsLoose(g,l);var t=g.prototype;t.hasVV=function(){return l.prototype.hasVV.call(this)||this.vvOpacity};t.setVV=function(r,w){l.prototype.setVV.call(this,r,w);this.vvOpacity=!w&&!!(r&C.WGLVVFlag.OPACITY)};
F._createClass(g,[{key:"vvOpacity",get:function(){return 0!==this.bit(14)},set:function(r){this.setBit(14,r)}}]);return g}(k);let q=function(k){function l(){return k.apply(this,arguments)||this}F._inheritsLoose(l,k);l.load=function(g){const t=this.shared;t.data=g;return t};l.from=function(g,t){const r=this.load(0);r.geometryType=C.WGLGeometryType.FILL;t?r.dotDensity=!0:r.setVV(g,!1);return r.data};l.prototype.getVariation=function(){return{...k.prototype.getVariation.call(this),dotDensity:this.dotDensity,
vvColor:this.vvColor,vvOpacity:this.vvOpacity}};F._createClass(l,[{key:"dotDensity",get:function(){return!!this.bit(15)},set:function(g){this.setBit(15,g)}}]);return l}(e(c(p)));q.shared=new q(0);let n=function(k){function l(){return k.apply(this,arguments)||this}F._inheritsLoose(l,k);l.load=function(g){const t=this.shared;t.data=g;return t};l.from=function(g){const t=this.load(0);t.geometryType=C.WGLGeometryType.MARKER;t.setVV(g,!1);return t.data};l.prototype.getVariation=function(){return{...k.prototype.getVariation.call(this),
vvColor:this.vvColor,vvRotation:this.vvRotation,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return l}(e(c(b(h(p)))));n.shared=new n(0);let a=function(k){function l(){return k.apply(this,arguments)||this}F._inheritsLoose(l,k);l.load=function(g){const t=this.shared;t.data=g;return t};l.from=function(g,t){const r=this.load(0);r.geometryType=C.WGLGeometryType.LINE;
r.setVV(g,t);return r.data};l.prototype.getVariation=function(){return{...k.prototype.getVariation.call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return l}(e(c(h(p))));a.shared=new a(0);let f=function(k){function l(){return k.apply(this,arguments)||this}F._inheritsLoose(l,k);l.load=function(g){const t=this.shared;t.data=g;return t};
l.from=function(g){const t=this.load(g);t.geometryType=C.WGLGeometryType.TEXT;t.setVV(g,!1);return t.data};l.prototype.getVariation=function(){return{...k.prototype.getVariation.call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvRotation:this.vvRotation,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return l}(e(c(b(h(p)))));f.shared=new f(0);let d=function(k){function l(){return k.apply(this,
arguments)||this}F._inheritsLoose(l,k);l.load=function(g){const t=this.shared;t.data=g;return t};l.from=function(g,t){const r=this.load(0);r.geometryType=C.WGLGeometryType.LABEL;r.setVV(g,!1);r.mapAligned=B.isMapAligned(t);return r.data};l.prototype.getVariation=function(){return{...k.prototype.getVariation.call(this),vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return l}(h(p));d.shared=
new d(0);A.FillMaterialKey=q;A.LabelMaterialKey=d;A.LineMaterialKey=a;A.MarkerMaterialKey=n;A.MaterialKeyBase=p;A.TextMaterialKey=f;A.createMaterialKey=function(k,l,g,t,r){switch(k){case C.WGLGeometryType.FILL:return q.from(l,t);case C.WGLGeometryType.LINE:return a.from(l,g);case C.WGLGeometryType.MARKER:return n.from(l);case C.WGLGeometryType.TEXT:return f.from(l);case C.WGLGeometryType.LABEL:return d.from(l,r);default:throw Error(`Unable to createMaterialKey for unknown geometryType ${k}`);}};A.getFillVVFlags=
function(k){return k&(C.WGLVVFlag.COLOR|C.WGLVVFlag.OPACITY)};A.getLabelVVFlags=function(k){const l=x(k,!1);return k&l};A.getLineVVFlags=function(k,l){if(l)return l=x(k,!0),k&l;l=x(k,!1);return k&(C.WGLVVFlag.COLOR|C.WGLVVFlag.OPACITY|l)};A.getMarkerVVFlags=m;A.getSizeFlagsMask=x;A.getTextVVFlags=function(k){return m(k)};A.hydrateMaterialKey=function(k){switch(p.load(k).geometryType){case C.WGLGeometryType.MARKER:return new n(k);case C.WGLGeometryType.FILL:return new q(k);case C.WGLGeometryType.LINE:return new a(k);
case C.WGLGeometryType.TEXT:return new f(k);case C.WGLGeometryType.LABEL:return new d(k)}};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/meshUtils":function(){define(["exports"],function(A){A.isMapAligned=function(F){switch(F){case "above-along":case "below-along":case "center-along":case "esriServerLinePlacementAboveAlong":case "esriServerLinePlacementBelowAlong":case "esriServerLinePlacementCenterAlong":return!0;default:return!1}};Object.defineProperty(A,
"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLabel":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../enums","../Utils","./WGLGeometryBrush","../materialKey/MaterialKey"],function(A,F,E,C,B){return function(x){function m(){return x.apply(this,arguments)||this}A._inheritsLoose(m,x);var p=m.prototype;p.dispose=function(){};p.getGeometryType=function(){return F.WGLGeometryType.LABEL};p.drawGeometry=function(h,b,e,c){const {context:q,painter:n,
state:a,rendererInfo:f}=h,d=B.LabelMaterialKey.load(e.materialKey),k=d.mapAligned?1:0;if(k||!(1<=Math.abs(b.key.level-Math.round(100*h.displayLevel)/100))){var {bufferLayouts:l,attributes:g}=E.createProgramDescriptor(d.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_haloColor",count:4,type:5121,normalized:!0},{location:4,name:"a_texAndSize",count:4,type:5121},{location:5,
name:"a_refSymbolAndPlacementOffset",count:4,type:5121},{location:6,name:"a_glyphData",count:4,type:5121},{location:7,name:"a_vertexOffset",count:2,type:5122},{location:8,name:"a_texCoords",count:2,type:5123}]});c=n.materialManager.getMaterialProgram(h,d,"materials/label",g,c);h.context.setStencilFunction(514,0,255);q.useProgram(c);this._setSharedUniforms(c,h,b);n.textureManager.bindTextures(q,c,d);var t=1===k?a.displayViewMat3:a.displayMat3;d.vvSizeMinMaxValue&&c.setUniform4fv("u_vvSizeMinMaxValue",
f.vvSizeMinMaxValue);d.vvSizeScaleStops&&c.setUniform1f("u_vvSizeScaleStopsValue",f.vvSizeScaleStopsValue);d.vvSizeFieldStops&&(b=f.getSizeVVFieldStops(b.key.level),c.setUniform1fv("u_vvSizeFieldStopsValues",b.values),c.setUniform1fv("u_vvSizeFieldStopsSizes",b.sizes));d.vvSizeUnitValue&&c.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",f.vvSizeUnitValueToPixelsRatio);c.setUniform1f("u_mapRotation",Math.floor(a.rotation/360*254));c.setUniform1f("u_mapAligned",k);c.setUniformMatrix3fv("u_displayMat3",
t);c.setUniform1f("u_opacity",1);c.setUniform2fv("u_screenSize",h.state.size);c.setUniform1f("u_isHalo",1);e.draw(q,l,g);c.setUniform1f("u_isHalo",0);e.draw(q,l,g);q.setStencilTestEnabled(!0);q.setBlendingEnabled(!0)}};return m}(C)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLine":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../enums","../Utils","./WGLGeometryBrush","../materialKey/MaterialKey"],function(A,F,E,C,B){return function(x){function m(){return x.apply(this,
arguments)||this}A._inheritsLoose(m,x);var p=m.prototype;p.dispose=function(){};p.getGeometryType=function(){return F.WGLGeometryType.LINE};p.drawGeometry=function(h,b,e,c){const {context:q,painter:n,rendererInfo:a,displayLevel:f}=h,d=B.LineMaterialKey.load(e.materialKey),{bufferLayouts:k,attributes:l}=E.createProgramDescriptor(d.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,
name:"a_offsetAndNormal",count:4,type:5120},{location:4,name:"a_accumulatedDistanceAndHalfWidth",count:2,type:5123},{location:5,name:"a_tlbr",count:4,type:5123},{location:6,name:"a_segmentDirection",count:4,type:5120},{location:7,name:"a_aux",count:2,type:5123},{location:8,name:"a_zoomRange",count:2,type:5123}]});c=n.materialManager.getMaterialProgram(h,d,"materials/line",l,c);const g=1/h.pixelRatio;q.useProgram(c);this._setSharedUniforms(c,h,b);d.textureBinding&&n.textureManager.bindTextures(q,c,
d);c.setUniform1f("u_zoomFactor",2**(f-b.key.level)/h.pixelRatio);c.setUniform1f("u_blur",0+g);c.setUniform1f("u_antialiasing",g);d.vvSizeMinMaxValue&&c.setUniform4fv("u_vvSizeMinMaxValue",a.vvSizeMinMaxValue);d.vvSizeScaleStops&&c.setUniform1f("u_vvSizeScaleStopsValue",a.vvSizeScaleStopsValue);d.vvSizeFieldStops&&(h=a.getSizeVVFieldStops(b.key.level),c.setUniform1fv("u_vvSizeFieldStopsValues",h.values),c.setUniform1fv("u_vvSizeFieldStopsSizes",h.sizes));d.vvSizeUnitValue&&c.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",
a.vvSizeUnitValueToPixelsRatio);d.vvColor&&(c.setUniform1fv("u_vvColorValues",a.vvColorValues),c.setUniform4fv("u_vvColors",a.vvColors));d.vvOpacity&&(c.setUniform1fv("u_vvOpacityValues",a.vvOpacityValues),c.setUniform1fv("u_vvOpacities",a.vvOpacities));q.setFaceCullingEnabled(!1);e.draw(q,k,l)};return m}(C)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushMarker":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../enums","../Utils","./WGLGeometryBrush","../materialKey/MaterialKey"],
function(A,F,E,C,B){return function(x){function m(){return x.apply(this,arguments)||this}A._inheritsLoose(m,x);var p=m.prototype;p.dispose=function(){};p.getGeometryType=function(){return F.WGLGeometryType.MARKER};p.drawGeometry=function(h,b,e,c){const {context:q,painter:n,rendererInfo:a,state:f}=h,d=B.MarkerMaterialKey.load(e.materialKey),{bufferLayouts:k,attributes:l}=E.createProgramDescriptor(d.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_vertexOffset",count:2,
type:5122},{location:2,name:"a_texCoords",count:2,type:5123},{location:3,name:"a_bitSetAndDistRatio",count:2,type:5123},{location:4,name:"a_id",count:4,type:5121},{location:5,name:"a_color",count:4,type:5121,normalized:!0},{location:6,name:"a_outlineColor",count:4,type:5121,normalized:!0},{location:7,name:"a_sizeAndOutlineWidth",count:4,type:5121},{location:8,name:"a_zoomRange",count:2,type:5123}]});c=n.materialManager.getMaterialProgram(h,d,"materials/icon",l,c);q.useProgram(c);d.textureBinding&&
n.textureManager.bindTextures(q,c,d,!0);this._setSharedUniforms(c,h,b);c.setUniformMatrix3fv("u_displayMat3",d.vvRotation?f.displayViewMat3:f.displayMat3);d.vvSizeMinMaxValue&&c.setUniform4fv("u_vvSizeMinMaxValue",a.vvSizeMinMaxValue);d.vvSizeScaleStops&&c.setUniform1f("u_vvSizeScaleStopsValue",a.vvSizeScaleStopsValue);d.vvSizeFieldStops&&(h=a.getSizeVVFieldStops(b.key.level),c.setUniform1fv("u_vvSizeFieldStopsValues",h.values),c.setUniform1fv("u_vvSizeFieldStopsSizes",h.sizes));d.vvSizeUnitValue&&
c.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",a.vvSizeUnitValueToPixelsRatio);d.vvColor&&(c.setUniform1fv("u_vvColorValues",a.vvColorValues),c.setUniform4fv("u_vvColors",a.vvColors));d.vvOpacity&&(c.setUniform1fv("u_vvOpacityValues",a.vvOpacityValues),c.setUniform1fv("u_vvOpacities",a.vvOpacities));d.vvRotation&&c.setUniform1f("u_vvRotationType","geographic"===a.vvMaterialParameters.vvRotationType?0:1);e.draw(q,k,l)};return m}(C)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushText":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers",
"../enums","../Utils","./WGLGeometryBrush","../materialKey/MaterialKey"],function(A,F,E,C,B){return function(x){function m(){return x.apply(this,arguments)||this}A._inheritsLoose(m,x);var p=m.prototype;p.dispose=function(){};p.getGeometryType=function(){return F.WGLGeometryType.TEXT};p.drawGeometry=function(h,b,e,c){const {context:q,painter:n,rendererInfo:a,state:f}=h,d=B.TextMaterialKey.load(e.materialKey),{bufferLayouts:k,attributes:l}=E.createProgramDescriptor(d.data,{geometry:[{location:0,name:"a_pos",
count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_haloColor",count:4,type:5121,normalized:!0},{location:4,name:"a_texFontSize",count:4,type:5121},{location:5,name:"a_aux",count:4,type:5120},{location:6,name:"a_zoomRange",count:2,type:5123},{location:7,name:"a_vertexOffset",count:2,type:5122},{location:8,name:"a_texCoords",count:2,type:5123}]});c=n.materialManager.getMaterialProgram(h,d,"materials/text",l,c);
q.useProgram(c);this._setSharedUniforms(c,h,b);n.textureManager.bindTextures(q,c,d);c.setUniformMatrix3fv("u_displayMat3",f.displayMat3);c.setUniformMatrix3fv("u_displayViewMat3",f.displayViewMat3);d.vvSizeMinMaxValue&&c.setUniform4fv("u_vvSizeMinMaxValue",a.vvSizeMinMaxValue);d.vvSizeScaleStops&&c.setUniform1f("u_vvSizeScaleStopsValue",a.vvSizeScaleStopsValue);d.vvSizeFieldStops&&(h=a.getSizeVVFieldStops(b.key.level),c.setUniform1fv("u_vvSizeFieldStopsValues",h.values),c.setUniform1fv("u_vvSizeFieldStopsSizes",
h.sizes));d.vvSizeUnitValue&&c.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",a.vvSizeUnitValueToPixelsRatio);d.vvColor&&(c.setUniform1fv("u_vvColorValues",a.vvColorValues),c.setUniform4fv("u_vvColors",a.vvColors));d.vvOpacity&&(c.setUniform1fv("u_vvOpacityValues",a.vvOpacityValues),c.setUniform1fv("u_vvOpacities",a.vvOpacities));d.vvRotation&&c.setUniform1f("u_vvRotationType","geographic"===a.vvMaterialParameters.vvRotationType?0:1);c.setUniform1f("u_isHalo",1);e.draw(q,k,l);c.setUniform1f("u_isHalo",
0);e.draw(q,k,l)};return m}(C)})},"esri/views/2d/engine/webgl/brushes/raster/BrushRasterBitmap":function(){define(["../../../../../../chunks/_rollupPluginBabelHelpers","../../../RasterBitmap","../../VertexStream","../WGLBrush","../../../../../webgl/rasterUtils"],function(A,F,E,C,B){return function(x){function m(){var h=x.apply(this,arguments)||this;h._desc={lut:{vsPath:"raster/lut",fsPath:"raster/lut",attributes:new Map([["a_position",0],["a_texcoord",1]])},stretch:{vsPath:"raster/stretch",fsPath:"raster/stretch",
attributes:new Map([["a_position",0],["a_texcoord",1]])},hillshade:{vsPath:"raster/hillshade",fsPath:"raster/hillshade",attributes:new Map([["a_position",0],["a_texcoord",1]])}};h._rendererUniformInfos=new Map;return h}A._inheritsLoose(m,x);var p=m.prototype;p.dispose=function(){this._quad&&this._quad.dispose()};p.prepareState=function({context:h},b){h.setBlendingEnabled(!0);h.setBlendFunctionSeparate(1,771,1,771);h.setColorMask(!0,!0,!0,!0);h.setStencilWriteMask(0);h.setStencilTestEnabled(!0);h.setStencilFunction(514,
b.stencilRef,255)};p.draw=function(h,b){var e;if(F.hasSource(b)&&!b.suspended){h.timeline.begin(this.name);var c=!(null!=(e=h.context.capabilities.textureFloat)&&e.textureFloatLinear);b.updateTexture(h);e=this.getShaderVariations(b,c);e=h.painter.materialManager.getProgram(h,this._desc[b.symbolizerParameters.type],e);this.drawWithProgram(h.context,e,b);h.timeline.end(this.name)}};p.drawWithProgram=function(h,b,e,c=1,q=[0,0],n=!1){this._quad||(this._quad=new E(h,[0,0,1,0,0,1,1,1]));const {symbolizerParameters:a,
transformGrid:f,width:d,height:k,opacity:l}=e;var g=a.type;h.useProgram(b);const t=this.getShaderVariations(e);g=this.getUniformInfos(g,h,b,t);const {names:r,textures:w}=e.getTextures();B.setTextures(h,b,r,w);h=B.getBasicGridUniforms(c,q);n=B.getCommonUniforms(f,[d,k],[e.source.width,e.source.height],l,n);B.setUniforms(b,g,{u_coordScale:e.coordScale,u_dvsMat3:e.transforms.dvs,...h,...n});if(a.colormap){const {colormap:v,colormapOffset:z}=a;e=B.getColormapUniforms(v,z);B.setUniforms(b,g,e)}"stretch"===
a.type?(e=B.getStretchUniforms(a),B.setUniforms(b,g,e)):"hillshade"===a.type&&(e=B.getShadedReliefUniforms(a),B.setUniforms(b,g,e));this._quad.draw()};p.getUniformInfos=function(h,b,e,c){h=0<c.length?h+"-"+c.join("-"):h;if(this._rendererUniformInfos.has(h))return this._rendererUniformInfos.get(h);b=B.getUniformLocationInfos(b,e);this._rendererUniformInfos.set(h,b);return b};p.getShaderVariations=function(h,b=!1){const e=[],{interpolation:c}=h,{type:q,colormap:n}=h.symbolizerParameters;"cubic"===c?
e.push("bicubic"):"bilinear"===c&&"stretch"===q&&null!=n?(e.push("bilinear"),e.push("nnedge")):b&&"bilinear"===c&&e.push("bilinear");h.isRendereredSource?e.push("noop"):n&&e.push("applyColormap");h.transformGrid&&e.push("applyProjection");return e};return m}(C)})},"esri/views/2d/engine/RasterBitmap":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/mat3 ../../../chunks/mat3f32 ../../../chunks/vec2f32 ../../../layers/support/rasterFunctions/pixelUtils ./DisplayObject ../../webgl/rasterUtils".split(" "),
function(A,F,E,C,B,x,m,p,h){const b={bandCount:3,outMin:0,outMax:1,minCutOff:[0,0,0],maxCutOff:[255,255,255],factor:[1/255,1/255,1/255],useGamma:!1,gamma:[1,1,1],gammaCorrection:[1,1,1],colormap:null,colormapOffset:null,stretchType:"none",type:"stretch"};p=function(c){function q(a=null,f=null,d=null){var k=c.call(this)||this;k._textureInvalidated=!0;k._colormapTextureInvalidated=!0;k._supportsBilinearTexture=!0;k.stencilRef=0;k.coordScale=[1,1];k._symbolizerParameters=null;k.height=null;k.isRendereredSource=
!1;k.pixelRatio=1;k.resolution=0;k.rotation=0;k._source=null;k.rawPixelData=null;k._suspended=!1;k._bandIds=null;k._interpolation=null;k._transformGrid=null;k.width=null;k.x=0;k.y=0;k.source=a;k.transformGrid=f;k.interpolation=d;return k}F._inheritsLoose(q,c);var n=q.prototype;n.destroy=function(){const a=this.getTextures();null==a?void 0:a.textures.forEach(f=>f.dispose());this._colormapTexture=this._transformGridTexture=this._rasterTexture=null};n.invalidateTexture=function(){this._textureInvalidated||
(this._textureInvalidated=!0,this.requestRender())};n._createTransforms=function(){return{dvs:B.create()}};n.setTransform=function(a){const f=C.identity(this.transforms.dvs),[d,k]=a.toScreenNoRotation([0,0],[this.x,this.y]);var l=this.resolution/this.pixelRatio/a.resolution;const g=l*this.width;l*=this.height;const t=Math.PI*this.rotation/180;C.translate(f,f,x.fromValues(d,k));C.translate(f,f,x.fromValues(g/2,l/2));C.rotate(f,f,-t);C.translate(f,f,x.fromValues(-g/2,-l/2));C.scaleByVec2(f,f,x.fromValues(g,
l));C.multiply(this.transforms.dvs,a.displayViewMat3,f)};n.getTextures=function(){if(!this._rasterTexture)return null;const a=[],f=[];this._transformGridTexture&&(f.push(this._transformGridTexture),a.push("u_transformGrid"));this._rasterTexture&&(f.push(this._rasterTexture),a.push("u_image"));this._colormapTexture&&(f.push(this._colormapTexture),a.push("u_colormap"));return{names:a,textures:f}};n.onAttach=function(){this.invalidateTexture()};n.onDetach=function(){this.invalidateTexture()};n.updateTexture=
function({context:a}){if(this.stage){var f=this._isValidSource(this.source);f&&this._colormapTextureInvalidated&&(this._colormapTextureInvalidated=!1,this._updateColormapTexture(a));this._textureInvalidated&&(this._textureInvalidated=!1,this._createOrDestroyRasterTexture(a),this._rasterTexture&&(f?this.transformGrid&&!this._transformGridTexture&&(this._transformGridTexture=h.createTransformTexture(a,this.transformGrid)):this._rasterTexture.setData(null)),this.suspended||(this.ready(),this.requestRender()))}else{var d,
k;null==(f=this._rasterTexture)?void 0:f.dispose();null==(d=this._transformGridTexture)?void 0:d.dispose();null==(k=this._colormapTexture)?void 0:k.dispose();this._colormapTexture=this._transformGridTexture=this._rasterTextureBandIds=this._rasterTexture=null}};n._createOrDestroyRasterTexture=function(a){var f,d;const k=E.isSome(this.source)?m.extractBands(this.source,this.bandIds):null;if(this._isValidSource(k)){var l=!this._isBandIdschanged(this.bandIds);if(this._rasterTexture){if(l)return;this._rasterTexture.dispose();
this._rasterTexture=this._rasterTextureBandIds=null}this._supportsBilinearTexture=null==(f=a.capabilities.textureFloat)?void 0:f.textureFloatLinear;f=this._getTextureSamplingMethod(this.interpolation);l=this.isRendereredSource||!(null!=(d=a.capabilities.textureFloat)&&d.textureFloat);this._rasterTexture=h.createRasterTexture(a,k,f,l);this._rasterTextureBandIds=this.bandIds?[...this.bandIds]:null}else this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTexture=this._rasterTextureBandIds=
null)};n._isBandIdschanged=function(a){const f=this._rasterTextureBandIds;return!(null==f&&null==a||f&&a&&f.join("")===a.join(""))};n._isValidSource=function(a){var f;return E.isSome(a)&&0<(null==(f=a.pixels)?void 0:f.length)};n._getTextureSamplingMethod=function(a){const {type:f,colormap:d}=this.symbolizerParameters,k="lut"===f||"stretch"===f&&E.isSome(d);return!this._supportsBilinearTexture||k||"bilinear"!==a&&"cubic"!==a?"nearest":"bilinear"};n._updateColormapTexture=function(a){const f=this._colormap,
d=this.symbolizerParameters.colormap;if(!d)this._colormapTexture&&(this._colormapTexture.dispose(),this._colormapTexture=null),this._colormap=null;else if(!f)this._colormapTexture=h.createColormapTexture(a,d),this._colormap=d;else if(d.length!==f.length||d.some((k,l)=>k!==f[l]))this._colormapTexture&&(this._colormapTexture.dispose(),this._colormapTexture=null),this._colormapTexture=h.createColormapTexture(a,d),this._colormap=d};F._createClass(q,[{key:"symbolizerParameters",get:function(){return this._symbolizerParameters||
b},set:function(a){this._symbolizerParameters!==a&&(this._symbolizerParameters=a,this._colormapTextureInvalidated=!0)}},{key:"source",get:function(){return this._source},set:function(a){this._source!==a&&(this._source=a,this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTextureBandIds=this._rasterTexture=null),this.invalidateTexture())}},{key:"suspended",get:function(){return this._suspended},set:function(a){this._suspended&&!a&&this.stage&&(this.ready(),this.requestRender());this._suspended=
a}},{key:"bandIds",get:function(){return this._bandIds},set:function(a){this._bandIds=a;this._isBandIdschanged(a)&&this.invalidateTexture()}},{key:"interpolation",get:function(){return this._interpolation||"nearest"},set:function(a){this._interpolation=a;this._rasterTexture&&this._rasterTexture.setSamplingMode("bilinear"===this._getTextureSamplingMethod(a)?9729:9728)}},{key:"transformGrid",get:function(){return this._transformGrid},set:function(a){this._transformGrid=a;this._transformGridTexture&&
(this._transformGridTexture.dispose(),this._transformGridTexture=null)}}]);return q}(p.DisplayObject);let e=function(c){function q(){return c.apply(this,arguments)||this}F._inheritsLoose(q,c);F._createClass(q,[{key:"source",get:function(){return this._source}}]);return q}(p);A.RasterBitmap=p;A.RasterBitmapWithSource=e;A.hasSource=function(c){return E.isSome(c.source)};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/layers/support/rasterFunctions/pixelUtils":function(){define(["exports",
"../../../core/maybe","../PixelBlock"],function(A,F,E){function C(a){return F.isSome(a)&&"esri.layers.support.PixelBlock"===a.declaredClass&&a.pixels&&0<a.pixels.length}function B(a,f){a=Math.min(Math.max(a,-100),100);f=Math.min(Math.max(f,-100),100);let d,k;const l=new Uint8Array(256);for(d=0;256>d;d++)0<a&&100>a?k=(200*d-25500+510*f)/(2*(100-a))+128:0>=a&&-100<a?k=(200*d-25500+510*f)*(100+a)/2E4+128:100===a?(k=200*d-25500+256*(100-a)+510*f,k=0<k?255:0):-100===a&&(k=128),l[d]=255<k?255:0>k?0:k;return l}
function x(a,f,d,k,l,g,t,r){return{xmin:l<=d*a?0:l<d*a+a?l-d*a:a,ymin:g<=k*f?0:g<k*f+f?g-k*f:f,xmax:l+t<=d*a?0:l+t<d*a+a?l+t-d*a:a,ymax:g+r<=k*f?0:g+r<k*f+f?g+r-k*f:f}}function m(a,f,d,k,l,g){const {width:t,height:r}=d.block,{x:w,y:v}=d.offset,{width:z,height:u}=d.mosaic;d=x(t,r,k,l,w,v,z,u);let y=0;var D=0;if(g){var G=g.hasGCSSShiftTransform?360:g.halfWorldWidth,H=t*g.resolutionX,J=g.startX+k*H;H=J+H;J<G&&H>G?D=g.rightPadding:J>=G&&(y=g.leftMargin-g.rightPadding,D=0)}d.xmax-=D;if("number"===typeof f)for(g=
d.ymin;g<d.ymax;g++)for(D=(l*r+g-v)*z+(k*t-w)+y,G=d.xmin;G<d.xmax;G++)a[D+G]=f;else for(g=d.ymin;g<d.ymax;g++)for(D=(l*r+g-v)*z+(k*t-w)+y,G=g*t,J=d.xmin;J<d.xmax;J++)a[D+J]=f[G+J]}function p(a,f,d,k,l){var g=a.filter(H=>C(H))[0];if(F.isNone(g))return null;const t=k?k.width:f.width,r=k?k.height:f.height;var w=g.width,v=g.height;const z=f.width/w,u=f.height/v;f={offset:d||{x:0,y:0},mosaic:k||f,block:{width:w,height:v}};d=g.pixelType;k=E.getPixelArrayConstructor(d);w=g.pixels.length;g=[];for(var y=0;y<
w;y++){v=new k(t*r);for(let H=0;H<u;H++)for(let J=0;J<z;J++){var D=a[H*z+J];C(D)&&(D=D.pixels[y],m(v,D,f,J,H,l))}g.push(v)}let G;if(a.some(H=>F.isNone(H)||H.mask&&0<H.mask.length))for(G=new Uint8Array(t*r),k=0;k<u;k++)for(w=0;w<z;w++)v=a[k*z+w],(y=F.isSome(v)?v.mask:null)?m(G,y,f,w,k,l):v?m(G,1,f,w,k,l):m(G,0,f,w,k,l);a=new E({width:t,height:r,pixels:g,pixelType:d,mask:G});a.updateStatistics();return a}function h(a){if(!C(a))return null;const f=a.clone(),{width:d,height:k,pixels:l,mask:g}=a;var t=
l[0];a=f.pixels[0];for(let v=2;v<k-1;v++){const z=new Map;for(var r=v-2;r<v+2;r++)for(var w=0;4>w;w++){const u=r*d+w;c(z,t[u],g?g[u]:1)}a[v*d]=b(z);a[v*d+1]=a[v*d+2]=a[v*d];for(r=3;r<d-1;r++)w=(v-2)*d+r+1,c(z,t[w],g?g[w]:1),w=(v-1)*d+r+1,c(z,t[w],g?g[w]:1),w=v*d+r+1,c(z,t[w],g?g[w]:1),w=(v+1)*d+r+1,c(z,t[w],g?g[w]:1),w=(v-2)*d+r-3,e(z,t[w],g?g[w]:1),w=(v-1)*d+r-3,e(z,t[w],g?g[w]:1),w=v*d+r-3,e(z,t[w],g?g[w]:1),w=(v+1)*d+r-3,e(z,t[w],g?g[w]:1),a[v*d+r]=b(z);a[v*d+r+1]=a[v*d+r]}for(t=0;t<d;t++)a[t]=
a[d+t]=a[2*d+t],a[(k-1)*d+t]=a[(k-2)*d+t];f.updateStatistics();return f}function b(a){if(0===a.size)return 0;let f=0,d=-1,k=0;const l=a.keys();let g=l.next();for(;!g.done;)k=a.get(g.value),k>f&&(d=g.value,f=k),g=l.next();return d}function e(a,f,d){0!==d&&(d=a.get(f),1===d?a.delete(f):a.set(f,d-1))}function c(a,f,d){0!==d&&a.set(f,a.has(f)?a.get(f)+1:1)}function q(a,f,d){let {x:k,y:l}=f;const {width:g,height:t}=d;if(0===k&&0===l&&t===a.height&&g===a.width)return a;const {width:r,height:w}=a;f=Math.max(0,
l);const v=Math.max(0,k),z=Math.min(k+g,r),u=Math.min(l+t,w);if(0>z||0>u||!C(a))return null;k=Math.max(0,-k);l=Math.max(0,-l);const {pixels:y,mask:D}=a;var G=g*t,H=y.length;const J=[];for(var K=0;K<H;K++){var L=y[K],M=E.createEmptyBand(a.pixelType,G);for(let N=f;N<u;N++){const P=N*r;let I=(N+l-f)*g+k;for(let O=v;O<z;O++)M[I++]=L[P+O]}J.push(M)}G=new Uint8Array(G);for(H=f;H<u;H++)for(K=H*r,L=(H+l-f)*g+k,M=v;M<z;M++)G[L++]=D?D[K+M]:1;a=new E({width:d.width,height:d.height,pixelType:a.pixelType,pixels:J,
mask:G});a.updateStatistics();return a}function n(a,f=!0){if(!C(a))return null;const {pixels:d,width:k,height:l,mask:g,pixelType:t}=a;a=[];const r=Math.round(k/2),w=Math.round(l/2),v=l-1,z=k-1;for(var u=0;u<d.length;u++){var y=d[u],D=E.createEmptyBand(t,r*w),G=0;for(var H=0;H<l;H+=2)for(var J=0;J<k;J+=2){var K=y[H*k+J];if(f){var L=J===z?K:y[H*k+J+1];const M=H===v?K:y[H*k+J+k],N=J===z?M:H===v?L:y[H*k+J+k+1];D[G++]=(K+L+M+N)/4}else D[G++]=K}a.push(D)}u=null;if(g)for(u=new Uint8Array(r*w),y=0,D=0;D<
l;D+=2)for(G=0;G<k;G+=2)H=g[D*k+G],f?(J=G===z?H:g[D*k+G+1],K=D===v?H:g[D*k+G+k],L=G===z?K:D===v?J:g[D*k+G+k+1],u[y++]=H*J*K*L?1:0):u[y++]=H;return new E({width:r,height:w,pixelType:t,pixels:a,mask:u})}A.approximateTransform=function(a,f,d,k,l="nearest"){if(!C(a))return null;"majority"===l&&(a=h(a));const {pixels:g,mask:t,pixelType:r}=a,w=a.width;var v=a.height;a=E.getPixelArrayConstructor(r);var z=g.length;const {width:u,height:y}=f;f=k.cols;var D=k.rows;const G=Math.ceil(u/f-.1/f),H=Math.ceil(y/
D-.1/D);k=!1;for(var J=0;J<d.length;J+=3)-1===d[J]&&-1===d[J+1]&&-1===d[J+2]&&(k=!0);let K,L,M,N,P,I;const O=G*f;J=O*H*D;const Q=new Float32Array(J),T=new Float32Array(J);J=0;let V,aa;const Z="majority"===l?0:.5;for(let U=0;U<H;U++)for(let X=0;X<G;X++){K=12*(U*G+X);l=d[K];L=d[K+1];M=d[K+2];N=d[K+3];P=d[K+4];I=d[K+5];for(var R=0;R<D;R++){J=(U*D+R)*O+X*f;aa=(R+.5)/D;for(var S=0;S<R;S++)V=(S+.5)/f,Q[J+S]=Math.round((l*V+L*aa+M)*w-Z),T[J+S]=Math.round((N*V+P*aa+I)*v-Z)}K+=6;l=d[K];L=d[K+1];M=d[K+2];N=
d[K+3];P=d[K+4];I=d[K+5];for(R=0;R<D;R++)for(J=(U*D+R)*O+X*f,aa=(R+.5)/D,S=R;S<f;S++)V=(S+.5)/f,Q[J+S]=Math.round((l*V+L*aa+M)*w-Z),T[J+S]=Math.round((N*V+P*aa+I)*v-Z)}d=(U,X)=>{for(let fa=0;fa<y;fa++){K=fa*O;for(let ea=0;ea<u;ea++)U[fa*u+ea]=0>Q[K]||0>T[K]?0:X[Q[K]+T[K]*w],K++}};v=[];for(D=0;D<z;D++)f=new a(u*y),d(f,g[D]),v.push(f);a=new E({width:u,height:y,pixelType:r,pixels:v});if(t)a.mask=new Uint8Array(u*y),d(a.mask,t);else if(k)for(a.mask=new Uint8Array(u*y),z=0;z<u*y;z++)a.mask[z]=0>Q[z]||
0>T[z]?0:1;a.updateStatistics();return a};A.clip=q;A.colorize=function(a,f){if(!C(a)||!f&&(f.indexedColormap||f.indexed2DColormap))return a;const d=a.clone();var k=d.pixels;let l=d.mask;const g=d.width*d.height;if(1!==k.length)return a;const {indexedColormap:t,indexed2DColormap:r,offset:w,alphaSpecified:v}=f;f=t.length-1;a=0;k=k[0];const z=new Uint8Array(k.length),u=new Uint8Array(k.length),y=new Uint8Array(k.length);let D=0;if(t)if(l)for(a=0;a<g;a++)l[a]&&(D=4*(k[a]-w),D<w||D>f?l[a]=0:(z[a]=t[D],
u[a]=t[D+1],y[a]=t[D+2],l[a]=t[D+3]));else{l=new Uint8Array(g);for(a=0;a<g;a++)D=4*(k[a]-w),D<w||D>f?l[a]=0:(z[a]=t[D],u[a]=t[D+1],y[a]=t[D+2],l[a]=t[D+3]);d.mask=l}else if(l)for(a=0;a<g;a++)l[a]&&(f=r[k[a]],z[a]=f[0],u[a]=f[1],y[a]=f[2],l[a]=f[3]);else{l=new Uint8Array(g);for(a=0;a<g;a++)f=r[k[a]],z[a]=f[0],u[a]=f[1],y[a]=f[2],l[a]=f[3];d.mask=l}d.pixels=[z,u,y];d.statistics=null;d.pixelType="u8";d.maskIsAlpha=v;return d};A.createColormapLUT=function(a){if(a){var f=a.colormap;if(f&&0!==f.length){f=
f.sort((v,z)=>v[0]-z[0]);var d=0;0>f[0][0]&&(d=f[0][0]);var k=Math.max(256,f[f.length-1][0]-d+1),l=new Uint8Array(4*k),g=[],t=0,r=0,w=5===f[0].length;if(65536<k)return f.forEach(v=>{g[v[0]-d]=w?v.slice(1):v.slice(1).concat([255])}),{indexed2DColormap:g,offset:d,alphaSpecified:w};if(a.fillUnspecified)for(a=f[r],t=a[0]-d;t<k;t++)l[4*t]=a[1],l[4*t+1]=a[2],l[4*t+2]=a[3],l[4*t+3]=w?a[4]:255,t===a[0]-d&&(a=r===f.length-1?a:f[++r]);else for(t=0;t<f.length;t++)a=f[t],r=4*(a[0]-d),l[r]=a[1],l[r+1]=a[2],l[r+
2]=a[3],l[r+3]=w?a[4]:255;return{indexedColormap:l,offset:d,alphaSpecified:w}}}};A.createContrastBrightnessLUT=B;A.createHistogramEqualizationLUT=function(a,f=256){f=Math.min(f,256);const {size:d,counts:k}=a;a=new Uint8Array(d);var l=k.reduce((v,z)=>v+z/f,0);let g=0;var t=0;let r=0,w=l;for(let v=0;v<d;v++)if(r+=k[v],!(v<d-1&&r+k[v+1]<w)){for(;g<f-1&&w<r;)g++,w+=l;for(;t<=v;t++)a[t]=g;t=v+1}for(l=t;l<d;l++)a[l]=f-1;return a};A.createStretchLUT=function(a){const {minCutOff:f,maxCutOff:d,gamma:k,pixelType:l}=
a,g=a.outMin||0,t=a.outMax||255;if(-1===["u8","u16","s8","s16"].indexOf(l))return null;const r=f.length;let w;let v=0;"s8"===l?v=-127:"s16"===l&&(v=-32767);let z=256;-1<["u16","s16"].indexOf(l)&&(z=65536);const u=[],y=t-g;for(w=0;w<r;w++)u[w]=d[w]-f[w];var D=k&&k.length>=r;const G=[];if(D)for(w=0;w<r;w++)G[w]=1<k[w]?2<k[w]?6.5+(k[w]-2)**2.5:6.5+100*(2-k[w])**4:1;let H;const J=[];let K,L,M;if(D)for(w=0;w<r;w++){M=[];for(D=0;D<z;D++)K=D+v,H=(K-f[w])/u[w],L=1,1<k[w]&&(L-=(1/y)**(H*G[w])),M[D]=K<d[w]&&
K>f[w]?Math.floor(L*y*H**(1/k[w]))+g:K>=d[w]?t:g;J[w]=M}else for(w=0;w<r;w++){M=[];for(D=0;D<z;D++)K=D+v,M[D]=K<=f[w]?g:K>=d[w]?t:Math.floor((K-f[w])/u[w]*y)+g;J[w]=M}if(null!=a.contrastOffset)for(a=B(a.contrastOffset,a.brightnessOffset),w=0;w<r;w++)for(M=J[w],D=0;D<z;D++)M[D]=a[M[D]];return{lut:J,offset:v}};A.estimateStatisticsFromHistograms=function(a){const f=[];for(let g=0;g<a.length;g++){const {min:t,max:r,size:w,counts:v}=a[g];let z=0;var d=0;for(var k=0;k<w;k++)z+=v[k],d+=k*v[k];d/=z;k=0;for(var l=
0;l<w;l++)k+=v[l]*(l-d)**2;l=(r-t)/w;f.push({min:t,max:r,avg:(d+.5)*l+t,stddev:Math.sqrt(k/(z-1))*l})}return f};A.estimateStatisticsHistograms=function(a){if(!C(a))return null;a.statistics||a.updateStatistics();const {pixels:f,mask:d,pixelType:k,statistics:l}=a;a=a.width*a.height;const g=f.length;let t,r;let w;var v;const z=[],u=[];for(w=0;w<g;w++){var y=new Uint32Array(256);var D=f[w];if("u8"===k)if(t=-.5,r=255.5,d)for(v=0;v<a;v++)d[v]&&y[D[v]]++;else for(v=0;v<a;v++)y[D[v]]++;else{t=l[w].minValue;
r=l[w].maxValue;var G=(r-t)/256;var H=new Uint32Array(257);if(d)for(v=0;v<a;v++)d[v]&&H[Math.floor((D[v]-t)/G)]++;else for(v=0;v<a;v++)H[Math.floor((D[v]-t)/G)]++;for(v=0;255>v;v++)y[v]=H[v];y[255]=H[255]+H[256]}z.push({min:t,max:r,size:256,counts:y});for(v=D=H=G=0;256>v;v++)G+=y[v],H+=v*y[v];H/=G;for(v=0;256>v;v++)D+=y[v]*(v-H)**2;y=Math.sqrt(D/(G-1));G=(r-t)/256;v=(H+.5)*G+t;y*=G;u.push({min:t,max:r,avg:v,stddev:y})}return{statistics:u,histograms:z}};A.extractBands=function(a,f){if(null==f||!f.length||
!C(a))return a;const d=a.pixels.length;return f&&f.some(k=>k>=d)||1===d&&1===f.length&&0===f[0]||d===f.length&&!f.some((k,l)=>k!==l)?a:new E({pixelType:a.pixelType,width:a.width,height:a.height,mask:a.mask,validPixelCount:a.validPixelCount,maskIsAlpha:a.maskIsAlpha,pixels:f.map(k=>a.pixels[k]),statistics:a.statistics&&f.map(k=>a.statistics[k])})};A.getClipBounds=x;A.isValidPixelBlock=C;A.lookupPixels=function(a,f){if(!C(a))return null;const {pixels:d,mask:k}=a,l=a.width*a.height,g=d.length;let t=
f.lut;({offset:f}=f);let r,w;t&&1===t[0].length&&(t=d.map(()=>t));const v=[];let z,u,y;if(f)if(null==k)for(r=0;r<g;r++){z=d[r];u=t[r];y=new Uint8Array(l);for(w=0;w<l;w++)y[w]=u[z[w]-f];v.push(y)}else for(r=0;r<g;r++){z=d[r];u=t[r];y=new Uint8Array(l);for(w=0;w<l;w++)k[w]&&(y[w]=u[z[w]-f]);v.push(y)}else if(null==k)for(r=0;r<g;r++){z=d[r];u=t[r];y=new Uint8Array(l);for(w=0;w<l;w++)y[w]=u[z[w]];v.push(y)}else for(r=0;r<g;r++){z=d[r];u=t[r];y=new Uint8Array(l);for(w=0;w<l;w++)k[w]&&(y[w]=u[z[w]]);v.push(y)}a=
new E({width:a.width,height:a.height,pixels:v,mask:k,pixelType:"u8"});a.updateStatistics();return a};A.mosaic=p;A.mosaicPixelData=function(a,f){if(!a||0===a.length)return null;var d=a.filter(u=>u.pixelBlock)[0];if(!d||F.isNone(d.pixelBlock))return null;var k=(d.extent.xmax-d.extent.xmin)/d.pixelBlock.width;const l=(d.extent.ymax-d.extent.ymin)/d.pixelBlock.height,g=.01*Math.min(k,l),t=a.sort((u,y)=>Math.abs(u.extent.ymax-y.extent.ymax)>g?y.extent.ymax-u.extent.ymax:Math.abs(u.extent.xmin-y.extent.xmin)>
g?u.extent.xmin-y.extent.xmin:0);var r=Math.min.apply(null,t.map(u=>u.extent.xmin));const w=Math.min.apply(null,t.map(u=>u.extent.ymin)),v=Math.max.apply(null,t.map(u=>u.extent.xmax)),z=Math.max.apply(null,t.map(u=>u.extent.ymax));a={x:Math.round((f.xmin-r)/k),y:Math.round((z-f.ymax)/l)};r={width:Math.round((v-r)/k),height:Math.round((z-w)/l)};k={width:Math.round((f.xmax-f.xmin)/k),height:Math.round((f.ymax-f.ymin)/l)};if(Math.round(r.width/d.pixelBlock.width)*Math.round(r.height/d.pixelBlock.height)!==
t.length||0>a.x||0>a.y||r.width<k.width||r.height<k.height)return null;d=t.map(u=>u.pixelBlock);d=p(d,r,a,k);return{extent:f,pixelBlock:d}};A.remapColor=function(a,f){if(!C(a))return null;a=a.clone();var {pixels:d}=a;const k=a.width*a.height,l=f.length,g=Math.floor(l/2),t=f[Math.floor(g)];d=d[0];let r,w,v,z,u,y,D=!1;const G=new Uint8Array(k),H=new Uint8Array(k),J=new Uint8Array(k);let K=a.mask;const L=4===f[0].mappedColor.length;K||(K=new Uint8Array(k),K.fill(L?255:1),a.mask=K);for(u=0;u<k;u++)if(K[u]){r=
d[u];D=!1;y=g;w=t;v=0;for(z=l-1;1<z-v;){if(r===w.value){D=!0;break}r>w.value?v=y:z=y;y=Math.floor((v+z)/2);w=f[Math.floor(y)]}D||(r===f[v].value?(w=f[v],D=!0):r===f[z].value?(w=f[z],D=!0):r<f[v].value?(D=!1,w=null):r>f[v].value&&(r<f[z].value?(w=f[v],D=!0):z===l-1?(D=!1,w=null):(w=f[z],D=!0)));D?(G[u]=w.mappedColor[0],H[u]=w.mappedColor[1],J[u]=w.mappedColor[2],K[u]=w.mappedColor[3]):G[u]=H[u]=J[u]=K[u]=0}a.pixels=[G,H,J];a.mask=K;a.pixelType="u8";a.maskIsAlpha=L;return a};A.resampleByMajority=h;
A.setValidBoundary=function(a,f,d){if(!C(a))return null;const {width:k,height:l}=a,g=f.x;f=f.y;const t=d.width+g;d=d.height+f;if(0>g||0>f||t>k||d>l||0===g&&0===f&&t===k&&d===l)return a;a.mask||(a.mask=new Uint8Array(k*l));const r=a.mask;for(let w=0;w<l;w++){const v=w*k;for(let z=0;z<k;z++)r[v+z]=w<f||w>=d||z<g||z>=t?0:1}a.updateStatistics();return a};A.split=function(a,f,d){if(!C(a))return null;const {width:k,height:l}=f;let {width:g,height:t}=a;const r=new Map,w={x:0,y:0};d=null==d?1:1+d;for(let v=
0;v<d;v++){const z=Math.ceil(g/k),u=Math.ceil(t/l);for(let y=0;y<u;y++){w.y=y*l;for(let D=0;D<z;D++){w.x=D*k;const G=q(a,w,f);r.set(`${v}/${y}/${D}`,G)}}v<d-1&&(a=n(a));g=Math.round(g/2);t=Math.round(t/2)}return r};A.stretch=function(a,f){if(!C(a))return null;a=a.clone();const {pixels:d,mask:k}=a,{minCutOff:l,maxCutOff:g,gamma:t}=f,r=f.outMin||0;f=f.outMax||255;const w=a.width*a.height,v=d.length;let z;let u,y,D;const G=f-r,H=[];for(z=0;z<v;z++)H[z]=g[z]-l[z];var J=t&&t.length>=v;const K=[];if(J)for(z=
0;z<v;z++)K[z]=1<t[z]?2<t[z]?6.5+(t[z]-2)**2.5:6.5+100*(2-t[z])**4:1;if(J)if(null!=k)for(J=0;J<w;J++){if(k[J])for(z=0;z<v;z++)u=d[z][J],D=(u-l[z])/H[z],y=1,1<t[z]&&(y-=(1/G)**(D*K[z])),d[z][J]=u<g[z]&&u>l[z]?Math.floor(y*G*D**(1/t[z]))+r:u>=g[z]?f:r}else for(J=0;J<w;J++)for(z=0;z<v;z++)u=d[z][J],D=(u-l[z])/H[z],y=1,1<t[z]&&(y-=(1/G)**(D*K[z])),d[z][J]=u<g[z]&&u>l[z]?Math.floor(y*G*D**(1/t[z]))+r:u>=g[z]?f:r;else if(null!=k)for(J=0;J<w;J++){if(k[J])for(z=0;z<v;z++)u=d[z][J],d[z][J]=u<g[z]&&u>l[z]?
Math.floor((u-l[z])/H[z]*G)+r:u>=g[z]?f:r}else for(J=0;J<w;J++)for(z=0;z<v;z++)u=d[z][J],d[z][J]=u<g[z]&&u>l[z]?Math.floor((u-l[z])/H[z]*G)+r:u>=g[z]?f:r;a.pixelType="u8";a.updateStatistics();return a};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/layers/support/PixelBlock":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/Error ../../core/JSONSupport ../../core/lang ../../core/Logger ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/subclass".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e){var c;const q=m.getLogger("esri.layers.support.PixelBlock");E=c=function(n){function a(d){d=n.call(this,d)||this;d.width=null;d.height=null;d.pixelType="f32";d.validPixelCount=null;d.mask=null;d.maskIsAlpha=!1;d.pixels=null;d.statistics=null;return d}A._inheritsLoose(a,n);a.createEmptyBand=function(d,k){return new (c.getPixelArrayConstructor(d))(k)};a.getPixelArrayConstructor=function(d){let k;switch(d){case "u1":case "u2":case "u4":case "u8":k=Uint8Array;break;case "u16":k=
Uint16Array;break;case "u32":k=Uint32Array;break;case "s8":k=Int8Array;break;case "s16":k=Int16Array;break;case "s32":k=Int32Array;break;case "u32":k=Uint32Array;break;case "f32":k=Float32Array;break;case "f64":k=Float64Array;break;case "c64":case "c128":case "unknown":k=Float32Array}return k};var f=a.prototype;f.castPixelType=function(d){if(!d)return"f32";d=d.toLowerCase();-1<["u1","u2","u4"].indexOf(d)?d="u8":-1==="unknown u8 s8 u16 s16 u32 s32 f32 f64".split(" ").indexOf(d)&&(d="f32");return d};
f.getPlaneCount=function(){return this.pixels&&this.pixels.length};f.addData=function(d){if(!d.pixels||d.pixels.length!==this.width*this.height)throw new C("pixelblock:invalid-or-missing-pixels","add data requires valid pixels array that has same length defined by pixel block width * height");this.pixels||(this.pixels=[]);this.statistics||(this.statistics=[]);this.pixels.push(d.pixels);this.statistics.push(d.statistics||{minValue:null,maxValue:null})};f.getAsRGBA=function(){const d=new ArrayBuffer(this.width*
this.height*4);switch(this.pixelType){case "s8":case "s16":case "u16":case "s32":case "u32":case "f32":case "f64":this._fillFromNon8Bit(d);break;default:this._fillFrom8Bit(d)}return new Uint8ClampedArray(d)};f.getAsRGBAFloat=function(){const d=new Float32Array(this.width*this.height*4);this._fillFrom32Bit(d);return d};f.updateStatistics=function(){this.statistics=this.pixels.map(l=>this._calculateBandStatistics(l,this.mask));const d=this.mask;let k=0;if(d)for(let l=0;l<d.length;l++)d[l]&&k++;else k=
this.width*this.height;this.validPixelCount=k};f.clamp=function(d){if(d&&"f64"!==d&&"f32"!==d){switch(d){case "u8":var k=[0,255];break;case "u16":k=[0,65535];break;case "u32":k=[0,4294967295];break;case "s8":k=[-128,127];break;case "s16":k=[-32768,32767];break;case "s32":k=[-2147483648,2147483647];break;default:k=[-3.4*1E39,3.4*1E39]}var [l,g]=k;k=this.pixels;var t=this.width*this.height,r=k.length,w=[];for(let y=0;y<r;y++){var v=c.createEmptyBand(d,t);var z=k[y];for(let D=0;D<t;D++){var u=z[D];v[D]=
u>g?g:u<l?l:u}w.push(v)}this.pixels=w;this.pixelType=d}};f.extractBands=function(d){if(p.isNone(d)||0===d.length||null==this.pixels||0===this.pixels.length)return this;var k=this.pixels.length;const l=d.some(g=>g>=this.pixels.length);k=k===d.length&&!d.some((g,t)=>g!==t);return l||k?this:new c({pixelType:this.pixelType,width:this.width,height:this.height,mask:this.mask,validPixelCount:this.validPixelCount,maskIsAlpha:this.maskIsAlpha,pixels:d.map(g=>this.pixels[g]),statistics:this.statistics&&d.map(g=>
this.statistics[g])})};f.clone=function(){const d=new c({width:this.width,height:this.height,pixelType:this.pixelType,maskIsAlpha:this.maskIsAlpha,validPixelCount:this.validPixelCount});this.mask&&(d.mask=this.mask instanceof Uint8Array?new Uint8Array(this.mask):this.mask.slice(0));let k;const l=c.getPixelArrayConstructor(this.pixelType);if(this.pixels&&0<this.pixels.length){d.pixels=[];const g=this.pixels[0].slice;for(k=0;k<this.pixels.length;k++)d.pixels[k]=g?this.pixels[k].slice(0,this.pixels[k].length):
new l(this.pixels[k])}if(this.statistics)for(d.statistics=[],k=0;k<this.statistics.length;k++)d.statistics[k]=x.clone(this.statistics[k]);return d};f._fillFrom8Bit=function(d){const {mask:k,maskIsAlpha:l,pixels:g}=this;if(d&&g&&g.length){var t,r;var w=t=r=g[0];3<=g.length?(t=g[1],r=g[2]):2===g.length&&(t=g[1]);var v=new Uint32Array(d),z=this.width*this.height;if(w.length!==z)q.error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");else if(k&&k.length===z)if(l)for(d=0;d<z;d++)k[d]&&
(v[d]=k[d]<<24|r[d]<<16|t[d]<<8|w[d]);else for(d=0;d<z;d++)k[d]&&(v[d]=-16777216|r[d]<<16|t[d]<<8|w[d]);else for(d=0;d<z;d++)v[d]=-16777216|r[d]<<16|t[d]<<8|w[d]}else q.error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")};f._fillFromNon8Bit=function(d){const {pixels:k,mask:l,statistics:g}=this;if(d&&k&&k.length){var t=this.pixelType,r=1,w=0;r=1;g&&0<g.length?(w=g.map(D=>D.minValue).reduce((D,G)=>Math.min(D,G)),r=g.map(D=>D.maxValue-D.minValue).reduce((D,G)=>Math.max(D,
G)),r=255/r):(r=255,"s8"===t?(w=-128,r=127):"u16"===t?r=65535:"s16"===t?(w=-32768,r=32767):"u32"===t?r=4294967295:"s32"===t?(w=-2147483648,r=2147483647):"f32"===t?(w=-3.4*1E39,r=3.4*1E39):"f64"===t&&(w=-Number.MAX_VALUE,r=Number.MAX_VALUE),r=255/(r-w));d=new Uint32Array(d);t=this.width*this.height;var v,z,u;var y=v=z=k[0];if(y.length!==t)return q.error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");if(2<=k.length)if(v=k[1],3<=k.length&&(z=k[2]),l&&l.length===t)for(u=0;u<t;u++)l[u]&&
(d[u]=-16777216|(z[u]-w)*r<<16|(v[u]-w)*r<<8|(y[u]-w)*r);else for(u=0;u<t;u++)d[u]=-16777216|(z[u]-w)*r<<16|(v[u]-w)*r<<8|(y[u]-w)*r;else if(l&&l.length===t)for(u=0;u<t;u++)v=(y[u]-w)*r,l[u]&&(d[u]=-16777216|v<<16|v<<8|v);else for(u=0;u<t;u++)v=(y[u]-w)*r,d[u]=-16777216|v<<16|v<<8|v}else q.error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")};f._fillFrom32Bit=function(d){const {pixels:k,mask:l}=this;if(!d||!k||!k.length)return q.error("getAsRGBAFloat()","Unable to convert to RGBA. The input pixel block is empty.");
let g,t,r,w;g=t=r=k[0];3<=k.length?(t=k[1],r=k[2]):2===k.length&&(t=k[1]);const v=this.width*this.height;if(g.length!==v)return q.error("getAsRGBAFloat()","Unable to convert to RGBA. The pixelblock is invalid.");let z=0;if(l&&l.length===v)for(w=0;w<v;w++)d[z++]=g[w],d[z++]=t[w],d[z++]=r[w],d[z++]=l[w]&1;else for(w=0;w<v;w++)d[z++]=g[w],d[z++]=t[w],d[z++]=r[w],d[z++]=1};f._calculateBandStatistics=function(d,k){let l=Infinity,g=-Infinity;const t=d.length;let r,w=0;if(k)for(r=0;r<t;r++)k[r]&&(w=d[r],
l=w<l?w:l,g=w>g?w:g);else for(r=0;r<t;r++)w=d[r],l=w<l?w:l,g=w>g?w:g;return{minValue:l,maxValue:g}};return a}(B.JSONSupport);F.__decorate([h.property({json:{write:!0}})],E.prototype,"width",void 0);F.__decorate([h.property({json:{write:!0}})],E.prototype,"height",void 0);F.__decorate([h.property({json:{write:!0}})],E.prototype,"pixelType",void 0);F.__decorate([b.cast("pixelType")],E.prototype,"castPixelType",null);F.__decorate([h.property({json:{write:!0}})],E.prototype,"validPixelCount",void 0);
F.__decorate([h.property({json:{write:!0}})],E.prototype,"mask",void 0);F.__decorate([h.property({json:{write:!0}})],E.prototype,"maskIsAlpha",void 0);F.__decorate([h.property({json:{write:!0}})],E.prototype,"pixels",void 0);F.__decorate([h.property({json:{write:!0}})],E.prototype,"statistics",void 0);return E=c=F.__decorate([e.subclass("esri.layers.support.PixelBlock")],E)})},"esri/views/webgl/rasterUtils":function(){define(["exports","./FramebufferObject","./Texture"],function(A,F,E){A.createColormapTexture=
function(C,B){return new E(C,{width:B.length/4,height:1,target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,flipped:!1},B)};A.createFrameBuffer=function(C,B,x,m){m=new E(C,{width:B,height:x,target:3553,pixelFormat:6408,internalFormat:6408,samplingMode:9728,dataType:m?5121:5126,wrapMode:33071,flipped:!1});return new F(C,{colorTarget:0,depthStencilTarget:3,width:B,height:x},m)};A.createRasterTexture=function(C,B,x="nearest",m=!1){var p;const h=(m=!(m&&"u8"===
B.pixelType))?5126:5121,b=null==B.pixels||0===B.pixels.length?null:m?B.getAsRGBAFloat():B.getAsRGBA(),e=null==(p=C.capabilities.textureFloat)?void 0:p.textureFloatLinear;return new E(C,{width:B.width,height:B.height,target:3553,pixelFormat:6408,internalFormat:"webgl2"===C.webglVersion&&m?34836:6408,samplingMode:!e||"bilinear"!==x&&"cubic"!==x?9728:9729,dataType:h,wrapMode:33071,flipped:!1},b)};A.createTransformTexture=function(C,B){var x=4*B.size[0],m=B.size[1];const p={width:x,height:m,target:3553,
pixelFormat:6408,internalFormat:"webgl2"===C.webglVersion?34836:6408,dataType:5126,samplingMode:9728,wrapMode:33071,flipped:!1};x=new Float32Array(x*m*4);m=0;for(let h=0;h<B.coefficients.length;h++)x[m++]=B.coefficients[h],2===h%3&&(x[m++]=1);return new E(C,p,x)};A.getBasicGridUniforms=function(C,B){return{u_scale:C,u_offset:B}};A.getColormapUniforms=function(C,B){return{u_colormapOffset:B||0,u_colormapMaxIndex:C?C.length/4-1:null}};A.getCommonUniforms=function(C,B,x,m=1,p=!0,h=!1){return{u_flipY:p,
u_isFloatTexture:h,u_applyTransform:C?!0:!1,u_opacity:m,u_transformSpacing:C?C.spacing:null,u_transformGridSize:C?C.size:null,u_targetImageSize:B,u_srcImageSize:x}};A.getShadedReliefUniforms=function(C){return{u_hillshadeType:C.hillshadeType,u_sinZcosAs:C.sinZcosAs,u_sinZsinAs:C.sinZsinAs,u_cosZs:C.cosZs,u_weights:C.weights,u_factor:C.factor,u_minValue:C.minValue,u_maxValue:C.maxValue}};A.getStretchUniforms=function(C){return{u_bandCount:C.bandCount,u_minOutput:C.outMin,u_maxOutput:C.outMax,u_minCutOff:C.minCutOff,
u_maxCutOff:C.maxCutOff,u_factor:C.factor,u_useGamma:C.useGamma,u_gamma:C.gamma,u_gammaCorrection:C.gammaCorrection}};A.getUniformLocationInfos=function(C,B){C=C.gl;B=B.glName;const x=C.getProgramParameter(B,C.ACTIVE_UNIFORMS),m=new Map;let p;for(let h=0;h<x;h++)(p=C.getActiveUniform(B,h))&&m.set(p.name,{location:C.getUniformLocation(B,p.name),info:p});return m};A.setTextures=function(C,B,x,m){x.length===m.length&&(m.some(p=>null==p)||x.some(p=>null==p)||x.forEach((p,h)=>{B.setUniform1i(p,h);C.bindTexture(m[h],
h)}))};A.setUniforms=function(C,B,x){Object.keys(x).forEach(m=>{var p=B.get(m)||B.get(m+"[0]");if(p){var h=x[m];if(null!==p&&null!=h)switch({info:p}=p,p.type){case 5126:1<p.size?C.setUniform1fv(m,h):C.setUniform1f(m,h);break;case 35664:C.setUniform2fv(m,h);break;case 35665:C.setUniform3fv(m,h);break;case 35666:C.setUniform4fv(m,h);break;case 35675:C.setUniformMatrix3fv(m,h);break;case 35676:C.setUniformMatrix4fv(m,h);break;case 5124:1<p.size?C.setUniform1iv(m,h):C.setUniform1i(m,h);break;case 35670:C.setUniform1i(m,
h?1:0);break;case 35667:case 35671:C.setUniform2iv(m,h);break;case 35668:case 35672:C.setUniform3iv(m,h);break;case 35669:case 35673:C.setUniform4iv(m,h)}}})};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/raster/BrushVectorField":function(){define(["../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/maybe","../WGLBrush"],function(A,F,E){const C=new Float32Array([.27058823529411763,.4588235294117647,.7098039215686275,1,.396078431372549,
.5372549019607843,.7215686274509804,1,.5176470588235295,.6196078431372549,.7294117647058823,1,.6352941176470588,.7058823529411765,.7411764705882353,1,.7529411764705882,.8,.7450980392156863,1,.8705882352941177,.8901960784313725,.7490196078431373,1,1,1,.7490196078431373,1,1,.8627450980392157,.6313725490196078,1,.9803921568627451,.7254901960784313,.5176470588235295,1,.9607843137254902,.596078431372549,.4117647058823529,1,.9294117647058824,.4588235294117647,.3176470588235294,1,.9098039215686274,.08235294117647059,
.08235294117647059,1]),B={beaufort_ft:C,beaufort_m:C,beaufort_km:C,beaufort_mi:C,beaufort_kn:new Float32Array([.1568627450980392,.5725490196078431,.7803921568627451,1,.34901960784313724,.6352941176470588,.7294117647058823,1,.5058823529411764,.7019607843137254,.6705882352941176,1,.6274509803921569,.7607843137254902,.6078431372549019,1,.7490196078431373,.8313725490196079,.5411764705882353,1,.8549019607843137,.9019607843137255,.4666666666666667,1,.9803921568627451,.9803921568627451,.39215686274509803,
1,.9882352941176471,.8352941176470589,.3254901960784314,1,.9882352941176471,.7019607843137254,.4,1,.9803921568627451,.5529411764705883,.20392156862745098,1,.9686274509803922,.43137254901960786,.16470588235294117,1,.9411764705882353,.2784313725490196,.11372549019607843,1]),classified_arrow:new Float32Array([.2196078431372549,.6588235294117647,0,1,.5450980392156862,1.2117647058823529,0,1,1,1,0,1,1,.5019607843137255,0,1,1,0,0,1]),ocean_current_m:new Float32Array([.3058823529411765,.10196078431372549,
.6,1,.7019607843137254,.10588235294117647,.10196078431372549,1,.792156862745098,.5019607843137255,.10196078431372549,1,.6941176470588235,.6941176470588235,.6941176470588235,1]),ocean_current_kn:new Float32Array([0,0,0,1,0,.1450980392156863,.39215686274509803,1,.3058823529411765,.10196078431372549,.6,1,.592156862745098,0,.39215686274509803,1,.7019607843137254,.10588235294117647,.10196078431372549,1,.6941176470588235,.3058823529411765,.10196078431372549,1,.792156862745098,.5019607843137255,.10196078431372549,
1,.6941176470588235,.7019607843137254,.20392156862745098,1,.6941176470588235,.6941176470588235,.6941176470588235,1]),single_arrow:new Float32Array([0,92/255,230/255,1]),wind_speed:new Float32Array([0,0,0,1])};return function(x){function m(){var h=x.apply(this,arguments)||this;h._desc={magdir:{vsPath:"raster/magdir",fsPath:"raster/magdir",attributes:new Map([["a_pos",0],["a_offset",1],["a_vv",2]])},scalar:{vsPath:"raster/scalar",fsPath:"raster/scalar",attributes:new Map([["a_pos",0],["a_offset",1],
["a_vv",2]])}};return h}A._inheritsLoose(m,x);var p=m.prototype;p.dispose=function(){};p.prepareState=function({context:h},b){h.setBlendingEnabled(!0);h.setBlendFunctionSeparate(1,771,1,771);h.setColorMask(!0,!0,!0,!0);h.setStencilWriteMask(0);h.setStencilTestEnabled(!0);h.setStencilOp(7680,7680,7681);h.setStencilFunction(514,b.stencilRef,255)};p.draw=function(h,b){if(!F.isNone(b.source)&&0!==b.source.validPixelCount){var {timeline:e}=h;e.begin(this.name);b.updateVectorFieldVAO(h);if("scalar"===h.renderPass){var c=
b.vaoData.scalar;c&&this._drawScalars(h,b,c.vao,c.elementCount)}else(c=b.vaoData.magdir)&&this._drawTriangles(h,b,c.vao,c.elementCount);e.end(this.name)}};p._drawTriangles=function(h,b,e,c){const {context:q,painter:n}=h,{symbolizerParameters:a}=b;var f=a.dataRange?["dataRange"]:[];"geographic"===a.rotationType&&f.push("rotationGeographic");f=n.materialManager.getProgram(h,this._desc.magdir,f);q.useProgram(f);const {coordScale:d,opacity:k,transforms:l}=b;f.setUniform2fv("u_coordScale",d);f.setUniform1f("u_opacity",
k);f.setUniformMatrix3fv("u_dvsMat3",l.dvs);const {style:g,dataRange:t,rotation:r,symbolPercentRange:w}=a;f.setUniform4fv("u_colors",B[g]||B.single_arrow);f.setUniform2fv("u_dataRange",t);f.setUniform1f("u_rotation",r);f.setUniform2fv("u_symbolPercentRange",w);h=this._getSymbolSize(h,b);f.setUniform2fv("u_symbolSize",h);q.bindVAO(e);q.drawElements(4,c,5125,0)};p._drawScalars=function(h,b,e,c){const {context:q,painter:n}=h,{symbolizerParameters:a}=b;var f=[];"wind_speed"===a.style?f.push("innerCircle"):
a.dataRange&&f.push("dataRange");"geographic"===a.rotationType&&f.push("rotationGeographic");f=n.materialManager.getProgram(h,this._desc.scalar,f);q.useProgram(f);const {coordScale:d,opacity:k,transforms:l}=b;f.setUniform2fv("u_coordScale",d);f.setUniform1f("u_opacity",k);f.setUniformMatrix3fv("u_dvsMat3",l.dvs);const {dataRange:g,symbolPercentRange:t}=a;f.setUniform2fv("u_dataRange",g);f.setUniform2fv("u_symbolPercentRange",t);h=this._getSymbolSize(h,b);f.setUniform2fv("u_symbolSize",h);q.bindVAO(e);
q.drawElements(4,c,5125,0)};p._getSymbolSize=function(h,b){h=2**(h.displayLevel-b.key.level);const {symbolTileSize:e}=b.symbolizerParameters;return[e/(Math.round((b.width-b.offset[0])/e)*e)/h,e/(Math.round((b.height-b.offset[1])/e)*e)/h]};return m}(E)})},"esri/views/2d/engine/vectorTiles/shaders/VTLMaterialManager":function(){define("../../../../webgl/BufferObject ../../../../webgl/FramebufferObject ../../../../webgl/Program ../../../../../chunks/_rollupPluginBabelHelpers ../../../../webgl/enums ../../../../webgl/checkWebGLError ../../../../webgl/renderState ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ./Programs".split(" "),
function(A,F,E,C,B,x,m,p,h,b){return function(){function e(){this._programByKey=new Map}var c=e.prototype;c.dispose=function(){this._programByKey.forEach(q=>q.dispose());this._programByKey.clear()};c.getMaterialProgram=function(q,n,a){const f=n.key<<3|this._getMaterialOptionsValue(n.type,a);if(this._programByKey.has(f))return this._programByKey.get(f);var d=this._getProgramTemplate(n.type);({shaders:d}=d);const {vertexShader:k,fragmentShader:l}=d(a);a=n.getShaderHeader();d=n.getShaderMain();a=k.replace("#pragma header",
a).replace("#pragma main",d);q=new E.Program(q,a,l,n.getAttributeLocations());this._programByKey.set(f,q);return q};c._getMaterialOptionsValue=function(q,n){switch(q){case 0:return(n.pattern?1:0)<<1|(n.id?1:0);case 1:return(n.pattern?1:0)<<1|(n.id?1:0);case 2:return n.id?1:0;case 3:return(n.sdf?1:0)<<2|(n.pattern?1:0)<<1|(n.id?1:0);case 4:return(n.sdf?1:0)<<1|(n.id?1:0);case 5:return n.id?1:0;case 6:return n.id?1:0;default:return 0}};c._getProgramTemplate=function(q){switch(q){case 0:return b.background;
case 5:return b.circle;case 1:return b.fill;case 4:return b.icon;case 3:return b.line;case 2:return b.outline;case 6:return b.text;default:return null}};return e}()})},"esri/views/2d/engine/vectorTiles/shaders/Programs":function(){define("exports ../../../../webgl/BufferObject ../../../../webgl/FramebufferObject ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../../../../webgl/checkWebGLError ../../../../webgl/enums ../../../../../chunks/builtins ../../../../webgl/programUtils ../../../../webgl/renderState ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ./sources/resolver".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c,q){A.background={shaders:n=>({vertexShader:h.glslifyDefineMap({ID:n.id,PATTERN:n.pattern})+q.resolveIncludes("background/background.vert"),fragmentShader:h.glslifyDefineMap({ID:n.id,PATTERN:n.pattern})+q.resolveIncludes("background/background.frag")})};A.circle={shaders:n=>({vertexShader:h.glslifyDefineMap({ID:n.id})+q.resolveIncludes("circle/circle.vert"),fragmentShader:h.glslifyDefineMap({ID:n.id})+q.resolveIncludes("circle/circle.frag")})};A.fill={shaders:n=>({vertexShader:h.glslifyDefineMap({ID:n.id,
PATTERN:n.pattern})+q.resolveIncludes("fill/fill.vert"),fragmentShader:h.glslifyDefineMap({ID:n.id,PATTERN:n.pattern})+q.resolveIncludes("fill/fill.frag")})};A.icon={shaders:n=>({vertexShader:h.glslifyDefineMap({ID:n.id,SDF:n.sdf})+q.resolveIncludes("icon/icon.vert"),fragmentShader:h.glslifyDefineMap({ID:n.id,SDF:n.sdf})+q.resolveIncludes("icon/icon.frag")})};A.line={shaders:n=>({vertexShader:h.glslifyDefineMap({ID:n.id,PATTERN:n.pattern,SDF:n.sdf})+q.resolveIncludes("line/line.vert"),fragmentShader:h.glslifyDefineMap({ID:n.id,
PATTERN:n.pattern,SDF:n.sdf})+q.resolveIncludes("line/line.frag")})};A.outline={shaders:n=>({vertexShader:h.glslifyDefineMap({ID:n.id})+q.resolveIncludes("outline/outline.vert"),fragmentShader:h.glslifyDefineMap({ID:n.id})+q.resolveIncludes("outline/outline.frag")})};A.text={shaders:n=>({vertexShader:h.glslifyDefineMap({ID:n.id})+q.resolveIncludes("text/text.vert"),fragmentShader:h.glslifyDefineMap({ID:n.id})+q.resolveIncludes("text/text.frag")})};Object.defineProperty(A,"__esModule",{value:!0})})},
"esri/views/2d/engine/vectorTiles/shaders/sources/resolver":function(){define("exports ../../../../../webgl/BufferObject ../../../../../webgl/FramebufferObject ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/has ../../../../../webgl/checkWebGLError ../../../../../webgl/enums ../../../../../../chunks/builtins ../../../../../webgl/renderState ../../../../../webgl/Texture ../../../../../webgl/ShaderCompiler ../../../../../webgl/VertexArrayObject ./shaderRepository".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c,q){const n=new e(function(a){let f=q;a.split("/").forEach(d=>{f&&(f=f[d])});return f});A.resolveIncludes=function(a){return n.resolveIncludes(a)};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/sources/shaderRepository":function(){define(function(){return{background:{"background.frag":"#ifdef PATTERN\nuniform lowp float u_opacity;\nuniform lowp sampler2D u_texture;\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_tileTextureCoord;\n#else\nuniform lowp vec4 u_color;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main() {\n#ifdef PATTERN\nmediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\nmediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\nlowp vec4 color \x3d texture2D(u_texture, samplePos);\ngl_FragColor \x3d u_opacity * color;\n#else\ngl_FragColor \x3d u_color;\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"background.vert":"precision mediump float;\nattribute vec2 a_pos;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_coord_range;\nuniform mediump float u_depth;\n#ifdef PATTERN\nuniform mediump mat3 u_pattern_matrix;\nvarying mediump vec2 v_tileTextureCoord;\nuniform mediump vec4 u_tlbr;\nuniform mediump vec2 u_mosaicSize;\nvarying mediump vec4 v_tlbr;\n#endif\nvoid main() {\ngl_Position \x3d vec4((u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0)).xy, u_depth, 1.0);\n#ifdef PATTERN\nv_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\nv_tlbr             \x3d u_tlbr / u_mosaicSize.xyxy;\n#endif\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\n}"},
circle:{"circle.frag":"precision lowp float;\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nmediump float dist \x3d length(v_offset);\nmediump float alpha \x3d smoothstep(0.0, -v_blur, dist - 1.0);\nlowp float color_mix_ratio \x3d v_stroke_width \x3c 0.01 ? 0.0 : smoothstep(-v_blur, 0.0, dist - v_radius / (v_radius + v_stroke_width));\ngl_FragColor \x3d alpha * mix(v_color, v_stroke_color, color_mix_ratio);\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"circle.vert":"precision mediump float;\nattribute vec2 a_pos;\n#pragma header\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_circleTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_antialiasingWidth;\nvoid main()\n{\n#pragma main\nv_color \x3d color * opacity;\nv_stroke_color \x3d stroke_color * stroke_opacity;\nv_stroke_width \x3d stroke_width;\nv_radius \x3d radius;\nv_blur \x3d max(blur, u_antialiasingWidth / (radius + stroke_width));\nmediump vec2 offset \x3d vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\nv_offset \x3d offset;\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos * 0.5, 1.0) + u_displayMat3 * vec3((v_radius + v_stroke_width) * offset + u_circleTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
fill:{"fill.frag":"precision lowp float;\n#ifdef PATTERN\nuniform lowp sampler2D u_texture;\nvarying mediump vec2 v_tileTextureCoord;\nvarying mediump vec4 v_tlbr;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvec4 mixColors(vec4 color1, vec4 color2) {\nfloat compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\nvec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\nreturn vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef PATTERN\nmediump vec2 normalizedTextureCoord \x3d fract(v_tileTextureCoord);\nmediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\nlowp vec4 color \x3d texture2D(u_texture, samplePos);\ngl_FragColor \x3d v_color[3] * color;\n#else\ngl_FragColor \x3d v_color;\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"fill.vert":"precision mediump float;\nattribute vec2 a_pos;\n#pragma header\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_fillTranslation;\n#ifdef PATTERN\n#include \x3cutil/util.glsl\x3e\nuniform mediump vec2 u_mosaicSize;\nuniform mediump float u_patternFactor;\nvarying mediump vec2 v_tileTextureCoord;\nvarying mediump vec4 v_tlbr;\n#endif\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvoid main()\n{\n#pragma main\nv_color \x3d color * opacity;\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\n#ifdef PATTERN\nfloat patternWidth \x3d nextPOT(tlbr.z - tlbr.x);\nfloat patternHeight \x3d nextPOT(tlbr.w - tlbr.y);\nfloat scaleX \x3d 1.0 / (patternWidth * u_patternFactor);\nfloat scaleY \x3d 1.0 / (patternHeight * u_patternFactor);\nmat3 patterMat \x3d mat3(scaleX, 0.0,    0.0,\n0.0,    -scaleY, 0.0,\n0.0,    0.0,    1.0);\nv_tileTextureCoord \x3d (patterMat * vec3(a_pos, 1.0)).xy;\nv_tlbr             \x3d tlbr / u_mosaicSize.xyxy;\n#endif\nvec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(u_fillTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
icon:{"icon.frag":"precision mediump float;\nuniform lowp sampler2D u_texture;\n#ifdef SDF\nuniform lowp vec4 u_color;\nuniform lowp vec4 u_outlineColor;\n#endif\nvarying mediump vec2 v_tex;\nvarying lowp float v_opacity;\nvarying mediump vec2 v_size;\nvarying lowp vec4 v_color;\n#ifdef SDF\nvarying mediump flaot v_halo_width;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\n#include \x3cutil/encoding.glsl\x3e\nvec4 mixColors(vec4 color1, vec4 color2) {\nfloat compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\nvec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\nreturn vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef SDF\nlowp vec4 fillPixelColor \x3d v_color;\nfloat d \x3d rgba2float(texture2D(u_texture, v_tex)) - 0.5;\nconst float softEdgeRatio \x3d 0.248062016;\nfloat size \x3d max(v_size.x, v_size.y);\nfloat dist \x3d d * softEdgeRatio * size;\nfillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\nif (v_halo_width \x3e 0.25) {\nlowp vec4 outlinePixelColor \x3d u_outlineColor;\nconst float outlineLimitRatio \x3d (16.0 / 86.0);\nfloat clampedOutlineSize \x3d softEdgeRatio * min(v_halo_width, outlineLimitRatio * max(v_size.x, v_size.y));\noutlinePixelColor *\x3d clamp(0.5 - (abs(dist) - clampedOutlineSize), 0.0, 1.0);\ngl_FragColor \x3d v_opacity * mixColors(fillPixelColor, outlinePixelColor);\n}\nelse {\ngl_FragColor \x3d v_opacity * fillPixelColor;\n}\n#else\nlowp vec4 texColor \x3d texture2D(u_texture, v_tex);\ngl_FragColor \x3d v_opacity * texColor;\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"icon.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texAngleRange;\nattribute vec4 a_levelInfo;\nattribute float a_opacityInfo;\n#pragma header\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\n#ifdef SDF\nvarying mediump float v_halo_width;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_iconTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeDuration;\nvarying mediump vec2 v_tex;\nvarying lowp float v_opacity;\nvarying mediump vec2 v_size;\nconst float C_OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float C_256_TO_RAD \x3d 3.14159265359 / 128.0;\nconst float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float tileCoordRatio \x3d 1.0 / 8.0;\nuniform highp float u_time;\nvoid main()\n{\n#pragma main\nv_color \x3d color;\nv_opacity \x3d opacity;\n#ifdef SDF\nv_halo_width \x3d halo_width;\n#endif\nfloat modded \x3d mod(a_opacityInfo, 128.0);\nfloat targetOpacity \x3d (a_opacityInfo - modded) / 128.0;\nfloat startOpacity \x3d modded / 127.0;\nfloat interpolatedOpacity \x3d clamp(startOpacity + 2.0 * (targetOpacity - 0.5) * u_time / u_fadeDuration, 0.0, 1.0);\nv_opacity *\x3d interpolatedOpacity;\nmediump float a_angle         \x3d a_levelInfo[1];\nmediump float a_minLevel      \x3d a_levelInfo[2];\nmediump float a_maxLevel      \x3d a_levelInfo[3];\nmediump vec2 a_tex            \x3d a_texAngleRange.xy;\nmediump float delta_z \x3d 0.0;\nmediump float rotated \x3d mod(a_angle + u_mapRotation, 256.0);\ndelta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * step(64.0, rotated) * (1.0 - step(192.0, rotated));\ndelta_z +\x3d 1.0 - step(a_minLevel, u_level);\ndelta_z +\x3d step(a_maxLevel, u_level);\ndelta_z +\x3d step(v_opacity, 0.0);\nvec2 offset \x3d C_OFFSET_PRECISION * a_vertexOffset;\nv_size \x3d abs(offset);\n#ifdef SDF\noffset \x3d (120.0 / 86.0) * offset;\n#endif\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayViewMat3 * vec3(size * offset, 0.0) + u_displayMat3 * vec3(u_iconTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\nv_tex \x3d a_tex.xy / u_mosaicSize;\n}"},
line:{"line.frag":"precision lowp float;\nvarying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nvarying mediump float v_lineHalfWidth;\nvarying lowp vec4 v_color;\nvarying mediump float v_blur;\n#if defined (PATTERN) || defined(SDF)\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\nvarying mediump float v_widthRatio;\nuniform sampler2D u_texture;\nuniform mediump float u_antialiasing;\n#endif\n#ifdef SDF\n#include \x3cutil/encoding.glsl\x3e\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nmediump float fragDist \x3d length(v_normal) * v_lineHalfWidth;\nlowp float alpha \x3d clamp((v_lineHalfWidth - fragDist) / v_blur, 0.0, 1.0);\n#ifdef PATTERN\nmediump float relativeTexX \x3d mod(v_accumulatedDistance / (v_patternSize.x * v_widthRatio), 1.0);\nmediump float relativeTexY \x3d 0.5 + v_normal.y * v_lineHalfWidth / (v_patternSize.y * v_widthRatio);\nmediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\nlowp vec4 color \x3d texture2D(u_texture, texCoord);\ngl_FragColor \x3d alpha * v_color[3] * color;\n#elif defined(SDF)\nmediump float relativeTexX \x3d mod((v_accumulatedDistance * 0.5) / (v_patternSize.x * v_widthRatio), 1.0);\nmediump float relativeTexY \x3d  0.5 + 0.25 * v_normal.y;\nmediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\nmediump float d \x3d rgba2float(texture2D(u_texture, texCoord)) - 0.5;\nfloat dist \x3d d * v_lineHalfWidth;\ngl_FragColor \x3d alpha * clamp(0.5 - dist, 0.0, 1.0) * v_color;\n#else\ngl_FragColor \x3d alpha * v_color;\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"line.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec4 a_extrude_offset;\nattribute vec4 a_dir_normal;\nattribute vec2 a_accumulatedDistance;\n#pragma header\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump float u_zoomFactor;\nuniform mediump vec2 u_lineTranslation;\nuniform mediump float u_antialiasing;\nuniform mediump float u_depth;\nvarying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nconst float scale \x3d 1.0 / 31.0;\nconst mediump float tileCoordRatio \x3d 8.0;\n#if defined (SDF)\nconst mediump float sdfPatternHalfWidth \x3d 15.5;\n#endif\n#if defined (PATTERN) || defined(SDF)\nuniform mediump vec2 u_mosaicSize;\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\nvarying mediump float v_widthRatio;\n#endif\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvarying mediump float v_lineHalfWidth;\nvarying mediump float v_blur;\nvoid main()\n{\n#pragma main\nv_color \x3d color * opacity;\nv_blur \x3d blur + u_antialiasing;\nv_normal \x3d a_dir_normal.zw * scale;\n#if defined (PATTERN) || defined(SDF)\nv_tlbr          \x3d tlbr / u_mosaicSize.xyxy;\nv_patternSize   \x3d vec2(tlbr.z - tlbr.x, tlbr.y - tlbr.w);\n#if defined (PATTERN)\nv_widthRatio \x3d width / v_patternSize.y;\n#else\nv_widthRatio \x3d width / sdfPatternHalfWidth / 2.0;\n#endif\n#endif\nv_lineHalfWidth \x3d (width + u_antialiasing) * 0.5;\nmediump vec2 dir \x3d a_dir_normal.xy * scale;\nmediump vec2 offset_ \x3d a_extrude_offset.zw * scale * offset;\nmediump vec2 dist \x3d v_lineHalfWidth * scale * a_extrude_offset.xy;\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos + offset_ * tileCoordRatio / u_zoomFactor, 1.0) + u_displayViewMat3 * vec3(dist, 0.0) + u_displayMat3 * vec3(u_lineTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n#if defined (PATTERN) || defined(SDF)\nv_accumulatedDistance \x3d a_accumulatedDistance.x * u_zoomFactor / tileCoordRatio + dot(dir, dist + offset_);\n#endif\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\n}"},
outline:{"outline.frag":"varying lowp vec4 v_color;\nvarying mediump vec2 v_normal;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nlowp float dist \x3d abs(v_normal.y);\nlowp float alpha \x3d smoothstep(1.0, 0.0, dist);\ngl_FragColor \x3d alpha * v_color;\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}","outline.vert":"attribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_xnormal;\n#pragma header\nvarying lowp vec4 v_color;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_fillTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_outline_width;\nvarying lowp vec2 v_normal;\nconst float scale \x3d 1.0 / 15.0;\nvoid main()\n{\n#pragma main\nv_color \x3d color * opacity;\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\nv_normal \x3d a_xnormal;\nmediump vec2 dist \x3d u_outline_width * scale * a_offset;\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(dist + u_fillTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
text:{"text.frag":"uniform lowp sampler2D u_texture;\nvarying lowp vec2 v_tex;\nvarying lowp vec4 v_color;\nvarying mediump float v_edgeWidth;\nvarying mediump float v_edgeDistance;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nlowp float dist \x3d texture2D(u_texture, v_tex).a;\nmediump float alpha \x3d smoothstep(v_edgeDistance - v_edgeWidth, v_edgeDistance + v_edgeWidth, dist);\ngl_FragColor \x3d alpha * v_color;\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"text.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texAngleRange;\nattribute vec4 a_levelInfo;\nattribute float a_opacityInfo;\n#pragma header\nvarying lowp vec4 v_color;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_textTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeDuration;\nvarying lowp vec2 v_tex;\nconst float offsetPrecision \x3d 1.0 / 8.0;\nconst mediump float edgePos \x3d 0.75;\nuniform mediump float u_antialiasingWidth;\nvarying mediump float v_edgeDistance;\nvarying mediump float v_edgeWidth;\nuniform lowp float u_halo;\nconst float sdfFontScale \x3d 1.0 / 24.0;\nconst float sdfPixel \x3d 3.0;\nuniform highp float u_time;\nvoid main()\n{\n#pragma main\nif (u_halo \x3e 0.5)\n{\nv_color \x3d halo_color * opacity;\nhalo_width *\x3d sdfPixel;\nhalo_blur *\x3d sdfPixel;\n}\nelse\n{\nv_color \x3d color * opacity;\nhalo_width \x3d 0.0;\nhalo_blur \x3d 0.0;\n}\nfloat modded \x3d mod(a_opacityInfo, 128.0);\nfloat targetOpacity \x3d (a_opacityInfo - modded) / 128.0;\nfloat startOpacity \x3d modded / 127.0;\nfloat interpolatedOpacity \x3d clamp(startOpacity + 2.0 * (targetOpacity - 0.5) * u_time / u_fadeDuration, 0.0, 1.0);\nv_color *\x3d interpolatedOpacity;\nmediump float a_angle       \x3d a_levelInfo[1];\nmediump float a_minLevel    \x3d a_levelInfo[2];\nmediump float a_maxLevel    \x3d a_levelInfo[3];\nmediump vec2 a_tex          \x3d a_texAngleRange.xy;\nmediump float a_visMinAngle    \x3d a_texAngleRange.z;\nmediump float a_visMaxAngle    \x3d a_texAngleRange.w;\nmediump float delta_z \x3d 0.0;\nmediump float angle \x3d mod(a_angle + u_mapRotation, 256.0);\nif (a_visMinAngle \x3c a_visMaxAngle)\n{\ndelta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * (step(a_visMaxAngle, angle) + (1.0 - step(a_visMinAngle, angle)));\n}\nelse\n{\ndelta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * (step(a_visMaxAngle, angle) * (1.0 - step(a_visMinAngle, angle)));\n}\ndelta_z +\x3d 1.0 - step(a_minLevel, u_level);\ndelta_z +\x3d step(a_maxLevel, u_level);\ndelta_z +\x3d step(v_color[3], 0.0);\nv_tex \x3d a_tex.xy / u_mosaicSize;\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\nv_edgeDistance \x3d edgePos - halo_width / size;\nv_edgeWidth \x3d (u_antialiasingWidth + halo_blur) / size;\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + sdfFontScale * u_displayViewMat3 * vec3(offsetPrecision * size * a_vertexOffset, 0.0) + u_displayMat3 * vec3(u_textTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n}"},
util:{"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n255.0 / (256.0),\n255.0 / (256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n);\nfloat rgba2float(vec4 rgba) {\nreturn dot(rgba, rgba2float_factors);\n}","util.glsl":"float nextPOT(in float x) {\nreturn pow(2.0, ceil(log2(abs(x))));\n}"}}})},"esri/views/2d/engine/webgl/BitBlitRenderer":function(){define("exports ../../../webgl/BufferObject ../../../webgl/FramebufferObject ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../webgl/checkWebGLError ../../../webgl/enums ../../../../chunks/builtins ../../../webgl/programUtils ../../../webgl/renderState ../../../webgl/Texture ../../../webgl/VertexArrayObject ./shaders/BitBlitPrograms".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c,q){E=function(){function n(){this._initialized=!1}var a=n.prototype;a.dispose=function(){this._program&&(this._program.dispose(),this._program=null);this._vertexArrayObject&&(this._vertexArrayObject.dispose(),this._vertexArrayObject=null)};a.render=function(f,d,k,l){f&&(this._initialized||this._initialize(f),f.setBlendFunctionSeparate(1,771,1,771),f.bindVAO(this._vertexArrayObject),f.useProgram(this._program),d.setSamplingMode(k),f.bindTexture(d,0),this._program.setUniform1i("u_tex",
0),this._program.setUniform1f("u_opacity",l),f.drawArrays(5,0,4),f.bindTexture(null,0),f.bindVAO())};a._initialize=function(f){if(this._initialized)return!0;const d=q.bitBlit.attributes,k=h.createProgram(f,q.bitBlit);if(!k)return!1;const l=new Int8Array(16);l[0]=-1;l[1]=-1;l[2]=0;l[3]=0;l[4]=1;l[5]=-1;l[6]=1;l[7]=0;l[8]=-1;l[9]=1;l[10]=0;l[11]=1;l[12]=1;l[13]=1;l[14]=1;l[15]=1;f=new c(f,d,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:4,normalized:!1,divisor:0},{name:"a_tex",count:2,type:5120,
offset:2,stride:4,normalized:!1,divisor:0}]},{geometry:F.createVertex(f,35044,l)});this._program=k;this._vertexArrayObject=f;return this._initialized=!0};return n}();A.BitBlitRenderer=E;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/shaders/BitBlitPrograms":function(){define(["exports","./sources/resolver"],function(A,F){F={shaders:{vertexShader:F.resolveIncludes("bitBlit/bitBlit.vert"),fragmentShader:F.resolveIncludes("bitBlit/bitBlit.frag")},attributes:new Map([["a_pos",
0],["a_tex",1]])};A.bitBlit=F;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/MaterialManager":function(){define("../../../../core/maybe ../../../webgl/BufferObject ../../../webgl/FramebufferObject ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../webgl/checkWebGLError ../../../webgl/enums ../../../../chunks/builtins ../../../webgl/ProgramCache ../../../webgl/renderState ../../../webgl/Texture ../../../webgl/VertexArrayObject ./enums ./shaders/MaterialPrograms".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c,q,n){const a=k=>k===q.WGLDrawPhase.HITTEST||k===q.WGLDrawPhase.LABEL_ALPHA,f=({rendererInfo:k,drawPhase:l},g,t,r)=>{g=g.getVariationHash();r=r.join(".");l=(a(l)?1:0)|(l===q.WGLDrawPhase.HIGHLIGHT?2:0);return`${g}-${r}-${l}-${k.getVariationHash()}-${A.isSome(t)&&t.join(".")}`},d=(k,l,g,t)=>{t=t.reduce((r,w)=>({...r,[w]:k.driverTestResult[w]}),{});l={...l.getVariation(),...k.rendererInfo.getVariation(),highlight:k.drawPhase===q.WGLDrawPhase.HIGHLIGHT,id:a(k.drawPhase),
...t};if(A.isSome(g))for(const r of g)l[r]=!0;return l};return function(){function k(g){this._programByKey=new Map;this._programCache=new h(g)}var l=k.prototype;l.dispose=function(){this._programCache&&this._programCache.dispose()};l.getProgram=function(g,t,r=[],w=[]){const v=t.vsPath+"."+t.fsPath+JSON.stringify(r)+w.join(".");if(this._programByKey.has(v))return this._programByKey.get(v);w=w.reduce((D,G)=>({...D,[G]:g.driverTestResult[G]}),{});r={...r.map(D=>"string"===typeof D?{name:D,value:!0}:
D).reduce((D,G)=>({...D,[G.name]:G.value}),{}),...w};const {vsPath:z,fsPath:u,attributes:y}=t;t=this._programCache.getProgram(n.createProgramTemplate(z,u,y),r);if(!t)throw Error("Unable to get program for key: ${key}");this._programByKey.set(v,t);return t};l.getMaterialProgram=function(g,t,r,w,v,z=["ignoresSamplerPrecision"]){const u=f(g,t,v,z);if(this._programByKey.has(u))return this._programByKey.get(u);g=d(g,t,v,z);r=this._programCache.getProgram(n.createProgramTemplate(r,r,w),g);if(!r)throw Error("Unable to get program for key: ${key}");
this._programByKey.set(u,r);return r};return k}()})},"esri/views/2d/engine/webgl/shaders/MaterialPrograms":function(){define(["exports","./sources/resolver","../../../../webgl/programUtils"],function(A,F,E){const C=B=>{const x={};for(const p in B){{let h=void 0;var m=p;h=""+m[0].toUpperCase();for(let b=1;b<m.length;b++){const e=m[b];e===e.toUpperCase()?(h+="_",h+=e):h+=e.toUpperCase()}m=h}x[m]=B[p]}return E.glslifyDefineMap(x)};A.createProgramTemplate=(B,x,m)=>{const p=B+B.substring(B.lastIndexOf("/")),
h=x+x.substring(x.lastIndexOf("/"));return{attributes:m,shaders:b=>({vertexShader:C(b)+F.resolveIncludes(`${p}.vert`),fragmentShader:C(b)+F.resolveIncludes(`${h}.frag`)})}};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/TextureManager":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../config ../../../../request ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/screenUtils ../../../../chunks/vec2 ../../../../chunks/vec2f32 ../../../../symbols/cim/Rasterizer ./definitions ./enums ./fontUtils ./GlyphMosaic ./GlyphSource ./SDFConverter ./SpriteMosaic ./animatedFormats/apng ./animatedFormats/gif ./util/BidiText ./util/Result ./util/symbolUtils ../../../support/QueueProcessor".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c,q,n,a,f,d,k,l,g,t,r,w,v){function z(M){switch(M.type){case "CIMSolidStroke":case "CIMSolidFill":return!0;case "esriSFS":return"esriSFSSolid"===M.style||"esriSFSNull"===M.style;case "esriSLS":return"esriSLSSolid"===M.style||"esriSLSNull"===M.style;default:return!1}}function u(M){switch(M.type){case "esriSMS":case "esriPMS":case "CIMPointSymbol":case "CIMVectorMarker":case "CIMPictureMarker":case "CIMCharacterMarker":return!1;default:return!0}}function y(M){const N=
"maxVVSize"in M&&M.maxVVSize;return N?N:M.width}function D(M,N){return G.apply(this,arguments)}function G(){G=A._asyncToGenerator(function*(M,N){M=M.imageData?`data:${M.contentType};base64,${M.imageData}`:M.url;var P;if(-1!==M.indexOf(";base64,")){N=M.indexOf(";base64,")+8;N=M.substring(N);N=atob(N);M=new Uint8Array(N.length);for(P=0;P<N.length;P++)M[P]=N.charCodeAt(P);P=M.buffer}else try{const {data:I}=yield E(M,{responseType:"array-buffer",...N});P=I}catch(I){if(!m.isAbortError(I))return new C("mapview-invalid-resource",
`Could not fetch requested resource at ${M}`)}return P});return G.apply(this,arguments)}function H(M,N){N=Math.round(p.pt2px(N)*window.devicePixelRatio);return Math.min(M,N*(128<=N?2:4))}const J=b.create(),K=B.getLogger("esri.views.2d.engine.webgl.TextureManager");let L=function(){function M(N,P,I){this.mosaicType=N;this.page=P;this.sdf=I}M.fromMosaic=function(N,P){return new M(N,P.page,P.sdf)};return M}();return function(){function M(P){this._invalidFontsMap=new Map;this._sdfConverter=new d(126);
this._bindingInfos=[];this._hashToBindingIndex=new Map;this._rasterizer=new e;this._ongoingRasterizations=new Map;this._imageRequestQueue=new v.QueueProcessor({concurrency:10,process:function(){var I=A._asyncToGenerator(function*(O,Q){m.throwIfAborted(Q);try{return yield E(O,{responseType:"image",signal:Q})}catch(T){if(!m.isAbortError(T))throw new C("mapview-invalid-resource",`Could not fetch requested resource at ${O}`,T);throw T;}});return function(O,Q){return I.apply(this,arguments)}}()});this._spriteMosaic=
new k(P,2048,2048,500);this._glyphSource=new f(`${F.fontsUrl}/{fontstack}/{range}.pbf`);this._glyphMosaic=new a(1024,1024,this._glyphSource)}var N=M.prototype;N.dispose=function(){this._spriteMosaic.dispose();this._glyphMosaic.dispose();this._rasterizer.dispose();this._sdfConverter.dispose();this._sdfConverter=this._rasterizer=this._glyphMosaic=this._spriteMosaic=null;this._hashToBindingIndex.clear();this._bindingInfos=this._hashToBindingIndex=null;this._ongoingRasterizations.clear();this._ongoingRasterizations=
null;this._imageRequestQueue.clear();this._imageRequestQueue=null};N.rasterizeItem=function(){var P=A._asyncToGenerator(function*(I,O,Q,T){if(x.isNone(I))return K.error(new C("mapview-null-resource","Unable to rasterize null resource",void 0)),null;switch(I.type){case "CIMTextSymbol":case "esriTS":return I=yield this._rasterizeText(I,Q,T),I.forEach(V=>this._setTextureBinding(q.MosaicType.GLYPH,V)),{glyphMosaicItems:I};default:if(I.type&&-1!==I.type.toLowerCase().indexOf("3d"))return K.error(new C("mapview-invalid-type",
`MapView does not support symbol type: ${I.type}`,I)),null;I=yield this._rasterizeSpriteSymbol(I,O,T);r.ok(I)&&I&&this._setTextureBinding(q.MosaicType.SPRITE,I);return{spriteMosaicItem:I}}});return function(I,O,Q,T){return P.apply(this,arguments)}}();N.bindTextures=function(P,I,O,Q=!1){if(0!==O.textureBinding){var T=this._bindingInfos[O.textureBinding-1];O=T.page;Q=Q?9987:9729;switch(T.mosaicType){case q.MosaicType.SPRITE:{T=this.sprites.getWidth(O);const V=this.sprites.getHeight(O);T=h.set(J,T,V);
this._spriteMosaic.bind(P,Q,O,c.TEXTURE_BINDING_SPRITE_ATLAS);I.setUniform1i("u_texture",c.TEXTURE_BINDING_SPRITE_ATLAS);I.setUniform2fv("u_mosaicSize",T);break}case q.MosaicType.GLYPH:T=h.set(J,this.glyphs.width,this.glyphs.height);this._glyphMosaic.bind(P,Q,O,c.TEXTURE_BINDING_GLYPH_ATLAS);I.setUniform1i("u_texture",c.TEXTURE_BINDING_GLYPH_ATLAS);I.setUniform2fv("u_mosaicSize",T);break;default:K.error("mapview-texture-manager",`Cannot handle unknown type ${T.mosaicType}`)}}};N._hashMosaic=function(P,
I){return 1|P<<1|(I.sdf?1:0)<<2|I.page<<3};N._setTextureBinding=function(P,I){const O=this._hashMosaic(P,I);this._hashToBindingIndex.has(O)||(P=L.fromMosaic(P,I),this._hashToBindingIndex.set(O,this._bindingInfos.length+1),this._bindingInfos.push(P));I.textureBinding=this._hashToBindingIndex.get(O)};N._rasterizeText=function(){var P=A._asyncToGenerator(function*(I,O,Q){const T=n.getFullyQualifiedFontName(I.font),V=this._invalidFontsMap.has(T);if(O)I=O;else{I=t.bidiText(I.text)[0];O=[];for(let aa=0;aa<
I.length;aa++)O.push(I.charCodeAt(aa));I=O}try{return yield this._glyphMosaic.getGlyphItems(V?"arial-unicode-ms-regular":T,I,Q)}catch(aa){return K.error(new C("mapview-invalid-resource",`Couldn't find font ${T}. Falling back to Arial Unicode MS Regular`,void 0)),this._invalidFontsMap.set(T,!0),this._glyphMosaic.getGlyphItems("arial-unicode-ms-regular",I,Q)}});return function(I,O,Q){return P.apply(this,arguments)}}();N._rasterizeSpriteSymbol=function(){var P=A._asyncToGenerator(function*(I,O,Q){if(z(I))return null;
O=w.keyFromSymbol(I);if(this._spriteMosaic.has(O))return this._spriteMosaic.getSpriteItem(O);if("esriSMS"===I.type&&I.path||I.url||I.imageData)return this._handleAsyncResource(O,I,Q);if(Q=this._rasterizer.rasterizeJSONResource(I,1)){const {size:T,image:V,sdf:aa,simplePattern:Z}=Q;return this._addItemToMosaic(O,T,{type:"static",data:V},u(I),aa,Z)}return new C("TextureManager","unrecognized or null rasterized image")});return function(I,O,Q){return P.apply(this,arguments)}}();N._handleAsyncResource=
function(){var P=A._asyncToGenerator(function*(I,O,Q){if(this._ongoingRasterizations.has(I))return this._ongoingRasterizations.get(I);O="esriSMS"===O.type&&O.path?this._handleSVG(O,I,Q):this._handleImage(O,I,Q);this._ongoingRasterizations.set(I,O);try{yield O,this._ongoingRasterizations.delete(I)}catch{this._ongoingRasterizations.delete(I)}return O});return function(I,O,Q){return P.apply(this,arguments)}}();N._handleSVG=function(){var P=A._asyncToGenerator(function*(I,O,Q){I=yield this._sdfConverter.draw(I.path,
Q);return this._addItemToMosaic(O,[126,126],{type:"static",data:new Uint32Array(I.buffer)},!1,!0,!0)});return function(I,O,Q){return P.apply(this,arguments)}}();N._handleGIFOrPNG=function(){var P=A._asyncToGenerator(function*(I,O,Q){var T=yield D(I,Q);if(r.ok(T)){var V=g.isGIF(T);const aa=l.isPNG(T);if(!V&&!aa)return new C("mapview-invalid-resource","Image data is neither GIF nor PNG!");let Z;try{V&&g.isAnimatedGIF(T)?Z=yield g["default"].create(T,Q):aa&&l.isAnimatedPNG(T)&&(Z=yield l["default"].create(T,
Q))}catch(R){if(!m.isAbortError(R))return new C("mapview-invalid-resource","Could not fetch requested resource!")}if(Z&&r.ok(Z))return this._addItemToMosaic(O,[Z.width,Z.height],{type:"animated",data:Z},u(I),!1,!1);Q=new Blob([T],{type:V?"image/gif":"image/png"});if((Q=yield this._imageFromBlob(Q))&&Q instanceof HTMLImageElement){T=Q.width;V=Q.height;"esriPMS"===I.type&&(T=Math.round(H(Q.width,y(I))),V=Math.round(T/Q.width*Q.height));const {size:R,sdf:S,image:U}=this._rasterizer.rasterizeImageResource(T,
V,Q,I.colorSubstitutions);return this._addItemToMosaic(O,R,{type:"static",data:U},u(I),S,!1)}}return new C("mapview-invalid-resource","Could not handle resource!")});return function(I,O,Q){return P.apply(this,arguments)}}();N._handleImage=function(){var P=A._asyncToGenerator(function*(I,O,Q){var T;(T=I.url&&-1!==I.url.indexOf(".gif")||I.contentType&&"image/gif"===I.contentType||I.imageData&&-1!==I.imageData.indexOf("data:image/gif"))||(T=I.url&&-1!==I.url.indexOf(".png")||I.contentType&&"image/png"===
I.contentType||I.imageData&&-1!==I.imageData.indexOf("data:image/png"));if(T)return this._handleGIFOrPNG(I,O,Q);T=I.imageData?`data:${I.contentType};base64,${I.imageData}`:I.url;try{const {data:V}=yield this._imageRequestQueue.push(T,{...Q});-1!==T.indexOf("data:image/svg+xml")&&(V.width=p.pt2px(I.width),V.height=p.pt2px(I.height));let aa=V.width,Z=V.height;"esriPMS"===I.type&&(aa=Math.round(H(V.width,y(I))),Z=Math.round(aa/V.width*V.height));const {size:R,sdf:S,image:U}=this._rasterizer.rasterizeImageResource(aa,
Z,V,I.colorSubstitutions);return this._addItemToMosaic(O,R,{type:"static",data:U},u(I),S,!1)}catch(V){if(!m.isAbortError(V))return new C("mapview-invalid-resource",`Could not fetch requested resource at ${T}. ${V.message}`)}});return function(I,O,Q){return P.apply(this,arguments)}}();N._imageFromBlob=function(){var P=A._asyncToGenerator(function*(I){I=window.URL.createObjectURL(I);try{const {data:O}=yield this._imageRequestQueue.push(I);window.URL.revokeObjectURL(I);return O}catch(O){window.URL.revokeObjectURL(I);
if(!m.isAbortError(O))return new C("mapview-invalid-resource",`Could not fetch requested resource at ${I}`);throw O;}});return function(I){return P.apply(this,arguments)}}();N._addItemToMosaic=function(P,I,O,Q,T,V){return this._spriteMosaic.addSpriteItem(P,I,O,Q,T,V)};A._createClass(M,[{key:"sprites",get:function(){return this._spriteMosaic}},{key:"glyphs",get:function(){return this._glyphMosaic}}]);return M}()})},"esri/symbols/cim/Rasterizer":function(){define(["./CIMSymbolHelper","./Rect","./SDFHelper",
"./utils"],function(A,F,E,C){return function(){function B(){}var x=B.prototype;x.dispose=function(){this._rasterizationCanvas=null};x.rasterizeJSONResource=function(m,p,h){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));if("simple-fill"===m.type||"esriSFS"===m.type){const [d,k,l]=A.SymbolHelper.rasterizeSimpleFill(this._rasterizationCanvas,m.style,p);return{size:[k,l],image:new Uint32Array(d.buffer),sdf:!1,simplePattern:!0,anchorX:0,anchorY:0}}if("simple-line"===
m.type||"esriSLS"===m.type){const [d,k,l]=A.SymbolHelper.rasterizeSimpleLine(m.style,m.cap);return{size:[k,l],image:new Uint32Array(d.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}}let b,e;"simple-marker"===m.type||"esriSMS"===m.type||"line-marker"===m.type?(m=A.CIMSymbolHelper.fromSimpleMarker(m),e=E.getSDFInfo(m)):"CIMHatchFill"===m.type?(m=A.CIMSymbolHelper.fromCIMHatchFill(m),b=new F(m.frame.xmin,-m.frame.ymax,m.frame.xmax-m.frame.xmin,m.frame.ymax-m.frame.ymin)):m.markerPlacement&&"CIMMarkerPlacementInsidePolygon"===
m.markerPlacement.type?(m=A.CIMSymbolHelper.fromCIMInsidePolygon(m),b=new F(m.frame.xmin,-m.frame.ymax,m.frame.xmax-m.frame.xmin,m.frame.ymax-m.frame.ymin)):e=E.getSDFInfo(m);if(e&&!h){const [d,k,l]=E.buildSDF(e);return d?{size:[k,l],image:new Uint32Array(d.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}:null}const [c,q,n,a,f]=A.CIMSymbolHelper.rasterize(this._rasterizationCanvas,m,b,!h);return c?{size:[q,n],image:new Uint32Array(c.buffer),sdf:!1,simplePattern:!1,anchorX:a,anchorY:f}:null};x.rasterizeImageResource=
function(m,p,h,b){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));this._rasterizationCanvas.width=m;this._rasterizationCanvas.height=p;var e=this._rasterizationCanvas.getContext("2d");h instanceof ImageData?e.putImageData(h,0,0):(h.setAttribute("width",`${m}px`),h.setAttribute("height",`${p}px`),e.drawImage(h,0,0,m,p));h=e.getImageData(0,0,m,p);h=new Uint8Array(h.data);if(b)for(var c of b)if(c&&c.oldColor&&4===c.oldColor.length&&c.newColor&&4===c.newColor.length){const [q,
n,a,f]=c.oldColor,[d,k,l,g]=c.newColor;if(q!==d||n!==k||a!==l||f!==g)for(b=0;b<h.length;b+=4)q===h[b]&&n===h[b+1]&&a===h[b+2]&&f===h[b+3]&&(h[b]=d,h[b+1]=k,h[b+2]=l,h[b+3]=g)}for(b=0;b<h.length;b+=4)c=h[b+3]/255,h[b]*=c,h[b+1]*=c,h[b+2]*=c;e=h;c=m;b=p;if(512<=c||512<=b){e=c/b;1<e?(c=512,b=Math.round(512/e)):(b=512,c=Math.round(512*e));e=new Uint8Array(4*c*b);const q=new Uint8ClampedArray(e.buffer);C.resampleHermite(h,m,p,q,c,b,!1)}return{size:[c,b],image:new Uint32Array(e.buffer),sdf:!1,simplePattern:!1,
anchorX:0,anchorY:0}};return B}()})},"esri/symbols/cim/CIMSymbolHelper":function(){define("exports ../../Color ../../core/Logger ../../core/mathUtils ./CIMPlacements ./CIMSymbolDrawHelper ./packingUtils".split(" "),function(A,F,E,C,B,x,m){function p(n,a){switch(a.type){case "CIMSymbolReference":n.drawSymbol(a.symbol,{type:"point",x:0,y:0});break;case "CIMPointSymbol":n.drawSymbol(a,{type:"point",x:0,y:0});break;case "CIMVectorMarker":{const f=new B.Placement;n.drawMarker(a,f)}}return n.envelope()}
const h=Math.PI,b=h/2,e=E.getLogger("esri.symbols.cim.CIMSymbolHelper");E=function(){function n(){}n.getEnvelope=function(a){const f=new x.EnvDrawHelper;if(Array.isArray(a)){let d;for(const k of a)d?d.union(p(f,k)):d=p(f,k);return d}return p(f,a)};n.getTextureAnchor=function(a){a=this.getEnvelope(a);if(!a||0>=a.width||0>=a.height)return[0,0,0];const f=96/72,d=a.height*f+2;return[(a.x+.5*a.width)*f/(a.width*f+2),-(a.y+.5*a.height)*f/d,d]};n.rasterize=function(a,f,d,k=!0){var l=d||this.getEnvelope(f);
if(!l||0>=l.width||0>=l.height)return[null,0,0,0,0];var g=96/72;const t=(l.x+.5*l.width)*g,r=(l.y+.5*l.height)*g;a.width=l.width*g;a.height=l.height*g;d||(a.width+=2,a.height+=2);d=a.getContext("2d");g=x.Transformation.createScale(g,-g);g.translate(.5*a.width-t,.5*a.height+r);g=new x.CanvasDrawHelper(d,g);switch(f.type){case "CIMPointSymbol":g.drawSymbol(f,{type:"point",x:0,y:0});break;case "CIMVectorMarker":l=new B.Placement,g.drawMarker(f,l)}f=d.getImageData(0,0,a.width,a.height);f=new Uint8Array(f.data);
if(k)for(d=0;d<f.length;d+=4)k=f[d+3]/255,f[d]*=k,f[d+1]*=k,f[d+2]*=k;return[f,a.width,a.height,-t/a.width,-r/a.height]};n.fromSimpleMarker=function(a){var f=a.style;if("circle"===f||"esriSMSCircle"===f){var d=Math.acos(.995);var k=Math.ceil(h/d/4);0===k&&(k=1);d=b/k;k*=4;f=[];f.push([50,0]);for(let g=1;g<k;g++)f.push([50*Math.cos(g*d),-50*Math.sin(g*d)]);f.push([50,0]);d={rings:[f]};k={xmin:-50,ymin:-50,xmax:50,ymax:50}}else if("cross"===f||"esriSMSCross"===f)d={rings:[[[0,50],[0,0],[50,0],[50,-0],
[0,-0],[0,-50],[-0,-50],[-0,-0],[-50,-0],[-50,0],[-0,0],[-0,50],[0,50]]]},k={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("diamond"===f||"esriSMSDiamond"===f)d={rings:[[[-50,0],[0,50],[50,0],[0,-50],[-50,0]]]},k={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("square"===f||"esriSMSSquare"===f)d={rings:[[[-50,-50],[-50,50],[50,50],[50,-50],[-50,-50]]]},k={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("x"===f||"esriSMSX"===f)d={rings:[[[0,0],[50,50],[50,50],[0,0],[50,-50],[50,-50],[0,-0],[-50,-50],[-50,-50],
[-0,0],[-50,50],[-50,50],[0,0]]]},k={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("triangle"===f||"esriSMSTriangle"===f)k=2/3*100,f=k-100,d={rings:[[[-57.735026918962575,f],[0,k],[57.735026918962575,f],[-57.735026918962575,f]]]},k={xmin:-57.735026918962575,ymin:f,xmax:57.735026918962575,ymax:k};else if("arrow"===f||"esriSMSArrow"===f)d={rings:[[[-50,50],[50,0],[-50,-50],[-33,-20],[-33,20],[-50,50]]]},k={xmin:-50,ymin:-50,xmax:50,ymax:50};if(d&&k){var l=[{type:"CIMSolidFill",enable:!0,color:a.color}];
a.outline&&l.push({type:"CIMSolidStroke",enable:!0,width:a.outline.width,color:a.outline.color});l={type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:a.angle,size:a.size,offsetX:a.xoffset,offsetY:a.yoffset,frame:k,markerGraphics:[{type:"CIMMarkerGraphic",geometry:d,symbol:{type:"CIMPolygonSymbol",symbolLayers:l}}]}]}}return l};n.fromCIMHatchFill=function(a){const f=void 0!==a.separation?a.separation:4,d=f/2;for(var k=this._getLineSymbolPeriod(a.lineSymbol)||4;4>k;)k*=
2;k/=2;return{type:"CIMVectorMarker",frame:{xmin:-k,xmax:k,ymin:-d,ymax:d},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[-k,0],[k,0]]]},symbol:a.lineSymbol}],size:f}};n._getLineSymbolPeriod=function(a){if(a){const f=this._getEffectsRepeat(a.effects);if(f)return f;if(a.symbolLayers)for(const d of a.symbolLayers)if((a=this._getEffectsRepeat(d.effects))||d&&(a=this._getPlacementRepeat(d.markerPlacement)))return a}return 0};n._getEffectsRepeat=function(a){if(a)for(var f of a)if(f)switch(f.type){case "CIMGeometricEffectDashes":if((a=
f.dashTemplate)&&a.length){f=0;for(const d of a)f+=d;a.length&1&&(f*=2);return f}break;case "CIMGeometricEffectWave":return f.period;default:e.error(`unsupported geometric effect type ${f.type}`)}return 0};n._getPlacementRepeat=function(a){if(a)switch(a.type){case "CIMMarkerPlacementAlongLineSameSize":case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineVariableSize":if((a=a.placementTemplate)&&a.length){let f=0;for(const d of a)f+=d;a.length&1&&(f*=2);return f}}return 0};
n.fromCIMInsidePolygon=function(a){var f=a.markerPlacement;const d={type:a.type,...a,markerPlacement:null,anchorPoint:null};let k,l;!0===f.shiftOddRows?(a=f.stepX/2,k=f.stepY,l=2*f.stepY,f=[{x:-a,y:0},{x:a,y:0},{x:0,y:k},{x:0,y:-k}].map(g=>({type:"CIMMarkerGraphic",geometry:g,symbol:{type:"CIMPointSymbol",symbolLayers:[d]}}))):(a=f.stepX/2,k=f.stepY/2,l=f.stepY,f=[{type:"CIMMarkerGraphic",geometry:{x:0,y:0},symbol:{type:"CIMPointSymbol",symbolLayers:[d]}}]);return{type:"CIMVectorMarker",frame:{xmin:-a,
xmax:a,ymin:-k,ymax:k},markerGraphics:f,size:l}};n.getFillColor=function(a){if(!a)return null;switch(a.type){case "CIMPolygonSymbol":if(a.symbolLayers)for(const f of a.symbolLayers)if(a=n.getFillColor(f),null!=a)return a;break;case "CIMTextSymbol":return n.getFillColor(a.symbol);case "CIMSolidFill":return a.color}};n.getStrokeColor=function(a){if(a)switch(a.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(a.symbolLayers)for(const f of a.symbolLayers)if(a=n.getStrokeColor(f),void 0!==a)return a;
break;case "CIMTextSymbol":return n.getStrokeColor(a.symbol);case "CIMSolidStroke":return a.color}};n.getStrokeWidth=function(a){if(a)switch(a.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(a.symbolLayers)for(const f of a.symbolLayers)if(a=n.getStrokeWidth(f),void 0!==a)return a;break;case "CIMTextSymbol":return n.getStrokeWidth(a.symbol);case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return a.width}};n.getSize=function(a){if(a)switch(a.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":{let f=
0;if(a.symbolLayers)for(const d of a.symbolLayers)a=n.getSize(d),a>f&&(f=a);return f}case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":return a.width;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":return a.size}};n.getMarkerScaleRatio=function(a){if(a)switch(a.type){case "CIMVectorMarker":if(!1!==a.scaleSymbolsProportionally&&a.frame)return a.size/(a.frame.ymax-a.frame.ymin)}return 1};return n}();let c=function(){function n(){}n.rasterizeSimpleFill=function(a,
f,d){"solid"!==f&&"none"!==f&&"esriSFSSolid"!==f&&"esriSFSNull"!==f||console.error("Unexpected: style does not require rasterization");d=C.nextPowerOfTwo(Math.ceil(d));var k=this._isHorizontalOrVertical(f)?8*d:16*d;const l=2*d;a.width=k;a.height=k;const g=a.getContext("2d");g.strokeStyle="#FFFFFF";g.lineWidth=d;g.beginPath();if("vertical"===f||"cross"===f||"esriSFSCross"===f||"esriSFSVertical"===f)g.moveTo(k/2,-l),g.lineTo(k/2,k+l);if("horizontal"===f||"cross"===f||"esriSFSCross"===f||"esriSFSHorizontal"===
f)g.moveTo(-l,k/2),g.lineTo(k+l,k/2);if("forward-diagonal"===f||"diagonal-cross"===f||"esriSFSDiagonalCross"===f||"esriSFSForwardDiagonal"===f)g.moveTo(-l,-l),g.lineTo(k+l,k+l),g.moveTo(k-l,-l),g.lineTo(k+l,l),g.moveTo(-l,k-l),g.lineTo(l,k+l);if("backward-diagonal"===f||"diagonal-cross"===f||"esriSFSBackwardDiagonal"===f||"esriSFSDiagonalCross"===f)g.moveTo(k+l,-l),g.lineTo(-l,k+l),g.moveTo(l,-l),g.lineTo(-l,l),g.moveTo(k+l,k-l),g.lineTo(k-l,k+l);g.stroke();f=g.getImageData(0,0,a.width,a.height);
f=new Uint8Array(f.data);for(k=0;k<f.length;k+=4)d=f[k+3]/255,f[k]*=d,f[k+1]*=d,f[k+2]*=d;return[f,a.width,a.height]};n.rasterizeSimpleLine=function(a,f){switch(f){case "butt":f="Butt";break;case "square":f="Square";break;default:f="Round"}const d="Butt"===f;switch(a){case "dash":case "esriSLSDash":a=d?[4,3]:[3,4];break;case "dash-dot":case "esriSLSDashDot":a=d?[4,3,1,3]:[3,4,0,4];break;case "dot":case "esriSLSDot":a=d?[1,3]:[0,4];break;case "long-dash":case "esriSLSLongDash":a=d?[8,3]:[7,4];break;
case "long-dash-dot":case "esriSLSLongDashDot":a=d?[8,3,1,3]:[7,4,0,4];break;case "long-dash-dot-dot":case "esriSLSDashDotDot":a=d?[8,3,1,3,1,3]:[7,4,0,4,0,4];break;case "short-dash":case "esriSLSShortDash":a=d?[4,1]:[3,2];break;case "short-dash-dot":case "esriSLSShortDashDot":a=d?[4,1,1,1]:[3,2,0,2];break;case "short-dash-dot-dot":case "esriSLSShortDashDotDot":a=d?[4,1,1,1,1,1]:[3,2,0,2,0,2];break;case "short-dot":case "esriSLSShortDot":a=d?[1,1]:[0,2];break;case "solid":case "esriSLSSolid":case "none":e.error("Unexpected: style does not require rasterization");
a=[0,0];break;default:e.error(`Tried to rasterize SLS, but found an unexpected style: ${a}!`),a=[0,0]}return this.rasterizeDash(a,f)};n.rasterizeDash=function(a,f){var d="Butt"===f,k="Square"===f;f=!d&&!k;1===a.length%2&&(a=[...a,...a]);var l=0;for(var g of a)l+=g;g=Math.round(15.5*l);l=new Float32Array(31*g);let t=0,r=0,w=.5,v=!0;for(var z of a){t=r;for(r+=15.5*z;w<=r;){for(a=.5;31>a;){const u=f?(a-15.5)*(a-15.5):Math.abs(a-15.5);l[(a-.5)*g+w-.5]=v?d?Math.max(Math.max(t+7.75-w,u),Math.max(w-r+7.75,
u)):u:f?Math.min((w-t)*(w-t)+u,(w-r)*(w-r)+u):k?Math.min(Math.max(w-t,u),Math.max(r-w,u)):Math.min(Math.max(w-t+7.75,u),Math.max(r+7.75-w,u));a++}w++}v=!v}d=l.length;z=new Uint8Array(4*d);for(k=0;k<d;++k)m.packFloatRGBA((f?Math.sqrt(l[k]):l[k])/15.5,z,4*k);return[z,g,31]};n._isHorizontalOrVertical=function(a){return"vertical"===a||"horizontal"===a||"cross"===a||"esriSFSCross"===a||"esriSFSVertical"===a||"esriSFSHorizontal"===a};return n}(),q=function(){function n(){}n.findApplicableOverrides=function(a,
f,d){if(f){if(a.primitiveName){let k=!1;for(const l of d)if(l.primitiveName===a.primitiveName){k=!0;break}if(!k)for(const l of f)l.primitiveName===a.primitiveName&&d.push(l)}switch(a.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(a.effects)for(const k of a.effects)n.findApplicableOverrides(k,f,d);if(a.symbolLayers)for(const k of a.symbolLayers)n.findApplicableOverrides(k,f,d);break;case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":case "CIMSolidFill":case "CIMPictureFill":case "CIMHatchFill":case "CIMGradientFill":case "CIMVectorMarker":case "CIMCharacterMarker":case "CIMPictureMarker":if(a.effects)for(const k of a.effects)n.findApplicableOverrides(k,
f,d);a.markerPlacement&&n.findApplicableOverrides(a.markerPlacement,f,d);if("CIMVectorMarker"===a.type){if(a.markerGraphics)for(const k of a.markerGraphics)n.findApplicableOverrides(k,f,d),n.findApplicableOverrides(k.symbol,f,d)}else"CIMCharacterMarker"===a.type?n.findApplicableOverrides(a.symbol,f,d):"CIMHatchFill"===a.type&&n.findApplicableOverrides(a.lineSymbol,f,d)}}};n.applyOverrides=function(a,f,d,k){if(f){if(a.primitiveName)for(const g of f)if(g.primitiveName===a.primitiveName){var l=(l=g.propertyName)?
l.charAt(0).toLowerCase()+l.substr(1):l;k&&k.push({cim:a,nocapPropertyName:l,value:a[l]});g.expression&&(g.value=n.toValue(g.propertyName,g.expression));if(d){let t=!1;for(const r of d)r.primitiveName===a.primitiveName&&(t=!0);t||d.push(g)}a[l]=g.value}switch(a.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(a.effects)for(const g of a.effects)n.applyOverrides(g,f,d,k);if(a.symbolLayers)for(const g of a.symbolLayers)n.applyOverrides(g,f,d,k);break;case "CIMSolidStroke":case "CIMSolidFill":case "CIMVectorMarker":if(a.effects)for(const g of a.effects)n.applyOverrides(g,
f,d,k);if("CIMVectorMarker"===a.type&&a.markerGraphics)for(const g of a.markerGraphics)n.applyOverrides(g,f,d,k),n.applyOverrides(g.symbol,f,d,k)}}};n.restoreOverrides=function(a){for(const f of a)f.cim[f.nocapPropertyName]=f.value};n.buildOverrideKey=function(a){let f="";for(const d of a)void 0!==d.value&&(f+=`${d.primitiveName}${d.propertyName}${JSON.stringify(d.value)}`);return f};n.toValue=function(a,f){return"DashTemplate"===a?f.split(" ").map(d=>Number(d)):"Color"===a?(a=(new F(f)).toRgba(),
a[3]*=255,a):f};return n}();A.CIMSymbolHelper=E;A.OverrideHelper=q;A.SymbolHelper=c;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/symbols/cim/CIMPlacements":function(){define(["exports"],function(A){let F=function(){function C(){this.setIdentity()}var B=C.prototype;B.getAngle=function(){if(null==this.rz||0===this.rz&&1!==this.rz_c&&0!==this.rz_s)this.rz=Math.atan2(this.rz_s,this.rz_c);return this.rz};B.setIdentity=function(){this.tz=this.ty=this.tx=0;this.s=1;this.rz=this.ry=this.rx=0;
this.rz_c=1;this.rz_s=0};B.setTranslate=function(x,m){this.tx=x;this.ty=m};B.setTranslateZ=function(x){this.tz=x};B.setRotateCS=function(x,m){this.rz=void 0;this.rz_c=x;this.rz_s=m};B.setRotate=function(x){this.rz=x;this.rz_s=this.rz_c=void 0};B.setRotateY=function(x){this.ry=x};B.setScale=function(x){this.s=x};B.setMeasure=function(x){this.m=x};return C}(),E=function(){function C(){}C.prototype.next=function(){return null};return C}();A.EmptyPlacementCursor=E;A.Placement=F;Object.defineProperty(A,
"__esModule",{value:!0})})},"esri/symbols/cim/CIMSymbolDrawHelper":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/Logger ../../geometry/support/aaBoundingRect ../../geometry/support/boundsUtils ../../geometry/support/jsonUtils ./CIMEffects ./CIMOperators ./CIMPlacements ./Rect".split(" "),function(A,F,E,C,B,x,m,p,h,b){const e=Math.PI/180,c=E.getLogger("esri.symbols.cim.CIMSymbolDrawHelper");let q=function(){function d(l){this._t=l}d.createIdentity=function(){return new d([1,
0,0,0,1,0])};var k=d.prototype;k.clone=function(){return new d(this._t.slice())};k.transform=function(l){const g=this._t;return[g[0]*l[0]+g[1]*l[1]+g[2],g[3]*l[0]+g[4]*l[1]+g[5]]};d.createScale=function(l,g){return new d([l,0,0,0,g,0])};k.scale=function(l,g){const t=this._t;t[0]*=l;t[1]*=l;t[2]*=l;t[3]*=g;t[4]*=g;t[5]*=g;return this};k.scaleRatio=function(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])};d.createTranslate=function(l,g){return new d([0,0,l,0,0,g])};k.translate=function(l,
g){const t=this._t;t[2]+=l;t[5]+=g;return this};d.createRotate=function(l){const g=Math.cos(l);l=Math.sin(l);return new d([g,-l,0,l,g,0])};k.rotate=function(l){return this.multiply(d.createRotate(l))};k.multiply=function(l){const g=this._t;l=l._t;const t=g[1]*l[0]+g[4]*l[1],r=g[2]*l[0]+g[5]*l[1]+l[2],w=g[0]*l[3]+g[3]*l[4],v=g[1]*l[3]+g[4]*l[4],z=g[2]*l[3]+g[5]*l[4]+l[5];g[0]=g[0]*l[0]+g[3]*l[1];g[1]=t;g[2]=r;g[3]=w;g[4]=v;g[5]=z;return this};return d}();E=function(){function d(l){this._transfos=[];
this._sizeTransfos=[];this._transfos.push(l||q.createIdentity());this._sizeTransfos.push(l?l.scaleRatio():1)}var k=d.prototype;k.transformPt=function(l){return this._transfos[this._transfos.length-1].transform(l)};k.transformSize=function(l){return l*this._sizeTransfos[this._sizeTransfos.length-1]};k.back=function(){return this._transfos[this._transfos.length-1]};k.push=function(l,g){g=g?l.scaleRatio():1;l.multiply(this.back());this._transfos.push(l);this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-
1]*g)};k.pop=function(){this._transfos.splice(-1,1);this._sizeTransfos.splice(-1,1)};k.drawSymbol=function(l,g){if(l)switch(l.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":this.drawMultiLayerSymbol(l,g)}};k.drawMultiLayerSymbol=function(l,g){if(l){var t=l.symbolLayers;if(t)if(l=l.effects){if(g=this.executeEffects(l,g))for(l=g.next();l;)this.drawSymbolLayers(t,l),l=g.next()}else this.drawSymbolLayers(t,g)}};k.executeEffects=function(l,g){g=new m.SimpleGeometryCursor(g);for(const t of l)(l=
p.getEffectOperator(t))&&(g=l.execute(g,t,1));return g};k.drawSymbolLayers=function(l,g){let t=l.length;for(;t--;){const w=l[t];if(w&&!1!==w.enable){var r=w.effects;if(r){if(r=this.executeEffects(r,g)){let v=r.next();for(;v;)this.drawSymbolLayer(w,v),v=r.next()}}else this.drawSymbolLayer(w,g)}}};k.drawSymbolLayer=function(l,g){switch(l.type){case "CIMSolidFill":this.drawSolidFill(g,l.color);break;case "CIMHatchFill":this.drawHatchFill(l,g);break;case "CIMSolidStroke":this.drawSolidStroke(g,l.color,
l.width,l.capStyle,l.joinStyle,l.miterLimit);break;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":this.drawMarkerLayer(l,g)}};k.drawHatchFill=function(l,g){const t=this._buildHatchPolyline(l,g,1);t&&(this.pushClipPath(g),this.drawMultiLayerSymbol(l.lineSymbol,t),this.popClipPath())};k.drawMarkerLayer=function(l,g){var t=l.markerPlacement;if(t){const w=p.getPlacementOperator(t);if(w){var r="CIMMarkerPlacementInsidePolygon"===t.type;r&&this.pushClipPath(g);if(g=w.execute(g,
t,1))for(t=g.next();t;)this.drawMarker(l,t),t=g.next();r&&this.popClipPath()}}else r=new h.Placement,r.tx=g.x,r.ty=g.y,this.drawMarker(l,r)};k.drawMarker=function(l,g){switch(l.type){case "CIMCharacterMarker":case "CIMPictureMarker":this.drawPictureMarker(l,g);break;case "CIMVectorMarker":this.drawVectorMarker(l,g)}};k.drawPictureMarker=function(l,g){if(l){var t=l.size||10,r=q.createIdentity(),w=l.anchorPoint;if(w){let v=w.x;w=w.y;"Absolute"!==l.anchorPointUnits&&(v*=t,w*=t);r.translate(-v,-w)}l.rotation&&
r.rotate(l.rotation*e);r.translate(l.offsetX||0,l.offsetY||0);r.translate(g.tx,g.ty);this.push(r,!1);this.drawImage(l.url,t,l.scaleX);this.pop()}};k.drawVectorMarker=function(l,g){if(l){var t=l.markerGraphics;if(t){var r=l.size,w=l.frame,v=w?w.ymax-w.ymin:0;r=r&&v?r/v:1;v=q.createIdentity();w&&v.translate(.5*-(w.xmax+w.xmin),.5*-(w.ymax+w.ymin));var z=l.anchorPoint;if(z){let u=z.x;z=z.y;"Absolute"!==l.anchorPointUnits?w&&(u*=w.xmax-w.xmin,z*=w.ymax-w.ymin):(u/=r,z/=r);v.translate(-u,-z)}1!==r&&v.scale(r,
r);l.rotation&&v.rotate(l.rotation*e);v.translate(l.offsetX||0,l.offsetY||0);v.translate(g.tx,g.ty);this.push(v,l.scaleSymbolsProportionally);for(const u of t)u&&u.symbol&&u.geometry||c.error("Invalid marker graphic",u),this.drawSymbol(u.symbol,u.geometry);this.pop()}}};k._buildHatchPolyline=function(l,g,t){var r=(void 0!==l.separation?l.separation:4)*t,w=void 0!==l.rotation?l.rotation:0;if(0===r)return null;0>r&&(r=-r);for(var v=0,z=.5*r;v>z;)v-=r;for(;v<-z;)v+=r;v=C.create();B.getBoundsXY(v,g);
v[0]-=z;v[1]-=z;v[2]+=z;v[3]+=z;for(var u=[[v[0],v[1]],[v[0],v[3]],[v[2],v[3]],[v[2],v[1]]];180<w;)w-=180;for(;0>w;)w+=180;z=Math.cos(w*e);var y=Math.sin(w*e);w=-r*y;g=r*z;v=(void 0!==l.offsetX?l.offsetX*t:0)*y-(void 0!==l.offsetY?l.offsetY*t:0)*z;let D;var G=l=Number.MAX_VALUE;D=t=-Number.MAX_VALUE;for(var H of u){var J=H[0];const K=H[1];u=z*J+y*K;J=-y*J+z*K;G=Math.min(G,u);l=Math.min(l,J);D=Math.max(D,u);t=Math.max(t,J)}l=Math.floor(l/r)*r;H=z*G-y*l-w*v/r;G=y*G+z*l-g*v/r;u=z*D-y*l-w*v/r;v=y*D+z*
l-g*v/r;r=1+Math.round((t-l)/r);z=[];for(y=0;y<r;y++)H+=w,G+=g,u+=w,v+=g,z.push([[H,G],[u,v]]);return{paths:z}};return d}();let n=function(d){function k(){var g=d.call(this)||this;g.reset();return g}F._inheritsLoose(k,d);var l=k.prototype;l.reset=function(){this._xmin=this._ymin=Infinity;this._xmax=this._ymax=-Infinity;this._clipCount=0};l.envelope=function(){return new b(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)};l.drawSolidFill=function(g){!g||0<this._clipCount||(x.isPolygon(g)?
this._processPath(g.rings,0):x.isPolyline(g)?this._processPath(g.paths,0):x.isExtent(g)&&(g=f(g))&&this._processPath(g.rings,0))};l.drawSolidStroke=function(g,t,r){!g||0<this._clipCount||(t=.5*this.transformSize(r),x.isPolygon(g)?this._processPath(g.rings,t):x.isPolyline(g)?this._processPath(g.paths,t):x.isExtent(g)&&(g=f(g))&&this._processPath(g.rings,t))};l.pushClipPath=function(g){this.drawSolidFill(g);++this._clipCount};l.popClipPath=function(){--this._clipCount};l.drawImage=function(g,t,r){g=
t/2;this._merge(this.transformPt([0,0]),g)};l._processPath=function(g,t){if(g)for(const r of g)if(g=r?r.length:0,1<g){this._merge(this.transformPt(r[0]),t);for(let w=1;w<g;++w)this._merge(this.transformPt(r[w]),t)}};l._merge=function(g,t){g[0]-t<this._xmin&&(this._xmin=g[0]-t);g[0]+t>this._xmax&&(this._xmax=g[0]+t);g[1]-t<this._ymin&&(this._ymin=g[1]-t);g[1]+t>this._ymax&&(this._ymax=g[1]+t)};return k}(E),a=function(d){function k(g,t){t=d.call(this,t)||this;t._ctx=g;return t}F._inheritsLoose(k,d);
var l=k.prototype;l.drawSolidFill=function(g,t){if(g){if(x.isPolygon(g))this._buildPath(g.rings,!0);else if(x.isPolyline(g))this._buildPath(g.paths,!0);else if(x.isExtent(g))this._buildPath(f(g).rings,!0);else return;g=this._ctx;g.fillStyle="string"===typeof t?t:"rgba("+Math.round(t[0])+","+Math.round(t[1])+","+Math.round(t[2])+","+t[3]/255+")";g.fill("evenodd")}};l.drawSolidStroke=function(g,t,r,w,v,z){if(g&&t&&0!==r){if(x.isPolygon(g))this._buildPath(g.rings,!0);else if(x.isPolyline(g))this._buildPath(g.paths,
!1);else if(x.isExtent(g))this._buildPath(f(g).rings,!0);else return;g=this._ctx;g.strokeStyle="string"===typeof t?t:"rgba("+Math.round(t[0])+","+Math.round(t[1])+","+Math.round(t[2])+","+t[3]/255+")";g.lineWidth=this.transformSize(r)+.5;this._setCapStyle(w);this._setJoinStyle(v);g.miterLimit=z;g.stroke()}};l.pushClipPath=function(g){this._ctx.save();if(x.isPolygon(g))this._buildPath(g.rings,!0);else if(x.isPolyline(g))this._buildPath(g.paths,!0);else if(x.isExtent(g))this._buildPath(f(g).rings,!0);
else return;this._ctx.clip("evenodd")};l.popClipPath=function(){this._ctx.restore()};l.drawImage=function(g,t,r){};l._buildPath=function(g,t){const r=this._ctx;r.beginPath();if(g)for(const w of g)if(g=w?w.length:0,1<g){let v=this.transformPt(w[0]);r.moveTo(v[0],v[1]);for(let z=1;z<g;++z)v=this.transformPt(w[z]),r.lineTo(v[0],v[1]);t&&r.closePath()}};l._setCapStyle=function(g){switch(g){case "Butt":this._ctx.lineCap="butt";break;case "Round":this._ctx.lineCap="round";break;case "Square":this._ctx.lineCap=
"square"}};l._setJoinStyle=function(g){switch(g){case "Bevel":this._ctx.lineJoin="bevel";break;case "Round":this._ctx.lineJoin="round";break;case "Miter":this._ctx.lineJoin="miter"}};return k}(E);const f=d=>d?{spatialReference:d.spatialReference,rings:[[[d.xmin,d.ymin],[d.xmin,d.ymax],[d.xmax,d.ymax],[d.xmax,d.ymin],[d.xmin,d.ymin]]]}:null;A.CIMSymbolDrawHelper=E;A.C_DEG_TO_RAD=e;A.CanvasDrawHelper=a;A.EnvDrawHelper=n;A.Transformation=q;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/symbols/cim/CIMEffects":function(){define(["exports",
"../../core/lang"],function(A,F){let E=function(){function C(B){this._geometry=B}C.prototype.next=function(){const B=this._geometry;this._geometry=null;return B};return C}();A.SimpleGeometryCursor=E;A.clone=function(C){return F.clone(C)};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/symbols/cim/CIMOperators":function(){define("exports ./effects/EffectAddControlPoints ./effects/EffectArrow ./effects/EffectBuffer ./effects/EffectCut ./effects/EffectDashes ./effects/EffectDonut ./effects/EffectJog ./effects/EffectMove ./effects/EffectOffset ./effects/EffectReverse ./effects/EffectRotate ./effects/EffectScale ./effects/EffectWave ./placements/PlacementAlongLineSameSize ./placements/PlacementAtExtremities ./placements/PlacementAtRatioPositions ./placements/PlacementInsidePolygon ./placements/PlacementOnLine ./placements/PlacementOnVertices ./placements/PlacementPolygonCenter".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c,q,n,a,f,d,k,l,g,t){A.getEffectOperator=function(r){if(!r)return null;switch(r.type){case "CIMGeometricEffectAddControlPoints":return F.EffectAddControlPoints.local();case "CIMGeometricEffectArrow":return E.EffectArrow.local();case "CIMGeometricEffectBuffer":return C.EffectBuffer.local();case "CIMGeometricEffectCut":return B.EffectCut.local();case "CIMGeometricEffectDashes":return x.EffectDashes.local();case "CIMGeometricEffectDonut":return m.EffectDonut.local();case "CIMGeometricEffectJog":return p.EffectJog.local();
case "CIMGeometricEffectMove":return h.EffectMove.local();case "CIMGeometricEffectOffset":return b.EffectOffset.local();case "CIMGeometricEffectReverse":return e.EffectReverse.local();case "CIMGeometricEffectRotate":return c.EffectRotate.local();case "CIMGeometricEffectScale":return q.EffectScale.local();case "CIMGeometricEffectWave":return n.EffectWave.local()}return null};A.getPlacementOperator=function(r){if(!r)return null;switch(r.type){case "CIMMarkerPlacementAlongLineSameSize":return a.PlacementAlongLineSameSize.local();
case "CIMMarkerPlacementAtExtremities":return f.PlacementAtExtremities.local();case "CIMMarkerPlacementAtRatioPositions":return d.PlacementAtRatioPositions.local();case "CIMMarkerPlacementInsidePolygon":return k.PlacementInsidePolygon.local();case "CIMMarkerPlacementOnLine":return l.PlacementOnLine.local();case "CIMMarkerPlacementOnVertices":return g.PlacementOnVertices.local();case "CIMMarkerPlacementPolygonCenter":return t.PlacementPolygonCenter.local()}return null};Object.defineProperty(A,"__esModule",
{value:!0})})},"esri/symbols/cim/effects/EffectAddControlPoints":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils","../CIMCursor"],function(A,F,E,C){let B=function(){function m(){}m.local=function(){null===m.instance&&(m.instance=new m);return m.instance};m.prototype.execute=function(p,h,b){return new x(p,h,b)};return m}();B.instance=null;let x=function(){function m(h,b,e){this._inputGeometries=h;this._angleTolerance=void 0!==b.angleTolerance?b.angleTolerance:
120;this._maxCosAngle=Math.cos((1-Math.abs(this._angleTolerance)/180)*Math.PI)}var p=m.prototype;p.next=function(){for(var h=this._inputGeometries.next();h;){if(E.isPolygon(h))return this._isClosed=!0,h=F.clone(h),this._processMultipath(h.rings),h;if(E.isPolyline(h))return this._isClosed=!1,h=F.clone(h),this._processMultipath(h.paths),h;if(E.isExtent(h)){if(this._maxCosAngle)return h;this._isClosed=!0;h=[[h.xmin,h.ymin],[h.xmin,h.ymax],[h.xmax,h.ymax],[h.xmax,h.ymin],[h.xmin,h.ymin]];this._processPath(h);
return{rings:[h]}}h=this._inputGeometries.next()}return null};p._processMultipath=function(h){if(h)for(const b of h)this._processPath(b)};p._processPath=function(h){if(h){let b=h.length,e=h[0],c,q,n,a,f,d;this._isClosed&&++b;for(let k=1;k<b;++k){let l;l=this._isClosed&&k===b-1?h[0]:h[k];const g=l[0]-e[0],t=l[1]-e[1],r=Math.sqrt(g*g+t*t);1<k&&0<r&&0<n&&(c*g+q*t)/r/n<=this._maxCosAngle&&C.setId(e,1);1===k&&(a=g,f=t,d=r);0<r&&(e=l,c=g,q=t,n=r)}this._isClosed&&0<n&&0<d&&(c*a+q*f)/d/n<=this._maxCosAngle&&
C.setId(h[0],1)}};return m}();A.EffectAddControlPoints=B;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/symbols/cim/CIMCursor":function(){define(["exports","../../core/lang","../../geometry/support/jsonUtils","./CIMPlacements"],function(A,F,E,C){function B(n){if(n){var a=n.length;for(--a;0<a;--a)n[a][0]-=n[a-1][0],n[a][1]-=n[a-1][1]}}function x(n){if(n)for(const a of n)B(a)}function m(n){if(n){const a=n.length;for(let f=1;f<a;++f)n[f][0]+=n[f-1][0],n[f][1]+=n[f-1][1]}}function p(n){if(n)for(const a of n)m(a)}
function h(n){n&&(E.isPolygon(n)?p(n.rings):E.isPolyline(n)?p(n.paths):E.isMultipoint(n)&&m(n.points))}function b(n){n&&n.reverse()}function e(n){return{rings:[[[n.xmin,n.ymin],[n.xmin,n.ymax],[n.xmax,n.ymax],[n.xmax,n.ymin],[n.xmin,n.ymin]]]}}let c=function(){function n(a,f,d,k){this.acceptPolygon=f;this.acceptPolyline=d;this.geomUnitsPerPoint=k;this.pathIndex=this.pathCount=-1;this.iteratePath=!1;a&&(E.isPolygon(a)?f&&(this.multiPath=a.rings,this.isClosed=!0):E.isPolyline(a)?d&&(this.multiPath=
a.paths,this.isClosed=!1):E.isExtent(a)&&f&&(this.multiPath=e(a).rings,this.isClosed=!0),this.multiPath&&(this.pathCount=this.multiPath.length));this.internalPlacement=new C.Placement}n.prototype.next=function(){if(!this.multiPath)return null;for(;this.iteratePath||this.pathIndex<this.pathCount-1;){this.iteratePath||this.pathIndex++;const a=this.processPath(this.multiPath[this.pathIndex]);if(a)return a}this.pathIndex=this.pathCount=-1;return this.multiPath=null};return n}(),q=function(){function n(a,
f,d,k){this.inputGeometries=a;this.acceptPolygon=f;this.acceptPolyline=d;this.geomUnitsPerPoint=k;this.pathIndex=this.pathCount=-1;this.iteratePath=!1}n.prototype.next=function(){for(;;){if(!this.multiPath){for(var a=this.inputGeometries.next();a;)if(E.isPolygon(a)?this.acceptPolygon&&(this.multiPath=a.rings,this.isClosed=!0):E.isPolyline(a)?this.acceptPolyline&&(this.multiPath=a.paths,this.isClosed=!1):E.isExtent(a)&&this.acceptPolygon&&(this.multiPath=e(a).rings,this.isClosed=!0),this.multiPath){this.pathCount=
this.multiPath.length;this.pathIndex=-1;break}else a=this.inputGeometries.next();if(!this.multiPath)return null}for(;this.iteratePath||this.pathIndex<this.pathCount-1;)if(this.iteratePath||this.pathIndex++,a=this.processPath(this.multiPath[this.pathIndex]))return a;this.pathIndex=this.pathCount=-1;this.multiPath=null}};return n}();A.PathGeometryCursor=q;A.PathTransformationCursor=c;A.cloneAndDecodeGeometry=function(n){n=F.clone(n);h(n);return n};A.deltaDecodeGeometry=h;A.deltaEncodeGeometry=function(n){n&&
(E.isPolygon(n)?x(n.rings):E.isPolyline(n)?x(n.paths):E.isMultipoint(n)&&B(n.points))};A.getCoord2D=function(n,a,f){return[n[0]+(a[0]-n[0])*f,n[1]+(a[1]-n[1])*f]};A.getId=function(n){return n[4]};A.isClosedPath=function(n){return n&&0!==n.length?n[0][0]===n[n.length-1][0]&&n[0][1]===n[n.length-1][1]:!1};A.reverseMultipath=function(n){if(n)for(const a of n)b(a)};A.reversePath=b;A.setId=function(n,a){n[4]=a};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectArrow":function(){define(["exports",
"../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(A,F,E,C){let B=function(){function m(){}m.local=function(){null===m.instance&&(m.instance=new m);return m.instance};m.prototype.execute=function(p,h,b){return new x(p,h,b)};return m}();B.instance=null;let x=function(m){function p(b,e,c){b=m.call(this,b,!1,!0)||this;b._curveHelper=new C.CurveHelper;b._width=(void 0!==e.width?e.width:5)*c;b._arrowType=void 0!==e.geometricEffectArrowType?e.geometricEffectArrowType:
"OpenEnded";b._offsetFlattenError=C.PIXEL_TOLERANCE*c;return b}F._inheritsLoose(p,m);var h=p.prototype;h.processPath=function(b){switch(this._arrowType){default:return this._constructSimpleArrow(b,!0);case "Block":return this._constructSimpleArrow(b,!1);case "Crossed":return this._constructCrossedArrow(b)}};h._constructSimpleArrow=function(b,e){var c=this._curveHelper.calculatePathLength(b),q=this._width;c<2*q&&(q=c/2);c=this._curveHelper.getSubCurve(b,0,c-q);if(!c)return null;var n=q/2;if(this._curveHelper.isEmpty(c,
!1))return null;q=this._constructOffset(c,-n);if(!q)return null;c=this._constructOffset(c,n);if(!c)return null;const a=this._constructArrowBasePoint(q,-n/2);if(!a)return null;n=this._constructArrowBasePoint(c,n/2);if(!n)return null;b=b[b.length-1];e||(this._makeControlPoint(c,!0),this._makeControlPoint(q,!0));const f=new C.PathHelper;f.addPath(c,!0);f.lineTo(n);this._makeControlPoint(f.path());f.lineTo(b);this._makeControlPoint(f.path());f.lineTo(a);this._makeControlPoint(f.path());f.addPath(q,!1);
return e?{paths:[f.path()]}:(f.close(),{rings:[f.path()]})};h._constructCrossedArrow=function(b){var e=this._curveHelper.calculatePathLength(b),c=this._width;e<3.732050807568877*c&&(c=e/3.732050807568877);var q=this._curveHelper.getSubCurve(b,0,e-2.732050807568877*c);if(!q)return null;var n=c/2;if(this._curveHelper.isEmpty(q,!1))return null;const a=this._constructOffset(q,n);if(!a)return null;q=this._constructOffset(q,-n);if(!q)return null;e=this._curveHelper.getSubCurve(b,0,e-c);if(!e||this._curveHelper.isEmpty(e,
!1))return null;c=this._constructOffset(e,n);if(!c)return null;var f=this._constructOffset(e,-n);if(!f)return null;e=c[c.length-1];c=this._constructArrowBasePoint(c,n/2);if(!c)return null;const d=f[f.length-1];n=this._constructArrowBasePoint(f,-n/2);if(!n)return null;b=b[b.length-1];this._makeControlPoint(a,!1);this._makeControlPoint(q,!1);f=new C.PathHelper;f.addPath(a,!0);this._makeControlPoint(f.path());f.lineTo(d);f.lineTo(n);this._makeControlPoint(f.path());f.lineTo(b);this._makeControlPoint(f.path());
f.lineTo(c);this._makeControlPoint(f.path());f.lineTo(e);this._makeControlPoint(f.path());f.addPath(q,!1);return{paths:[f.path()]}};h._constructOffset=function(b,e){return this._curveHelper.offset(b,e,"Rounded",4,this._offsetFlattenError)};h._constructArrowBasePoint=function(b,e){if(!b||2>b.length)return null;var c=b[b.length-2];b=b[b.length-1];c=[b[0]-c[0],b[1]-c[1]];this._curveHelper.normalize(c);return[b[0]+c[1]*e,b[1]-c[0]*e]};h._makeControlPoint=function(b,e=!1){e?E.setId(b[0],1):E.setId(b[b.length-
1],1)};return p}(E.PathGeometryCursor);A.EffectArrow=B;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/symbols/cim/CurveHelper":function(){define(["exports"],function(A){let F=function(){function C(){this._path=[]}var B=C.prototype;B.path=function(){return this._path};B.addPath=function(x,m){m||x.reverse();Array.prototype.push.apply(this._path,x);m||x.reverse()};C.mergePath=function(x,m){m&&Array.prototype.push.apply(x,m)};B.startPath=function(x){this._path.push(x)};B.lineTo=function(x){this._path.push(x)};
B.close=function(){const x=this._path;1<x.length&&(x[0][0]!==x[x.length-1][0]||x[0][1]!==x[x.length-1][1])&&x.push([x[0][0],x[0][1]])};return C}(),E=function(){function C(x,m){}var B=C.prototype;B.normalize=function(x){const m=Math.sqrt(x[0]*x[0]+x[1]*x[1]);x[0]/=m;x[1]/=m};B.calculateLength=function(x,m){const p=m[0]-x[0];x=m[1]-x[1];return Math.sqrt(p*p+x*x)};B.calculateSegLength=function(x,m){return this.calculateLength(x[m],x[m+1])};B.calculatePathLength=function(x){let m=0;const p=x?x.length:
0;for(let h=0;h<p-1;++h)m+=this.calculateSegLength(x,h);return m};B.calculatePathArea=function(x){let m=0;const p=x?x.length:0;for(let h=0;h<p-1;++h)m+=(x[h+1][0]-x[h][0])*(x[h+1][1]+x[h][1]);return m/2};B.getCoord2D=function(x,m,p){return[x[0]+(m[0]-x[0])*p,x[1]+(m[1]-x[1])*p]};B.getSegCoord2D=function(x,m,p){return this.getCoord2D(x[m],x[m+1],p)};B.getAngle=function(x,m,p){return Math.atan2(m[1]-x[1],m[0]-x[0])};B.getSegAngle=function(x,m,p){return this.getAngle(x[m],x[m+1],p)};B.getAngleCS=function(x,
m,p){p=m[0]-x[0];x=m[1]-x[1];m=Math.sqrt(p*p+x*x);return 0<m?[p/m,x/m]:[1,0]};B.getSegAngleCS=function(x,m,p){return this.getAngleCS(x[m],x[m+1],p)};B.cut=function(x,m,p,h){p=0>=p?x[m]:this.getSegCoord2D(x,m,p);x=1<=h?x[m+1]:this.getSegCoord2D(x,m,h);return[p,x]};B.addSegment=function(x,m,p){p&&x.push(m[0]);x.push(m[1])};B.getSubCurve=function(x,m,p){const h=[];return this.appendSubCurve(h,x,m,p)?h:null};B.appendSubCurve=function(x,m,p,h){const b=m?m.length-1:0;let e=0,c=!0,q=0;for(;q<b;){const a=
this.calculateSegLength(m,q);if(0!==a){if(c){if(e+a>p){var n=(p-e)/a;let f=1,d=!1;e+a>=h&&(f=(h-e)/a,d=!0);(n=this.cut(m,q,n,f))&&this.addSegment(x,n,c);if(d)break;c=!1}}else{if(e+a>h){(m=this.cut(m,q,0,(h-e)/a))&&this.addSegment(x,m,c);break}this.addSegment(x,[m[q],m[q+1]],c)}e+=a}++q}return!0};B.getCIMPointAlong=function(x,m){const p=x?x.length-1:0;let h=0,b=-1;for(;b<p;){++b;const e=this.calculateSegLength(x,b);if(0!==e){if(h+e>m)return this.getCoord2D(x[b],x[b+1],(m-h)/e);h+=e}}return null};B.isEmpty=
function(x,m){if(!x||1>=x.length)return!0;const p=x?x.length-1:0;let h=-1;for(;h<p;)if(++h,x[h+1][0]!==x[h][0]||x[h+1][1]!==x[h][1]||m&&x[h+1][2]!==x[h][2])return!1;return!0};B.offset=function(x,m,p,h,b){if(!x||2>x.length)return null;b=x.length;const e=x[0][0]===x[b-1][0]&&x[0][1]===x[b-1][1];if(e){if(3>x.length)return null;--b}const c=[];var q=e?x[b-1]:null;let n=x[0];for(let k=0;k<b;k++){const l=k===b-1?e?x[0]:null:x[k+1];if(q)if(l){var a=[l[0]-n[0],l[1]-n[1]];this.normalize(a);q=[n[0]-q[0],n[1]-
q[1]];this.normalize(q);var f=q[0]*a[1]-q[1]*a[0],d=q[0]*a[0]+q[1]*a[1];if(0<=f===0>=m)a=[a[0]-q[0],a[1]-q[1]],this.normalize(a),q=Math.sqrt((1+d)/2),q>1/h&&(q=-Math.abs(m)/q,c.push([n[0]-a[0]*q,n[1]-a[1]*q]));else switch(p){case "Mitered":if(d=Math.sqrt((1+d)/2),0<d&&1/d<h){a=[a[0]-q[0],a[1]-q[1]];this.normalize(a);q=Math.abs(m)/d;c.push([n[0]-a[0]*q,n[1]-a[1]*q]);break}case "Bevelled":c.push([n[0]+q[1]*m,n[1]-q[0]*m]);c.push([n[0]+a[1]*m,n[1]-a[0]*m]);break;case "Rounded":c.push([n[0]+q[1]*m,n[1]-
q[0]*m]);d=.2;for(f=1;5>f;f++,d+=.2){const g=[q[1]*(1-d)+a[1]*d,-q[0]*(1-d)-a[0]*d];this.normalize(g);c.push([n[0]+g[0]*m,n[1]+g[1]*m])}c.push([n[0]+a[1]*m,n[1]-a[0]*m]);break;default:0>f?(c.push([n[0]+(q[1]+q[0])*m,n[1]+(q[1]-q[0])*m]),c.push([n[0]+(a[1]-a[0])*m,n[1]-(a[0]+a[1])*m])):(d=Math.sqrt((1+Math.abs(d))/2),a=[a[0]-q[0],a[1]-q[1]],this.normalize(a),q=m/d,c.push([n[0]-a[0]*q,n[1]-a[1]*q]))}}else a=[n[0]-q[0],n[1]-q[1]],this.normalize(a),c.push([n[0]+a[1]*m,n[1]-a[0]*m]);else a=[l[0]-n[0],
l[1]-n[1]],this.normalize(a),c.push([n[0]+a[1]*m,n[1]-a[0]*m]);q=n;n=l}e&&c.push([c[0][0],c[0][1]]);return c};return C}();A.CurveHelper=E;A.PIXEL_TOLERANCE=.03;A.PathHelper=F;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectBuffer":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper"],function(A,F,E){let C=function(){function x(){}x.local=function(){null===x.instance&&(x.instance=new x);return x.instance};x.prototype.execute=function(m,
p,h){return new B(m,p,h)};return x}();C.instance=null;let B=function(){function x(m,p,h){this._inputGeometries=m;this._curveHelper=new E.CurveHelper;this._size=(void 0!==p.size?p.size:1)*h;this._offsetFlattenError=E.PIXEL_TOLERANCE*h}x.prototype.next=function(){let m=this._inputGeometries.next();for(;m;){if(F.isExtent(m))if(0<this._size){var p=this._curveHelper.offset([[m.xmin,m.ymin],[m.xmin,m.ymax],[m.xmax,m.ymax],[m.xmax,m.ymin],[m.xmin,m.ymin]],this._size,"Rounded",4,this._offsetFlattenError);
if(p)return{rings:[p]}}else if(0>this._size){if(0<Math.min(m.xmax-m.xmin,m.ymax-m.ymin)+2*this._size)return{xmin:m.xmin-this._size,xmax:m.xmax+this._size,ymin:m.ymin-this._size,ymax:m.ymax+this._size}}else return m;if(F.isPolygon(m)){if(0===this._size)return m;p=[];for(const b of m.rings){var h=this._curveHelper.offset(b,this._size,"Rounded",4,this._offsetFlattenError);h&&p.push(h)}if(p.length)return{rings:p}}if(F.isPolyline(m)&&0<this._size){p=[];for(const b of m.paths)if(b&&1<b.length){h=this._curveHelper.offset(b,
this._size,"Rounded",4,this._offsetFlattenError);const e=this._curveHelper.offset(b,-this._size,"Rounded",4,this._offsetFlattenError);if(h&&e){for(let c=e.length-1;0<=c;c--)h.push(e[c]);h.push([h[0][0],h[0][1]]);p.push(h)}}if(p.length)return{rings:p}}F.isPoint(m);m=this._inputGeometries.next()}return null};return x}();A.EffectBuffer=C;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectCut":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor",
"../CurveHelper"],function(A,F,E,C){let B=function(){function m(){}m.local=function(){null===m.instance&&(m.instance=new m);return m.instance};m.prototype.execute=function(p,h,b){return new x(p,h,b)};return m}();B.instance=null;let x=function(m){function p(h,b,e){h=m.call(this,h,!0,!0)||this;h._curveHelper=new C.CurveHelper;h._beginCut=(void 0!==b.beginCut?b.beginCut:1)*e;h._endCut=(void 0!==b.endCut?b.endCut:1)*e;h._middleCut=(void 0!==b.middleCut?b.middleCut:0)*e;h._invert=void 0!==b.invert?b.invert:
!1;0>h._beginCut&&(h._beginCut=0);0>h._endCut&&(h._endCut=0);0>h._middleCut&&(h._middleCut=0);return h}F._inheritsLoose(p,m);p.prototype.processPath=function(h){var b=this._beginCut;const e=this._endCut,c=this._middleCut,q=this._curveHelper.calculatePathLength(h),n=[];if(!this._invert)0===b&&0===e&&0===c?n.push(h):b+e+c>=q||(0===c?(h=this._curveHelper.getSubCurve(h,b,q-e))&&n.push(h):((b=this._curveHelper.getSubCurve(h,b,.5*(q-c)))&&n.push(b),(b=this._curveHelper.getSubCurve(h,.5*(q+c),q-e))&&n.push(b)));
else if(0!==b||0!==e||0!==c)b+e+c>=q?n.push(h):((b=this._curveHelper.getSubCurve(h,0,b))&&n.push(b),(b=this._curveHelper.getSubCurve(h,.5*(q-c),.5*(q+c)))&&n.push(b),(b=this._curveHelper.getSubCurve(h,q-e,e))&&n.push(b));return 0===n.length?null:{paths:n}};return p}(E.PathGeometryCursor);A.EffectCut=B;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectDashes":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper","../GeometryWalker"],
function(A,F,E,C,B){let x=function(){function p(){}p.local=function(){null===p.instance&&(p.instance=new p);return p.instance};p.prototype.execute=function(h,b,e){return new m(h,b,e)};return p}();x.instance=null;let m=function(p){function h(b,e,c){b=p.call(this,b,!0,!0)||this;b._walker=new B.GeometryWalker;b._walker.updateTolerance(c);b._endings=e.lineDashEnding;b._customDashPos=void 0!==e.offsetAlongLine?e.offsetAlongLine*c:0;b._offsetAtEnd=void 0!==e.customEndingOffset?e.customEndingOffset*c:0;
b._pattern=new B.DashPattern;b._pattern.init(e.dashTemplate,!0);b._pattern.scale(c);return b}F._inheritsLoose(h,p);h.prototype.processPath=function(b){if(0===this._pattern.length())return this.iteratePath=!1,{paths:[b]};if(!this.iteratePath){var e=!0;switch(this._endings){default:this._pattern.extPtGap=0;break;case "FullPattern":this.isClosed||(this._pattern.extPtGap=.5*this._pattern.firstValue());break;case "FullGap":this.isClosed||(this._pattern.extPtGap=.5*this._pattern.lastValue());break;case "NoConstraint":this.isClosed||
(e=!1);break;case "Custom":this.isClosed||(this._pattern.extPtGap=.5*this._offsetAtEnd)}var c=this._walker.calculatePathLength(b);if(this._pattern.isEmpty()||c<.1*this._pattern.length()||!this._walker.init(b,this._pattern,e))return{paths:[b]}}if(this.iteratePath)b=this._pattern.nextValue();else{switch(this._endings){default:e=.5*this._pattern.firstValue();break;case "HalfGap":e=.5*-this._pattern.lastValue();break;case "FullGap":e=-this._pattern.lastValue();break;case "FullPattern":e=0;break;case "NoConstraint":case "Custom":e=
-this._customDashPos}b=e/this._pattern.length();b-=Math.floor(b);e=b*this._pattern.length();this._pattern.reset();b=this._pattern.nextValue();for(c=!1;e>=b;)e-=b,b=this._pattern.nextValue(),c=!c;b-=e;c?(this._walker.nextPosition(b),b=this._pattern.nextValue()):this.isClosed&&(this._firstCurve=this._walker.nextCurve(b),b=this._pattern.nextValue(),this._walker.nextPosition(b),b=this._pattern.nextValue())}(e=this._walker.nextCurve(b))?this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(this._firstCurve.splice(0,
1),C.PathHelper.mergePath(e,this._firstCurve),this._firstCurve=null)):(b=this._pattern.nextValue(),!this._walker.nextPosition(b)||this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(e=this._firstCurve,this._firstCurve=null)):this.iteratePath=!0):(this.iteratePath=!1,e=this._firstCurve,this._firstCurve=null);return{paths:[e]}};return h}(E.PathGeometryCursor);A.EffectDashes=x;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/symbols/cim/GeometryWalker":function(){define(["exports",
"../../chunks/_rollupPluginBabelHelpers","./CIMCursor","./CurveHelper"],function(A,F,E,C){let B=function(){function p(){this._values=[];this._currentValue=this._length=this.ctrlPtGap=this.extPtGap=0}var h=p.prototype;h.isEmpty=function(){return 0===this._values.length};h.size=function(){return this._values.length};h.init=function(b,e,c=!0){this._setEmpty();if(!b||0===b.length)return!1;for(let q=0;q<b.length;q++){let n=Math.abs(b[q]);c&&1E-7>n&&(n=1E-7);this._values.push(n);this._length+=n}e&&b.length&
1&&(this._length*=2);if(0===this._length)return!1;this.ctrlPtGap=this.extPtGap=0;this._currentValue=-1;return!0};h.scale=function(b){const e=this._values?this._values.length:0;for(let c=0;c<e;++c)this._values[c]*=b;this._length*=b;this.extPtGap*=b;this.ctrlPtGap*=b};h.addValue=function(b){this._length+=b;this._values.push(b)};h.firstValue=function(){return this._values[0]};h.lastValue=function(){return this._values[this._values.length-1]};h.nextValue=function(){this._currentValue++;this._currentValue===
this._values.length&&(this._currentValue=0);return this._values[this._currentValue]};h.reset=function(){this._currentValue=-1};h.length=function(){return this._length};h._setEmpty=function(){this.extPtGap=this.ctrlPtGap=this._length=0;this._currentValue=-1;this._values.length=0};return p}(),x=function(){function p(){this.reset()}var h=p.prototype;h.reset=function(){this.segment=-1;this.abscissa=this.segmentLength=0;this.isPartEnd=this.isPathEnd=!1};h.isValid=function(){return-1!==this.segment};h.copyTo=
function(b){b.segment=this.segment;b.segmentLength=this.segmentLength;b.abscissa=this.abscissa;b.isPathEnd=this.isPathEnd;b.isPartEnd=this.isPartEnd};return p}(),m=function(p){function h(e=0,c=!1){e=p.call(this,e,c)||this;e._tolerance=C.PIXEL_TOLERANCE;e._currentPosition=new x;return e}F._inheritsLoose(h,p);var b=h.prototype;b.updateTolerance=function(e){this._tolerance=C.PIXEL_TOLERANCE*e};b.init=function(e,c,q=!0){q?(this._patternLength=c.length(),this._partExtPtGap=c.extPtGap,this._partCtrlPtGap=
c.ctrlPtGap):this._partCtrlPtGap=this._partExtPtGap=this._patternLength=0;this._currentPosition.reset();this._partSegCount=0;this._path=e;this._seg=-1;return this.setPosAtNextPart()};b.curPositionIsValid=function(){return this._currentPosition.isValid()};b.nextPosition=function(e,c=0){const q=new x;if(!this._nextPosition(e,q,null,c))return!1;q.copyTo(this._currentPosition);return!0};b.curPointAndAngle=function(e){e.pt=this._getPoint(this._currentPosition);const [c,q]=this._getAngle(this._currentPosition);
e.ca=c;e.sa=q};b.nextPointAndAngle=function(e,c,q=0){const n=new x;if(!this._nextPosition(e,n,null,q))return!1;n.copyTo(this._currentPosition);c.pt=this._getPoint(n);const [a,f]=this._getAngle(n);c.ca=a;c.sa=f;return!0};b.nextCurve=function(e){if(0===e)return null;const c=[],q=new x;if(!this._nextPosition(e,q,c,1))return null;q.copyTo(this._currentPosition);return c};b.isPathEnd=function(){return this._currentPosition.isPathEnd};b.getPathEnd=function(){if(-1===this._currentPosition.segment)throw Error("missing segment");
return this._path[this._currentPosition.segment+1]};b._nextPosition=function(e,c,q,n){if(this._currentPosition.isPathEnd)return!1;var a=this._currentPosition.abscissa;0<this._currentPosition.segmentLength&&(a/=this._currentPosition.segmentLength);for(this._currentPosition.copyTo(c);c.abscissa+e*this._partLengthRatio>c.segmentLength+this._tolerance;)if(q&&(0===q.length&&(0===a?(a=this._path[c.segment],q.push([a[0],a[1]])):q.push(this.getSegCoord2D(this._path,c.segment,a))),a=this._path[c.segment+1],
q.push([a[0],a[1]])),a=0,e-=(c.segmentLength-c.abscissa)/this._partLengthRatio,this._partSegCount)c.segment=this.nextSegment(),c.segmentLength=this.calculateSegLength(this._path,c.segment),c.abscissa=0,this._partSegCount--;else{if(!this.setPosAtNextPart()){if(0===n)return!1;c.segmentLength=this.calculateSegLength(this._path,c.segment);c.isPartEnd=!0;1===n?(c.abscissa=c.segmentLength,c.isPathEnd=!0):c.abscissa=c.segmentLength+e;return!0}this._currentPosition.copyTo(c)}c.abscissa+=e*this._partLengthRatio;
q&&(0===q.length&&(0===a?(e=this._path[c.segment],q.push([e[0],e[1]])):q.push(this.getSegCoord2D(this._path,c.segment,a))),e=c.abscissa/c.segmentLength,1===e?(e=this._path[c.segment+1],q.push([e[0],e[1]])):q.push(this.getSegCoord2D(this._path,c.segment,e)));!this._partSegCount&&Math.abs(c.abscissa-c.segmentLength)<this._tolerance&&(c.isPathEnd=this._partIsLast,c.isPartEnd=!0);return!0};b._getPoint=function(e){if(-1===e.segment)throw Error("missing segment");return this.getSegCoord2D(this._path,e.segment,
0>=e.segmentLength?0:e.abscissa/e.segmentLength)};b._getAngle=function(e){if(-1===e.segment)throw Error("missing segment");return this.getSegAngleCS(this._path,e.segment,0>=e.segmentLength?0:e.abscissa/e.segmentLength)};b.setPosAtNextPart=function(){for(;this._partSegCount;)this.hasNextSegment()&&this.nextSegment(),this._partSegCount--;if(!this.hasNextSegment())return!1;this._partLength=0;this._partIsLast=!0;for(this._partSegCount=0;this.hasNextSegment();)if(this._partLength+=this.calculateSegLength(this._path,
this.nextSegment()),this._partSegCount++,1===E.getId(this._path[this.getEndPointIndex()])){this._partIsLast=!this.hasNextSegment();break}for(var e=this._partSegCount;e;)this.previousSegment(),--e;this._currentPosition.segment=this.nextSegment();this._currentPosition.segmentLength=this.calculateSegLength(this._path,this._currentPosition.segment);this._currentPosition.abscissa=0;this._currentPosition.isPathEnd=this._currentPosition.isPartEnd=!1;--this._partSegCount;e=this.getStartPointIndex();this._ctrlPtBegin=
1===E.getId(this._path[e]);e=e+this._partSegCount+1;e>=this._path.length&&(e=0);this._ctrlPtEnd=1===E.getId(this._path[e]);if(0<this._patternLength){e=this._ctrlPtBegin?this._partCtrlPtGap:this._partExtPtGap;const c=this._ctrlPtEnd?this._partCtrlPtGap:this._partExtPtGap;let q=Math.round((this._partLength-(e+c))/this._patternLength);0>=q&&(q=0<e+c?0:1);this._partLengthRatio=this._partLength/(e+c+q*this._patternLength);.01>this._partLengthRatio&&(this._partLengthRatio=1)}else this._partLengthRatio=
1;return!0};b.hasNextSegment=function(){return this._seg<this._path.length-2};b.previousSegment=function(){return--this._seg};b.nextSegment=function(){return++this._seg};b.getStartPointIndex=function(){return this._seg};b.getEndPointIndex=function(){return this._seg+1};return h}(C.CurveHelper);A.DashPattern=B;A.GeometryWalker=m;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectDonut":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper"],
function(A,F,E){let C=function(){function x(){}x.local=function(){null===x.instance&&(x.instance=new x);return x.instance};x.prototype.execute=function(m,p,h){return new B(m,p,h)};return x}();C.instance=null;let B=function(){function x(m,p,h){this._inputGeometries=m;this._curveHelper=new E.CurveHelper;this._width=(void 0!==p.width?p.width:2)*h;switch(p.method){default:this._method="Mitered";break;case "Bevelled":this._method="Bevelled";break;case "Rounded":case "TrueBuffer":this._method="Rounded";
break;case "Square":this._method="Square"}this._option=p.option;this._offsetFlattenError=E.PIXEL_TOLERANCE*h}x.prototype.next=function(){for(var m=this._inputGeometries.next();m;){if(F.isExtent(m)&&0<this._width){if(0>Math.min(m.xmax-m.xmin,m.ymax-m.ymin)-2*this._width)return m;var p=[];p.push([[m.xmin,m.ymin],[m.xmin,m.ymax],[m.xmax,m.ymax],[m.xmax,m.ymin],[m.xmin,m.ymin]]);p.push([[m.xmin+this._width,m.ymin+this._width],[m.xmax-this._width,m.ymin+this._width],[m.xmax-this._width,m.ymax-this._width],
[m.xmin+this._width,m.ymax-this._width],[m.xmin+this._width,m.ymin+this._width]]);return{rings:p}}if(F.isPolygon(m)&&0<this._width){p=[];for(const h of m.rings){m=this._curveHelper.calculatePathLength(h);const b=this._curveHelper.offset(h,this._width,this._method,4,this._offsetFlattenError);b&&(0>m&&b.reverse(),p.push(b))}if(p.length)return{rings:p}}m=this._inputGeometries.next()}return null};return x}();A.EffectDonut=C;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectJog":function(){define(["exports",
"../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(A,F,E,C){let B=function(){function m(){}m.local=function(){null===m.instance&&(m.instance=new m);return m.instance};m.prototype.execute=function(p,h,b){return new x(p,h,b)};return m}();B.instance=null;let x=function(m){function p(h,b,e){h=m.call(this,h,!1,!0)||this;h._curveHelper=new C.CurveHelper;h._length=(void 0!==b.length?b.length:20)*e;h._angle=void 0!==b.angle?b.angle:225;h._position=void 0!==b.position?b.position:
50;0>h._length&&(h._length=-h._length);20>h._position&&(h._position=20);80<h._position&&(h._position=80);h._mirror=!1;return h}F._inheritsLoose(p,m);p.prototype.processPath=function(h){if(this._curveHelper.isEmpty(h,!1))return null;const b=h[0];h=h[h.length-1];this._curveHelper.normalize([h[0]-b[0],h[1]-b[1]]);const e=[b[0]+(h[0]-b[0])*this._position/100,b[1]+(h[1]-b[1])*this._position/100],c=Math.cos((90-this._angle)/180*Math.PI);let q=Math.sin((90-this._angle)/180*Math.PI);this._mirror&&(q=-q);
this._mirror=!this._mirror;return{paths:[[b,[e[0]-this._length/2*c,e[1]-this._length/2*q],[e[0]+this._length/2*c,e[1]+this._length/2*q],h]]}};return p}(E.PathGeometryCursor);A.EffectJog=B;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectMove":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils"],function(A,F,E){let C=function(){function x(){}x.local=function(){null===x.instance&&(x.instance=new x);return x.instance};x.prototype.execute=
function(m,p,h){return new B(m,p,h)};return x}();C.instance=null;let B=function(){function x(p,h,b){this._inputGeometries=p;this._offsetX=void 0!==h.offsetX?h.offsetX*b:0;this._offsetY=void 0!==h.offsetY?-h.offsetY*b:0}var m=x.prototype;m.next=function(){for(var p=this._inputGeometries.next();p;){if(E.isExtent(p))return{xmin:p.xmin+this._offsetX,xmax:p.xmax+this._offsetX,ymin:p.ymin+this._offsetY,ymax:p.ymax+this._offsetY};if(E.isPolygon(p))return p=F.clone(p),this._moveMultipath(p.rings,this._offsetX,
this._offsetY),p;if(E.isPolyline(p))return p=F.clone(p),this._moveMultipath(p.paths,this._offsetX,this._offsetY),p;if(E.isMultipoint(p))return p=F.clone(p),this._movePath(p.points,this._offsetX,this._offsetY),p;if(E.isPoint(p))return{x:p.x+this._offsetX,y:p.y+this._offsetY};p=this._inputGeometries.next()}return null};m._moveMultipath=function(p,h,b){if(p)for(const e of p)this._movePath(e,h,b)};m._movePath=function(p,h,b){if(p)for(const e of p)e[0]+=h,e[1]+=b};return x}();A.EffectMove=C;Object.defineProperty(A,
"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectOffset":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper"],function(A,F,E){let C=function(){function x(){}x.local=function(){null===x.instance&&(x.instance=new x);return x.instance};x.prototype.execute=function(m,p,h){return new B(m,p,h)};return x}();C.instance=null;let B=function(){function x(m,p,h){this._inputGeometries=m;this._curveHelper=new E.CurveHelper;this._offset=(void 0!==p.offset?p.offset:1)*h;
this._method=p.method;this._option=p.option;this._offsetFlattenError=E.PIXEL_TOLERANCE*h}x.prototype.next=function(){for(var m=this._inputGeometries.next();m;){if(0===this._offset)return m;if(F.isExtent(m)){if("Rounded"===this._method&&0<this._offset){var p=this._curveHelper.offset([[m.xmin,m.ymin],[m.xmin,m.ymax],[m.xmax,m.ymax],[m.xmax,m.ymin],[m.xmin,m.ymin]],this._offset,this._method,4,this._offsetFlattenError);return p?{rings:[p]}:null}if(0<Math.min(m.xmax-m.xmin,m.ymax-m.ymin)+2*this._offset)return{xmin:m.xmin-
this._offset,xmax:m.xmax+this._offset,ymin:m.ymin-this._offset,ymax:m.ymax+this._offset}}if(F.isPolygon(m)){var h=[];for(p of m.rings){const b=this._curveHelper.offset(p,this._offset,this._method,4,this._offsetFlattenError);b&&h.push(b)}if(h.length)return{rings:h}}if(F.isPolyline(m)){h=[];for(const b of m.paths)(m=this._curveHelper.offset(b,this._offset,this._method,4,this._offsetFlattenError))&&h.push(m);if(h.length)return{paths:h}}m=this._inputGeometries.next()}return null};return x}();A.EffectOffset=
C;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectReverse":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils","../CIMCursor"],function(A,F,E,C){let B=function(){function m(){}m.local=function(){null===m.instance&&(m.instance=new m);return m.instance};m.prototype.execute=function(p,h,b){return new x(p,h,b)};return m}();B.instance=null;let x=function(){function m(p,h,b){this._inputGeometries=p;this._reverse=void 0!==h.reverse?
h.reverse:!0}m.prototype.next=function(){for(var p=this._inputGeometries.next();p;){if(!this._reverse)return p;if(E.isPolyline(p))return p=F.clone(p),C.reverseMultipath(p.paths),p;p=this._inputGeometries.next()}return null};return m}();A.EffectReverse=B;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectRotate":function(){define(["exports","../../../core/lang","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../../../geometry/support/jsonUtils"],
function(A,F,E,C,B){let x=function(){function p(){}p.local=function(){null===p.instance&&(p.instance=new p);return p.instance};p.prototype.execute=function(h,b,e){return new m(h,b,e)};return p}();x.instance=null;let m=function(){function p(b,e,c){this._inputGeometries=b;this._rotateAngle=void 0!==e.angle?-e.angle*Math.PI/180:0}var h=p.prototype;h.next=function(){for(var b=this._inputGeometries.next();b;){if(0===this._rotateAngle)return b;var e=E.create();C.getBoundsXY(e,b);const c=(e[2]+e[0])/2;e=
(e[3]+e[1])/2;if(B.isExtent(b))return b={rings:[[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]]]},this._rotateMultipath(b.rings,c,e),b;if(B.isPolygon(b))return b=F.clone(b),this._rotateMultipath(b.rings,c,e),b;if(B.isPolyline(b))return b=F.clone(b),this._rotateMultipath(b.paths,c,e),b;if(B.isMultipoint(b))return b=F.clone(b),this._rotatePath(b.points,c,e),b;if(B.isPoint(b))return b;b=this._inputGeometries.next()}return null};h._rotateMultipath=function(b,e,c){if(b)for(const q of b)this._rotatePath(q,
e,c)};h._rotatePath=function(b,e,c){if(b){const q=Math.cos(this._rotateAngle),n=Math.sin(this._rotateAngle);for(const a of b){b=a[0]-e;const f=a[1]-c;a[0]=e+b*q-f*n;a[1]=c+b*n+f*q}}};return p}();A.EffectRotate=x;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectScale":function(){define(["exports","../../../core/lang","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../../../geometry/support/jsonUtils"],function(A,F,E,C,B){let x=
function(){function p(){}p.local=function(){null===p.instance&&(p.instance=new p);return p.instance};p.prototype.execute=function(h,b,e){return new m(h,b,e)};return p}();x.instance=null;let m=function(){function p(b,e,c){this._inputGeometries=b;this._xFactor=void 0!==e.xScaleFactor?e.xScaleFactor:1.15;this._yFactor=void 0!==e.yScaleFactor?e.yScaleFactor:1.15}var h=p.prototype;h.next=function(){for(var b=this._inputGeometries.next();b;){if(1===this._xFactor&&1===this._yFactor)return b;var e=E.create();
C.getBoundsXY(e,b);const c=(e[2]+e[0])/2;e=(e[3]+e[1])/2;if(B.isExtent(b))return b={rings:[[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]]]},this._scaleMultipath(b.rings,c,e),b;if(B.isPolygon(b))return b=F.clone(b),this._scaleMultipath(b.rings,c,e),b;if(B.isPolyline(b))return b=F.clone(b),this._scaleMultipath(b.paths,c,e),b;if(B.isMultipoint(b))return b=F.clone(b),this._scalePath(b.points,c,e),b;if(B.isPoint(b))return b;b=this._inputGeometries.next()}return null};
h._scaleMultipath=function(b,e,c){if(b)for(const q of b)this._scalePath(q,e,c)};h._scalePath=function(b,e,c){if(b)for(const q of b)b=(q[1]-c)*this._yFactor,q[0]=e+(q[0]-e)*this._xFactor,q[1]=c+b};return p}();A.EffectScale=x;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectWave":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper","../GeometryWalker"],function(A,F,E,C){let B=function(){function m(){}m.local=function(){null===m.instance&&
(m.instance=new m);return m.instance};m.prototype.execute=function(p,h,b){return new x(p,h,b)};return m}();B.instance=null;let x=function(){function m(h,b,e){this._inputGeometries=h;this._height=(void 0!==b.amplitude?b.amplitude:2)*e;this._period=(void 0!==b.period?b.period:3)*e;this._style=b.waveform;0>=this._height&&(this._height=Math.abs(this._height));0>=this._period&&(this._period=Math.abs(this._period));this._pattern=new C.DashPattern;this._pattern.addValue(this._period);this._pattern.addValue(this._period);
this._walker=new C.GeometryWalker;this._walker.updateTolerance(e)}var p=m.prototype;p.next=function(){for(var h=this._inputGeometries.next();h;){if(0===this._height||0===this._period)return h;if(F.isPolyline(h)){const b=this._processGeom(h.paths);if(b.length)return{paths:b}}if(F.isPolygon(h)&&(h=this._processGeom(h.rings),h.length))return{rings:h};h=this._inputGeometries.next()}return null};p._processGeom=function(h){const b=[];for(const e of h)if(this._walker.init(e,this._pattern))switch(this._style){default:b.push(this._constructCurve(e,
!1));break;case "Square":b.push(this._constructSquare(e));break;case "Triangle":b.push(this._constructTriangle(e));break;case "Random":b.push(this._constructCurve(e,!0))}else b.push(e);return b};p._constructCurve=function(h,b){const e=new E.PathHelper;var c=this._walker.calculatePathLength(h),q=Math.round(c/this._period);0===q&&(q=1);const n=this._period/16,a=1/(16*q+1);c=2*Math.PI*c/(c/q);q=2*Math.PI*Math.random();const f=2*Math.PI*Math.random(),d=2*Math.PI*Math.random(),k=.75-Math.random()/2,l=
.75-Math.random()/2,g={};this._walker.curPointAndAngle(g);e.startPath(g.pt);let t=0;for(;;)if(this._walker.nextPointAndAngle(n,g)){const r=t;t+=a;let w;if(b){const v=this._height/2*(1+.3*Math.sin(k*c*r+q));w=v*Math.sin(c*r+f);w+=v*Math.sin(l*c*r+d);w/=2}else w=.5*this._height*Math.sin(.5*c*r);e.lineTo([g.pt[0]-w*g.sa,g.pt[1]+w*g.ca])}else{e.lineTo(h[h.length-1]);break}return e.path()};p._constructSquare=function(h){const b=new E.PathHelper;h=this._walker.calculatePathLength(h);Math.round(h/this._period);
for(h=!0;;){let e=!1;if(this._walker.curPositionIsValid()){const c={};this._walker.curPointAndAngle(c);const q={};if(this._walker.nextPointAndAngle(this._period,q)){const n={};this._walker.nextPointAndAngle(this._period,n)&&(h?(b.startPath(c.pt),h=!1):b.lineTo(c.pt),b.lineTo([c.pt[0]-this._height/2*c.sa,c.pt[1]+this._height/2*c.ca]),b.lineTo([q.pt[0]-this._height/2*q.sa,q.pt[1]+this._height/2*q.ca]),b.lineTo([q.pt[0]+this._height/2*q.sa,q.pt[1]-this._height/2*q.ca]),b.lineTo([n.pt[0]+this._height/
2*n.sa,n.pt[1]-this._height/2*n.ca]),e=!0)}}if(!e){b.lineTo(this._walker.getPathEnd());break}}return b.path()};p._constructTriangle=function(h){const b=new E.PathHelper;h=this._walker.calculatePathLength(h);Math.round(h/this._period);for(h=!0;;){let e=!1;if(this._walker.curPositionIsValid()){const c={};this._walker.curPointAndAngle(c);const q={};if(this._walker.nextPointAndAngle(this._period/2,q)){const n={};this._walker.nextPointAndAngle(this._period,n)&&(this._walker.nextPosition(this._period/2)&&
(h?(b.startPath(c.pt),h=!1):b.lineTo(c.pt),b.lineTo([q.pt[0]-this._height/2*q.sa,q.pt[1]+this._height/2*q.ca]),b.lineTo([n.pt[0]+this._height/2*n.sa,n.pt[1]-this._height/2*n.ca])),e=!0)}}if(!e){b.lineTo(this._walker.getPathEnd());break}}return b.path()};return m}();A.EffectWave=B;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementAlongLineSameSize":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../enums","../GeometryWalker"],
function(A,F,E,C,B){let x=function(){function p(){}p.local=function(){null===p.instance&&(p.instance=new p);return p.instance};p.prototype.execute=function(h,b,e){return new m(h,b,e)};return p}();x.instance=null;let m=function(p){function h(e,c,q){e=p.call(this,e,!0,!0)||this;e._grometryWalker=new B.GeometryWalker;e._grometryWalker.updateTolerance(q);e._angleToLine=void 0!==c.angleToLine?c.angleToLine:!0;e._offset=void 0!==c.offset?c.offset*q:0;e._originalEndings=c.endings;e._offsetAtEnd=void 0!==
c.customEndingOffset?c.customEndingOffset*q:0;e._position=void 0!==c.offsetAlongLine?c.offsetAlongLine*q:0;e._pattern=new B.DashPattern;e._pattern.init(c.placementTemplate,!1);e._pattern.scale(q);e._endings=e._originalEndings;return e}F._inheritsLoose(h,p);var b=h.prototype;b.processPath=function(e){if(this._pattern.isEmpty())return null;if(this.iteratePath)var c=this._pattern.nextValue();else{this._endings=this._originalEndings===C.PlacementEndings.WithFullGap&&this.isClosed?C.PlacementEndings.WithMarkers:
this._originalEndings;this._pattern.extPtGap=0;let q=!0;switch(this._endings){case C.PlacementEndings.NoConstraint:c=-this._position;c=this._adjustPosition(c);q=!1;break;default:c=-this._pattern.lastValue()/2;break;case C.PlacementEndings.WithFullGap:c=-this._pattern.lastValue();this._pattern.extPtGap=this._pattern.lastValue();break;case C.PlacementEndings.WithMarkers:c=0;break;case C.PlacementEndings.Custom:c=-this._position,c=this._adjustPosition(c),this._pattern.extPtGap=.5*this._offsetAtEnd}if(!this._grometryWalker.init(e,
this._pattern,q))return null;this._pattern.reset();for(e=0;c>e;)c-=e,e=this._pattern.nextValue();c=e-=c;this.iteratePath=!0}e={};if(!this._grometryWalker.nextPointAndAngle(c,e)||this._endings===C.PlacementEndings.WithFullGap&&this._grometryWalker.isPathEnd())return this.iteratePath=!1,null;if(this._endings===C.PlacementEndings.WithMarkers&&this._grometryWalker.isPathEnd()&&(this.iteratePath=!1,this.isClosed))return null;this.internalPlacement.setTranslate(e.pt[0]+this._offset*e.sa,e.pt[1]-this._offset*
e.ca);this._angleToLine&&this.internalPlacement.setRotateCS(e.ca,e.sa);return this.internalPlacement};b._adjustPosition=function(e){e/=this._pattern.length();e-=Math.floor(e);return e*this._pattern.length()};return h}(E.PathTransformationCursor);A.PlacementAlongLineSameSize=x;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/symbols/cim/enums":function(){define(["exports"],function(A){A.PlacementEndings=void 0;var F=A.PlacementEndings||(A.PlacementEndings={});F.NoConstraint="NoConstraint";
F.WithMarkers="WithMarkers";F.WithFullGap="WithFullGap";F.WithHalfGap="WithHalfGap";F.Custom="Custom";Object.defineProperty(A,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementAtExtremities":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(A,F,E,C){let B=function(){function m(){}m.local=function(){null===m.instance&&(m.instance=new m);return m.instance};m.prototype.execute=function(p,h,b){return new x(p,h,b)};return m}();
B.instance=null;let x=function(m){function p(b,e,c){b=m.call(this,b,!1,!0)||this;b._curveHelper=new C.CurveHelper;b._angleToLine=void 0!==e.angleToLine?e.angleToLine:!0;b._offset=void 0!==e.offset?e.offset*c:0;b._type=e.extremityPlacement;b._position=void 0!==e.offsetAlongLine?e.offsetAlongLine*c:0;b._beginProcessed=!1;return b}F._inheritsLoose(p,m);var h=p.prototype;h.processPath=function(b){let e;switch(this._type){default:this._beginProcessed?(e=this._atExtremities(b,this._position,!1),this.iteratePath=
this._beginProcessed=!1):(e=this._atExtremities(b,this._position,!0),this.iteratePath=this._beginProcessed=!0);break;case "JustBegin":e=this._atExtremities(b,this._position,!0);break;case "JustEnd":e=this._atExtremities(b,this._position,!1);case "None":}return e};h._atExtremities=function(b,e,c){var q=b.length;if(2>q)return null;var n=c?1:q-2;const a=c?q:-1,f=c?1:-1;let d=0;c=c?b[0]:b[q-1];for(q=n;q!==a;q+=f){n=c;c=b[q];const k=this._curveHelper.calculateLength(n,c);if(d+k>e){b=(e-d)/k;const [l,g]=
this._curveHelper.getAngleCS(n,c,b);b=E.getCoord2D(n,c,b);this.internalPlacement.setTranslate(b[0]-this._offset*g,b[1]+this._offset*l);this._angleToLine&&this.internalPlacement.setRotateCS(-l,-g);return this.internalPlacement}d+=k}return null};return p}(E.PathTransformationCursor);A.PlacementAtExtremities=B;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementAtRatioPositions":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor",
"../GeometryWalker"],function(A,F,E,C){let B=function(){function m(){}m.local=function(){null===m.instance&&(m.instance=new m);return m.instance};m.prototype.execute=function(p,h,b){return new x(p,h,b)};return m}();B.instance=null;let x=function(m){function p(h,b,e){h=m.call(this,h,!0,!0)||this;h._walker=new C.GeometryWalker;h._walker.updateTolerance(e);h._angleToLine=void 0!==b.angleToLine?b.angleToLine:!0;h._offset=void 0!==b.offset?b.offset*e:0;h._beginGap=void 0!==b.beginPosition?b.beginPosition*
e:0;h._endGap=void 0!==b.endPosition?b.endPosition*e:0;h._flipFirst=void 0!==b.flipFirst?b.flipFirst:!0;h._pattern=new C.DashPattern;h._pattern.init(b.positionArray,!1,!1);h._subPathLen=0;h._posCount=h._pattern.size();h._isFirst=!0;h._prevPos=0;return h}F._inheritsLoose(p,m);p.prototype.processPath=function(h){if(this._pattern.isEmpty())return null;if(this.iteratePath){h=this._pattern.nextValue()*this._subPathLen;var b=this._beginGap+h;h=b-this._prevPos;this._prevPos=b}else{this._posCount=this._pattern.size();
this._isFirst=!0;this._prevPos=0;this._subPathLen=this._walker.calculatePathLength(h)-this._beginGap-this._endGap;if(0>this._subPathLen)return this.iteratePath=!1,null;if(!this._walker.init(h,this._pattern,!1))return null;this._pattern.reset();h=this._pattern.nextValue()*this._subPathLen;b=this._beginGap+h;h=b-this._prevPos;this._prevPos=b;this.iteratePath=!0}b={};if(!this._walker.nextPointAndAngle(h,b,1))return this.iteratePath=!1,null;this.internalPlacement.setTranslate(b.pt[0]+this._offset*b.sa,
b.pt[1]-this._offset*b.ca);h=this._isFirst&&this._flipFirst;let e;this._angleToLine?(e=b.ca,b=b.sa):(e=1,b=0);h&&(e=-e,b=-b);this.internalPlacement.setRotateCS(e,b);this._isFirst=!1;this._posCount--;0===this._posCount&&(this.iteratePath=!1);return this.internalPlacement};return p}(E.PathTransformationCursor);A.PlacementAtRatioPositions=B;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementInsidePolygon":function(){define(["exports","../CIMPlacements"],function(A,
F){let E=function(){function B(){}B.local=function(){null===B.instance&&(B.instance=new B);return B.instance};B.prototype.execute=function(x,m,p){return new C(x,m,p)};return B}();E.instance=null;let C=function(){function B(m,p,h){this._currentY=this._currentX=this._yMax=this._yMin=this._xMax=this._xMin=0;this._stepX=(void 0!==p.stepX?Math.abs(p.stepX):16)*h;this._stepY=(void 0!==p.stepY?Math.abs(p.stepY):16)*h;if(0!==this._stepX&&0!==this._stepY&&m&&void 0!==m.rings&&m.rings){this._gridType=void 0!==
p.gridType?p.gridType:"Fixed";if("Random"===this._gridType)this._randomness=void 0!==p.randomness?p.randomness/100:1,this._gridAngle=0,this._shiftOddRows=!1,this._cosAngle=1,this._offsetY=this._offsetX=this._sinAngle=0;else{this._randomness=0;this._gridAngle=void 0!==p.gridAngle?p.gridAngle:0;this._shiftOddRows=void 0!==p.shiftOddRows?p.shiftOddRows:!1;this._offsetX=void 0!==p.offsetX?p.offsetX*h:0;this._offsetY=void 0!==p.offsetY?p.offsetY*h:0;this._cosAngle=Math.cos(this._gridAngle/180*Math.PI);
this._sinAngle=-Math.sin(this._gridAngle/180*Math.PI);if(this._stepX)if(0>this._offsetX)for(;this._offsetX<-.5*this._stepX;)this._offsetX+=this._stepX;else for(;this._offsetX>=.5*this._stepX;)this._offsetX-=this._stepX;if(this._stepY)if(0>this._offsetY)for(;this._offsetY<-.5*this._stepY;)this._offsetY+=this._stepY;else for(;this._offsetY>=.5*this._stepY;)this._offsetY-=this._stepY}this._graphicOriginY=this._graphicOriginX=0;this._internalPlacement=new F.Placement;this._calculateMinMax(m);this._geometry=
m}}var x=B.prototype;x.next=function(){return this._geometry?this._nextInside():null};x._calculateMinMax=function(m){this._yMax=this._yMin=this._xMax=this._xMin=0;let p,h,b,e,c;h=b=Number.MAX_VALUE;e=c=-Number.MAX_VALUE;for(const n of m.rings){const a=n?n.length:0;for(let f=0;f<a;++f){var q=n[f][0]-this._graphicOriginX-this._offsetX;p=n[f][1]-this._graphicOriginY-this._offsetY;m=this._cosAngle*q-this._sinAngle*p;q=this._sinAngle*q+this._cosAngle*p;h=Math.min(h,m);e=Math.max(e,m);b=Math.min(b,q);c=
Math.max(c,q)}}h+=this._graphicOriginX;e+=this._graphicOriginX;b+=this._graphicOriginY;c+=this._graphicOriginY;this._xMin=Math.round(h/this._stepX);this._xMax=Math.round(e/this._stepX);this._yMin=Math.round(b/this._stepY);this._yMax=Math.round(c/this._stepY);this._currentX=this._xMax+1;this._currentY=this._yMin-1};x._nextInside=function(){for(;;){if(this._currentX>this._xMax){this._currentY++;if(this._currentY>this._yMax)return null;this._currentX=this._xMin;this._shiftOddRows&&this._currentY%2&&
this._currentX--}var m=this._currentX*this._stepX+this._offsetX;this._shiftOddRows&&this._currentY%2&&(m+=.5*this._stepX);const p=this._currentY*this._stepY+this._offsetY;this._currentX++;let h;"Random"===this._gridType?(h=this._graphicOriginX+m+this._stepX*this._randomness*(.5-Math.random())*2/3,m=this._graphicOriginY+p+this._stepY*this._randomness*(.5-Math.random())*2/3):(h=this._graphicOriginX+this._cosAngle*m+this._sinAngle*p,m=this._graphicOriginY-this._sinAngle*m+this._cosAngle*p);this._internalPlacement.setTranslate(h,
m);return this._internalPlacement}};return B}();A.PlacementInsidePolygon=E;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementOnLine":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(A,F,E,C){let B=function(){function m(){}m.local=function(){null===m.instance&&(m.instance=new m);return m.instance};m.prototype.execute=function(p,h,b){return new x(p,h,b)};return m}();B.instance=null;let x=function(m){function p(b,
e,c){b=m.call(this,b,!0,!0)||this;b._curveHelper=new C.CurveHelper;b._angleToLine=void 0!==e.angleToLine?e.angleToLine:!0;b._offset=void 0!==e.offset?e.offset*c:0;b._relativeTo=e.relativeTo;b._position=void 0!==e.startPointOffset?e.startPointOffset*c:0;b._epsilon=.001*c;return b}F._inheritsLoose(p,m);var h=p.prototype;h.processPath=function(b){var e=this._position;if("SegmentMidpoint"===this._relativeTo){this.iteratePath||(this._segmentCount=b.length,this._curSegment=1,this.iteratePath=!0);for(;this._curSegment<
this._segmentCount;){var c=this._curSegment;this._curSegment++;e=b[c-1];c=b[c];const q=this._curveHelper.calculateLength(e,c);if(q<this._epsilon)continue;b=.5+this._position/q;const [n,a]=this._curveHelper.getAngleCS(e,c,b);b=E.getCoord2D(e,c,b);this.internalPlacement.setTranslate(b[0]-this._offset*a,b[1]+this._offset*n);this._angleToLine&&this.internalPlacement.setRotateCS(n,a);return this.internalPlacement}this.iteratePath=!1;return null}"LineEnd"===this._relativeTo&&E.reversePath(b);e=this.onLine(b,
e);"LineEnd"===this._relativeTo&&E.reversePath(b);return e};h.onLine=function(b,e){let c,q=!1;switch(this._relativeTo){default:c=this._curveHelper.calculatePathLength(b)/2+e;break;case "LineBeginning":c=e;break;case "LineEnd":c=e,q=!0}const n=b.length;let a=0,f=b[0];for(let d=1;d<n;++d){e=f;f=b[d];const k=this._curveHelper.calculateLength(e,f);if(a+k>c){b=(c-a)/k;const [l,g]=this._curveHelper.getAngleCS(e,f,b);b=E.getCoord2D(e,f,b);e=q?this._offset:-this._offset;this.internalPlacement.setTranslate(b[0]-
e*g,b[1]+e*l);this._angleToLine&&(q?this.internalPlacement.setRotateCS(-l,-g):this.internalPlacement.setRotateCS(l,g));return this.internalPlacement}a+=k}return null};return p}(E.PathTransformationCursor);A.PlacementOnLine=B;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementOnVertices":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(A,F,E,C){function B(p,h){const b=Math.PI;for(;Math.abs(h-p)>
b+2E-15;)h=h-p>b?h-2*b:h+2*b;return(p+h)/2}let x=function(){function p(){}p.local=function(){null===p.instance&&(p.instance=new p);return p.instance};p.prototype.execute=function(h,b,e){return new m(h,b,e)};return p}();x.instance=null;let m=function(p){function h(e,c,q){e=p.call(this,e,!0,!0)||this;e._curveHelper=new C.CurveHelper;e._angleToLine=void 0!==c.angleToLine?c.angleToLine:!0;e._offset=void 0!==c.offset?c.offset*q:0;e._endPoints=void 0!==c.placeOnEndPoints?c.placeOnEndPoints:!0;e._controlPoints=
void 0!==c.placeOnControlPoints?c.placeOnControlPoints:!0;e._regularVertices=void 0!==c.placeOnRegularVertices?c.placeOnRegularVertices:!0;e._tags=[];e._tagIterator=0;return e}F._inheritsLoose(h,p);var b=h.prototype;b.processPath=function(e){this.iteratePath||(this._preparePath(e),this.iteratePath=!0);if(this._tagIterator>=this._tags.length)return this._tagIterator=this._tags.length=0,this.iteratePath=!1,null;e=this._tags[this._tagIterator];this._angleToLine&&this.internalPlacement.setRotate(e[2]);
let c=e[0],q=e[1];if(0!==this._offset){const n=Math.cos(e[2]);c-=this._offset*Math.sin(e[2]);q+=this._offset*n}this.internalPlacement.setTranslate(c,q);this._tagIterator++;return this.internalPlacement};b._preparePath=function(e){this._tagIterator=this._tags.length=0;const c=E.isClosedPath(e),q=e.length-1;let n=0,a=0,f=0,d=0,k=0,l,g;for(;n<q;){n++;l=e[n-1];g=e[n];const t=E.getId(l),r=E.getId(g);if(this._angleToLine||0!==this._offset)d=this._curveHelper.getAngle(l,g,0);1===n?c?(a=d,f=t):this._endPoints&&
this._tags.push([l[0],l[1],d]):1===t?this._controlPoints&&this._tags.push([l[0],l[1],B(k,d)]):this._regularVertices&&this._tags.push([l[0],l[1],B(k,d)]);if(this._angleToLine||0!==this._offset)k=this._curveHelper.getAngle(l,g,1);n===q&&(c?1===r||1===f?this._controlPoints&&this._tags.push([g[0],g[1],B(k,a)]):this._regularVertices&&this._tags.push([g[0],g[1],B(k,a)]):this._endPoints&&this._tags.push([g[0],g[1],k]))}this._tagIterator=0};return h}(E.PathTransformationCursor);A.PlacementOnVertices=x;Object.defineProperty(A,
"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementPolygonCenter":function(){define(["exports","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../CIMPlacements"],function(A,F,E,C){let B=function(){function m(){}m.local=function(){null===m.instance&&(m.instance=new m);return m.instance};m.prototype.execute=function(p,h,b){return new x(p,h,b)};return m}();B.instance=null;let x=function(){function m(h,b,e){this._geometry=h;this._offsetX=void 0!==b.offsetX?
b.offsetX*e:0;this._offsetY=void 0!==b.offsetY?b.offsetY*e:0;this._method=void 0!==b.method?b.method:"OnPolygon";this._internalPlacement=new C.Placement}var p=m.prototype;p.next=function(){const h=this._geometry;this._geometry=null;return h&&void 0!==h.rings?this._polygonCenter(h):null};p._polygonCenter=function(h){switch(this._method){default:case "CenterOfMass":case "BoundingBoxCenter":{const b=F.create();E.getBoundsXY(b,h);this._internalPlacement.setTranslate((b[2]+b[0])/2+this._offsetX,(b[3]+
b[1])/2-this._offsetY)}}return this._internalPlacement};return m}();A.PlacementPolygonCenter=B;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/symbols/cim/Rect":function(){define(["../../chunks/_rollupPluginBabelHelpers"],function(A){return function(){function F(E=0,C=0,B=0,x=0){this.x=E;this.y=C;this.width=B;this.height=x}F.prototype.union=function(E){this.x=Math.min(this.x,E.x);this.y=Math.min(this.y,E.y);this.width=Math.max(this.width,E.width);this.height=Math.max(this.height,E.height)};
A._createClass(F,[{key:"isEmpty",get:function(){return 0>=this.width||0>=this.height}}]);return F}()})},"esri/symbols/cim/packingUtils":function(){define(["exports"],function(A){function F(m,p=0){let h=0;for(let b=0;4>b;b++)h+=m[p+b]*B[b];return h}function E(m){return m-Math.floor(m)}const C=[1,256,65536,16777216],B=[1/256,1/65536,1/16777216,1/4294967296],x=F(new Uint8ClampedArray([255,255,255,255]));A.packFloatRGBA=function(m,p,h=0){m=0>m?0:m>x?x:m;for(let b=0;4>b;b++)p[h+b]=Math.floor(256*E(m*C[b]))};
A.unpackFloatRGBA=F;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/symbols/cim/SDFHelper":function(){define(["exports","../../geometry/support/jsonUtils","./packingUtils","./Rect"],function(A,F,E,C){function B(m){if(!m)return null;switch(m.type){case "CIMPointSymbol":m=m.symbolLayers;if(!m||1!==m.length)break;return B(m[0]);case "CIMVectorMarker":m=m.markerGraphics;if(!m||1!==m.length)break;var p=m[0];if(!p)break;m=p.geometry;if(!m)break;p=p.symbol;if(!p||"CIMPolygonSymbol"!==p.type&&"CIMLineSymbol"!==
p.type)break;return{geom:m,asFill:"CIMPolygonSymbol"===p.type};case "sdf":return{geom:m.geom,asFill:m.asFill}}return null}function x(m){let p=Infinity,h=-Infinity,b=Infinity,e=-Infinity;for(const c of m)for(const q of c)q[0]<p&&(p=q[0]),q[0]>h&&(h=q[0]),q[1]<b&&(b=q[1]),q[1]>e&&(e=q[1]);return[p,b,h,e]}A.buildSDF=function(m){var p=m.geom;var h=p?p.rings?p.rings:p.paths?p.paths:void 0!==p.xmin&&void 0!==p.ymin&&void 0!==p.xmax&&void 0!==p.ymax?[[[p.xmin,p.ymin],[p.xmin,p.ymax],[p.xmax,p.ymax],[p.xmax,
p.ymin],[p.xmin,p.ymin]]]:null:null;p=Infinity;var b=-Infinity;var e=Infinity,c=-Infinity;for(var q of h)for(var n of q)n[0]<p&&(p=n[0]),n[0]>b&&(b=n[0]),n[1]<e&&(e=n[1]),n[1]>c&&(c=n[1]);b=new C(p,e,b-p,c-e);e=64/Math.max(b.width,b.height);q=Math.round(b.width*e)+62;n=Math.round(b.height*e)+62;p=[];for(var a of h)if(a&&1<a.length){h=[];for(var f of a){let [u,y]=f;u-=b.x;y-=b.y;u*=e;y*=e;u+=30.5;y+=30.5;m.asFill?h.push([u,y]):h.push([Math.round(u),Math.round(y)])}m.asFill&&(c=h.length-1,h[0][0]===
h[c][0]&&h[0][1]===h[c][1]||h.push(h[0]));p.push(h)}var d;a=q*n;f=Array(a);for(h=0;h<a;++h)f[h]=962;for(d of p)for(h=d.length,b=1;b<h;++b){e=d[b-1];c=d[b];var k=void 0,l=void 0;e[0]<c[0]?(k=e[0],l=c[0]):(k=c[0],l=e[0]);var g=void 0,t=void 0;e[1]<c[1]?(g=e[1],t=c[1]):(g=c[1],t=e[1]);var r=Math.floor(k)-31;l=Math.floor(l)+31;g=Math.floor(g)-31;t=Math.floor(t)+31;0>r&&(r=0);l>q&&(l=q);0>g&&(g=0);t>n&&(t=n);k=c[0]-e[0];const u=c[1]-e[1],y=k*k+u*u;for(;r<l;r++)for(let D=g;D<t;D++){var w=(r-e[0])*k+(D-
e[1])*u,v=void 0;0>w?(v=e[0],w=e[1]):w>y?(v=c[0],w=c[1]):(w/=y,v=e[0]+w*k,w=e[1]+w*u);v=(r-v)*(r-v)+(D-w)*(D-w);w=(n-D-1)*q+r;v<f[w]&&(f[w]=v)}}for(d=0;d<a;++d)f[d]=Math.sqrt(f[d]);d=f;if(m.asFill)for(var z of p)for(m=z.length,p=1;p<m;++p)for(a=z[p-1],f=z[p],a[0]<f[0]?(h=a[0],b=f[0]):(h=f[0],b=a[0]),a[1]<f[1]?(c=a[1],e=f[1]):(c=f[1],e=a[1]),h=Math.floor(h),b=Math.floor(b)+1,c=Math.floor(c),e=Math.floor(e)+1,31>h&&(h=31),b>q-31&&(b=q-31),31>c&&(c=31),e>n-31&&(e=n-31);c<e;++c)if(a[1]>c!==f[1]>c){l=
(n-c-1)*q;for(g=h;g<b;++g)g<(f[0]-a[0])*(c-a[1])/(f[1]-a[1])+a[0]&&(d[l+g]=-d[l+g]);for(g=31;g<h;++g)d[l+g]=-d[l+g]}z=d.length;m=new Uint8Array(4*z);for(p=0;p<z;++p)E.packFloatRGBA(.5-d[p]/62,m,4*p);z=m;return[z,q,n]};A.getExtent=function(m){return m?m.rings?x(m.rings):m.paths?x(m.paths):F.isExtent(m)?[m.xmin,m.ymin,m.xmax,m.ymax]:null:null};A.getSDFInfo=B;A.getSDFMetrics=function(m,p,h,b,e){const [c,q,n,a]=m;if(n<c||a<q)return[0,0,0];var f=n-c,d=a-q;m=64/Math.max(f,d);f=Math.round(f*m);d=Math.round(d*
m)+62;let k=1;p&&(k=d/m/(p.ymax-p.ymin));let l=0,g=0;b&&(e?p&&h&&0<p.ymax-p.ymin&&(l=b.x/((p.xmax-p.xmin)/(p.ymax-p.ymin)*h),g=b.y/h):(l=b.x,g=b.y));l=.5*(p.xmax+p.xmin)+l*(p.xmax-p.xmin);g=.5*(p.ymax+p.ymin)+g*(p.ymax-p.ymin);l=(l-c)*m+31;g=(g-q)*m+31;return[k,l/(f+62)-.5,-(g/d-.5)]};A.getSDFSymbol=function(m){m=m.markerGraphics;if(!m||1!==m.length)return null;m=m[0];if(!m)return null;m=m.symbol;return!m||"CIMPolygonSymbol"!==m.type&&"CIMLineSymbol"!==m.type?null:m};Object.defineProperty(A,"__esModule",
{value:!0})})},"esri/views/2d/engine/webgl/fontUtils":function(){define(["exports"],function(A){function F(E){E=E.toLowerCase().split(" ").join("-");switch(E){case "serif":return"noto-serif";case "sans-serif":return"arial-unicode-ms";case "monospace":return"ubuntu-mono";case "fantasy":return"cabin-sketch";case "cursive":return"redressed";default:return E}}A.getFontDecorationTop=function(E){switch(E){case "underline":return-26;case "line-through":return-18}return NaN};A.getFullyQualifiedFontName=function(E){a:{if(E.weight)switch(E.weight.toLowerCase()){case "bold":case "bolder":var C=
"-bold";break a}C=""}a:{if(E.style)switch(E.style.toLowerCase()){case "italic":case "oblic":var B="-italic";break a}B=""}C+=B;return F(E.family)+(0<C.length?C:"-regular")};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/GlyphMosaic":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/promiseUtils ./Rect ./RectangleBinPack ../../../webgl/Texture".split(" "),function(A,F,E,C,B,x){function m(h){const b=new Set;for(const e of h)b.add(Math.floor(e/
256));return b}function p(h,b,e){h.has(b)||h.set(b,e().then(()=>{h.delete(b)}).catch(c=>{h.delete(b);E.throwIfNotAbortError(c)}));return h.get(b)}return function(){function h(e,c,q){this.height=this.width=0;this._dirties=[];this._glyphData=[];this._currentPage=0;this._glyphCache={};this._textures=[];this._rangePromises=new Map;this.width=e;this.height=c;this._glyphSource=q;this._binPack=new B(e-4,c-4);this._glyphData.push(new Uint8Array(e*c));this._dirties.push(!0);this._textures.push(null);this._initDecorationGlyph()}
var b=h.prototype;b.dispose=function(){this._binPack=null;for(const e of this._textures)e&&e.dispose();this._textures.length=0;this._glyphData.length=0};b._initDecorationGlyph=function(){var e=[117,149,181,207,207,181,149,117];const c=[];for(let q=0;q<e.length;q++){const n=e[q];for(let a=0;11>a;a++)c.push(n)}e={metrics:{width:5,height:2,left:0,top:0,advance:0},bitmap:new Uint8Array(c)};this._recordGlyph(e)};b.getGlyphItems=function(){var e=A._asyncToGenerator(function*(c,q,n){const a=this._getGlyphCache(c);
yield this._fetchRanges(c,q,n);return q.map(f=>this._getMosaicItem(a,c,f))});return function(c,q,n){return e.apply(this,arguments)}}();b.bind=function(e,c,q,n){const a=this._getTexture(e,q);a.setSamplingMode(c);this._dirties[q]&&(a.setData(this._glyphData[q]),this._dirties[q]=!1);e.bindTexture(a,n)};b._getGlyphCache=function(e){this._glyphCache[e]||(this._glyphCache[e]={});return this._glyphCache[e]};b._getTexture=function(e,c){this._textures[c]||(this._textures[c]=new x(e,{pixelFormat:6406,dataType:5121,
width:this.width,height:this.height},new Uint8Array(this.width*this.height)));return this._textures[c]};b._invalidate=function(){this._dirties[this._currentPage]=!0};b._fetchRanges=function(){var e=A._asyncToGenerator(function*(c,q,n){const a=[];m(q).forEach(f=>{a.push(this._fetchRange(c,f,n))});yield Promise.all(a)});return function(c,q,n){return e.apply(this,arguments)}}();b._fetchRange=function(){var e=A._asyncToGenerator(function*(c,q,n){return 256<q?null:p(this._rangePromises,c+q,()=>this._glyphSource.getRange(c,
q,n))});return function(c,q,n){return e.apply(this,arguments)}}();b._getMosaicItem=function(e,c,q){if(!e[q]){c=this._glyphSource.getGlyph(c,q);if(!c||!c.metrics)return{rect:new C(0,0,0,0),page:0,metrics:{left:0,width:0,height:0,advance:0,top:0},code:q,sdf:!0};const n=this._recordGlyph(c);e[q]={rect:n,page:this._currentPage,metrics:c.metrics,code:q,sdf:!0};this._invalidate()}return e[q]};b._recordGlyph=function(e){var c=e.metrics;if(0===c.width)c=new C(0,0,0,0);else{const q=c.width+6,n=c.height+6;
c=this._binPack.allocate(q,n);c.isEmpty&&(this._dirties[this._currentPage]||(this._glyphData[this._currentPage]=null),this._currentPage=this._glyphData.length,this._glyphData.push(new Uint8Array(this.width*this.height)),this._dirties.push(!0),this._textures.push(null),this._initDecorationGlyph(),this._binPack=new B(this.width-4,this.height-4),c=this._binPack.allocate(q,n));const a=this._glyphData[this._currentPage];e=e.bitmap;let f,d;if(e)for(let k=0;k<n;k++){f=q*k;d=this.width*(c.y+k)+c.x;for(let l=
0;l<q;l++)a[d+l]=e[f+l]}F("esri-glyph-debug")&&this._showDebugPage(a)}return c};b._showDebugPage=function(e){const c=document.createElement("canvas"),q=c.getContext("2d"),n=new ImageData(this.width,this.height),a=n.data;c.width=this.width;c.height=this.height;c.style.border="1px solid black";for(let f=0;f<e.length;++f)a[4*f]=e[f],a[4*f+1]=0,a[4*f+2]=0,a[4*f+3]=255;q.putImageData(n,0,0);document.body.appendChild(c)};return h}()})},"esri/views/2d/engine/webgl/Rect":function(){define(["../../../../chunks/_rollupPluginBabelHelpers"],
function(A){return function(){function F(E=0,C=0,B=0,x=0){this.x=E;this.y=C;this.width=B;this.height=x}F.prototype.union=function(E){this.x=Math.min(this.x,E.x);this.y=Math.min(this.y,E.y);this.width=Math.max(this.width,E.width);this.height=Math.max(this.height,E.height)};A._createClass(F,[{key:"isEmpty",get:function(){return 0>=this.width||0>=this.height}}]);return F}()})},"esri/views/2d/engine/webgl/RectangleBinPack":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","./Rect"],function(A,
F){return function(){function E(B,x){this._height=this._width=0;this._free=[];this._width=B;this._height=x;this._free.push(new F(0,0,B,x))}var C=E.prototype;C.allocate=function(B,x){if(B>this._width||x>this._height)return new F;let m=null,p=-1;for(let h=0;h<this._free.length;++h){const b=this._free[h];B<=b.width&&x<=b.height&&(null===m||b.y<=m.y&&b.x<=m.x)&&(m=b,p=h)}if(null===m)return new F;this._free.splice(p,1);m.width<m.height?(m.width>B&&this._free.push(new F(m.x+B,m.y,m.width-B,x)),m.height>
x&&this._free.push(new F(m.x,m.y+x,m.width,m.height-x))):(m.width>B&&this._free.push(new F(m.x+B,m.y,m.width-B,m.height)),m.height>x&&this._free.push(new F(m.x,m.y+x,B,m.height-x)));return new F(m.x,m.y,B,x)};C.release=function(B){for(let x=0;x<this._free.length;++x){const m=this._free[x];if(m.y===B.y&&m.height===B.height&&m.x+m.width===B.x)m.width+=B.width;else if(m.x===B.x&&m.width===B.width&&m.y+m.height===B.y)m.height+=B.height;else if(B.y===m.y&&B.height===m.height&&B.x+B.width===m.x)m.x=B.x,
m.width+=B.width;else if(B.x===m.x&&B.width===m.width&&B.y+B.height===m.y)m.y=B.y,m.height+=B.height;else continue;this._free.splice(x,1);this.release(B)}this._free.push(B)};A._createClass(E,[{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}}]);return E}()})},"esri/views/2d/engine/webgl/GlyphSource":function(){define(["../../../../request","../../../../core/pbf"],function(A,F){let E=function(){function B(m){this._metrics=[];for(this._bitmaps=[];m.next();)switch(m.tag()){case 1:{const p=
m.getMessage();for(;p.next();)switch(p.tag()){case 3:{const h=p.getMessage();let b,e,c,q,n,a,f;for(;h.next();)switch(h.tag()){case 1:b=h.getUInt32();break;case 2:e=h.getBytes();break;case 3:c=h.getUInt32();break;case 4:q=h.getUInt32();break;case 5:n=h.getSInt32();break;case 6:a=h.getSInt32();break;case 7:f=h.getUInt32();break;default:h.skip()}h.release();b&&(this._metrics[b]={width:c,height:q,left:n,top:a,advance:f},this._bitmaps[b]=e);break}default:p.skip()}p.release();break}default:m.skip()}}var x=
B.prototype;x.getMetrics=function(m){return this._metrics[m]};x.getBitmap=function(m){return this._bitmaps[m]};return B}(),C=function(){function B(){this._ranges=[]}var x=B.prototype;x.getRange=function(m){return this._ranges[m]};x.addRange=function(m,p){this._ranges[m]=p};return B}();return function(){function B(m){this._glyphInfo={};this._baseURL=m}var x=B.prototype;x.getRange=function(m,p,h){const b=this._getFontStack(m);if(b.getRange(p))return Promise.resolve();const e=256*p,c=e+255;m=this._baseURL.replace("{fontstack}",
m).replace("{range}",e+"-"+c);return A(m,{responseType:"array-buffer",...h}).then(q=>{b.addRange(p,new E(new F(new Uint8Array(q.data),new DataView(q.data))))})};x.getGlyph=function(m,p){if(m=this._getFontStack(m)){var h=Math.floor(p/256);if(!(256<h)&&(m=m.getRange(h)))return{metrics:m.getMetrics(p),bitmap:m.getBitmap(p)}}};x._getFontStack=function(m){let p=this._glyphInfo[m];p||(p=this._glyphInfo[m]=new C);return p};return B}()})},"esri/views/2d/engine/webgl/SDFConverter":function(){define(["../../../../core/promiseUtils",
"./packingUtils"],function(A,F){return function(){function E(B){this.size=B;const x=document.createElement("canvas");x.width=x.height=B;this._context=x.getContext("2d");this._gridOuter=new Float64Array(B*B);this._gridInner=new Float64Array(B*B);this._f=new Float64Array(B);this._d=new Float64Array(B);this._z=new Float64Array(B+1);this._v=new Int16Array(B)}var C=E.prototype;C.dispose=function(){this._context=this._gridOuter=this._gridInner=this._f=this._d=this._z=this._v=null;this._svg&&(document.body.removeChild(this._svg),
this._svg=null)};C.draw=function(B,x,m=31){this._initSVG();const p=this._createSVGString(B);return new Promise((h,b)=>{const e=new Image;e.src="data:image/svg+xml; charset\x3dutf8, "+encodeURIComponent(p);e.onload=()=>{e.onload=null;this._context.clearRect(0,0,this.size,this.size);this._context.drawImage(e,0,0,this.size,this.size);var q=this._context.getImageData(0,0,this.size,this.size);const n=new Uint8Array(this.size*this.size*4);for(let a=0;a<this.size*this.size;a++){const f=q.data[4*a+3]/255;
this._gridOuter[a]=1===f?0:0===f?1E20:Math.max(0,.5-f)**2;this._gridInner[a]=1===f?1E20:0===f?0:Math.max(0,f-.5)**2}this._edt(this._gridOuter,this.size,this.size);this._edt(this._gridInner,this.size,this.size);for(q=0;q<this.size*this.size;q++)F.packFloatRGBA(.5-(this._gridOuter[q]-this._gridInner[q])/(2*m),n,4*q);h(n)};const c=x&&x.signal;if(c)A.onAbort(c,()=>b(A.createAbortError()))})};C._initSVG=function(){if(!this._svg){const B=document.createElementNS("http://www.w3.org/2000/svg","svg");B.setAttribute("style",
"position: absolute;");B.setAttribute("width","0");B.setAttribute("height","0");B.setAttribute("aria-hidden","true");B.setAttribute("role","presentation");document.body.appendChild(B);this._svg=B}};C._createSVGString=function(B){const x=document.createElementNS("http://www.w3.org/2000/svg","path");x.setAttribute("d",B);this._svg.appendChild(x);B=x.getBBox();var m=B.width/B.height;const p=this.size/2;let h,b,e;1<m?(b=h=p/B.width,e=this.size/4,m=p-1/m*p/2):(h=b=p/B.height,e=p-p*m/2,m=this.size/4);x.setAttribute("style",
`transform: matrix(${h}, 0, 0, ${b}, ${-B.x*h+e}, ${-B.y*b+m})`);B=`<svg style="fill:red;" height="${this.size}" width="${this.size}" xmlns="http://www.w3.org/2000/svg">${this._svg.innerHTML}</svg>`;this._svg.removeChild(x);return B};C._edt=function(B,x,m){const p=this._f,h=this._d,b=this._v,e=this._z;for(var c=0;c<x;c++){for(var q=0;q<m;q++)p[q]=B[q*x+c];this._edt1d(p,h,b,e,m);for(q=0;q<m;q++)B[q*x+c]=h[q]}for(c=0;c<m;c++){for(q=0;q<x;q++)p[q]=B[c*x+q];this._edt1d(p,h,b,e,x);for(q=0;q<x;q++)B[c*
x+q]=Math.sqrt(h[q])}};C._edt1d=function(B,x,m,p,h){m[0]=0;p[0]=-1E20;p[1]=1E20;for(let b=1,e=0;b<h;b++){let c=(B[b]+b*b-(B[m[e]]+m[e]*m[e]))/(2*b-2*m[e]);for(;c<=p[e];)e--,c=(B[b]+b*b-(B[m[e]]+m[e]*m[e]))/(2*b-2*m[e]);e++;m[e]=b;p[e]=c;p[e+1]=1E20}for(let b=0,e=0;b<h;b++){for(;p[e+1]<b;)e++;x[b]=(b-m[e])*(b-m[e])+B[m[e]]}};return E}()})},"esri/views/2d/engine/webgl/packingUtils":function(){define(["exports"],function(A){function F(x){return x-Math.floor(x)}const E=[1,256,65536,16777216],C=[1/256,
1/65536,1/16777216,1/4294967296],B=function(x,m=0){let p=0;for(let h=0;4>h;h++)p+=x[m+h]*C[h];return p}(new Uint8ClampedArray([255,255,255,255]));A.packFloatRGBA=function(x,m,p=0){x=0>x?0:x>B?B:x;for(let h=0;4>h;h++)m[p+h]=Math.floor(256*F(x*E[h]))};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/SpriteMosaic":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Error ../../../../core/maybe ../../../webgl/BufferObject ../../../webgl/FramebufferObject ../../../../core/has ../../../webgl/checkWebGLError ../../../webgl/enums ../../../../chunks/builtins ../../../webgl/renderState ../../../webgl/Texture ../../../webgl/VertexArrayObject ./definitions ./GeometryUtils ./Rect ./RectangleBinPack".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c,q,n,a,f){function d(k){return k&&"static"===k.type}return function(){function k(g,t,r,w=0){this._mosaicPages=[];this._pageHeight=this._pageWidth=this._currentPage=this._maxItemSize=0;this._mosaicRects=new Map;this._spriteCopyQueue=[];this.pixelRatio=1;(0>=t||0>=r)&&console.error("Sprites mosaic defaultWidth and defaultHeight must be greater than zero!");this._pageWidth=t;this._pageHeight=r;this._requestRender=g;0<w&&(this._maxItemSize=w);this.pixelRatio=window.devicePixelRatio||
1;this._binPack=new f(this._pageWidth,this._pageHeight);this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(Math.floor(this._pageWidth)*Math.floor(this._pageHeight))},size:[this._pageWidth,this._pageHeight],dirty:!0,texture:void 0})}var l=k.prototype;l.getWidth=function(g){return g>=this._mosaicPages.length?-1:this._mosaicPages[g].size[0]};l.getHeight=function(g){return g>=this._mosaicPages.length?-1:this._mosaicPages[g].size[1]};l.getPageTexture=function(g){return g<this._mosaicPages.length?
this._mosaicPages[g].texture:null};l.has=function(g){return this._mosaicRects.has(g)};l.getSpriteItem=function(g){return this._mosaicRects.get(g)};l.addSpriteItem=function(g,t,r,w,v,z){if(this._mosaicRects.has(g))return this._mosaicRects.get(g);let u,y,D;d(r)?[u,y,D]=this._allocateImage(t[0],t[1]):(u=new a(0,0,t[0],t[1]),y=this._mosaicPages.length,this._mosaicPages.push({mosaicsData:r,size:t,dirty:!0,texture:void 0}));if(0>=u.width||0>=u.height)return null;z={rect:u,width:t[0],height:t[1],sdf:v,simplePattern:z,
pixelRatio:1,page:y};this._mosaicRects.set(g,z);d(r)&&this._copy({rect:u,spriteSize:t,spriteData:r.data,page:y,pageSize:D,repeat:w,sdf:v});return z};l.hasItemsToProcess=function(){return 0!==this._spriteCopyQueue.length};l.processNextItem=function(){const g=this._spriteCopyQueue.pop();g&&this._copy(g)};l.getSpriteItems=function(g){const t={};for(const r of g)t[r]=this.getSpriteItem(r);return t};l.getMosaicItemPosition=function(g){const t=(g=this.getSpriteItem(g))&&g.rect;if(!t)return null;t.width=
g.width;t.height=g.height;const r=q.SPRITE_PADDING,w=this._mosaicPages[g.page];return{size:[g.width,g.height],tl:[(t.x+r)/w[0],(t.y+r)/w[1]],br:[(t.x+r+g.width)/w[0],(t.y+r+g.height)/w[1]],page:g.page}};l.bind=function(g,t,r=0,w=0){r=this._mosaicPages[r];var v=r.mosaicsData,z=r.texture;z||(z=r.size,z=d(v)?new e(g,{pixelFormat:6408,dataType:5121,width:z[0],height:z[1]},new Uint8Array(v.data.buffer)):new e(g,{pixelFormat:6408,dataType:5121,samplingMode:9729,wrapMode:33071,width:z[0],height:z[1]},null),
r.texture=z);z.setSamplingMode(t);d(v)?(g.bindTexture(z,w),r.dirty&&(z.setData(new Uint8Array(v.data.buffer)),z.generateMipmap())):(t=v.data,v=t.bindFrame(g,z,w),E.isSome(this._requestRender)&&v&&0<t.frameCount&&this._requestRender.requestRender(),t.bindFrame(g,z,w));r.dirty=!1};k._copyBits=function(g,t,r,w,v,z,u,y,D,G,H){let J=w*t+r;u=y*z+u;if(H)for(u-=z,H=-1;H<=G;H++,J=((H+G)%G+w)*t+r,u+=z)for(y=-1;y<=D;y++)v[u+y]=g[J+(y+D)%D];else for(r=0;r<G;r++){for(w=0;w<D;w++)v[u+w]=g[J+w];J+=t;u+=z}};l._copy=
function(g){if(!(g.page>=this._mosaicPages.length)){var t=this._mosaicPages[g.page],r=t.mosaicsData;if(!d(t.mosaicsData))throw new F("mapview-invalid-resource","unsuitable data type!");var w=g.spriteData;(r=r.data)&&w||console.error("Source or target images are uninitialized!");k._copyBits(w,g.spriteSize[0],0,0,r,g.pageSize[0],g.rect.x+q.SPRITE_PADDING,g.rect.y+q.SPRITE_PADDING,g.spriteSize[0],g.spriteSize[1],g.repeat);t.dirty=!0}};l._allocateImage=function(g,t){g+=2*q.SPRITE_PADDING;t+=2*q.SPRITE_PADDING;
var r=Math.max(g,t);if(this._maxItemSize&&this._maxItemSize<r){r=2**Math.ceil(n.log2(g));const w=2**Math.ceil(n.log2(t));g=new a(0,0,g,t);this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(r*w)},size:[r,w],dirty:!0,texture:void 0});return[g,this._mosaicPages.length-1,[r,w]]}r=this._binPack.allocate(g,t);return 0>=r.width?(r=this._mosaicPages[this._currentPage],!r.dirty&&d(r.mosaicsData)&&(r.mosaicsData.data=null),this._currentPage=this._mosaicPages.length,this._mosaicPages.push({mosaicsData:{type:"static",
data:new Uint32Array(this._pageWidth*this._pageHeight)},size:[this._pageWidth,this._pageHeight],dirty:!0,texture:void 0}),this._binPack=new f(this._pageWidth,this._pageHeight),this._allocateImage(g,t)):[r,this._currentPage,[this._pageWidth,this._pageHeight]]};l.dispose=function(){this._binPack=null;for(const t of this._mosaicPages){var g=t.texture;g&&g.dispose();g=t.mosaicsData;d(g)||g.data.pause()}this._mosaicPages=null;this._mosaicRects.clear()};A._createClass(k,[{key:"itemCount",get:function(){return this._mosaicRects.size}}]);
return k}()})},"esri/views/2d/engine/webgl/animatedFormats/apng":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/Error","../../../../../core/promiseUtils"],function(A,F,E,C){function B(l,g=0,t=l.length-g){let r=-1;for(let w=g,v=g+t;w<v;w++)r=r>>>8^q[(r^l[w])&255];return r^-1}function x(l){const g=l.constructor===Uint8Array?l:new Uint8Array(l);return d.some((t,r)=>t!==g[r])?!1:!0}function m(l,g){const t=new Uint8Array(g);if(d.some((H,J)=>H!==t[J]))return a;
let r=!1;p(t,H=>!(r="acTL"===H));if(!r)return f;const w=[],v=[];let z=null,u=null,y=0;p(t,(H,J,K,L)=>{const M=new DataView(J.buffer);switch(H){case "IHDR":z=J.subarray(K+8,K+8+L);l.width=M.getUint32(K+8);l.height=M.getUint32(K+12);break;case "acTL":l.numPlays=M.getUint32(K+8+4);break;case "fcTL":u&&(l.frames.push(u),y++);u=new k;u.width=M.getUint32(K+8+4);u.height=M.getUint32(K+8+8);u.left=M.getUint32(K+8+12);u.top=M.getUint32(K+8+16);H=M.getUint16(K+8+20);J=M.getUint16(K+8+22);0===J&&(J=100);u.delay=
1E3*H/J;10>=u.delay&&(u.delay=100);l.playTime+=u.delay;u.disposeOp=M.getUint8(K+8+24);u.blendOp=M.getUint8(K+8+25);u.dataParts=[];0===y&&2===u.disposeOp&&(u.disposeOp=1);break;case "fdAT":u&&u.dataParts.push(J.subarray(K+8+4,K+8+L));break;case "IDAT":u&&u.dataParts.push(J.subarray(K+8,K+8+L));break;case "IEND":v.push(b(J,K,12+L));break;default:w.push(b(J,K,12+L))}});if(0===l.frames.length)return f;l.frameCount=l.frames.length;const D=new Blob(w),G=new Blob(v);l.frames.forEach(H=>{let J=[];J.push(d);
z.set(c(H.width),0);z.set(c(H.height),4);J.push(e("IHDR",z));J.push(D);H.dataParts.forEach(K=>J.push(e("IDAT",K)));J.push(G);H.data=new Blob(J,{type:"image/png"});delete H.dataParts;J=null});return l}function p(l,g){const t=new DataView(l.buffer);let r=8;let w,v;do{w=t.getUint32(r);var z=r+4;z=Array.prototype.slice.call(l.subarray(z,z+4));z=String.fromCharCode.apply(String,z);v=g(z,l,r,w);r+=12+w}while(!1!==v&&"IEND"!==z&&r<l.length)}function h(l){const g=new Uint8Array(l.length);for(let t=0;t<l.length;t++)g[t]=
l.charCodeAt(t);return g}function b(l,g,t){const r=new Uint8Array(t);r.set(l.subarray(g,g+t));return r}function e(l,g){const t=l.length+g.length,r=new Uint8Array(t+8),w=new DataView(r.buffer);w.setUint32(0,g.length);r.set(h(l),4);r.set(g,8);l=B(r,4,t);w.setUint32(t+4,l);return r}function c(l){return new Uint8Array([l>>>24&255,l>>>16&255,l>>>8&255,l&255])}const q=new Uint32Array(256);for(var n=0;256>n;n++){let l=n;for(let g=0;8>g;g++)l=0!==(l&1)?3988292384^l>>>1:l>>>1;q[n]=l}const a=new E("Not a PNG"),
f=new E("Not an animated PNG"),d=new Uint8Array([137,80,78,71,13,10,26,10]);n=function(){function l(){this.playTime=this.numPlays=this.height=this.width=0;this.frames=[];this.playing=this.paused=!1;this.playSpeed=1;this.currentFrameNumber=0;this._lastUsedFrame=-1}l.create=function(){var t=F._asyncToGenerator(function*(r,w){const v=new l;try{yield v._load(r,w)}catch(z){if(!C.isAbortError(z))return new E("invalid-resource",`Could not load PNG: ${z.message}`)}return v});return function(r,w){return t.apply(this,
arguments)}}();var g=l.prototype;g.play=function(){this.playing||(this.paused=!1,this.playing=!0,this._play())};g.pause=function(){this.paused=!0;this.playing=!1;clearTimeout(this.timerID)};g.togglePlay=function(){this.paused||!this.playing?this.play():this.pause()};g.bindFrame=function(t,r,w){t.bindTexture(r,w);t=this.frameChanged();if(!t)return!1;w=this.currentFrame;const v=w.frameData,z=r.descriptor;(w.left||w.top||w.width!==z.width||w.height!==z.height)&&r.setData(null);r.updateData(0,w.left,
w.top,w.width,w.height,v);this.updateUsedFrame();return t};g.frameChanged=function(){return this._lastUsedFrame!==this.currentFrameNumber};g.updateUsedFrame=function(){this._lastUsedFrame=this.currentFrameNumber};g._load=function(){var t=F._asyncToGenerator(function*(r,w){try{const v=m(this,r);if(v!==this)return v;this._resizeCanvas=document.createElement("canvas");this._resizeCanvas.width=this.width;this._resizeCanvas.height=this.height;yield Promise.all(this.frames.map(z=>z.createImage(this._resizeCanvas)))}catch(v){if(!C.isAbortError(v))return new E("invalid-resource",
"Could not parse PNG")}this.play()});return function(r,w){return t.apply(this,arguments)}}();g._play=function(){if(0===this.playSpeed)this.pause();else{if(0>this.playSpeed){--this.currentFrameNumber;0>this.currentFrameNumber&&(this.currentFrameNumber=this.frames.length-1);var t=this.currentFrameNumber;--t;0>t&&(t=this.frames.length-1);t=-this.frames[t].delay/this.playSpeed}else this.currentFrameNumber+=1,this.currentFrameNumber%=this.frames.length,t=1*this.frames[this.currentFrameNumber].delay/this.playSpeed;
var r=this.frames[this.currentFrameNumber];this.currentFrame={frameData:r.imageData,top:r.top,left:r.left,width:r.width,height:r.height};this.timerID=window.setTimeout(()=>this._play(),t)}};return l}();let k=function(){function l(){this.blendOp=this.disposeOp=this.delay=this.height=this.width=this.top=this.left=0;this.imageData=this.data=null}l.prototype.createImage=function(){var g=F._asyncToGenerator(function*(t){if(null===this.imageData)return new Promise((r,w)=>{const v=URL.createObjectURL(this.data),
z=document.createElement("img");z.onload=()=>{URL.revokeObjectURL(v);{t.width=z.width;t.height=z.height;var u=t.getContext("2d");u.drawImage(z,0,0,z.width,z.height);u=u.getImageData(0,0,z.width,z.height);u=new Uint8Array(u.data);let y;for(let D=0;D<u.length;D+=4)y=u[D+3]/255,u[D]*=y,u[D+1]*=y,u[D+2]*=y;u=new ImageData(new Uint8ClampedArray(u.buffer),z.width,z.height)}this.imageData=u;r()};z.onerror=()=>{URL.revokeObjectURL(v);this.imageData=null;w(Error("Image creation error"))};z.src=v})});return function(t){return g.apply(this,
arguments)}}();return l}();A["default"]=n;A.getPNGSize=function(l){l=new Uint8Array(l);let g,t;p(l,(r,w,v)=>{w=new DataView(w.buffer);"IHDR"===r&&(g=w.getUint32(v+8),t=w.getUint32(v+12))});return[g,t]};A.isAnimatedPNG=function(l){l=new Uint8Array(l);if(!x(l))return!1;let g=!1;p(l,t=>!(g="acTL"===t));return g};A.isPNG=x;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/animatedFormats/gif":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers",
"../../../../../core/Error","../../../../../core/promiseUtils"],function(A,F,E,C){function B(p){if(!p||0===p.byteLength)return!1;p=p.constructor===Uint8Array?p:new Uint8Array(p);return 71===p[0]&&73===p[1]&&70===p[2]&&56===p[3]}let x=function(){function p(){this.playing=this.paused=!1;this.waitTillDone=!0;this.firstFrameOnly=this.loading=!1;this.frames=[];this.comment="";this.frameCount=this.currentFrameNumber=this.length=0;this.playSpeed=1;this.lastFrame=null;this.playOnLoad=!0;this.complete=!1;
this.interlaceOffsets=[0,4,2,1];this.interlaceSteps=[8,8,4,2];this._lastUsedFrame=-1}p.create=function(){var b=F._asyncToGenerator(function*(e,c){const q=new p;try{yield q._load(e,c)}catch(n){if(!C.isAbortError(n))return new E("invalid-resource",`Could not load PNG: ${n.message}`)}return q});return function(e,c){return b.apply(this,arguments)}}();var h=p.prototype;h.play=function(){this.playing||(this.paused=!1,this.playing=!0,this._play())};h.pause=function(){this.paused=!0;this.playing=!1;clearTimeout(this.timerID)};
h.togglePlay=function(){this.paused||!this.playing?this.play():this.pause()};h.bindFrame=function(b,e,c){b.bindTexture(e,c);if(b=this.frameChanged())c=this.currentFrame,e.updateData(0,0,0,c.width,c.height,c.frameData),this.updateUsedFrame();return b};h.seekFrame=function(b){clearTimeout(this.timerID);this.currentFrameNumber=b%this.frames.length;this.playing?this._play():this._setCurrentFrame(this.currentFrameNumber)};h.seek=function(b){clearTimeout(this.timerID);0>b&&(b=0);b=1E3*b%this.length;let e=
0;for(;b>this.frames[e].time+this.frames[e].delay&&e<this.frames.length;)e+=1;this.currentFrameNumber=e;this.playing?this._play():this._setCurrentFrame(this.currentFrameNumber)};h.frameChanged=function(){return this._lastUsedFrame!==this.currentFrameNumber};h.updateUsedFrame=function(){this._lastUsedFrame=this.currentFrameNumber};h._load=function(){var b=F._asyncToGenerator(function*(e,c){try{this.loading=!0,yield this._parse(e,c),this.loading=!1,this.play()}catch(q){if(!C.isAbortError(q))return new E("invalid-resource",
"Could not parse gif!")}});return function(e,c){return b.apply(this,arguments)}}();h._parse=function(b,e){const c=new m(b);c.pos+=6;this.width=c.data[c.pos++]+(c.data[c.pos++]<<8);this.height=c.data[c.pos++]+(c.data[c.pos++]<<8);b=c.data[c.pos++];this.globalColourCount=1<<(b&7)+1;c.pos++;c.pos++;b&128&&(this.globalColourTable=this._parseColourTable(this.globalColourCount,c));return new Promise((q,n)=>{setTimeout(()=>this._parseBlock(c,q,n,e),0)})};h._parseBlock=function(){var b=F._asyncToGenerator(function*(e,
c,q,n){if(n&&n.signal&&C.isAborted(n.signal))q(C.createAbortError());else{var a=e.data[e.pos++];if(44===a){if(this._parseImg(e),this.firstFrameOnly){this._finishedLoading();c();return}}else{if(59===a){this._finishedLoading();c();return}this._parseExt(e)}if("function"===typeof this.onprogress)this.onprogress({bytesRead:e.pos,totalBytes:e.data.length,frame:this.frames.length});setTimeout(()=>this._parseBlock(e,c,q,n),0)}});return function(e,c,q,n){return b.apply(this,arguments)}}();h._parseColourTable=
function(b,e){const c=[];for(let q=0;q<b;q++)c.push([e.data[e.pos++],e.data[e.pos++],e.data[e.pos++]]);return c};h._parseImg=function(b){const e=n=>{const a=this.pixelBufSize/n;this.interlacedBufSize!==this.pixelBufSize&&(this.deinterlaceBuf=new Uint8Array(this.pixelBufSize),this.interlacedBufSize=this.pixelBufSize);let f=0;for(let d=0;4>d;d++)for(let k=this.interlaceOffsets[d];k<a;k+=this.interlaceSteps[d])this.deinterlaceBuf.set(this.pixelBuf.subarray(f,f+n),k*n),f+=n},c={};this.frames.push(c);
c.disposalMethod=this.disposalMethod;c.time=this.length;c.delay=10*this.delayTime;this.length+=c.delay;c.transparencyIndex=this.transparencyGiven?this.transparencyIndex:void 0;c.leftPos=b.data[b.pos++]+(b.data[b.pos++]<<8);c.topPos=b.data[b.pos++]+(b.data[b.pos++]<<8);c.width=b.data[b.pos++]+(b.data[b.pos++]<<8);c.height=b.data[b.pos++]+(b.data[b.pos++]<<8);const q=b.data[b.pos++];c.localColourTableFlag=q&128?!0:!1;c.localColourTableFlag&&(c.localColourTable=this._parseColourTable(1<<(q&7)+1,b));
this.pixelBufSize!==c.width*c.height&&(this.pixelBuf=new Uint8Array(c.width*c.height),this.pixelBufSize=c.width*c.height);this._lzwDecode(b.data[b.pos++],b.readSubBlocksB());q&64?(c.interlaced=!0,e(c.width)):c.interlaced=!1;this._processFrame(c)};h._lzwDecode=function(b,e){let c,q,n,a,f;let d,k;n=q=0;let l=[];const g=1<<b,t=g+1;a=b+1;for(k=!1;!k;){var r=f;for(c=f=0;c<a;c++)e[n>>3]&1<<(n&7)&&(f|=1<<c),n++;if(f===g){l=[];a=b+1;for(c=0;c<g;c++)l[c]=[c];l[g]=[];l[t]=null}else{if(f===t){k=!0;break}f>=
l.length?l.push(l[r].concat(l[r][0])):r!==g&&l.push(l[r].concat(l[f][0]));r=l[f];d=r.length;for(c=0;c<d;c++)this.pixelBuf[q++]=r[c];l.length===1<<a&&12>a&&a++}}};h._processFrame=function(b){b.image=document.createElement("canvas");b.image.width=this.width;b.image.height=this.height;b.ctx=b.image.getContext("2d");const e=b.localColourTableFlag?b.localColourTable:this.globalColourTable;null===this.lastFrame&&(this.lastFrame=b);const c=2===this.lastFrame.disposalMethod||3===this.lastFrame.disposalMethod?
!0:!1;c||b.ctx.drawImage(this.lastFrame.image,0,0,this.width,this.height);const q=b.ctx.getImageData(b.leftPos,b.topPos,b.width,b.height),n=b.transparencyIndex,a=q.data,f=b.interlaced?this.deinterlaceBuf:this.pixelBuf,d=f.length;let k=0,l,g;for(let t=0;t<d;t++)l=f[t],g=e[l],n!==l?(a[k++]=g[0],a[k++]=g[1],a[k++]=g[2],a[k++]=255):(c&&(a[k+3]=0),k+=4);b.ctx.putImageData(q,b.leftPos,b.topPos);this.lastFrame=b};h._parseExt=function(b){const e=b.data[b.pos++];249===e?this._parseGCExt(b):254===e?this.comment+=
b.readSubBlocks():255===e?this._parseAppExt(b):(1===e&&(b.pos+=13),b.readSubBlocks())};h._parseAppExt=function(b){b.pos+=1;"NETSCAPE"===b.getString(8)?b.pos+=8:(b.pos+=3,b.readSubBlocks())};h._parseGCExt=function(b){b.pos++;const e=b.data[b.pos++];this.disposalMethod=(e&28)>>2;this.transparencyGiven=e&1?!0:!1;this.delayTime=b.data[b.pos++]+(b.data[b.pos++]<<8);this.transparencyIndex=b.data[b.pos++];b.pos++};h._finishedLoading=function(){this.loading=!1;this.frameCount=this.frames.length;this.lastFrame=
null;this.complete=!0;this.deinterlaceBuf=this.pixelBufSize=this.deinterlaceBuf=this.pixelBuf=this.waitTillDone=this.transparencyIndex=this.delayTime=this.transparencyGiven=this.disposalMethod=void 0;this.currentFrameNumber=0;0<this.frames.length&&this._setCurrentFrame(0);this.playOnLoad&&this.play()};h._play=function(){if(0===this.playSpeed)this.pause();else{if(0>this.playSpeed){--this.currentFrameNumber;0>this.currentFrameNumber&&(this.currentFrameNumber=this.frames.length-1);var b=this.currentFrameNumber;
--b;0>b&&(b=this.frames.length-1);b=-this.frames[b].delay/this.playSpeed}else this.currentFrameNumber+=1,this.currentFrameNumber%=this.frames.length,b=1*this.frames[this.currentFrameNumber].delay/this.playSpeed;this._setCurrentFrame(this.currentFrameNumber);this.timerID=window.setTimeout(()=>this._play(),b)}};h._setCurrentFrame=function(b){this.currentFrame={frameData:this.frames[b].image,top:0,left:0,width:this.width,height:this.height}};return p}(),m=function(){function p(b){this.pos=0;this.data=
new Uint8ClampedArray(b);this.len=this.data.length}var h=p.prototype;h.getString=function(b){let e="";for(;b--;)e+=String.fromCharCode(this.data[this.pos++]);return e};h.readSubBlocks=function(){let b,e,c="";do for(e=b=this.data[this.pos++];e--;)c+=String.fromCharCode(this.data[this.pos++]);while(0!==b&&this.pos<this.len);return c};h.readSubBlocksB=function(){let b,e;const c=[];do for(e=b=this.data[this.pos++];e--;)c.push(this.data[this.pos++]);while(0!==b&&this.pos<this.len);return c};return p}();
A["default"]=x;A.getGIFSize=function(p){var h=new Uint8ClampedArray(p);let b=6;p=h[b++]+(h[b++]<<8);h=h[b++]+(h[b++]<<8);return[p,h]};A.isAnimatedGIF=function(p){if(!p||0===p.byteLength)return!1;p=new Uint8Array(p);if(!B(p))return!1;let h=0;for(let b=0,e=p.length-9;b<e&&(0!==p[b]||33!==p[b+1]||249!==p[b+2]||4!==p[b+3]||0!==p[b+8]||44!==p[b+9]&&33!==p[b+9]||(h++,!(1<h)));++b);return 1<h};A.isGIF=B;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/util/BidiText":function(){define(["exports",
"../../../../../core/BidiEngine"],function(A,F){const E=new F;A.bidiText=function(C){if(!E.hasBidiChar(C))return[C,!1];let B;B="rtl"===E.checkContextual(C)?"IDNNN":"ICNNN";return[E.bidiTransform(C,B,"VLYSN"),!0]};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/core/BidiEngine":function(){define(["./bidiEngineTables"],function(A){function F(r,w,v,z,u){var y=r;void 0===w&&(w=u.defInFormat);void 0===v&&(v=u.defOutFormat);void 0===z&&(z=u.defSwap);if(w!==v){var D=w.substring(0,1),G=v.substring(0,
1);var H=w.substring(1,4);var J=v.substring(1,4);"C"===H.charAt(0)&&(H=E(y),H="ltr"===H||"rtl"===H?H.toUpperCase():"L"===w.charAt(2)?"LTR":"RTL",w=D+H);"C"===J.charAt(0)&&(H=E(y),"rtl"===H?J="RTL":"ltr"===H?(y=y.split(""),y.reverse(),H=E(y.join("")),J=H.toUpperCase()):J="L"===v.charAt(2)?"LTR":"RTL",v=G+J)}if(w===v)return r;G=w.substring(0,1);y=w.substring(1,4);D=v.substring(0,1);J=v.substring(1,4);u.inFormat=w;u.outFormat=v;u.swap=z;if("L"===G&&"VLTR"===v){if("LTR"===y)return u.dir=0,C(r,u);if("RTL"===
y)return u.dir=1,C(r,u)}if("V"===G&&"V"===D)return u.dir="RTL"===y?1:0,x(r,u);if("L"===G&&"VRTL"===v)return u.dir="LTR"===y?0:1,r=C(r,u),x(r);if("VLTR"===w&&"LLTR"===v)return u.dir=0,C(r,u);if("V"===G&&"L"===D&&y!==J)return r=x(r),"RTL"===y?F(r,"LLTR","VLTR",z,u):F(r,"LRTL","VRTL",z,u);if("VRTL"===w&&"LRTL"===v)return F(r,"LRTL","VRTL",z,u);"L"===G&&"L"===D&&(w=u.swap,u.swap=w.substr(0,1)+"N","RTL"===y?(u.dir=1,r=C(r,u),u.swap="N"+w.substr(1,2),u.dir=0,r=C(r,u)):(u.dir=0,r=C(r,u),u.swap="N"+w.substr(1,
2),r=F(r,"VLTR","LRTL",u.swap,u)));return r}function E(r){return(r=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(r))?"z">=r[0]?"ltr":"rtl":""}function C(r,w){r=r.split("");const v=[];B(r,v,w);if(0!==w.hiLevel&&w.swap.substr(0,1)!==w.swap.substr(1,2))for(let y=0;y<r.length;y++)if(1===v[y]){var z=y;b:{let D=void 0;var u=r[y];let G=0,H=A.SwapTable.length-1;for(;G<=H;)if(D=Math.floor((G+H)/2),u<A.SwapTable[D][0])H=D-1;else if(u>A.SwapTable[D][0])G=D+1;else{u=A.SwapTable[D][1];
break b}}r[z]=u}h(2,r,v,w);h(1,r,v,w);k=v;return r.join("")}function B(r,w,v){const z=r.length;var u=v.dir?A.impTabRtl:A.impTabLtr,y=0,D=-1;const G=[],H=[];v.hiLevel=v.dir;v.lastArabic=!1;v.hasUbatAl=!1;v.hasUbatB=!1;v.hasUbatS=!1;for(var J=0;J<z;J++){var K=J;{var L=r[J].charCodeAt(0);const M=A.PrimaryTable[L>>8];L=M<A.TBBASE?M:A.UnicodeTable[M-A.TBBASE][L&255]}G[K]=L}for(K=0;K<z;K++){J=b(r,G,H,K,v);H[K]=J;y=u[y][J];L=y&240;y&=15;J=u[y][5];w[K]=J;if(0<L){if(16===L)for(;D<K;D++)w[D]=1;D=-1}if(u[y][6])-1===
D&&(D=K);else if(-1<D){for(;D<K;D++)w[D]=J;D=-1}G[K]===A.UBAT_B&&(w[K]=0);v.hiLevel|=J}if(v.hasUbatS)for(r=0;r<z;r++)if(G[r]===A.UBAT_S)for(w[r]=v.dir,u=r-1;0<=u;u--)if(G[u]===A.UBAT_WS)w[u]=v.dir;else break}function x(r,w){r=r.split("");if(w){const v=[];B(r,v,w);k=v}r.reverse();f.reverse();return r.join("")}function m(r){for(let w=0;w<A.ArabicAlefBetIntervalsBegine.length;w++)if(r>=A.ArabicAlefBetIntervalsBegine[w]&&r<=A.ArabicAlefBetIntervalsEnd[w])return!0;return!1}function p(r,w,v,z){for(;w*v<
z&&c(r[w]);)w+=v;return w*v<z&&m(r[w])?!0:!1}function h(r,w,v,z){if(!(z.hiLevel<r))if(1!==r||1!==z.dir||z.hasUbatB){z=w.length;for(var u=0,y,D,G;u<z;){if(v[u]>=r){for(y=u+1;y<z&&v[y]>=r;)y++;for(D=y-1;u<D;u++,D--)G=w[u],w[u]=w[D],w[D]=G,G=f[u],f[u]=f[D],f[D]=G;u=y}u++}}else w.reverse(),f.reverse()}function b(r,w,v,z,u){return{UBAT_L:()=>{u.lastArabic=!1;return A.UBAT_L},UBAT_R:()=>{u.lastArabic=!1;return A.UBAT_R},UBAT_ON:()=>A.UBAT_ON,UBAT_AN:()=>A.UBAT_AN,UBAT_EN:()=>u.lastArabic?A.UBAT_AN:A.UBAT_EN,
UBAT_AL:()=>{u.lastArabic=!0;u.hasUbatAl=!0;return A.UBAT_R},UBAT_WS:()=>A.UBAT_ON,UBAT_CS:()=>{let y,D;if(1>z||z+1>=w.length||(y=v[z-1])!==A.UBAT_EN&&y!==A.UBAT_AN||(D=w[z+1])!==A.UBAT_EN&&D!==A.UBAT_AN)return A.UBAT_ON;u.lastArabic&&(D=A.UBAT_AN);return D===y?D:A.UBAT_ON},UBAT_ES:()=>(0<z?v[z-1]:A.UBAT_B)===A.UBAT_EN&&z+1<w.length&&w[z+1]===A.UBAT_EN?A.UBAT_EN:A.UBAT_ON,UBAT_ET:()=>{if(0<z&&v[z-1]===A.UBAT_EN)return A.UBAT_EN;if(u.lastArabic)return A.UBAT_ON;let y=z+1;const D=w.length;for(;y<D&&
w[y]===A.UBAT_ET;)y++;return y<D&&w[y]===A.UBAT_EN?A.UBAT_EN:A.UBAT_ON},UBAT_NSM:()=>{if("VLTR"===u.inFormat){for(var y=w.length,D=z+1;D<y&&w[D]===A.UBAT_NSM;)D++;if(D<y&&(y=r[z].charCodeAt[0],D=w[D],(1425<=y&&2303>=y||64286===y)&&(D===A.UBAT_R||D===A.UBAT_AL)))return A.UBAT_R}return 1>z||w[z-1]===A.UBAT_B?A.UBAT_ON:v[z-1]},UBAT_B:()=>{u.lastArabic=!0;u.hasUbatB=!0;return u.dir},UBAT_S:()=>{u.hasUbatS=!0;return A.UBAT_ON},UBAT_LRE:()=>{u.lastArabic=!1;return A.UBAT_ON},UBAT_RLE:()=>{u.lastArabic=
!1;return A.UBAT_ON},UBAT_LRO:()=>{u.lastArabic=!1;return A.UBAT_ON},UBAT_RLO:()=>{u.lastArabic=!1;return A.UBAT_ON},UBAT_PDF:()=>{u.lastArabic=!1;return A.UBAT_ON},UBAT_BN:()=>A.UBAT_ON}[A.TYPES_NAMES[w[z]]]()}function e(r,w){for(let v=0;v<A.BaseForm.length;v++)if(r===A.BaseForm[v])return w[v];return r}function c(r){return"\u064b"<=r&&"\u0655">=r?!0:!1}function q(r){return"L"===r?"LTR":"R"===r?"RTL":"C"===r?"CLR":"D"===r?"CRL":""}function n(r,w){for(let v=0;v<A.AlefTable.length;v++)if(r===A.AlefTable[v])return w[v];
return r}function a(r,w,v,z){for(let u=0;u<r.length;u++)if(r[u]>w||!v&&r[u]===w)r[u]+=z}let f=[],d=[],k=[];const l={dir:0,defInFormat:"LLTR",defoutFormat:"VLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,hasUbatAl:!1,hasBlockSep:!1,hasSegSep:!1,defOutFormat:""},g=/^[(I|V)][(L|R|C|D)][(Y|N)][(S|N)][N]$/,t=/[\u0591-\u06ff\ufb1d-\ufefc]/;return function(){function r(){this.inputFormat="ILYNN";this.outputFormat="VLNNN";this.sourceToTarget=[];this.targetToSource=[];
this.levels=[]}var w=r.prototype;w.bidiTransform=function(v,z,u){this.sourceToTarget=[];this.targetToSource=[];if(!v)return"";var y=this.sourceToTarget,D=this.targetToSource,G=v.length;f=[];k=[];for(var H=0;H<G;H++)y[H]=H,D[H]=H,f[H]=H;if(!this.checkParameters(z,u))return v;z=this.inputFormat;u=this.outputFormat;y=v;G=q(z.charAt(1));y=q(u.charAt(1));H="I"===z.charAt(0)?"L":z.charAt(0);D="I"===u.charAt(0)?"L":u.charAt(0);G=H+G;y=D+y;D=z.charAt(2)+u.charAt(2);l.defInFormat=G;l.defOutFormat=y;l.defSwap=
D;v=F(v,G,y,D,l);y=!1;if("R"===u.charAt(1))y=!0;else if("C"===u.charAt(1)||"D"===u.charAt(1))y="rtl"===this.checkContextual(v);D=this.sourceToTarget=f;G=Array(D.length);for(H=0;H<D.length;H++)G[D[H]]=H;d=this.targetToSource=D=G;if(z.charAt(3)===u.charAt(3))y=v;else if("S"===u.charAt(3))if(z=y,u=!0,0===v.length)y="";else{void 0===z&&(z=!0);void 0===u&&(u=!0);v=String(v);v=v.split("");G=0;y=1;D=v.length;z||(G=v.length-1,y=-1,D=1);var J=G;G=u;var K=0;H=[];for(var L=0;J*y<D;J+=y)if(m(v[J])||c(v[J])){var M;
if(M="\u0644"===v[J])b:{for(var N=v,P=J+y,I=y,O=D;P*I<O&&c(N[P]);)P+=I;M=" ";if(P*I<O)for(M=N[P],N=0;N<A.AlefTable.length;N++)if(A.AlefTable[N]===M){M=!0;break b}M=!1}if(M){v[J]=0===K?n(v[J+y],A.LamAlefInialTableFE):n(v[J+y],A.LamAlefMedialTableFE);J+=y;K=v;M=J;N=y;for(P=D;M*N<P&&c(K[M]);)M+=N;M*N<P&&(K[M]=" ");G&&(H[L]=J,L++);K=0}else{M=v[J];if(1===K){N=J;if(p(v,J+y,y,D))b:for(P=v[J],I=0;I<A.BaseForm.length;I++){if(P===A.BaseForm[I]){P=A.MedialForm[I];break b}}else P=e(v[J],A.FinalForm);v[N]=P}else!0===
p(v,J+y,y,D)?v[J]=e(v[J],A.InitialForm):v[J]=e(v[J],A.IsolatedForm);c(M)||(K=1);b:{for(N=0;N<A.StandAlonForm.length;N++)if(A.StandAlonForm[N]===M){M=!0;break b}M=!1}!0===M&&(K=0)}}else K=0;y=H;D="";for(G=0;G<v.length;G++){if(H=u){b:{for(H=0;H<y.length;H++)if(y[H]===G)break b;H=-1}H=-1<H}H?(a(d,G,!z,-1),f.splice(G,1)):D+=v[G]}y=D}else if(z=v,u=y,v=!0,0===z.length)y="";else for(void 0===v&&(v=!0),void 0===u&&(u=!0),z=String(z),y="",D=z.split(""),G=0;G<z.length;G++)H=!1,"\ufe70"<=D[G]&&"\ufeff">D[G]?
(L=z.charCodeAt(G),"\ufef5"<=D[G]&&"\ufefc">=D[G]?(u?(0<G&&v&&" "===D[G-1]?y=y.substring(0,y.length-1)+"\u0644":(y+="\u0644",H=!0),y+=A.AlefTable[(L-65269)/2]):(y+=A.AlefTable[(L-65269)/2],y+="\u0644",G+1<z.length&&v&&" "===D[G+1]?G++:H=!0),H&&(a(d,G,!0,1),f.splice(G,0,f[G]))):y+=A.FETo06Table[L-65136]):y+=D[G];this.sourceToTarget=f;this.targetToSource=d;this.levels=k;return y};w._inputFormatSetter=function(v){if(!g.test(v))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");
this.inputFormat=v};w._outputFormatSetter=function(v){if(!g.test(v))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.outputFormat=v};w.checkParameters=function(v,z){v?this._inputFormatSetter(v):v=this.inputFormat;z?this._outputFormatSetter(z):z=this.outputFormat;return v===z?!1:!0};w.checkContextual=function(v){v=E(v);if("ltr"!==v&&"rtl"!==v){try{v=document.dir.toLowerCase()}catch(z){}"ltr"!==v&&"rtl"!==v&&(v="ltr")}return v};w.hasBidiChar=function(v){return t.test(v)};
return r}()})},"esri/core/bidiEngineTables":function(){define(["exports"],function(A){A.AlefTable=["\u0622","\u0623","\u0625","\u0627"];A.ArabicAlefBetIntervalsBegine=["\u0621","\u0641"];A.ArabicAlefBetIntervalsEnd=["\u063a","\u064a"];A.BaseForm="\u0627\u0628\u062a\u062b\u062c\u062d\u062e\u062f\u0630\u0631\u0632\u0633\u0634\u0635\u0636\u0637\u0638\u0639\u063a\u0641\u0642\u0643\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u06cc\u0626\u0624".split("");
A.FETo06Table="\u064b\u064b\u064c\u061f\u064d\u061f\u064e\u064e\u064f\u064f\u0650\u0650\u0651\u0651\u0652\u0652\u0621\u0622\u0622\u0623\u0623\u0624\u0624\u0625\u0625\u0626\u0626\u0626\u0626\u0627\u0627\u0628\u0628\u0628\u0628\u0629\u0629\u062a\u062a\u062a\u062a\u062b\u062b\u062b\u062b\u062c\u062c\u062c\u062c\u062d\u062d\u062d\u062d\u062e\u062e\u062e\u062e\u062f\u062f\u0630\u0630\u0631\u0631\u0632\u0632\u0633\u0633\u0633\u0633\u0634\u0634\u0634\u0634\u0635\u0635\u0635\u0635\u0636\u0636\u0636\u0636\u0637\u0637\u0637\u0637\u0638\u0638\u0638\u0638\u0639\u0639\u0639\u0639\u063a\u063a\u063a\u063a\u0641\u0641\u0641\u0641\u0642\u0642\u0642\u0642\u0643\u0643\u0643\u0643\u0644\u0644\u0644\u0644\u0645\u0645\u0645\u0645\u0646\u0646\u0646\u0646\u0647\u0647\u0647\u0647\u0648\u0648\u0649\u0649\u064a\u064a\u064a\u064a\ufef5\ufef6\ufef7\ufef8\ufef9\ufefa\ufefb\ufefc\u061f\u061f\u061f".split("");
A.FinalForm="\ufe8e\ufe90\ufe96\ufe9a\ufe9e\ufea2\ufea6\ufeaa\ufeac\ufeae\ufeb0\ufeb2\ufeb6\ufeba\ufebe\ufec2\ufec6\ufeca\ufece\ufed2\ufed6\ufeda\ufede\ufee2\ufee6\ufeea\ufeee\ufef2\ufe88\ufe84\ufe82\ufe94\ufef0\ufbfd\ufe8a\ufe86\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8a\ufe86".split("");A.InitialForm="\ufe8d\ufe91\ufe97\ufe9b\ufe9f\ufea3\ufea7\ufea9\ufeab\ufead\ufeaf\ufeb3\ufeb7\ufebb\ufebf\ufec3\ufec7\ufecb\ufecf\ufed3\ufed7\ufedb\ufedf\ufee3\ufee7\ufeeb\ufeed\ufef3\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfe\ufe8b\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8b\ufe85".split("");
A.IsolatedForm="\ufe8d\ufe8f\ufe95\ufe99\ufe9d\ufea1\ufea5\ufea9\ufeab\ufead\ufeaf\ufeb1\ufeb5\ufeb9\ufebd\ufec1\ufec5\ufec9\ufecd\ufed1\ufed5\ufed9\ufedd\ufee1\ufee5\ufee9\ufeed\ufef1\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfc\ufe89\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe89\ufe85".split("");A.LamAlefInialTableFE=["\ufef5","\ufef7","\ufef9","\ufefb"];A.LamAlefMedialTableFE=["\ufef6","\ufef8","\ufefa","\ufefc"];A.MedialForm="\ufe8e\ufe92\ufe98\ufe9c\ufea0\ufea4\ufea8\ufeaa\ufeac\ufeae\ufeb0\ufeb4\ufeb8\ufebc\ufec0\ufec4\ufec8\ufecc\ufed0\ufed4\ufed8\ufedc\ufee0\ufee4\ufee8\ufeec\ufeee\ufef4\ufe88\ufe84\ufe82\ufe94\ufef0\ufbff\ufe8c\ufe86\ufe71\ufe72\ufe74\ufe77\ufe79\ufe7b\ufe7d\ufe7f\ufe80\ufe8c\ufe86".split("");
A.PrimaryTable=[100,0,0,0,0,101,102,103,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,104,4,4,4,0,4,0,4,0,4,4,4,0,0,4,4,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,4,4,0,0,4,4,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,
4,4,4,4,4,4,4,4,4,4,0,0,0,105,7,7,106,107];A.StandAlonForm="\u0621\u0622\u0623\u0624\u0625\u0627\u0629\u062f\u0630\u0631\u0632\u0648\u0649".split("");A.SwapTable=[["(",")"],[")","("],["\x3c","\x3e"],["\x3e","\x3c"],["[","]"],["]","["],["{","}"],["}","{"],["\u00ab","\u00bb"],["\u00bb","\u00ab"],["\u2039","\u203a"],["\u203a","\u2039"],["\u207d","\u207e"],["\u207e","\u207d"],["\u208d","\u208e"],["\u208e","\u208d"],["\u2264","\u2265"],["\u2265","\u2264"],["\u2329","\u232a"],["\u232a","\u2329"],["\ufe59",
"\ufe5a"],["\ufe5a","\ufe59"],["\ufe5b","\ufe5c"],["\ufe5c","\ufe5b"],["\ufe5d","\ufe5e"],["\ufe5e","\ufe5d"],["\ufe64","\ufe65"],["\ufe65","\ufe64"]];A.TBBASE=100;A.TYPES_NAMES="UBAT_L UBAT_R UBAT_EN UBAT_AN UBAT_ON UBAT_B UBAT_S UBAT_AL UBAT_WS UBAT_CS UBAT_ES UBAT_ET UBAT_NSM UBAT_LRE UBAT_RLE UBAT_PDF UBAT_LRO UBAT_RLO UBAT_BN".split(" ");A.UBAT_AL=7;A.UBAT_AN=3;A.UBAT_B=5;A.UBAT_BN=18;A.UBAT_CS=9;A.UBAT_EN=2;A.UBAT_ES=10;A.UBAT_ET=11;A.UBAT_L=0;A.UBAT_LRE=13;A.UBAT_LRO=16;A.UBAT_NSM=12;A.UBAT_ON=
4;A.UBAT_PDF=15;A.UBAT_R=1;A.UBAT_RLE=14;A.UBAT_RLO=17;A.UBAT_S=6;A.UBAT_WS=8;A.UnicodeTable=[[18,18,18,18,18,18,18,18,18,6,5,6,8,5,18,18,18,18,18,18,18,18,18,18,18,18,18,18,5,5,5,6,8,4,4,11,11,11,4,4,4,4,4,10,9,10,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,18,18,18,18,18,18,5,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,9,4,11,11,11,11,4,4,4,4,0,
4,4,18,4,4,11,11,2,2,4,0,4,4,4,2,0,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,4,4,4,4,4,4,4,12,12,12,12,12,12,12,12,12,12,12,12,
12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,1,12,1,12,12,1,12,12,1,12,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,4],[3,3,3,3,4,4,4,4,7,11,11,7,9,7,4,4,12,12,12,12,12,12,12,12,12,12,12,7,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,3,3,3,3,3,3,3,3,3,3,11,3,3,7,7,7,12,
7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,3,4,12,12,12,12,12,12,7,7,12,12,4,12,12,12,12,7,7,2,2,2,2,2,2,2,2,2,2,7,7,7,7,7,7],[7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,7,7,12,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,4,4,7,7,7,7,7,7,
7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,12,12,12,12,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,12,12,12,12,12,12,12,12,12,1,1,4,4,4,4,1,4,4,4,4,4],[8,8,8,8,8,8,8,8,8,8,8,18,18,18,0,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,5,13,14,15,16,17,9,11,11,11,11,11,4,4,4,4,4,4,4,
4,4,4,4,4,4,4,4,9,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,18,18,18,18,18,4,4,4,4,4,18,18,18,18,18,18,2,0,4,4,2,2,2,2,2,2,10,10,4,4,4,0,2,2,2,2,2,2,2,2,2,2,10,10,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],[0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,
4,4,0,0,0,0,0,4,4,4,4,4,1,12,1,1,1,1,1,1,1,1,1,1,10,1,1,1,1,1,1,1,1,1,1,1,1,1,4,1,1,1,1,1,4,1,4,1,1,4,1,1,4,1,1,1,1,1,1,1,1,1,1,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7],[12,12,12,12,12,12,12,
12,12,12,12,12,12,12,12,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,12,12,12,12,12,12,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,9,4,9,4,4,9,4,4,4,4,4,4,4,4,4,11,4,4,10,10,4,4,4,4,4,11,11,4,4,4,4,4,7,7,7,7,7,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
7,7,7,7,7,7,4,4,18],[4,4,4,11,11,11,4,4,4,4,4,10,9,10,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,0,0,0,4,4,0,0,0,0,0,0,4,4,0,0,0,0,0,0,4,4,0,0,0,4,4,4,11,11,4,4,4,11,11,4,4,4,4,4,
4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4]];A.impTabLtr=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]];A.impTabRtl=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]];Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/util/Result":function(){define(["exports","../../../../../core/Error"],function(A,F){A.ok=function(E,C){return E&&"name"in E?(C&&C.error(new F(E.name,E.message,E.details)),!1):!0};Object.defineProperty(A,
"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/util/symbolUtils":function(){define(["exports"],function(A){A.keyFromSymbol=function(F){switch(F.type){case "esriSMS":return`${F.style}.${F.path}`;case "esriSLS":return`${F.style}.${F.cap}`;case "esriSFS":return`${F.style}`;case "esriPFS":case "esriPMS":return F.imageData?`${F.imageData}${F.width}${F.height}`:`${F.url}${F.width}${F.height}`;default:return F.mosaicHash?F.mosaicHash:JSON.stringify(F)}};Object.defineProperty(A,"__esModule",{value:!0})})},
"esri/views/2d/engine/webgl/effects/AnimationEffect":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ../VertexStream ./Effect".split(" "),function(A,F,E,C,B,x){x=function(m){function p(){var b=m.apply(this,arguments)||this;b.defines=[];b._desc={vsPath:"fx/integrate",fsPath:"fx/integrate",attributes:new Map([["a_position",0]])};return b}F._inheritsLoose(p,m);var h=p.prototype;h.dispose=function(){this._quad&&this._quad.dispose()};
h.bind=function(){};h.unbind=function(){};h.draw=function(b,e){if(e.size){var {context:c,renderingOptions:q}=b;this._quad||(this._quad=new B(c,[0,0,1,0,0,1,1,1]));var n=c.getBoundFramebufferObject(),{x:a,y:f,width:d,height:k}=c.getViewport();e.bindTextures(c);var l=e.getBlock(C.ATTRIBUTE_DATA_ANIMATION);if(!E.isNone(l)){var g=l.getFBO(c);l=l.getFBO(c,1);c.setViewport(0,0,e.size,e.size);this._computeDelta(b,l,q.labelsAnimationTime);this._updateAnimationState(b,l,g);c.bindFramebuffer(n);c.setViewport(a,
f,d,k)}}};h._computeDelta=function(b,e,c){const {context:q,painter:n,displayLevel:a}=b,f=n.materialManager.getProgram(b,this._desc,["delta"]);q.bindFramebuffer(e);q.setClearColor(0,0,0,0);q.clear(q.gl.COLOR_BUFFER_BIT);q.useProgram(f);f.setUniform1i("u_maskTexture",C.TEXTURE_BINDING_ATTRIBUTE_DATA_0);f.setUniform1i("u_sourceTexture",C.TEXTURE_BINDING_ATTRIBUTE_DATA_1);f.setUniform1f("u_timeDelta",b.deltaTime);f.setUniform1f("u_animationTime",c);f.setUniform1f("u_zoomLevel",Math.round(10*a));this._quad.draw()};
h._updateAnimationState=function(b,e,c){const {context:q,painter:n}=b;b=n.materialManager.getProgram(b,this._desc,["update"]);q.bindTexture(e.colorTexture,1);q.useProgram(b);b.setUniform1i("u_sourceTexture",1);q.bindFramebuffer(c);q.setClearColor(0,0,0,0);q.clear(q.gl.COLOR_BUFFER_BIT);this._quad.draw()};return p}(x.Effect);A.AnimationEffect=x;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/Effect":function(){define(["exports"],function(A){A.Effect=function(){this.name=
this.constructor.name};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/BlendEffect":function(){define("exports ../../../../../core/Error ../../../../../core/Logger ../../../../../core/maybe ../../../../webgl/BufferObject ../../../../webgl/FramebufferObject ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../../../../webgl/checkWebGLError ../../../../webgl/enums ../../../../../chunks/builtins ../../../../webgl/ProgramCache ../../../../webgl/renderState ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ../enums ../VertexStream ../shaders/BlendPrograms".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c,q,n,a,f,d,k){const l=E.getLogger("esri.views.2d.engine.webgl.effects.blendEffects.BlendEffect");E=function(){function g(){this._size=[0,0]}var t=g.prototype;t.dispose=function(r){this._backBufferTexture&&(this._backBufferTexture.dispose(),this._backBufferTexture=null);this._programCache&&(this._programCache.dispose(),this._programCache=null);this._quad&&(this._quad.dispose(),this._quad=null)};t.draw=function(r,w,v,z,u){const {context:y,drawPhase:D}=r;this._setupShader(y);
z&&"normal"!==z&&D!==f.WGLDrawPhase.LABEL?this._drawBlended(r,w,v,z,u):(r=this._programCache.getProgram(k.blend,"normal"))?(y.useProgram(r),w.setSamplingMode(v),y.bindTexture(w,0),r.setUniform1i("u_layerTexture",0),r.setUniform1f("u_opacity",u),y.setBlendingEnabled(!0),y.setBlendFunction(1,771),w=this._quad,w.draw(),w.unbind()):l.error(new F("mapview-BlendEffect",'Error creating shader program for blend mode "normal"'))};t._drawBlended=function(r,w,v,z,u){const {context:y,state:D,pixelRatio:G,inFadeTransition:H}=
r;var {size:J}=D,K=y.getBoundFramebufferObject();let L;C.isSome(K)?(J=K.descriptor,L=J.width,J=J.height):(L=Math.round(G*J[0]),J=Math.round(G*J[1]));this._createOrResizeTexture(r,L,J);r=this._backBufferTexture;K.copyToTexture(0,0,L,J,0,0,r);y.setStencilTestEnabled(!1);y.setStencilWriteMask(0);y.setBlendingEnabled(!0);y.setDepthTestEnabled(!1);y.setDepthWriteEnabled(!1);(K=this._programCache.getProgram(k.blend,z))?(y.useProgram(K),r.setSamplingMode(v),y.bindTexture(r,0),K.setUniform1i("u_backbufferTexture",
0),w.setSamplingMode(v),y.bindTexture(w,1),K.setUniform1i("u_layerTexture",1),K.setUniform1f("u_opacity",u),K.setUniform1f("u_inFadeOpacity",H?1:0),y.setBlendFunction(1,0),w=this._quad,w.draw(),w.unbind(),y.setBlendFunction(1,771)):l.error(new F("mapview-BlendEffect",`Error creating shader program for blend mode ${z}`))};t._setupShader=function(r){this._programCache||(this._programCache=new c(r),this._quad||(this._quad=new d(r,[-1,-1,1,-1,-1,1,1,1])))};t._createOrResizeTexture=function(r,w,v){({context:r}=
r);if(null===this._backBufferTexture||w!==this._size[0]||v!==this._size[1])this._backBufferTexture?this._backBufferTexture.resize(w,v):this._backBufferTexture=new n(r,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!1,width:w,height:v}),this._size[0]=w,this._size[1]=v};return g}();A.BlendEffect=E;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/shaders/BlendPrograms":function(){define(["exports","./sources/resolver"],
function(A,F){const E={attributes:new Map([["a_pos",0],["a_tex",1]]),shaders:C=>({vertexShader:`#define ${C.replace("-","_").toUpperCase()}\n`+F.resolveIncludes("blend/blend.vert"),fragmentShader:`#define ${C.replace("-","_").toUpperCase()}\n`+F.resolveIncludes("blend/blend.frag")})};A.blend=E;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/FeatureEffect":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","./Effect"],function(A,F,
E){E=function(C){function B(m){var p=C.call(this)||this;p.name=p.constructor.name;p.defines=[m];return p}F._inheritsLoose(B,C);var x=B.prototype;x.dispose=function(){};x.bind=function({context:m,painter:p}){this._prev=m.getBoundFramebufferObject();const {width:h,height:b}=m.getViewport();p=p.getFbos(h,b).effect0;m.bindFramebuffer(p);m.setColorMask(!0,!0,!0,!0);m.setClearColor(0,0,0,0);m.clear(m.gl.COLOR_BUFFER_BIT)};x.unbind=function(){};x.draw=function(m,p){const {context:h,painter:b,state:e,deltaTime:c}=
m,q=b.getPostProcessingEffects(p.effects),n=h.getBoundFramebufferObject();q.length&&p.transitionStep(c,e.scale);for(const {postProcessingEffect:a,effect:f}of q)a.draw(m,n,f);h.bindFramebuffer(this._prev);h.setStencilTestEnabled(!1);b.blitTexture(h,n.colorTexture,9728);h.setStencilTestEnabled(!0)};return B}(E.Effect);A.FeatureEffect=E;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/HighlightEffect":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../BitBlitRenderer ./Effect ./highlight/HighlightGradient ./highlight/HighlightRenderer ./highlight/HighlightSurfaces".split(" "),
function(A,F,E,C,B,x,m){return function(p){function h(){var e=p.apply(this,arguments)||this;e.defines=["highlight"];e._hlRenderer=new x;e._hlGradient=new B;e._width=void 0;e._height=void 0;e._hlSurfaces=new m;e._adjustedWidth=void 0;e._adjustedHeight=void 0;e._blitRenderer=new E.BitBlitRenderer;return e}A._inheritsLoose(h,p);var b=h.prototype;b.dispose=function(){this._hlSurfaces&&this._hlSurfaces.dispose();this._hlRenderer&&this._hlRenderer.dispose();this._hlGradient&&this._hlGradient.destroy();
this._boundFBO=null};b.bind=function(e){const {context:c,painter:q}=e,{width:n,height:a}=c.getViewport(),f=q.getFbos(n,a).effect0;this.setup(e,n,a);c.bindFramebuffer(f);c.setColorMask(!0,!0,!0,!0);c.setClearColor(0,0,0,0);c.clear(c.gl.COLOR_BUFFER_BIT)};b.unbind=function(){};b.setup=function({context:e},c,q){this._width=c;this._height=q;const n=c%4,a=q%4;c+=2>n?-n:4-n;q+=2>a?-a:4-a;this._adjustedWidth=c;this._adjustedHeight=q;this._boundFBO=e.getBoundFramebufferObject();c=Math.round(1*c);q=Math.round(1*
q);this._hlRenderer.setup(e,c,q);this._hlSurfaces.setup(e,c,q)};b.draw=function({context:e}){const c=e.getBoundFramebufferObject();e.setViewport(0,0,1*this._adjustedWidth,1*this._adjustedHeight);e.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);e.setStencilTestEnabled(!1);e.setClearColor(0,0,0,0);e.clear(e.gl.COLOR_BUFFER_BIT);this._blitRenderer.render(e,c.colorTexture,9728,1);e.setStencilTestEnabled(!1);e.setBlendingEnabled(!1);e.setColorMask(!1,!1,!1,!0);e.bindFramebuffer(this._hlSurfaces.sharedBlur2Fbo);
e.setClearColor(0,0,0,0);e.clear(e.gl.COLOR_BUFFER_BIT);this._hlRenderer.preBlur(e,this._hlSurfaces.sharedBlur1Tex);e.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);e.setClearColor(0,0,0,0);e.clear(e.gl.COLOR_BUFFER_BIT);this._hlRenderer.finalBlur(e,this._hlSurfaces.sharedBlur2Tex);e.bindFramebuffer(this._boundFBO);e.setBlendingEnabled(!0);e.setColorMask(!0,!0,!0,!0);e.setViewport(0,0,this._width,this._height);this._hlRenderer.renderHighlight(e,this._hlSurfaces.sharedBlur1Tex,this._hlGradient);
this._boundFBO=null};b.setHighlightOptions=function(e){this._hlGradient.setHighlightOptions(e)};return h}(C.Effect)})},"esri/views/2d/engine/webgl/effects/highlight/HighlightGradient":function(){define("../../../../../../core/Logger ../../../../../webgl/BufferObject ../../../../../webgl/FramebufferObject ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/has ../../../../../webgl/checkWebGLError ../../../../../webgl/enums ../../../../../../chunks/builtins ../../../../../webgl/renderState ../../../../../webgl/Texture ../../../../../webgl/VertexArrayObject ../../definitions ./parameters".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c,q){function n(d,k){k.fillColor[0]=d.color.r/255;k.fillColor[1]=d.color.g/255;k.fillColor[2]=d.color.b/255;k.fillColor[3]=d.color.a;d.haloColor?(k.outlineColor[0]=d.haloColor.r/255,k.outlineColor[1]=d.haloColor.g/255,k.outlineColor[2]=d.haloColor.b/255,k.outlineColor[3]=d.haloColor.a):(k.outlineColor[0]=k.fillColor[0],k.outlineColor[1]=k.fillColor[1],k.outlineColor[2]=k.fillColor[2],k.outlineColor[3]=k.fillColor[3]);k.fillColor[3]*=d.fillOpacity;k.outlineColor[3]*=
d.haloOpacity;k.fillColor[0]*=k.fillColor[3];k.fillColor[1]*=k.fillColor[3];k.fillColor[2]*=k.fillColor[3];k.outlineColor[0]*=k.outlineColor[3];k.outlineColor[1]*=k.outlineColor[3];k.outlineColor[2]*=k.outlineColor[3];k.outlineWidth=q.HIGHLIGHT_SIZING.outlineWidth;k.outerHaloWidth=q.HIGHLIGHT_SIZING.outerHaloWidth;k.innerHaloWidth=q.HIGHLIGHT_SIZING.innerHaloWidth;k.outlinePosition=q.HIGHLIGHT_SIZING.outlinePosition}const a=A.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient"),
f=[0,0,0,0];return function(){function d(){this._convertedHighlightOptions={fillColor:[.2*.75,.6*.75,.675,.75],outlineColor:[.2*.9,.54,.81,.9],outlinePosition:q.HIGHLIGHT_SIZING.outlinePosition,outlineWidth:q.HIGHLIGHT_SIZING.outlineWidth,innerHaloWidth:q.HIGHLIGHT_SIZING.innerHaloWidth,outerHaloWidth:q.HIGHLIGHT_SIZING.outerHaloWidth};this.shadeTexChanged=!0;this.texelData=new Uint8Array(4*q.SHADE_TEXTURE_SIZE);this.minMaxDistance=[0,0]}var k=d.prototype;k.setHighlightOptions=function(l){function g(D,
G,H){y[0]=(1-H)*D[0]+H*G[0];y[1]=(1-H)*D[1]+H*G[1];y[2]=(1-H)*D[2]+H*G[2];y[3]=(1-H)*D[3]+H*G[3]}const t=this._convertedHighlightOptions;n(l,t);l=t.outlinePosition-t.outlineWidth/2-t.outerHaloWidth;const r=t.outlinePosition-t.outlineWidth/2,w=t.outlinePosition+t.outlineWidth/2,v=t.outlinePosition+t.outlineWidth/2+t.innerHaloWidth;var z=Math.sqrt(Math.PI/2)*q.SIGMA,u=Math.abs(l)>z?Math.round(10*(Math.abs(l)-z))/10:0;z=Math.abs(v)>z?Math.round(10*(Math.abs(v)-z))/10:0;u&&!z?a.error("The outer rim of the highlight is "+
u+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!u&&z?a.error("The inner rim of the highlight is "+z+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):u&&z&&a.error("The highlight is "+Math.max(u,z)+"px away from the edge of the feature; consider reducing some width values.");const y=[void 0,void 0,void 0,
void 0];({texelData:z}=this);for(let D=0;D<q.SHADE_TEXTURE_SIZE;++D)u=l+D/(q.SHADE_TEXTURE_SIZE-1)*(v-l),u<l?(y[4*D]=0,y[4*D+1]=0,y[4*D+2]=0,y[4*D+3]=0):u<r?g(f,t.outlineColor,(u-l)/(r-l)):u<w?[y[0],y[1],y[2],y[3]]=t.outlineColor:u<v?g(t.outlineColor,t.fillColor,(u-w)/(v-w)):[y[4*D],y[4*D+1],y[4*D+2],y[4*D+3]]=t.fillColor,z[4*D]=255*y[0],z[4*D+1]=255*y[1],z[4*D+2]=255*y[2],z[4*D+3]=255*y[3];this.minMaxDistance[0]=l;this.minMaxDistance[1]=v;this.shadeTexChanged=!0};k.applyHighlightOptions=function(l,
g){this.shadeTex||(this.shadeTex=new b(l,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:q.SHADE_TEXTURE_SIZE,height:1,samplingMode:9729}));this.shadeTexChanged&&(this.shadeTex.updateData(0,0,0,q.SHADE_TEXTURE_SIZE,1,this.texelData),this.shadeTexChanged=!1);l.bindTexture(this.shadeTex,c.TEXTURE_BINDING_HIGHLIGHT_1);g.setUniform2fv("u_minMaxDistance",this.minMaxDistance)};k.destroy=function(){this.shadeTex&&(this.shadeTex.dispose(),this.shadeTex=null)};return d}()})},"esri/views/2d/engine/webgl/effects/highlight/parameters":function(){define(["exports"],
function(A){A.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1];A.HIGHLIGHT_SIZING={outlineWidth:.7,outerHaloWidth:.7,innerHaloWidth:.7,outlinePosition:0};A.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];A.SHADE_TEXTURE_SIZE=256;A.SIGMA=1;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/highlight/HighlightRenderer":function(){define("../../../../../webgl/BufferObject ../../../../../webgl/FramebufferObject ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/has ../../../../../webgl/checkWebGLError ../../../../../webgl/enums ../../../../../../chunks/builtins ../../../../../webgl/programUtils ../../../../../webgl/renderState ../../../../../webgl/Texture ../../../../../webgl/VertexArrayObject ../../definitions ./parameters ../../shaders/HighlightPrograms".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c,q,n){return function(){function a(){this._height=this._width=void 0;this._resources=null}var f=a.prototype;f.dispose=function(){this._resources&&(this._resources.quadGeometry.dispose(),this._resources.quadVAO.dispose(),this._resources.highlightProgram.dispose(),this._resources.blurProgram.dispose(),this._resources=null)};f.preBlur=function(d,k){d.bindTexture(k,c.TEXTURE_BINDING_HIGHLIGHT_0);d.useProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",
[1,0,1/this._width,0]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",q.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);d.bindVAO(this._resources.quadVAO);d.drawArrays(5,0,4);d.bindVAO()};f.finalBlur=function(d,k){d.bindTexture(k,c.TEXTURE_BINDING_HIGHLIGHT_0);d.useProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",[0,1,0,1/this._height]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",q.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);
d.bindVAO(this._resources.quadVAO);d.drawArrays(5,0,4);d.bindVAO()};f.renderHighlight=function(d,k,l){d.bindTexture(k,c.TEXTURE_BINDING_HIGHLIGHT_0);d.useProgram(this._resources.highlightProgram);l.applyHighlightOptions(d,this._resources.highlightProgram);d.bindVAO(this._resources.quadVAO);d.setBlendingEnabled(!0);d.setBlendFunction(1,771);d.drawArrays(5,0,4);d.bindVAO()};f._initialize=function(d,k,l){this._width=k;this._height=l;k=A.createVertex(d,35044,(new Int8Array([-1,-1,0,0,1,-1,1,0,-1,1,0,
1,1,1,1,1])).buffer);l=new e(d,new Map([["a_position",0],["a_texcoord",1]]),{geometry:[{name:"a_position",count:2,type:5120,offset:0,stride:4,normalized:!1},{name:"a_texcoord",count:2,type:5121,offset:2,stride:4,normalized:!1}]},{geometry:k});const g=p.createProgram(d,n.highlight);d=p.createProgram(d,n.blur);g.setUniform1i("u_texture",c.TEXTURE_BINDING_HIGHLIGHT_0);g.setUniform1i("u_shade",c.TEXTURE_BINDING_HIGHLIGHT_1);g.setUniform1f("u_sigma",q.SIGMA);d.setUniform1i("u_texture",c.TEXTURE_BINDING_HIGHLIGHT_0);
d.setUniform1f("u_sigma",q.SIGMA);this._resources={quadGeometry:k,quadVAO:l,highlightProgram:g,blurProgram:d}};f.setup=function(d,k,l){this._resources?(this._width=k,this._height=l):this._initialize(d,k,l)};return a}()})},"esri/views/2d/engine/webgl/shaders/HighlightPrograms":function(){define(["exports","./sources/resolver"],function(A,F){const E={shaders:{vertexShader:F.resolveIncludes("highlight/textured.vert"),fragmentShader:F.resolveIncludes("highlight/highlight.frag")},attributes:new Map([["a_position",
0],["a_texcoord",1]])};F={shaders:{vertexShader:F.resolveIncludes("highlight/textured.vert"),fragmentShader:F.resolveIncludes("highlight/blur.frag")},attributes:new Map([["a_position",0],["a_texcoord",1]])};A.blur=F;A.highlight=E;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/highlight/HighlightSurfaces":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../webgl/BufferObject ../../../../../webgl/FramebufferObject ../../../../../../core/has ../../../../../webgl/checkWebGLError ../../../../../webgl/enums ../../../../../../chunks/builtins ../../../../../webgl/renderState ../../../../../webgl/Texture ../../../../../webgl/VertexArrayObject".split(" "),
function(A,F,E,C,B,x,m,p,h,b){function e(c,q,n){q=new h(c,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:q,height:n,samplingMode:9729});c=new E(c,{colorTarget:0,depthStencilTarget:2},q);return[q,c]}return function(){function c(){this._height=this._width=void 0;this._resources=null}var q=c.prototype;q.dispose=function(){this._resources&&(this._resources.sharedBlur1Tex.dispose(),this._resources.sharedBlur1Fbo.dispose(),this._resources.sharedBlur2Tex.dispose(),this._resources.sharedBlur2Fbo.dispose(),
this._resources=null)};q._initialize=function(n,a,f){this._width=a;this._height=f;const [d,k]=e(n,a,f),[l,g]=e(n,a,f);this._resources={sharedBlur1Tex:d,sharedBlur1Fbo:k,sharedBlur2Tex:l,sharedBlur2Fbo:g}};q.setup=function(n,a,f){!this._resources||this._width===a&&this._height===f||this.dispose();this._resources||this._initialize(n,a,f)};A._createClass(c,[{key:"sharedBlur1Tex",get:function(){return this._resources.sharedBlur1Tex}},{key:"sharedBlur1Fbo",get:function(){return this._resources.sharedBlur1Fbo}},
{key:"sharedBlur2Tex",get:function(){return this._resources.sharedBlur2Tex}},{key:"sharedBlur2Fbo",get:function(){return this._resources.sharedBlur2Fbo}}]);return c}()})},"esri/views/2d/engine/webgl/effects/HittestEffect":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe","../definitions","./Effect"],function(A,F,E,C,B){B=function(x){function m(){var h=x.apply(this,arguments)||this;h.name=h.constructor.name;h.defines=["id"];h._lastSize=0;return h}
F._inheritsLoose(m,x);var p=m.prototype;p.dispose=function(){E.isSome(this._fbo)&&this._fbo.dispose()};p.bind=function({context:h,painter:b}){const {width:e,height:c}=h.getViewport();b=b.getFbos(e,c).effect0;h.bindFramebuffer(b);h.setColorMask(!0,!0,!0,!0);h.setClearColor(0,0,0,0);h.clear(h.gl.COLOR_BUFFER_BIT)};p.unbind=function(){};p.draw=function({context:h,state:b,pixelRatio:e},c,q=C.HITTEST_SEARCH_SIZE){const n=h.getBoundFramebufferObject(),a=b.size[1]*e,f=Math.round(q*e),d=f/2,k=f/2;this._ensureBuffer(f);
c.forEach((l,g)=>{var t=new Map;n.readPixels(Math.floor(g[0]*e-f/2),Math.floor(a-g[1]*e-f/2),f,f,6408,5121,this._buf);for(let v=0;v<this._buf32.length;v++){const z=this._buf32[v];if(4294967295!==z&&0!==z){var r=v%f,w=f-Math.floor(v/f);r=(d-r)*(d-r)+(k-w)*(k-w);w=t.has(z)?t.get(z):4294967295;t.set(z,Math.min(r,w))}}t=Array.from(t).sort((v,z)=>v[1]-z[1]).map(v=>v[0]);l.resolve(t);c.delete(g)})};p._ensureBuffer=function(h){this._lastSize!==h&&(this._lastSize=h,this._buf=new Uint8Array(4*h*h),this._buf32=
new Uint32Array(this._buf.buffer))};return m}(B.Effect);A.HittestEffect=B;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/post-processing/EffectManager":function(){define(["require","exports","../../../../../../chunks/_rollupPluginBabelHelpers"],function(A,F,E){const C={colorize:function(){var x=E._asyncToGenerator(function*(){return new (yield new Promise(function(m,p){A(["./Colorize"],m,p)})).Colorize});return function(){return x.apply(this,arguments)}}(),
blur:function(){var x=E._asyncToGenerator(function*(){return new (yield new Promise(function(m,p){A(["./Blur"],m,p)})).Blur});return function(){return x.apply(this,arguments)}}(),bloom:function(){var x=E._asyncToGenerator(function*(){return new (yield new Promise(function(m,p){A(["./Bloom"],m,p)})).Bloom});return function(){return x.apply(this,arguments)}}(),opacity:function(){var x=E._asyncToGenerator(function*(){return new (yield new Promise(function(m,p){A(["./Opacity"],m,p)})).Opacity});return function(){return x.apply(this,
arguments)}}(),"drop-shadow":function(){var x=E._asyncToGenerator(function*(){return new (yield new Promise(function(m,p){A(["./DropShadow"],m,p)})).DropShadow});return function(){return x.apply(this,arguments)}}()};let B=function(){function x(p){this._requestRender=p;this._effectMap=new Map;this._effectPromiseMap=new Map}var m=x.prototype;m.dispose=function(){this._requestRender&&(this._requestRender=null);this._effectMap.forEach(p=>p.dispose());this._effectMap.clear();this._effectPromiseMap.clear()};
m.getPostProcessingEffects=function(p){if(!p||0===p.length)return[];const h=[];for(const b of p){a:switch(p=b.type,p){case "bloom":case "blur":case "opacity":case "drop-shadow":break a;default:p="colorize"}const e=this._effectMap.get(p);e?h.push({postProcessingEffect:e,effect:b}):this._enablePostProcessingEffect(p)}return h};m._enablePostProcessingEffect=function(){var p=E._asyncToGenerator(function*(h){const b=yield this._loadPostProcessingEffect(h);this._requestRender&&(this._effectMap.set(h,b),
this._requestRender.requestRender())});return function(h){return p.apply(this,arguments)}}();m._loadPostProcessingEffect=function(){var p=E._asyncToGenerator(function*(h){this._effectPromiseMap.has(h)||this._effectPromiseMap.set(h,C[h]());return this._effectPromiseMap.get(h)});return function(h){return p.apply(this,arguments)}}();return x}();F.EffectManager=B;Object.defineProperty(F,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/painter/RenderPass":function(){define(["../../../../../core/arrayUtils",
"../../../../../core/maybe","../enums"],function(A,F,E){return function(){function C(x,m){var p;this.brushes=x;this.name=m.name;this.drawPhase=m.drawPhase||E.WGLDrawPhase.MAP;this._targetFn=m.target;this.effects=m.effects||[];this.enableDefaultDraw=null!=(p=m.enableDefaultDraw)?p:()=>!0}var B=C.prototype;B.render=function(x){const {context:m,profiler:p}=x,h=this._targetFn();var b=this.drawPhase&x.drawPhase;p.recordPassStart(this.name);if(b){this.enableDefaultDraw()&&this._doRender(x,h);p.recordPassEnd();
for(const e of this.effects){if(!e.enable())continue;b=e.apply;p.recordPassStart(this.name+"."+b.name);p.recordBrushStart(b.name);const c=e.args&&e.args(),{x:q,y:n,width:a,height:f}=m.getViewport(),d=m.getBoundFramebufferObject();b.bind(x,c);this._doRender(x,h,b.defines);b.draw(x,c);b.unbind(x,c);m.bindFramebuffer(d);m.setViewport(q,n,a,f);p.recordBrushEnd();p.recordPassEnd()}}};B._doRender=function(x,m,p){if(!F.isNone(m))if(A.isArrayLike(m))for(const h of m){if(h.visible)for(const b of this.brushes)x.profiler.recordBrushStart(b.name),
b.prepareState(x,h,p),b.draw(x,h,p),x.profiler.recordBrushEnd()}else for(const h of this.brushes)x.profiler.recordBrushStart(h.name),h.prepareState(x,m,p),h.draw(x,m,p),x.profiler.recordBrushEnd()};return C}()})},"esri/views/2d/engine/webgl/Profiler":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/CircularArray ../../../../core/Evented ../../../../core/has ../../../../core/maybe ../../../webgl/capabilities/DisjointTimerQuery".split(" "),function(A,F,E,C,B,
x,m){const p=B("esri-2d-profiler");B=function(){function h(e,c){this._events=new C;this._entries=new Map;this._timings=new E(10);if(p){this._ext=m.createDisjointTimerQuery(e.gl,{});this._debugOutput=c;var q=e.gl;if(this.enableCommandLogging)for(const n in q)if("function"===typeof q[n]){const a=q[n],f=-1!==n.indexOf("draw");q[n]=(...d)=>{this._events.emit("command",{container:this._currentContainer,pass:this._currentPass,brush:this._currentBrush,method:n,args:d,isDrawCommand:f});this._currentSummary&&
(this._currentSummary.commands++,f&&this._currentSummary.drawCommands++);return a.apply(q,d)}}}}var b=h.prototype;b.recordContainerStart=function(e){p&&(this._currentContainer=e)};b.recordContainerEnd=function(){p&&(this._currentContainer=null)};b.recordPassStart=function(e){p&&(this._currentPass=e,this._initSummary())};b.recordPassEnd=function(){p&&(this._currentPass=null,this._emitSummary())};b.recordBrushStart=function(e){p&&(this._currentBrush=e)};b.recordBrushEnd=function(){p&&(this._currentBrush=
null)};b.recordStart=function(e){if(p&&x.isSome(this._ext)){if(this._entries.has(e)){const f=this._entries.get(e);var c=this._ext.resultAvailable(f.query),q=this._ext.disjoint();if(c&&!q){c=this._ext.getResult(f.query)/1E6;q=0;if(x.isSome(this._timings.enqueue(c))){q=this._timings.entries;const d=q.length;let k=0;for(var n of q)k+=n;q=k/d}n=c.toFixed(2);c=q?q.toFixed(2):"--";this.enableCommandLogging?(console.groupCollapsed(`Frame report for ${e}, ${n} ms (${c} last 10 avg)\n${f.commandsLen} Commands (${f.drawCommands} draw)`),
console.log("RenderPass breakdown: "),console.table(f.summaries),console.log("Commands: ",f.commands),console.groupEnd()):console.log(`Frame report for ${e}, ${n} ms (${c} last 10 avg)`);this._debugOutput.innerHTML=`${n} (${c})`}for(const d of f.handles)d.remove();this._entries.delete(e)}const a={name:e,query:this._ext.createQuery(),commands:[],commandsLen:0,drawCommands:0,summaries:[],handles:[]};this.enableCommandLogging&&(a.handles.push(this._events.on("command",f=>{a.commandsLen++;a.commands.push(f);
f.isDrawCommand&&a.drawCommands++})),a.handles.push(this._events.on("summary",f=>{a.summaries.push(f)})));this._ext.beginTimeElapsed(a.query);this._entries.set(e,a)}};b.recordEnd=function(e){p&&x.isSome(this._ext)&&this._entries.has(e)&&this._ext.endTimeElapsed()};b._initSummary=function(){this.enableCommandLogging&&(this._currentSummary={container:this._currentContainer,pass:this._currentPass,drawCommands:0,commands:0})};b._emitSummary=function(){this.enableCommandLogging&&this._events.emit("summary",
this._currentSummary)};F._createClass(h,[{key:"enableCommandLogging",get:function(){return!("object"===typeof p&&p.disableCommands)}}]);return h}();A.Profiler=B;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/core/CircularArray":function(){define(["../chunks/_rollupPluginBabelHelpers","./maybe"],function(A,F){return function(){function E(B){this._start=this.size=0;this.maxSize=B;this._buffer=Array(B)}var C=E.prototype;C.enqueue=function(B){if(this.size===this.maxSize){const x=this._buffer[this._start];
this._buffer[this._start]=B;this._start=(this._start+1)%this.maxSize;return x}this._buffer[(this._start+this.size++)%this.maxSize]=B;return null};C.dequeue=function(){if(0===this.size)return null;const B=this._buffer[this._start];this._buffer[this._start]=null;this.size--;this._start=(this._start+1)%this.maxSize;return B};C.peek=function(){return 0===this.size?null:this._buffer[this._start]};C.find=function(B){if(0===this.size)return null;for(const x of this._buffer)if(F.isSome(x)&&B(x))return x;
return null};C.clear=function(B){let x=this.dequeue();for(;F.isSome(x);)B&&B(x),x=this.dequeue()};A._createClass(E,[{key:"entries",get:function(){return this._buffer}}]);return E}()})},"esri/views/2d/engine/webgl/WebGLDriverTest":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Logger ../../../../core/maybe ../../../webgl/BufferObject ../../../webgl/FramebufferObject ../../../webgl/Program ../../../webgl/enums ../../../webgl/checkWebGLError ../../../webgl/renderState ../../../webgl/Texture ../../../webgl/VertexArrayObject ./VertexStream ../../../webgl/testSVGPremultipliedAlpha".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c,q,n){const a=E.getLogger("esri.views.2d.engine.webgl.WebGLDriverTest");let f=function(){function k(l){this.svgAlwaysPremultipliesAlpha=!1;this._ignoresSamplerPrecision=null;this._context=l;n.testSVGPremultipliedAlpha(l).then(g=>{this.svgAlwaysPremultipliesAlpha=!g})}F._createClass(k,[{key:"ignoresSamplerPrecision",get:function(){C.isNone(this._ignoresSamplerPrecision)&&(this._ignoresSamplerPrecision=d(this._context));return this._ignoresSamplerPrecision}}]);return k}();
const d=k=>{var l=new x(k,{colorTarget:0,depthStencilTarget:0},{target:3553,wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1});const g=new Uint8Array(4),t=new q(k,[0,0,1,0,0,1,1,1]),r=new m.Program(k,"\nprecision highp float;\n\nattribute vec2 a_pos;\n\nuniform highp sampler2D u_texture;\nvarying vec4 v_color;\n\nfloat getBit(in float bitset, in int bitIndex) {\n  float offset \x3d pow(2.0, float(bitIndex));\n\n  return mod(floor(bitset / offset), 2.0);\n}\n\nvoid main() {\n  vec4 value \x3d texture2D(u_texture, vec2(0.0));\n\n  float bit \x3d getBit(value.x * 255.0, 1);\n\n  v_color \x3d bit * vec4(1.0);\n\n  gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}\n",
"\nprecision highp float;\n\nvarying vec4 v_color;\n\nvoid main() {\n  gl_FragColor \x3d v_color;\n}\n",new Map([["a_pos",0]]));var w=new e(k,{target:3553,wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array([2,255,0,0]));r.setUniform1i("u_texture",0);k.bindTexture(w,0);w=k.getBoundFramebufferObject();k.bindFramebuffer(l);k.useProgram(r);const {x:v,y:z,width:u,height:y}=k.getViewport();k.setViewport(0,0,1,1);t.draw();k.setViewport(v,z,u,y);l.readPixels(0,
0,1,1,6408,5121,g);r.dispose();t.dispose();l.dispose();(l=255!==g[0]||255!==g[1]||255!==g[2]||255!==g[3])&&a.warn(`A problem was detected with your graphics driver. Your driver does not appear to honor sampler precision specifiers, which may result in rendering issues due to numerical instability. We recommend ensuring that your drivers have been updated to the latest version. Applying lowp sampler workaround. [${g[0]}.${g[1]}.${g[2]}.${g[3]}]`);k.bindFramebuffer(w);return l};A.testSamplerPrecision=
d;A.testWebGLDriver=k=>new f(k);Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/webgl/testSVGPremultipliedAlpha":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ./BufferObject ./FramebufferObject ./Program ./Texture ./VertexArrayObject".split(" "),function(A,F,E,C,B,x,m){function p(){p=F._asyncToGenerator(function*(h){const b=new Image;b.src="data:image/svg+xml,%3C%3Fxml version\x3d'1.0' encoding\x3d'UTF-8'%3F%3E%3Csvg width\x3d'5' height\x3d'5' version\x3d'1.1' viewBox\x3d'0 0 5 5' xmlns\x3d'http://www.w3.org/2000/svg'%3E%3Crect width\x3d'5' height\x3d'5' fill\x3d'%23f00' fill-opacity\x3d'.5'/%3E%3C/svg%3E%0A";
b.width=5;b.height=5;yield b.decode();if(!h.gl)return!0;const e=new C(h,{colorTarget:0,depthStencilTarget:0},{target:3553,wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1}),c=E.createVertex(h,35044,new Uint16Array([0,0,1,0,0,1,1,1])),q=new m(h,new Map([["a_pos",0]]),{geometry:[{name:"a_pos",count:2,type:5123,offset:0,stride:4,normalized:!1}]},{geometry:c}),n=new B.Program(h,"\n  precision highp float;\n\n  attribute vec2 a_pos;\n  varying vec2 v_uv;\n\n  void main() {\n    v_uv \x3d a_pos;\n    gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n  }\n  ",
"\n  precision highp float;\n\n  varying vec2 v_uv;\n  uniform sampler2D u_texture;\n\n  void main() {\n    gl_FragColor \x3d texture2D(u_texture, v_uv);\n  }\n  ",new Map([["a_pos",0]]));h.useProgram(n);const a=new x(h,{dataType:5121,pixelFormat:6408,preMultiplyAlpha:!1,wrapMode:33071,samplingMode:9729},b);h.bindTexture(a,0);n.setUniform1i("u_texture",0);const f=h.getBoundFramebufferObject(),{x:d,y:k,width:l,height:g}=h.getViewport();h.bindFramebuffer(e);h.setViewport(0,0,1,1);h.bindVAO(q);h.drawArrays(5,
0,4);const t=new Uint8Array(4);e.readPixels(0,0,1,1,6408,5121,t);n.dispose();q.dispose(!1);c.dispose();e.dispose();a.dispose();h.setViewport(d,k,l,g);h.bindFramebuffer(f);b.src="";return 255===t[0]});return p.apply(this,arguments)}A.testSVGPremultipliedAlpha=function(h){return p.apply(this,arguments)};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/shaders/StencilPrograms":function(){define(["exports","./sources/resolver"],function(A,F){F={shaders:{vertexShader:F.resolveIncludes("stencil/stencil.vert"),
fragmentShader:F.resolveIncludes("stencil/stencil.frag")},attributes:new Map([["a_pos",0]])};A.stencil=F;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/LabelManager":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Error ../../core/HandleOwner ../../core/Logger ../../core/throttle ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./engine/webgl/collisions/CollisionEngine".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c){const q=x.getLogger("esri.views.2d.layers.labels.LabelManager");E=function(n){function a(d){d=n.call(this,d)||this;d._applyVisibilityPassThrottled=m.throttle(d._applyVisibilityPass,32,A._assertThisInitialized(d));d.lastUpdateId=-1;d.updateRequested=!1;d.view=null;return d}A._inheritsLoose(a,n);var f=a.prototype;f.initialize=function(){this.collisionEngine=new c.CollisionEngine};f.destroy=function(){this.collisionEngine=null;this._applyVisibilityPassThrottled.remove();
this._applyVisibilityPassThrottled=null};f.update=function(d){this._applyVisibilityPassThrottled(d)};f.viewChange=function(){this.requestUpdate()};f.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.view.requestUpdate())};f.processUpdate=function(d){this._set("updateParameters",d);this.updateRequested&&(this.updateRequested=!1,this.update(d))};f._applyVisibilityPass=function(d){try{const k=this.view.featuresTilingScheme.getClosestInfoForScale(d.state.scale).level;this.collisionEngine.run(this.view.allLayerViews.items,
d,k)}catch(k){q.error(new C("mapview-labeling","Encountered an error during label decluttering",k))}};A._createClass(a,[{key:"updating",get:function(){return this.updateRequested}}]);return a}(B.HandleOwnerMixin(E));F.__decorate([p.property()],E.prototype,"updateRequested",void 0);F.__decorate([p.property({readOnly:!0})],E.prototype,"updateParameters",void 0);F.__decorate([p.property()],E.prototype,"updating",null);F.__decorate([p.property()],E.prototype,"view",void 0);return E=F.__decorate([e.subclass("esri.views.2d.layers.labels.LabelManager")],
E)})},"esri/views/2d/engine/webgl/collisions/CollisionEngine":function(){define("exports ../../../../../core/maybe ../../../../../core/screenUtils ../definitions ./CollisionGrid ./visualVariableSimpleUtils".split(" "),function(A,F,E,C,B,x){function m(e,c){const q=[];e.forEachTile(n=>q.push(n));q.sort((n,a)=>n.instanceId-a.instanceId);q.forEach(n=>{F.isSome(n.labelMetrics)&&n.isReady&&c(n,n.labelMetrics.getCursor())})}function p(e){return c=>E.pt2px(x.getSizeForValueSimple(c,e))}function h(e){for(const q of e){var c;
e=("featureReduction"in q&&"cluster"===(null==(c=q.featureReduction)?void 0:c.type)&&q.featureReduction).labelingInfo||[];e=[...q.labelingInfo||[],...e];if(q.labelsVisible&&e.length&&e.some(n=>"none"===n.deconflictionStrategy))return!0}return!1}let b=function(){function e(){}var c=e.prototype;c.run=function(q,n,a){const f=[];for(let g=q.length-1;0<=g;g--)a:{var d=f,k=q[g];if("feature"!==k.layer.type&&"csv"!==k.layer.type&&"geojson"!==k.layer.type&&"ogc-feature"!==k.layer.type&&"stream"!==k.layer.type&&
"subtype-group"!==k.layer.type&&"wfs"!==k.layer.type)break a;const t=k.layer.geometryType,r=!h("subtype-group"===k.layer.type?k.layer.sublayers.items:[k.layer]),w={};if("subtype-group"!==k.layer.type){if("heatmap"===k.layer.renderer.type)break a;b:{var l=k.layer.renderer;if(l="visualVariables"in l&&l.visualVariables)for(const v of l)if("size"===v.type){l=p(v);break b}l=null}w[0]=l}l=k.tileRenderer;F.isNone(l)||d.push({tileRenderer:l,vvEvaluators:w,deconflictionEnabled:r,geometryType:t,visible:k.layer.visible})}this._transformMetrics(f,
n);this._runCollision(f,n,a)};c._runCollision=function(q,n,a){const [f,d]=n.state.size;n=new B.CollisionBitsetGrid(f*n.pixelRatio,d*n.pixelRatio);for(const {tileRenderer:k,deconflictionEnabled:l,visible:g}of q){const t=k.featuresView.attributeView;l?g?(this._prepare(k),this._collideVisible(n,k,a),this._collideInvisible(n,k)):m(k,(r,w)=>{for(;w.nextId();)t.setLabelMinZoom(w.id,255)}):m(k,(r,w)=>{for(;w.nextId();)t.setLabelMinZoom(w.id,0)})}};c._isFiltered=function(q,n,a){q=n.getFilterFlags(q);n=!a.effect||
a.effect.excludedLabelsVisible||!!(q&C.EFFECT_FLAG_0);return!((!a.hasFilter||q&C.FILTER_FLAG_0)&&n)};c._prepare=function(q){const n=q.featuresView.attributeView,a=new Set;m(q,(f,d)=>{for(;d.nextId();)a.has(d.id)||(a.add(d.id),this._isFiltered(d.id,n,q.layerView)?n.setLabelMinZoom(d.id,254):0!==n.getLabelMinZoom(d.id)?n.setLabelMinZoom(d.id,255):n.setLabelMinZoom(d.id,0))})};c._collideVisible=function(q,n,a){const f=n.featuresView.attributeView,d=new Set;m(n,(k,l)=>{for(;l.nextId();)if(!d.has(l.id))if(k.key.level!==
a)f.setLabelMinZoom(l.id,254);else if(0===f.getLabelMinZoom(l.id))switch(q.insertMetrics(l)){case B.HAS_COLLISION:f.setLabelMinZoom(l.id,254);d.add(l.id);break;case B.NONE:f.setLabelMinZoom(l.id,0),d.add(l.id)}})};c._collideInvisible=function(q,n){const a=n.featuresView.attributeView,f=new Set;m(n,(d,k)=>{for(;k.nextId();)if(!f.has(k.id)&&255===a.getLabelMinZoom(k.id))switch(q.insertMetrics(k)){case B.HAS_COLLISION:a.setLabelMinZoom(k.id,255);f.add(k.id);break;case B.NONE:a.setLabelMinZoom(k.id,0),
f.add(k.id)}})};c._transformMetrics=function(q,n){for(const {tileRenderer:a,geometryType:f,vvEvaluators:d}of q)m(a,(k,l)=>{const g=a.featuresView.attributeView;k=k.transforms.labelMat2d;k[4]=Math.round(k[4]);k[5]=Math.round(k[5]);const t=k[4],r=k[5],w="polyline"===f;for(;l.next();){const G=l.boundsCount,H=l.anchorX,J=l.anchorY;var v=l.size,z=d[0];if(F.isSome(z)){var u=g.getVVSize(l.id);z=z(u);v=isNaN(z)||null==z||Infinity===z?v:z}z=v/2*l.directionX;v=v/2*l.directionY;for(u=0;u<G;u++){var y=H,D=l.anchorY;
w?(y=y+l.boundsX(u)+z,D=D+l.boundsY(u)+v,n.state.rotation?(y=k[0]*y+k[2]*D+k[4],D=k[1]*y+k[3]*D+k[5]):(y+=t,D+=r),l.setBoundsComputedAnchorX(u,Math.floor(y)),l.setBoundsComputedAnchorY(u,Math.floor(D))):(n.state.rotation?(y=k[0]*H+k[2]*J+k[4],D=k[1]*H+k[3]*J+k[5]):(y+=t,D+=r),y=y+l.boundsX(u)+z,D=D+l.boundsY(u)+v,l.setBoundsComputedAnchorX(u,y),l.setBoundsComputedAnchorY(u,D))}}})};return e}();A.CollisionEngine=b;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/collisions/CollisionGrid":function(){define(["exports",
"../../../../../core/mathUtils","../definitions","../../../layers/features/support/StaticBitSet"],function(A,F,E,C){let B=function(){function m(h,b){this.width=h;this.height=b;h=Math.ceil(h/1);b=Math.ceil(b/1);this._cols=h;this._rows=b;this._cells=C.StaticBitSet.create(h*b)}var p=m.prototype;p.insertMetrics=function(h){const b=this._hasCollision(h);0===b&&this._markMetrics(h);return b};p.getCellId=function(h,b){return h+b*this._cols};p.has=function(h){return this._cells.has(h)};p.hasRange=function(h,
b){return this._cells.hasRange(h,b)};p.set=function(h){this._cells.set(h)};p.setRange=function(h,b){this._cells.setRange(h,b)};p._hasCollision=function(h){const b=h.id;let e=0,c=0;h.save();do{const q=h.boundsCount;e+=q;for(let n=0;n<q;n++){const a=h.boundsComputedAnchorX(n),f=h.boundsComputedAnchorY(n),d=h.boundsWidth(n)+2,k=h.boundsHeight(n)+2;switch(this._collide(a,f,d,k)){case 2:return 2;case 1:c++}}}while(h.peekId()===b&&h.next());h.restore();return e===c?1:0};p._collide=function(h,b,e,c){h-=
e/2;b-=c/2;e=h+e;var q=b+c;if(0>e||0>q||h>this.width||b>this.height)return 1;c=F.clamp(Math.floor(h/1),0,this._cols);var n=F.clamp(Math.floor(b/1),0,this._rows);h=F.clamp(Math.ceil(e/1),0,this._cols);b=F.clamp(Math.ceil(q/1),0,this._rows);for(e=n;e<=b;e++)for(q=c;q<=h;q++)if(n=this.getCellId(q,e),this.has(n))return 2;return 0};p._mark=function(h,b,e,c){h-=e/2;b-=c/2;e=h+e;var q=b+c;c=F.clamp(Math.floor(h/1),0,this._cols);var n=F.clamp(Math.floor(b/1),0,this._rows);h=F.clamp(Math.ceil(e/1),0,this._cols);
b=F.clamp(Math.ceil(q/1),0,this._rows);for(e=n;e<=b;e++)for(q=c;q<=h;q++)n=this.getCellId(q,e),this.set(n);return!1};p._markMetrics=function(h){const b=h.id;do{const e=h.boundsCount;for(let c=0;c<e;c++){const q=h.boundsComputedAnchorX(c),n=h.boundsComputedAnchorY(c),a=h.boundsWidth(c)+2,f=h.boundsHeight(c)+2;this._mark(q,n,a,f)}}while(h.peekId()===b&&h.next())};return m}(),x=function(){function m(h,b=2){this._bucketSize=h;this._rowsLength=E.TILE_SIZE/h;this._colsLength=E.TILE_SIZE/h;this._elementsPerBucket=
b;this._grid=this._initGrid()}var p=m.prototype;p.checkOverlap=function(h,b){h=Math.floor(h/this._bucketSize);b=Math.floor(b/this._bucketSize);return 0>h||h>=this._rowsLength||0>b||b>=this._colsLength?!0:this._grid[b*this._colsLength+h]>=this._elementsPerBucket};p.markUsed=function(h,b){this._grid[Math.floor(b/this._bucketSize)*this._colsLength+Math.floor(h/this._bucketSize)]+=1};p.reset=function(){this._grid=this._initGrid()};p._initGrid=function(){return new Uint8Array(this._rowsLength*this._colsLength)};
return m}();A.CollisionBitsetGrid=B;A.CollisionGrid=x;A.HAS_COLLISION=2;A.NONE=0;A.OUTSIDE_EXTENT=1;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/StaticBitSet":function(){define(["exports"],function(A){let F=function(){function E(B,x){this._mask=0;this._buf=B;this._mask=x}E.fromBuffer=function(B,x){return new E(B,x)};E.create=function(B,x=4294967295){B=new Uint32Array(Math.ceil(B/32));return new E(B,x)};var C=E.prototype;C._getIndex=function(B){return Math.floor(B/
32)};C.has=function(B){B&=this._mask;return!!(this._buf[this._getIndex(B)]&1<<B%32)};C.hasRange=function(B,x){for(;B%32&&B!==x;){if(this.has(B))return!0;B++}for(;x%32&&B!==x;){if(this.has(B))return!0;x--}if(B===x)return!1;for(B/=32;B!==x/32;B++)if(this._buf[B])return!0;return!1};C.set=function(B){B&=this._mask;const x=this._getIndex(B);this._buf[x]|=1<<B%32};C.setRange=function(B,x){for(;B%32&&B!==x;)this.set(B++);for(;x%32&&B!==x;)this.set(x--);if(B!==x)for(B/=32;B!==x/32;B++)this._buf[B]=4294967295};
C.unset=function(B){B&=this._mask;const x=this._getIndex(B);this._buf[x]&=4294967295^1<<B%32};C.resize=function(B){const x=this._buf;B=new Uint32Array(Math.ceil(B/32));B.set(x);this._buf=B};C.or=function(B){for(let x=0;x<this._buf.length;x++)this._buf[x]|=B._buf[x];return this};C.and=function(B){for(let x=0;x<this._buf.length;x++)this._buf[x]&=B._buf[x];return this};C.xor=function(B){for(let x=0;x<this._buf.length;x++)this._buf[x]^=B._buf[x];return this};C.ior=function(B){for(let x=0;x<this._buf.length;x++)this._buf[x]|=
~B._buf[x];return this};C.iand=function(B){for(let x=0;x<this._buf.length;x++)this._buf[x]&=~B._buf[x];return this};C.ixor=function(B){for(let x=0;x<this._buf.length;x++)this._buf[x]^=~B._buf[x];return this};C.any=function(){for(let B=0;B<this._buf.length;B++)if(this._buf[B])return!0;return!1};C.copy=function(B){for(let x=0;x<this._buf.length;x++)this._buf[x]=B._buf[x];return this};C.clone=function(){return new E(this._buf.slice(),this._mask)};C.clear=function(){for(let B=0;B<this._buf.length;B++)this._buf[B]=
0};C.forEachSet=function(B){for(let x=0;x<this._buf.length;x++){let m=this._buf[x],p=32*x;if(m)for(;m;)m&1&&B(p),m>>>=1,p++}};C.countSet=function(){let B=0;this.forEachSet(x=>{B++});return B};return E}();A.StaticBitSet=F;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/collisions/visualVariableSimpleUtils":function(){define(["exports","../../../../../core/mathUtils","../../../../../renderers/support/lengthUtils"],function(A,F,E){function C(p,h){switch(h.transformationType){case "additive":var b=
B(h.minSize,p);return p+=b||h.minDataValue;case "constant":return b=(b=h.stops)&&b.length&&b[0].size,null==b&&(b=h.minSize),p=B(b,p);case "clamped-linear":b=(p-h.minDataValue)/(h.maxDataValue-h.minDataValue);var e=B(h.minSize,p),c=B(h.maxSize,p);p=p<=h.minDataValue?e:p>=h.maxDataValue?c:e+b*(c-e);return p;case "proportional":return b=p/h.minDataValue,e=B(h.minSize,p),p=B(h.maxSize,p),p=F.clamp(b*e,e,p);case "stops":{const [q,n,a]=x(p,h.cache.ipData);q===n?p=B(h.stops[q].size,p):(b=B(h.stops[q].size,
p),p=B(h.stops[n].size,p),p=b+(p-b)*a)}return p;case "real-world-size":{b=E.meterIn[h.valueUnit];e=B(h.minSize,p);c=B(h.maxSize,p);({valueRepresentation:h}=h);let q=null;q="area"===h?2*Math.sqrt(p/m)/b:"radius"===h||"distance"===h?2*p/b:p/b;p=F.clamp(q,e,c)}return p;case "identity":return p;case "unknown":return null}}function B(p,h){return"number"===typeof p?p:C(h,p)}function x(p,h){if(h){var b=0,e=h.length-1;h.some((c,q)=>{if(p<c)return e=q,!0;b=q;return!1});return[b,e,(p-h[b])/(h[e]-h[b])]}}const m=
Math.PI;A.getSizeForValueSimple=C;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/layers/graphics/GraphicsView2D":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/Accessor ../../../../core/HandleOwner ../../../../core/has ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/screenUtils ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/Logger ../../../../core/accessorSupport/decorators/subclass ../../../../geometry/Polygon ../../../../geometry/SpatialReference ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/coordsUtils ../../../../geometry/support/jsonUtils ../../../../geometry/support/normalizeUtilsSync ../../../../geometry/support/spatialReferenceUtils ../../../../layers/graphics/data/projectionSupport ../../../../symbols/cim/cimSymbolUtils ../../../../symbols/support/defaults ../../engine/webgl/definitions ../../engine/webgl/GraphicTile ../../engine/webgl/TileData ../../engine/webgl/WGLDisplayObject ../../engine/webgl/mesh/MeshData ../../engine/webgl/mesh/factories/WGLMeshFactory ../../engine/webgl/mesh/templates/WGLTemplateStore ../../engine/webgl/util/BidiText ../../engine/webgl/util/Matcher ../features/schemaUtils ../features/support/AttributeStore ../features/support/ComputedAttributeStorage ../features/support/GraphicsReader ./GraphicStore ./graphicsUtils ../../../layers/GraphicsView ../../../webgl/capabilities".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c,q,n,a,f,d,k,l,g,t,r,w,v,z,u,y,D,G,H,J,K,L,M,N,P,I,O,Q){function T(V,aa,Z){if(Z.has(V))return Z.get(V);aa={tile:aa,addedOrModified:[],removed:[]};Z.set(V,aa);return aa}E=function(V){function aa(R){R=V.call(this,R)||this;R._storage=new M.ComputedAttributeStorage;R._displayIds=new Map;R._controller=new AbortController;R._tiles=new Map;R._graphicStoreUpdate=!1;R._graphicsSet=new Set;R._matcher=Promise.resolve(null);R._tileUpdateSet=new Set;R._tilesToUpdate=new Map;R._graphicIdToAbortController=
new Map;R._attached=!1;R._highlightIds=new Map;R._updatingGraphicsTimer=null;R._hashToExpandedSymbol=new Map;R._hashTpExpandedSymbolPromise=new Map;R._processing=!1;R._needsProcessing=!1;R._pendingUpdate={added:new Set,updated:new Set,removed:new Set};R.lastUpdateId=-1;R.updateRequested=!1;R.graphicUpdateHandler=R.graphicUpdateHandler.bind(A._assertThisInitialized(R));return R}A._inheritsLoose(aa,V);var Z=aa.prototype;Z._createMatcher=function(R,S){R&&(R=K.createMatcherSchema({indexCount:0,fields:{}},
"feature",R),this._matcher=J.createMatcher(R,S,null))};Z._createDisplayId=function(R){this._displayIds.has(R)||this._displayIds.set(R,this._storage.createDisplayId());return this._displayIds.get(R)};Z.initialize=function(){this._attributeStore=new L["default"]({type:"local",initialize:S=>Promise.resolve(this.container.attributeView.initialize(S)),update:S=>this.container.attributeView.requestUpdate(S),render:()=>this.container.requestRender()},Q());this.container.hasHighlight=()=>!!this._highlightIds.size;
this._graphicStore=new P(this.view.featuresTilingScheme,this.view.state.scale,this.uid,this.graphics,S=>{this._createDisplayId(S.uid);this._setFilterState(S.uid,S.visible)},S=>{const U=this._displayIds.get(S.uid);this._displayIds.delete(S.uid);this._storage.releaseDisplayId(U)});const R=new G.WGLTemplateStore(this.container.getMaterialItems.bind(this.container),this.view.featuresTilingScheme.tileInfo);this._createMatcher(this.renderer,R);this._meshFactory=new D.WGLMeshFactory(null,this.uid,R);this._templateStore=
R;this.handles.add([this.watch("renderer",S=>{this._createMatcher(S,R);for(const U of this.graphics)this._pendingUpdate.updated.add(U);this.requestUpdate()}),this.view.graphicsTileStore.on("update",this._onTileUpdate.bind(this)),this.container.on("attach",()=>{0<this.graphics.items.length&&this._graphicsChangeHandler({target:this.graphics,added:this.graphics.items,removed:[],moved:[]});this.handles.add(this.graphics.on("change",S=>this._graphicsChangeHandler(S)),"graphics");this._attached=!0;this.notifyChange("updating")})]);
this._onTileUpdate({added:this.view.graphicsTileStore.tiles,removed:[]})};Z.destroy=function(){this._updatingGraphicsTimer&&(clearTimeout(this._updatingGraphicsTimer),this._updatingGraphicsTimer=null,this.notifyChange("updating"));this._controller.abort();this.container.destroy();this._set("graphics",null);this._graphicStore.clear();this._attributeStore=null;this._hashToExpandedSymbol.clear();this.renderer=this.view=null};Z.hitTest=function(R,S){if(!this.view||!this.view.position)return Promise.resolve(null);
R=this.view.toMap(p.createScreenPoint(R,S));return this.searchFeatures(R).then(U=>U&&U.length?U[0]:null)};Z.searchFeatures=function(){var R=A._asyncToGenerator(function*(S,U=2){return this._graphicStore.hitTest(S.x,S.y,U,this.view.state.resolution,this.view.state.rotation)});return function(S){return R.apply(this,arguments)}}();Z.update=function(R){m.throwIfAborted(this._controller.signal);R=this.view.featuresTilingScheme.getClosestInfoForScale(R.state.scale).level;this._graphicStore.updateLevel(R);
this._graphicStoreUpdate=!0;this.updateRequested=!1;0<this._pendingUpdate.updated.size&&(this._processing?this._needsProcessing=!0:this._updateGraphics())};Z.viewChange=function(){this.requestUpdate()};Z.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.requestUpdateCallback())};Z.processUpdate=function(R){this.updateRequested&&(this.updateRequested=!1,this.update(R))};Z.graphicUpdateHandler=function(R){const {graphic:S,property:U,newValue:X}=R;switch(U){case "geometry":case "symbol":this._pendingUpdate.updated.add(S);
this.requestUpdate();break;case "visible":this._setFilterState(S.uid,X),this._attributeStore.sendUpdates()}};Z.addHighlight=function(R){for(const S of R)this._highlightIds.has(S)?(R=this._highlightIds.get(S),this._highlightIds.set(S,R+1)):this._highlightIds.set(S,1);this._updateHighlight()};Z.removeHighlight=function(R){for(const S of R)this._highlightIds.has(S)&&(R=this._highlightIds.get(S)-1,0===R?this._highlightIds.delete(S):this._highlightIds.set(S,R));this._updateHighlight()};Z._updateHighlight=
function(){const R=Array.from(this._highlightIds.keys()),S=R.map(U=>this._displayIds.get(U));this._attributeStore.setHighlight(R,S)};Z._getIntersectingTiles=function(R){R=this._graphicStore.getBounds(R);if(!R||0===a.width(R)||0===a.height(R))return[];const S=I.intersectingInternationalDateline(R,this.view.spatialReference);return x.isSome(S)?[...new Set([...this.view.graphicsTileStore.boundsIntersections(S[0]),...this.view.graphicsTileStore.boundsIntersections(S[1])])]:this.view.graphicsTileStore.boundsIntersections(R)};
Z._updateTile=function(){var R=A._asyncToGenerator(function*(S){m.throwIfAborted(this._controller.signal);const U=S.tile;var X=this._getGraphicsData(this._templateStore,U,S.addedOrModified);X=yield this._processGraphics(U,X);m.throwIfAborted(this._controller.signal);this._patchTile(U.key,{type:"update",addOrUpdate:X,remove:S.removed,end:!0,clear:!1,sort:!1});return X});return function(S){return R.apply(this,arguments)}}();Z._patchTile=function(R,S){this._tiles.has(R)&&(R=this._tiles.get(R),this.container.onTileData(R,
S),this.container.requestRender())};Z._graphicsChangeHandler=function(R){const S=this._pendingUpdate;for(const U of R.added)S.added.add(U);for(const U of R.moved)S.updated.add(U);for(const U of R.removed)this._pendingUpdate.added.has(U)?S.added.delete(U):S.removed.add(U);this._processing?this._needsProcessing=!0:this._updateGraphics()};Z._getGraphicsToUpdate=function(){const R={added:[],removed:[],updated:[]};if(!this.graphics)return R;const S=this._pendingUpdate;for(const U of this.graphics.items)S.added.has(U)?
R.added.push(U):S.updated.has(U)&&R.updated.push(U);for(const U of S.removed)this._graphicStore.has(U)&&R.removed.push(U);S.added.clear();S.removed.clear();S.updated.clear();return R};Z._updateGraphics=function(){var R=A._asyncToGenerator(function*(){this._processing=!0;const {added:S,removed:U,updated:X}=this._getGraphicsToUpdate(),fa=this._tilesToUpdate;try{if(!this._graphicStoreUpdate){var ea=this.view.featuresTilingScheme.getClosestInfoForScale(this.view.state.scale).level;this._graphicStore.updateLevel(ea)}ea=
[];const ba=Array(S.length+U.length);for(let da=0;da<X.length;da++){var ha=X[da];const ia=this._getIntersectingTiles(ha);for(const ja of ia){var W=ja.id;T(W,ja,fa).removed.push(this._displayIds.get(ha.uid))}ea.push(this._updateGraphic(ha,null));ba[da]=ha}var Y=X.length;for(ha=0;ha<S.length;ha++){const da=S[ha];ba[Y+ha]=da;this._graphicsSet.add(da);ea.push(this._addGraphic(da))}for(const da of U){this._abortProcessingGraphic(da.uid);const ia=this._getIntersectingTiles(da);for(const ja of ia)W=ja.id,
T(W,ja,fa).removed.push(this._displayIds.get(da.uid));this._graphicsSet.delete(da);this._graphicStore.remove(da)}this._flipUpdatingGraphics();yield Promise.all(ea);let ca;for(Y=0;Y<ba.length;Y++){ca=ba[Y];const da=this._getIntersectingTiles(ca);for(const ia of da)W=ia.id,T(W,ia,fa).addedOrModified.push(ca)}this._graphicStore.updateZ();W=[];for(const [,da]of fa)W.push(this._updateTile(da));yield Promise.all(W)}catch(ba){m.isAbortError(ba)}for(const ba of U)try{const ca=yield this._getSymbolForGraphic(ba,
{});ca&&this._hashToExpandedSymbol.delete(ca.hash())}catch(ca){m.isAbortError(ca)}fa.clear();this.notifyChange("updating");this._processing=!1;this._needsProcessing&&(this._needsProcessing=!1,this._updateGraphics())});return function(){return R.apply(this,arguments)}}();Z._getArcadeInfo=function(R){const S=(R.attributes?Object.keys(R.attributes):[]).map(U=>({name:U,alias:U,type:"string"===typeof R.attributes[U]?"esriFieldTypeString":"esriFieldTypeDouble"}));return x.isNone(R.geometry)?null:{geometryType:d.getJsonType(R.geometry),
spatialReference:n.fromJSON(R.geometry.spatialReference),fields:S}};Z._getSymbolForGraphic=function(){var R=A._asyncToGenerator(function*(S,U){m.throwIfAborted(this._controller.signal);return x.isSome(S.symbol)?S.symbol:x.isSome(this.renderer)?this.renderer.getSymbolAsync(S,{scale:this.view.scale,abortOptions:U}):this._getNullSymbol(S)});return function(S,U){return R.apply(this,arguments)}}();Z._getSymbolResources=function(){var R=A._asyncToGenerator(function*(S,U){m.throwIfAborted(this._controller.signal);
if(!this.container.stage)return null;var X=yield this._getSymbolForGraphic(S,U),fa=X.hash();let ea=this._hashToExpandedSymbol.get(fa);if(!ea){let ha=this._hashTpExpandedSymbolPromise.get(fa);if(ha)ea=yield ha,m.throwIfAborted(this._controller.signal);else{S=this._getArcadeInfo(S);X=K.createSymbolSchema(X);ha=t.expandSymbol(X,S,U);this._hashTpExpandedSymbolPromise.set(fa,ha);try{ea=yield ha,this._hashTpExpandedSymbolPromise.delete(fa),this._hashToExpandedSymbol.set(fa,ea)}catch(W){this._hashTpExpandedSymbolPromise.delete(fa),
m.throwIfAborted(W)}}}if("esriTS"===ea.type){U=[];[fa]=H.bidiText(ea.text);for(X=0;X<fa.length;X++)U.push(fa.charCodeAt(X));[{mosaicItem:U}]=yield this.container.getMaterialItems([{symbol:ea,id:0,glyphIds:U}]);return{symbol:ea,mosaicItem:U}}return{symbol:ea,mosaicItem:null}});return function(S,U){return R.apply(this,arguments)}}();Z._projectAndNormalizeGeometry=function(){var R=A._asyncToGenerator(function*(S,U){m.throwIfAborted(this._controller.signal);if(x.isNone(S.geometry)||"mesh"===S.geometry.type)return null;
var X=S.geometry;d.isPolygon(X)?X.rings=X.rings:d.isPolyline(X)?X.paths=X.paths:d.isExtent(X)&&(S=yield this._getSymbolForGraphic(S,U),m.throwIfAborted(this._controller.signal),X=I.isMarkerSymbol(S.type)||I.isTextSymbol(S.type)?X.center:q.fromExtent(X));yield g.checkProjectionSupport(X.spatialReference,this.view.spatialReference);S=k.normalizeCentralMeridianSync(X);X=g.project(S,X.spatialReference,this.view.spatialReference);f.closeRingsAndFixWinding(X);return X});return function(S,U){return R.apply(this,
arguments)}}();Z._onTileUpdate=function(R){const S=l.getInfo(this.view.spatialReference);if(R.added&&0<R.added.length)for(const U of R.added)this._addNewTile(U,S);if(R.removed&&0<R.removed.length)for(const U of R.removed)this._removeTile(U.key)};Z._addGraphic=function(){var R=A._asyncToGenerator(function*(S){this._abortProcessingGraphic(S.uid);m.throwIfAborted(this._controller.signal);var U=m.createAbortController();this._graphicIdToAbortController.set(S.uid,U);U={signal:U.signal};try{yield this._addOrUpdateGraphic(S,
U),m.throwIfAborted(this._controller.signal),this._graphicIdToAbortController.delete(S.uid)}catch(X){if(this._graphicIdToAbortController.delete(S.uid),!m.isAbortError(X))throw X;}});return function(S){return R.apply(this,arguments)}}();Z._updateGraphic=function(){var R=A._asyncToGenerator(function*(S,U){m.throwIfAborted(this._controller.signal);const X=this._projectAndNormalizeGeometry(S,U);U=this._getSymbolResources(S,U);const [fa,ea]=yield Promise.all([X,U]);m.throwIfAborted(this._controller.signal);
this._graphicStore.addOrModify(S,ea,fa)});return function(S,U){return R.apply(this,arguments)}}();Z._addOrUpdateGraphic=function(){var R=A._asyncToGenerator(function*(S,U){m.throwIfAborted(this._controller.signal);const X=this._projectAndNormalizeGeometry(S,U);U=this._getSymbolResources(S,U);try{const [fa,ea]=yield Promise.all([X,U]);m.throwIfAborted(this._controller.signal);this._addProjectedGraphic(S,ea,fa)}catch(fa){if(!m.isAbortError(fa))throw fa;}});return function(S,U){return R.apply(this,arguments)}}();
Z._addProjectedGraphic=function(R,S,U){this._graphicsSet.has(R)&&this._graphicStore.addOrModify(R,S,U)};Z._addTile=function(R){var S=this.view.featuresTilingScheme.getTileBounds(a.create(),R);S=new v.GraphicTile(R,S[0],S[3]);this._tiles.set(R,S);this.container.addChild(S);return S};Z._addNewTile=function(){var R=A._asyncToGenerator(function*(S,U){const X=this._addTile(S.key),fa=this._graphicStore.queryTileData(this._templateStore,S);if(0!==fa.length){if(U){U=Math.round((U.valid[1]-U.valid[0])/S.resolution);
for(var ea of fa)ea.geometry&&(d.isPoint(ea.geometry)||d.isMultipoint(ea.geometry))&&this._wrapPoints(ea,U)}ea=S.key;this._tileUpdateSet.add(S.key);this.notifyChange("updating");try{const ha={type:"update",clear:!1,addOrUpdate:yield this._processGraphics(S,fa),remove:[],end:!0,sort:!1};X.patch(ha);this._tileUpdateSet.delete(ea);this.notifyChange("updating")}catch(ha){if(this._tileUpdateSet.delete(ea),this.notifyChange("updating"),!m.isAbortError(ha))throw ha;}}});return function(S,U){return R.apply(this,
arguments)}}();Z._removeTile=function(R){if(this._tiles.has(R)){var S=this._tiles.get(R);this.container.removeChild(S);S.destroy();this._tiles.delete(R)}};Z._setFilterState=function(R,S){const U=this._displayIds.get(R);R=this._attributeStore.getHighlightFlag(R);this._attributeStore.setData(U,0,0,R|(S?w.FILTER_FLAG_0:0))};Z._getGraphicsData=function(R,S,U){const X=l.getInfo(this.view.spatialReference);R=this._graphicStore.getGraphicsData(R,S,U);if(X){S=Math.round((X.valid[1]-X.valid[0])/S.resolution);
for(const fa of R)fa.geometry&&(d.isPoint(fa.geometry)||d.isMultipoint(fa.geometry))&&this._wrapPoints(fa,S)}return R};Z._wrapPoints=function(R,S){const U=R.geometry;d.isMultipoint(U)?this._wrapMultipoint(U,S):this._wrapPoint(R,S)};Z._wrapMultipoint=function(R,S){var U=R.points;const X=[];let fa=0,ea=0;for(const [ha,W]of U)X.push([ha+fa,W]),fa=0,S===I.TILE_SIZE?(U=5*I.PIXEL_BUFFER,ha+ea<U?(X.push([S,0]),fa=-S):ha+ea>I.TILE_SIZE-U&&(X.push([-S,0]),fa=S)):ha+ea<-I.PIXEL_BUFFER?(X.push([S,0]),fa=-S):
ha+ea>I.TILE_SIZE+I.PIXEL_BUFFER&&(X.push([-S,0]),fa=S),ea+=ha;R.points=X};Z._wrapPoint=function(R,S){const U=R.geometry;if(S===I.TILE_SIZE){const X=5*I.PIXEL_BUFFER;U.x<X?R.geometry={points:[[U.x,U.y],[S,0]]}:U.x>I.TILE_SIZE-X&&(R.geometry={points:[[U.x,U.y],[-S,0]]})}else U.x<-I.PIXEL_BUFFER?R.geometry={points:[[U.x,U.y],[S,0]]}:U.x>I.TILE_SIZE+I.PIXEL_BUFFER&&(R.geometry={points:[[U.x,U.y],[-S,0]]})};Z._processGraphics=function(){var R=A._asyncToGenerator(function*(S,U,X){if(!U||!U.length||!this._meshFactory)return null;
U=N.GraphicsReader.from(U);const fa=this._meshFactory,ea=yield this._matcher;yield fa.analyzeGraphics(U,ea,null,null,X);this._attributeStore.sendUpdates();return this._processAnalyzedGraphics(S,U)});return function(S,U,X){return R.apply(this,arguments)}}();Z._processAnalyzedGraphics=function(R,S){const U=this._meshFactory;var X=S.getSize();S=S.getCursor();const fa=new y.MeshData(R.key.id,{features:X,records:X,metrics:0},!1,!1,!1);for(X=[];S.next();){const ea=S.readGraphic();ea.insertAfter=-1===ea.insertAfter?
-1:this._displayIds.get(ea.insertAfter);ea.displayId=this._displayIds.get(ea.attributes[this.uid]);const ha=new u(ea.displayId);ha.insertAfter=ea.insertAfter;X.push(ha);U.writeGraphic(fa,S,R.level)}R=fa.serialize(R.tileInfoView.tileInfo.isWrappable);return 1!==R.length?new z.TileData:z.TileData.fromVertexData(R[0].message,X)};Z._abortProcessingGraphic=function(R){this._graphicIdToAbortController.has(R)&&this._graphicIdToAbortController.get(R).abort()};Z._getNullSymbol=function(R){R=R.geometry;return d.isPolyline(R)?
r.errorPolylineSymbol2D:d.isPolygon(R)||d.isExtent(R)?r.errorPolygonSymbol2D:r.errorPointSymbol2D};Z._flipUpdatingGraphics=function(){this._updatingGraphicsTimer&&clearTimeout(this._updatingGraphicsTimer);this._updatingGraphicsTimer=setTimeout(()=>{this._updatingGraphicsTimer=null;this.notifyChange("updating")},160);this.notifyChange("updating")};A._createClass(aa,[{key:"updating",get:function(){return!this._attached||null!==this._updatingGraphicsTimer||0<this._tileUpdateSet.size||0<this._tilesToUpdate.size}}]);
return aa}(O.GraphicsView(C.HandleOwnerMixin(E)));F.__decorate([h.property({constructOnly:!0})],E.prototype,"requestUpdateCallback",void 0);F.__decorate([h.property()],E.prototype,"container",void 0);F.__decorate([h.property({constructOnly:!0})],E.prototype,"graphics",void 0);F.__decorate([h.property()],E.prototype,"updating",null);F.__decorate([h.property()],E.prototype,"view",void 0);F.__decorate([h.property()],E.prototype,"updateRequested",void 0);return E=F.__decorate([c.subclass("esri.views.2d.layers.support.GraphicsView2D")],
E)})},"esri/geometry/support/normalizeUtilsSync":function(){define("exports ./aaBoundingRect ./boundsUtils ./intersectsBase ./jsonUtils ./normalizeUtilsCommon ./spatialReferenceUtils".split(" "),function(A,F,E,C,B,x,m){function p(d,k){const l=x.getGeometryParts(d);for(const g of l)for(const t of g)t[0]+=k;return d}function h(d,k){if(!k)return d;const l=e(d,k).map(g=>g.extent);return 2>l.length?l[0]||d:2<l.length?(d.xmin=k.valid[0],d.xmax=k.valid[1],d):{rings:l.map(g=>[[g.xmin,g.ymin],[g.xmin,g.ymax],
[g.xmax,g.ymax],[g.xmax,g.ymin],[g.xmin,g.ymin]])}}function b(d,k,l){if(Array.isArray(d)){var g=d[0];g>k?(l=x.offsetMagnitude(g,k),d[0]=g+-2*l*k):g<l&&(k=x.offsetMagnitude(g,l),d[0]=g+-2*k*l)}else g=d.x,g>k?(l=x.offsetMagnitude(g,k),d.x+=-2*l*k):g<l&&(k=x.offsetMagnitude(g,l),d.x+=-2*k*l);return d}function e(d,k){const l=[],{ymin:g,ymax:t}=d;var r=d.xmax-d.xmin,w=d.xmin,v=d.xmax;const [z,u]=k.valid;var y=c(d.xmin,k);var D=y.x;const G=y.frameId;y=c(d.xmax,k);d=y.x;y=y.frameId;k=D===d&&0<r;if(r>2*u){r=
{xmin:w<v?D:d,ymin:g,xmax:u,ymax:t};w={xmin:z,ymin:g,xmax:w<v?d:D,ymax:t};v={xmin:0,ymin:g,xmax:u,ymax:t};D={xmin:z,ymin:g,xmax:0,ymax:t};d=[];k=[];q(r,v)&&d.push(G);q(r,D)&&k.push(G);q(w,v)&&d.push(y);q(w,D)&&k.push(y);for(let H=G+1;H<y;H++)d.push(H),k.push(H);l.push({extent:r,frameIds:[G]},{extent:w,frameIds:[y]},{extent:v,frameIds:d},{extent:D,frameIds:k})}else D>d||k?l.push({extent:{xmin:D,ymin:g,xmax:u,ymax:t},frameIds:[G]},{extent:{xmin:z,ymin:g,xmax:d,ymax:t},frameIds:[y]}):l.push({extent:{xmin:D,
ymin:g,xmax:d,ymax:t},frameIds:[G]});return l}function c(d,k){const [l,g]=k.valid;k=2*g;var t=0;d>g?(t=Math.ceil(Math.abs(d-g)/k),d-=t*k):d<l&&(t=Math.ceil(Math.abs(d-l)/k),d+=t*k,t=-t);return{x:d,frameId:t}}function q(d,k){const {xmin:l,ymin:g,xmax:t,ymax:r}=k;return n(d,l,g)&&n(d,l,r)&&n(d,t,r)&&n(d,t,g)}function n(d,k,l){return k>=d.xmin&&k<=d.xmax&&l>=d.ymin&&l<=d.ymax?!0:!1}let a=function(){function d(){}d.prototype.cut=function(k,l){let g;if(k.rings)this.closed=!0,g=k.rings,this.minPts=4;else if(k.paths)this.closed=
!1,g=k.paths,this.minPts=2;else return null;const t=g.length;l*=-2;for(let r=0;r<t;r++){const w=g[r];if(w&&w.length>=this.minPts){const v=[];for(const z of w)v.push([z[0]+l,z[1]]);g.push(v)}}this.closed?k.rings=g:k.paths=g;return k};return d}();const f=F.create();A.normalizeCentralMeridianSync=function(d){if(!d)return null;if("mesh"===d.type)return d.toJSON();let k=null;var l=d.spatialReference,g=m.getInfo(l);if(!g)return d.toJSON();var t=l.isWebMercator?102100:4326;const r=x.cutParams[t].maxX,w=
x.cutParams[t].minX;l=x.cutParams[t].plus180Line;t=x.cutParams[t].minus180Line;let v;var z=d.toJSON();B.isPoint(z)?v=b(z,r,w):B.isMultipoint(z)?(z.points=z.points.map(u=>b(u,r,w)),v=z):B.isExtent(z)?v=h(z,g):B.isPolygon(z)||B.isPolyline(z)?(E.getBoundsXY(f,z),d={xmin:f[0],ymin:f[1],xmax:f[2],ymax:f[3]},g=2*x.offsetMagnitude(d.xmin,w)*r,z=0===g?z:p(z,g),d.xmin+=g,d.xmax+=g,C.extentIntersectsPolyline(d,l)&&d.xmax!==r?k=z:C.extentIntersectsPolyline(d,t)&&d.xmin!==w?k=z:v=z):v=d.toJSON();return null!==
k?(new a).cut(k,r):v};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/layers/graphics/data/projectionSupport":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../geometry/projection ../../../geometry/geometryAdapters/json ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),function(A,F,E,C,B,x,m){function p(f,d){if(!d)return null;if("x"in d){var k={x:0,y:0};[k.x,k.y]=f(d.x,d.y,c);null!=d.z&&
(k.z=d.z);null!=d.m&&(k.m=d.m);return k}if("xmin"in d)return k={xmin:0,ymin:0,xmax:0,ymax:0},[k.xmin,k.ymin]=f(d.xmin,d.ymin,c),[k.xmax,k.ymax]=f(d.xmax,d.ymax,c),d.hasZ&&(k.zmin=d.zmin,k.zmax=d.zmax,k.hasZ=!0),d.hasM&&(k.mmin=d.mmin,k.mmax=d.mmax,k.hasM=!0),k;if("rings"in d)return{rings:h(d.rings,f),hasM:d.hasM,hasZ:d.hasZ};if("paths"in d)return{paths:h(d.paths,f),hasM:d.hasM,hasZ:d.hasZ};if("points"in d)return{points:b(d.points,f),hasM:d.hasM,hasZ:d.hasZ}}function h(f,d){const k=[];for(const l of f)k.push(b(l,
d));return k}function b(f,d){const k=[];for(const l of f)f=d(l[0],l[1],[0,0]),k.push(f),2<l.length&&f.push(l[2]),3<l.length&&f.push(l[3]);return k}function e(){e=F._asyncToGenerator(function*(f,d){d&&(f=Array.isArray(f)?f.map(k=>E.isSome(k.geometry)&&k.geometry.spatialReference):[f],yield C.initializeProjection(f.map(k=>({source:k,dest:d}))))});return e.apply(this,arguments)}const c=[0,0],q=p.bind(null,m.lngLatToXY),n=p.bind(null,m.xyToLngLat),a=new (function(){function f(){this._jobs=[];this._timer=
null;this._process=this._process.bind(this)}var d=f.prototype;d.push=function(){var k=F._asyncToGenerator(function*(l,g,t){if(!(l&&l.length&&g&&t)||x.equals(g,t))return l;const r={geometries:l,inSpatialReference:g,outSpatialReference:t,resolve:null};this._jobs.push(r);return new Promise(w=>{r.resolve=w;null===this._timer&&(this._timer=setTimeout(this._process,10))})});return function(l,g,t){return k.apply(this,arguments)}}();d._process=function(){this._timer=null;const k=this._jobs.shift();if(k){var {geometries:l,
inSpatialReference:g,outSpatialReference:t,resolve:r}=k;m.canProject(g,t)?x.isWebMercator(t)?r(l.map(q)):r(l.map(n)):r(C.projectMany(B.jsonAdapter,l,g,t,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return f}());A.checkProjectionSupport=function(f,d){return e.apply(this,arguments)};A.project=function(f,d,k){if(!f)return f;k||(k=d,d=f.spatialReference);return x.isValid(d)&&x.isValid(k)&&!x.equals(d,k)?m.canProject(d,k)?x.isWebMercator(k)?q(f):n(f):C.projectMany(B.jsonAdapter,
[f],d,k,null)[0]:f};A.projectMany=function(f,d,k){return a.push(f,d,k)};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/geometry/geometryAdapters/json":function(){define(["exports"],function(A){let F=function(m,p,h){this.x=m;this.y=p;this.spatialReference=h;this.m=this.z=void 0},E=function(m,p,h,b){this.rings=m;this.spatialReference=p;this.hasM=this.hasZ=void 0;h&&(this.hasZ=h);b&&(this.hasM=b)},C=function(m,p,h,b){this.paths=m;this.spatialReference=p;this.hasM=this.hasZ=void 0;h&&(this.hasZ=
h);b&&(this.hasM=b)},B=function(m,p,h,b){this.points=m;this.spatialReference=p;this.hasM=this.hasZ=void 0;h&&(this.hasZ=h);b&&(this.hasM=b)},x=function(m,p,h,b,e){this.xmin=m;this.ymin=p;this.xmax=h;this.ymax=b;this.spatialReference=e;this.mmax=this.mmin=this.zmax=this.zmin=void 0};A.jsonAdapter={convertToGEGeometry:function(m,p){return null==p?null:m.convertJSONToGeometry(p)},exportPoint:function(m,p,h){h=new F(m.getPointX(p),m.getPointY(p),h);const b=m.hasZ(p),e=m.hasM(p);b&&(h.z=m.getPointZ(p));
e&&(h.m=m.getPointM(p));return h},exportPolygon:function(m,p,h){return new E(m.exportPaths(p),h,m.hasZ(p),m.hasM(p))},exportPolyline:function(m,p,h){return new C(m.exportPaths(p),h,m.hasZ(p),m.hasM(p))},exportMultipoint:function(m,p,h){return new B(m.exportPoints(p),h,m.hasZ(p),m.hasM(p))},exportExtent:function(m,p,h){var b=m.hasZ(p);const e=m.hasM(p);h=new x(m.getXMin(p),m.getYMin(p),m.getXMax(p),m.getYMax(p),h);b&&(b=m.getZExtent(p),h.zmin=b.vmin,h.zmax=b.vmax);e&&(m=m.getMExtent(p),h.mmin=m.vmin,
h.mmax=m.vmax);return h}};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/symbols/cim/cimSymbolUtils":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../symbols ./cimAnalyzer ./ExpandedCIM ../WebStyleSymbol".split(" "),function(A,F,E,C,B,x){E=function(){var h=F._asyncToGenerator(function*(b,e,c){return Promise.all(b.map(q=>p(q,e,c)))});return function(b,e,c){return h.apply(this,arguments)}}();const m=function(){var h=F._asyncToGenerator(function*(b,e){return new B.ExpandedCIM(yield C.analyzeCIMSymbol(b.data,
e),b.data,b.rendererKey,b.maxVVSize)});return function(b,e){return h.apply(this,arguments)}}(),p=function(){var h=F._asyncToGenerator(function*(b,e,c){return b?"cim"===b.type?m(b,e):"web-style"===b.type?(b={type:"cim",data:(yield x.fromJSON(b).fetchCIMSymbol(c)).data,rendererKey:b.rendererKey,maxVVSize:b.maxVVSize},m(b,e)):b:null});return function(b,e,c){return h.apply(this,arguments)}}();A.expandSymbol=p;A.expandSymbols=E;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/symbols/cim/cimAnalyzer":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../Color ../../core/Logger ../../core/screenUtils ../../core/string ../../support/arcadeOnDemand ./CIMSymbolHelper ./SDFHelper ./utils ../../views/2d/arcade/callExpressionWithFeature".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e){function c(I){switch(I){case "Butt":return 0;case "Square":return 2;default:return 1}}function q(I){switch(I){case "Bevel":return 0;case "Miter":return 2;default:return 1}}function n(I){switch(I){default:return"left";case "Right":return"right";case "Center":return"center";case "Justify":return"justify"}}function a(I){switch(I){default:return"top";case "Center":return"middle";case "Baseline":return"baseline";case "Bottom":return"bottom"}}function f(I){let O="normal",
Q="normal";I&&(I=I.toLowerCase(),-1!==I.indexOf("italic")?O="italic":-1!==I.indexOf("oblique")&&(O="oblique"),-1!==I.indexOf("bold")?Q="bold":-1!==I.indexOf("light")&&(Q="lighter"));return{style:O,weight:Q}}function d(I,O,Q,T){let V;I[O]?V=I[O]:(V={},I[O]=V);V[Q]=T}function k(I){return(I=I.markerPlacement)&&I.angleToLine?1:0}function l(){l=F._asyncToGenerator(function*(I,O,Q,T){Q=null!=Q?Q:[];if(!I)return Q;let V;const aa={};if("CIMSymbolReference"===I.type){if(V=I.symbol,I=I.primitiveOverrides){const R=
[];for(const S of I){var Z=S.valueExpressionInfo;Z&&O?(Z=m.createRendererExpression(Z.expression,O.spatialReference,O.fields).then(U=>{U&&d(aa,S.primitiveName,S.propertyName,U)}),R.push(Z)):null!=S.value&&d(aa,S.primitiveName,S.propertyName,S.value)}yield Promise.all(R)}}else return P.error("Expect cim type to be 'CIMSymbolReference'"),Q;switch(V.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":g(V,I,aa,O,Q,T)}return Q});return l.apply(this,arguments)}function g(I,O,Q,T,V,
aa){if(I){var Z=I.symbolLayers;if(Z){var R,S=p.CIMSymbolHelper.getSize(I);"CIMPointSymbol"===I.type&&"Map"===I.angleAlignment&&(R=1);for(var U=Z.length;U--;){var X=Z[U];if(X&&!1!==X.enable){var fa=[];p.OverrideHelper.findApplicableOverrides(X,O,fa);switch(X.type){case "CIMSolidFill":t(X,Q,fa,T,V);break;case "CIMPictureFill":r(X,Q,fa,T,V);break;case "CIMHatchFill":w(X,Q,fa,T,V);break;case "CIMGradientFill":{var ea=Q,ha=T,W=V;const [ka,la]=N(fa,X.primitiveName);var Y=x.numericHash(JSON.stringify(X)+
la).toString();W.push({type:"fill",templateHash:Y,materialHash:ka?M(Y,ea,fa,ha):Y,cim:X,materialOverrides:null,colorLocked:X.colorLocked,effects:X.effects,color:{r:128,g:128,b:128,a:1},height:0,angle:0,offsetX:0,offsetY:0,scaleX:1})}break;case "CIMSolidStroke":v(X,Q,fa,T,V,"CIMPolygonSymbol"===I.type,S);break;case "CIMPictureStroke":z(X,Q,fa,T,V,"CIMPolygonSymbol"===I.type,S);break;case "CIMGradientStroke":{ea=Q;ha=T;W=V;Y="CIMPolygonSymbol"===I.type;var ba=S,ca=X.primitiveName,da=void 0!==X.width?
X.width:4,ia=c(X.capStyle),ja=q(X.joinStyle);const ka=X.miterLimit,[la,ma]=N(fa,ca),pa=x.numericHash(JSON.stringify(X)+ma).toString();W.push({type:"line",templateHash:pa,materialHash:la?M(pa,ea,fa,ha):pa,cim:X,materialOverrides:null,isOutline:Y,colorLocked:X.colorLocked,effects:X.effects,color:{r:128,g:128,b:128,a:1},width:L(ca,ea,"Width",ha,da),cap:L(ca,ea,"CapStyle",ha,ia),join:L(ca,ea,"JoinStyle",ha,ja),miterLimit:L(ca,ea,"MiterLimit",ha,ka),referenceWidth:ba,zOrder:J(X.name),isDashed:!1})}break;
case "CIMCharacterMarker":u(X,Q,fa,T,V);break;case "CIMPictureMarker":if(u(X,Q,fa,T,V))break;"CIMLineSymbol"===I.type&&(R=k(X));y(X,Q,fa,T,V,R,S);break;case "CIMVectorMarker":if(u(X,Q,fa,T,V))break;"CIMLineSymbol"===I.type&&(R=k(X));ea=Q;ha=T;W=V;Y=R;ba=S;ca=aa;if(ia=X.markerGraphics){da=0;X.scaleSymbolsProportionally&&(ja=X.frame)&&(da=ja.ymax-ja.ymin);for(const ka of ia)if(ka&&(ia=ka.symbol))switch(ia.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":G(X,ka,fa,ea,ha,W,Y,ba,
da,ca);break;case "CIMTextSymbol":D(X,ka,ea,fa,ha,W,Y,ba,da)}}break;default:P.error("Cannot analyze CIM layer",X.type)}}}}}}function t(I,O,Q,T,V){const aa=I.primitiveName,Z=b.fromCIMColor(I.color),[R,S]=N(Q,aa),U=x.numericHash(JSON.stringify(I)+S).toString();V.push({type:"fill",templateHash:U,materialHash:R?()=>U:U,cim:I,materialOverrides:null,colorLocked:I.colorLocked,color:L(aa,O,"Color",T,Z,K),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:I.effects})}function r(I,O,Q,T,V){const aa=I.primitiveName,
Z=I.tintColor?b.fromCIMColor(I.tintColor):{r:255,g:255,b:255,a:1},[R,S]=N(Q,aa);Q=x.numericHash(JSON.stringify(I)+S).toString();const U=x.numericHash(`${I.url}${JSON.stringify(I.colorSubstitutions)}`).toString();V.push({type:"fill",templateHash:Q,materialHash:R?()=>U:U,cim:I,materialOverrides:null,colorLocked:I.colorLocked,effects:I.effects,color:L(aa,O,"TintColor",T,Z,K),height:L(aa,O,"Height",T,I.height),scaleX:L(aa,O,"ScaleX",T,I.scaleX),angle:L(aa,O,"Rotation",T,I.rotation),offsetX:L(aa,O,"OffsetX",
T,I.offsetX),offsetY:L(aa,O,"OffsetY",T,I.offsetY)})}function w(I,O,Q,T,V){const aa=["Rotation","OffsetX","OffsetY"],Z=Q.filter(fa=>fa.primitiveName!==I.primitiveName&&-1===aa.indexOf(fa.propertyName)),R=I.primitiveName,[S,U]=N(Q,R);Q=x.numericHash(JSON.stringify(I)+U).toString();const X=x.numericHash(`${I.separation}${JSON.stringify(I.lineSymbol)}`).toString();V.push({type:"fill",templateHash:Q,materialHash:S?M(X,O,Z,T):X,cim:I,materialOverrides:Z,colorLocked:I.colorLocked,effects:I.effects,color:{r:255,
g:255,b:255,a:1},height:L(R,O,"Separation",T,I.separation),scaleX:1,angle:L(R,O,"Rotation",T,I.rotation),offsetX:L(R,O,"OffsetX",T,I.offsetX),offsetY:L(R,O,"OffsetY",T,I.offsetY)})}function v(I,O,Q,T,V,aa,Z){const R=I.primitiveName,S=b.fromCIMColor(I.color),U=void 0!==I.width?I.width:4,X=c(I.capStyle),fa=q(I.joinStyle),ea=I.miterLimit,[ha,W]=N(Q,R),Y=x.numericHash(JSON.stringify(I)+W).toString();V.push({type:"line",templateHash:Y,materialHash:ha?()=>Y:Y,cim:I,materialOverrides:null,isOutline:aa,colorLocked:I.colorLocked,
effects:I.effects,color:L(R,O,"Color",T,S,K),width:L(R,O,"Width",T,U),cap:L(R,O,"CapStyle",T,X),join:L(R,O,"JoinStyle",T,fa),miterLimit:L(R,O,"MiterLimit",T,ea),referenceWidth:Z,zOrder:J(I.name),isDashed:!1})}function z(I,O,Q,T,V,aa,Z){const R=x.numericHash(`${I.url}${JSON.stringify(I.colorSubstitutions)}`).toString(),S=I.primitiveName,U=b.fromCIMColor(I.tintColor),X=void 0!==I.width?I.width:4,fa=c(I.capStyle),ea=q(I.joinStyle),ha=I.miterLimit,[W,Y]=N(Q,S);Q=x.numericHash(JSON.stringify(I)+Y).toString();
V.push({type:"line",templateHash:Q,materialHash:W?()=>R:R,cim:I,materialOverrides:null,isOutline:aa,colorLocked:I.colorLocked,effects:I.effects,color:L(S,O,"TintColor",T,U,K),width:L(S,O,"Width",T,X),cap:L(S,O,"CapStyle",T,fa),join:L(S,O,"JoinStyle",T,ea),miterLimit:L(S,O,"MiterLimit",T,ha),referenceWidth:Z,zOrder:J(I.name),isDashed:!1})}function u(I,O,Q,T,V){const aa=I.markerPlacement;if(!aa||"CIMMarkerPlacementInsidePolygon"!==aa.type)return!1;const Z=["Rotation","OffsetX","OffsetY"],R=Q.filter(X=>
X.primitiveName!==I.primitiveName&&-1===Z.indexOf(X.propertyName)),[S,U]=N(Q,aa.primitiveName);Q=x.numericHash(JSON.stringify(I)+U).toString();V.push({type:"fill",templateHash:Q,materialHash:S?M(Q,O,R,T):Q,cim:I,materialOverrides:R,colorLocked:I.colorLocked,effects:I.effects,color:{r:255,g:255,b:255,a:1},height:L(aa.primitiveName,O,"StepY",T,aa.stepY),scaleX:1,angle:L(aa.primitiveName,O,"GridAngle",T,aa.gridAngle),offsetX:L(aa.primitiveName,O,"OffsetX",T,aa.offsetX),offsetY:L(aa.primitiveName,O,"OffsetY",
T,aa.offsetY)});return!0}function y(I,O,Q,T,V,aa,Z){const R=I.primitiveName,S=I.size,U=I.scaleX,X=I.rotation,fa=I.offsetX,ea=I.offsetY,ha=I.tintColor?b.fromCIMColor(I.tintColor):{r:255,g:255,b:255,a:1},W=x.numericHash(`${I.url}${JSON.stringify(I.colorSubstitutions)}`).toString(),[Y,ba]=N(Q,R);Q=x.numericHash(JSON.stringify(I)+ba).toString();V.push({type:"marker",templateHash:Q,materialHash:Y?()=>W:W,cim:I,materialOverrides:null,colorLocked:I.colorLocked,effects:I.effects,scaleSymbolsProportionally:!1,
alignment:aa,size:L(R,O,"Size",T,S),scaleX:L(R,O,"ScaleX",T,U),rotation:L(R,O,"Rotation",T,X),offsetX:L(R,O,"OffsetX",T,fa),offsetY:L(R,O,"OffsetY",T,ea),color:L(R,O,"TintColor",T,ha,K),anchorPoint:I.anchorPoint,isAbsoluteAnchorPoint:"Relative"!==I.anchorPointUnits,outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:I.rotateClockwise,referenceSize:Z,sizeRatio:1,markerPlacement:I.markerPlacement})}function D(I,O,Q,T,V,aa,Z,R,S){p.OverrideHelper.findApplicableOverrides(O,T,[]);
var U=O.geometry;if("x"in U&&"y"in U){var X=O.symbol;var fa=X.underline?"underline":X.strikethrough?"line-through":"none";var ea=f(X.fontStyleName);X.font={family:X.fontFamilyName,decoration:fa,...ea};var ha=I.frame,W=I.size/S;S=I.primitiveName;fa=(X.height||0)*W;ea=X.angle||0;var Y=((X.offsetX||0)+(U.x-.5*(ha.xmin+ha.xmax)))*W;U=((X.offsetY||0)+(U.y-.5*(ha.ymin+ha.ymax)))*W;ha=b.fromCIMColor(p.CIMSymbolHelper.getFillColor(X));var ba=b.fromCIMColor(p.CIMSymbolHelper.getStrokeColor(X)),ca=p.CIMSymbolHelper.getStrokeWidth(X);
ca||(ba=b.fromCIMColor(p.CIMSymbolHelper.getFillColor(X.haloSymbol)),ca=X.haloSize*W);W="";for(const da of T)da.primitiveName===S&&void 0!==da.value&&(W+=`-${da.primitiveName}-${da.propertyName}-${JSON.stringify(da.value)}`);T=JSON.stringify(I.effects)+Number(I.colorLocked)+JSON.stringify(I.anchorPoint)+I.anchorPointUnits+JSON.stringify(I.markerPlacement);T=x.numericHash(JSON.stringify(O)+T+W).toString();aa.push({type:"text",templateHash:T,materialHash:()=>x.numericHash(JSON.stringify(X.font)).toString(),
cim:X,materialOverrides:null,colorLocked:I.colorLocked,effects:I.effects,alignment:Z,anchorPoint:{x:I.anchorPoint?I.anchorPoint.x:0,y:I.anchorPoint?I.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==I.anchorPointUnits,fontName:X.fontFamilyName,decoration:"none",weight:"normal",style:"normal",size:L(S,Q,"Size",V,fa),angle:L(S,Q,"Rotation",V,ea),offsetX:L(S,Q,"OffsetX",V,Y),offsetY:L(S,Q,"OffsetY",V,U),horizontalAlignment:n(X.horizontalAlignment),verticalAlignment:a(X.verticalAlignment),text:L(O.primitiveName,
Q,"TextString",V,O.textString,b._adjustTextCase,X.textCase),color:ha,outlineColor:ba,outlineSize:ca,referenceSize:R,sizeRatio:1,markerPlacement:I.markerPlacement})}}function G(I,O,Q,T,V,aa,Z,R,S,U){const X=O.geometry;if(X){var fa=O.symbol.symbolLayers;if(fa)if(U)H(I,O,T,Q,V,aa,Z,R,S);else for(U=fa.length;U--;){var ea=fa[U];if(ea&&!1!==ea.enable)switch(ea.type){case "CIMSolidFill":case "CIMSolidStroke":{var ha=h.getExtent(X);if(!ha)continue;const [ba,ca,da]=h.getSDFMetrics(ha,I.frame,I.size,I.anchorPoint,
"Relative"!==I.anchorPointUnits);var W="CIMSolidFill"===ea.type;ha={type:"sdf",geom:X,asFill:W};var Y=I.primitiveName;const ia=I.size,ja=I.rotation||0,ka=I.offsetX,la=I.offsetY,ma=ea.primitiveName,pa=W?b.fromCIMColor(p.CIMSymbolHelper.getFillColor(ea)):b.fromCIMColor(p.CIMSymbolHelper.getStrokeColor(ea)),qa=W?{r:0,g:0,b:0,a:0}:b.fromCIMColor(p.CIMSymbolHelper.getStrokeColor(ea)),na=p.CIMSymbolHelper.getStrokeWidth(ea);if(!W&&!na)break;W=!1;let oa="";for(const ra of Q)if(ra.primitiveName===ma||ra.primitiveName===
Y)void 0!==ra.value?oa+=`-${ra.primitiveName}-${ra.propertyName}-${JSON.stringify(ra.value)}`:ra.valueExpressionInfo&&(W=!0);Y=JSON.stringify({...I,markerGraphics:null});const sa=x.numericHash(JSON.stringify(ha)).toString();ea={type:"marker",templateHash:x.numericHash(JSON.stringify(O)+JSON.stringify(ea)+Y+oa).toString(),materialHash:W?()=>sa:sa,cim:ha,materialOverrides:null,colorLocked:I.colorLocked,effects:I.effects,scaleSymbolsProportionally:I.scaleSymbolsProportionally,alignment:Z,anchorPoint:{x:ca,
y:da},isAbsoluteAnchorPoint:!1,size:L(I.primitiveName,T,"Size",V,ia),rotation:L(I.primitiveName,T,"Rotation",V,ja),offsetX:L(I.primitiveName,T,"OffsetX",V,ka),offsetY:L(I.primitiveName,T,"OffsetY",V,la),scaleX:1,frameHeight:S,rotateClockwise:I.rotateClockwise,referenceSize:R,sizeRatio:ba,color:L(ma,T,"Color",V,pa,K),outlineColor:L(ma,T,"Color",V,qa,K),outlineWidth:L(ma,T,"Width",V,na),markerPlacement:I.markerPlacement};aa.push(ea);break}default:H(I,O,T,Q,V,aa,Z,R,S)}}}}function H(I,O,Q,T,V,aa,Z,R,
S){O={type:I.type,enable:!0,name:I.name,colorLocked:I.colorLocked,primitiveName:I.primitiveName,anchorPoint:I.anchorPoint,anchorPointUnits:I.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:I.rotateClockwise,rotation:0,size:I.size,billboardMode3D:I.billboardMode3D,depth3D:I.depth3D,frame:I.frame,markerGraphics:[O],scaleSymbolsProportionally:I.scaleSymbolsProportionally,respectFrame:I.respectFrame,clippingPath:I.clippingPath,effects:I.effects};let U=[];const X=["Rotation","OffsetX","OffsetY"];
U=T.filter(da=>da.primitiveName!==I.primitiveName||-1===X.indexOf(da.propertyName));var fa="";for(var ea of T)void 0!==ea.value&&(fa+=`-${ea.primitiveName}-${ea.propertyName}-${JSON.stringify(ea.value)}`);const [ha,W,Y]=p.CIMSymbolHelper.getTextureAnchor(O);T=I.primitiveName;ea=I.rotation||0;const ba=I.offsetX||0,ca=I.offsetY||0;fa=x.numericHash(JSON.stringify(O)+fa).toString();Q={type:"marker",templateHash:fa,materialHash:0===U.length?fa:M(fa,Q,U,V),cim:O,materialOverrides:U,colorLocked:I.colorLocked,
effects:I.effects,scaleSymbolsProportionally:I.scaleSymbolsProportionally,alignment:Z,anchorPoint:{x:ha,y:W},isAbsoluteAnchorPoint:!1,size:I.size,rotation:L(T,Q,"Rotation",V,ea),offsetX:L(T,Q,"OffsetX",V,ba),offsetY:L(T,Q,"OffsetY",V,ca),color:{r:255,g:255,b:255,a:1},outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,scaleX:1,frameHeight:S,rotateClockwise:I.rotateClockwise,referenceSize:R,sizeRatio:Y/B.pt2px(I.size),markerPlacement:I.markerPlacement};aa.push(Q)}function J(I){return I&&0===I.indexOf("Level_")?
parseInt(I.substr(6),10):0}function K(I){if(!I||0===I.length)return null;I=(new E(I)).toRgba();return{r:I[0],g:I[1],b:I[2],a:I[3]}}function L(I,O,Q,T,V,aa,Z){if(I=O[I]){const R=I[Q];if("string"===typeof R||"number"===typeof R||R instanceof Array)return aa?aa.call(null,R,Z):R;if(null!=R&&R instanceof m.ArcadeExpression)return(S,U,X)=>{S=e(R,S,{$view:X},T.geometryType,U);null!==S&&aa&&(S=aa.call(null,S,Z));return null!==S?S:V}}return V}function M(I,O,Q,T){for(const V of Q)if(V.valueExpressionInfo){const aa=
O[V.primitiveName]&&O[V.primitiveName][V.propertyName];aa instanceof m.ArcadeExpression&&(V.fn=(Z,R,S)=>e(aa,Z,{$view:S},T.geometryType,R))}return(V,aa,Z)=>{for(const R of Q)R.fn&&(R.value=R.fn(V,aa,Z));return x.numericHash(I+p.OverrideHelper.buildOverrideKey(Q)).toString()}}function N(I,O){let Q=!1,T="";for(const V of I)V.primitiveName===O&&(void 0!==V.value?T+=`-${V.primitiveName}-${V.propertyName}-${JSON.stringify(V.value)}`:V.valueExpressionInfo&&(Q=!0));return[Q,T]}const P=C.getLogger("esri.symbols.cim.cimAnalyzer");
A.analyzeCIMResource=function(I,O){if(!O||0===O.length)return I;I=JSON.parse(JSON.stringify(I));p.OverrideHelper.applyOverrides(I,O);return I};A.analyzeCIMSymbol=function(I,O,Q,T){return l.apply(this,arguments)};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/arcade/callExpressionWithFeature":function(){define(["../../../core/Error","../../../core/Logger","../../../geometry/support/quantizationUtils"],function(A,F,E){function C(x){const m={};switch(x){case "esriGeometryPoint":return(p,
h,b,e)=>E.unquantizePoint(h,m,p,b,e);case "esriGeometryPolygon":return(p,h,b,e)=>E.unquantizePolygon(h,m,p,b,e);case "esriGeometryPolyline":return(p,h,b,e)=>E.unquantizePolyline(h,m,p,b,e);case "esriGeometryMultipoint":return(p,h,b,e)=>E.unquantizeMultipoint(h,m,p,b,e);default:return F.getLogger("esri.views.2d.support.arcadeOnDemand").error(new A("mapview-arcade",`Unable to handle geometryType: ${x}`)),p=>p}}const B=new Map;return function(x,m,p,h,b){if(x.referencesGeometry()&&b){{const {transform:e,
hasZ:c,hasM:q}=b;B.has(h)||B.set(h,C(h));h=B.get(h)(m.geometry,e,c,q);m={...m,geometry:h}}}m=x.repurposeFeature(m);try{return x.evaluate({...p,$feature:m})}catch(e){return F.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",e),null}}})},"esri/geometry/support/quantizationUtils":function(){define(["exports","../../core/maybe","./jsonUtils"],function(A,F,E){function C({scale:y,translate:D},G){return Math.round((G-D[0])/y[0])}function B({scale:y,translate:D},
G){return Math.round((D[1]-G)/y[1])}function x(y,D,G){const H=[];let J,K,L,M;for(let N=0;N<G.length;N++){const P=G[N];if(0<N){if(L=C(y,P[0]),M=B(y,P[1]),L!==J||M!==K)H.push(D(P,L-J,M-K)),J=L,K=M}else J=C(y,P[0]),K=B(y,P[1]),H.push(D(P,J,K))}return 0<H.length?H:null}function m(y,D,G,H){return x(y,G?H?u:z:H?z:v,D)}function p(y,D,G,H){const J=[];G=G?H?u:z:H?z:v;for(H=0;H<D.length;H++){const K=x(y,G,D[H]);K&&3<=K.length&&J.push(K)}return J.length?J:null}function h(y,D,G,H){const J=[];G=G?H?u:z:H?z:v;
for(H=0;H<D.length;H++){const K=x(y,G,D[H]);K&&2<=K.length&&J.push(K)}return J.length?J:null}function b({scale:y,translate:D},G){return G*y[0]+D[0]}function e({scale:y,translate:D},G){return D[1]-G*y[1]}function c(y,D,G){const H=Array(G.length);if(!G.length)return H;const [J,K]=y.scale;let L=b(y,G[0][0]);y=e(y,G[0][1]);H[0]=D(G[0],L,y);for(let M=1;M<G.length;M++){const N=G[M];L+=N[0]*J;y-=N[1]*K;H[M]=D(N,L,y)}return H}function q(y,D,G){const H=Array(G.length);for(let J=0;J<G.length;J++)H[J]=c(y,D,
G[J]);return H}function n(y,D,G,H){return c(y,G?H?u:z:H?z:v,D)}function a(y,D,G,H){return q(y,G?H?u:z:H?z:v,D)}function f(y,D,G,H){return q(y,G?H?u:z:H?z:v,D)}function d(y,D,G){let [H,J]=G[0],K=Math.min(H,D[0]),L=Math.min(J,D[1]),M=Math.max(H,D[2]);D=Math.max(J,D[3]);for(let N=1;N<G.length;N++){const [P,I]=G[N];H+=P;J+=I;0>P&&(K=Math.min(K,H));0<P&&(M=Math.max(M,H));0>I?L=Math.min(L,J):0<I&&(D=Math.max(D,J))}y[0]=K;y[1]=L;y[2]=M;y[3]=D;return y}function k(y,D){if(!D.length)return null;y[0]=y[1]=Number.POSITIVE_INFINITY;
y[2]=y[3]=Number.NEGATIVE_INFINITY;for(let G=0;G<D.length;G++)d(y,y,D[G]);return y}function l(y,D,G,H,J){D.xmin=C(y,G.xmin);D.ymin=B(y,G.ymin);D.xmax=C(y,G.xmax);D.ymax=B(y,G.ymax);D!==G&&(H&&(D.zmin=G.zmin,D.zmax=G.zmax),J&&(D.mmin=G.mmin,D.mmax=G.mmax));return D}function g(y,D,G,H,J){D.points=m(y,G.points,H,J);return D}function t(y,D,G,H,J){D.x=C(y,G.x);D.y=B(y,G.y);D!==G&&(H&&(D.z=G.z),J&&(D.m=G.m));return D}function r(y,D,G,H,J){y=p(y,G.rings,H,J);if(!y)return null;D.rings=y;return D}function w(y,
D,G,H,J){y=h(y,G.paths,H,J);if(!y)return null;D.paths=y;return D}const v=(y,D,G)=>[D,G],z=(y,D,G)=>[D,G,y[2]],u=(y,D,G)=>[D,G,y[2],y[3]];A.equals=function(y,D){if(y===D||null==y&&null==D)return!0;if(null==y||null==D)return!1;let G,H,J,K;y&&"upperLeft"===y.originPosition?(G=y.translate[0],H=y.translate[1],y=y.scale[0]):(G=y.extent.xmin,H=y.extent.ymax,y=y.tolerance);D&&"upperLeft"===D.originPosition?(J=D.translate[0],K=D.translate[1],D=D.scale[0]):(J=D.extent.xmin,K=D.extent.ymax,D=D.tolerance);return G===
J&&H===K&&y===D};A.getQuantizedBoundsCoordsArray=d;A.getQuantizedBoundsCoordsArrayArray=k;A.getQuantizedBoundsPaths=function(y){return k([0,0,0,0],y)};A.getQuantizedBoundsPoints=function(y){const D=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return d(D,D,y)};A.getQuantizedBoundsRings=function(y){return k([0,0,0,0],y)};A.quantizeBounds=function(y,D,G){D[0]=C(y,G[0]);D[3]=B(y,G[1]);D[2]=C(y,G[2]);D[1]=B(y,G[3]);return D};A.quantizeExtent=l;A.quantizeGeometry=
function(y,D){return y&&D?E.isPoint(D)?t(y,{},D,!1,!1):E.isPolyline(D)?w(y,{},D,!1,!1):E.isPolygon(D)?r(y,{},D,!1,!1):E.isMultipoint(D)?g(y,{},D,!1,!1):E.isExtent(D)?l(y,{},D,!1,!1):null:null};A.quantizeMultipoint=g;A.quantizePaths=h;A.quantizePoint=t;A.quantizePoints=m;A.quantizePolygon=r;A.quantizePolyline=w;A.quantizeRings=p;A.quantizeX=C;A.quantizeY=B;A.toQuantizationTransform=function(y){return y?{originPosition:"upper-left"===y.originPosition?"upperLeft":"lower-left"===y.originPosition?"lowerLeft":
y.originPosition,scale:y.tolerance?[y.tolerance,y.tolerance]:[1,1],translate:y.extent?[y.extent.xmin,y.extent.ymax]:[0,0]}:null};A.unquantizeBounds=function(y,D,G){return G?(D[0]=b(y,G[0]),D[1]=e(y,G[3]),D[2]=b(y,G[2]),D[3]=e(y,G[1]),D):[b(y,D[0]),e(y,D[3]),b(y,D[2]),e(y,D[1])]};A.unquantizeCoordsArray=c;A.unquantizeCoordsArrayArray=q;A.unquantizeExtent=function(y,D,G,H,J){D.xmin=b(y,G.xmin);D.ymin=e(y,G.ymin);D.xmax=b(y,G.xmax);D.ymax=e(y,G.ymax);D!==G&&(H&&(D.zmin=G.zmin,D.zmax=G.zmax),J&&(D.mmin=
G.mmin,D.mmax=G.mmax));return D};A.unquantizeMultipoint=function(y,D,G,H,J){F.isSome(G)&&(D.points=n(y,G.points,H,J));return D};A.unquantizePaths=a;A.unquantizePoint=function(y,D,G,H,J){if(F.isNone(G))return D;D.x=b(y,G.x);D.y=e(y,G.y);D!==G&&(H&&(D.z=G.z),J&&(D.m=G.m));return D};A.unquantizePoints=n;A.unquantizePolygon=function(y,D,G,H,J){F.isSome(G)&&(D.rings=f(y,G.rings,H,J));return D};A.unquantizePolyline=function(y,D,G,H,J){F.isSome(G)&&(D.paths=a(y,G.paths,H,J));return D};A.unquantizeRings=
f;A.unquantizeX=b;A.unquantizeY=e;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/symbols/cim/ExpandedCIM":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../views/2d/engine/webgl/enums","../../views/2d/engine/webgl/materialKey/MaterialKey"],function(A,F,E,C){const B={marker:E.WGLGeometryType.MARKER,fill:E.WGLGeometryType.FILL,line:E.WGLGeometryType.LINE,text:E.WGLGeometryType.TEXT};E=function(){function x(m,p,h,b){const e={minScale:null==p?void 0:p.minScale,maxScale:null==
p?void 0:p.maxScale};var c=e.minScale||e.maxScale?e.minScale+"-"+e.maxScale:"";this.layers=m;this.data=p;this.hash=this._createHash()+c;this.rendererKey=h;for(const q of m)q.materialKey=C.createMaterialKey(B[q.type],this.rendererKey,!1,!1),q.maxVVSize=b,q.scaleInfo=e,q.templateHash+=c}x.prototype._createHash=function(){let m="";for(const p of this.layers)m+=p.templateHash;return m};F._createClass(x,[{key:"type",get:function(){return"expanded-cim"}}]);return x}();A.ExpandedCIM=E;Object.defineProperty(A,
"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/GraphicTile":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ./DirtyMap ./DisplayRecordStore ./WGLBuffers ./WGLTile".split(" "),function(A,F,E,C,B,x){x=function(m){function p(){var b=m.apply(this,arguments)||this;b._data=null;b._displayList=null;b._lastCommitTime=0;b._hasData=!1;b._invalidated=!1;b._wglBuffers=null;b._dirtyMap=new E;return b}F._inheritsLoose(p,m);var h=p.prototype;h.destroy=function(){m.prototype.destroy.call(this);
this.clear()};h.getGeometry=function(b){return this._wglBuffers&&this._wglBuffers.has(b)?this._wglBuffers.get(b):null};h.getDisplayList=function(){return this._displayList};h.patch=function(b){if(!0===b.clear)this.clear(),this._hasData=!1;else{var e=b.addOrUpdate,c=b.remove;!this._data&&e&&e.tileDisplayData.displayObjects.length?(e.tileDisplayData.computeDisplayList(),this._dirtyMap=new E,this._dispRecStore=C.fromTileData(e,this._dirtyMap),this._data=e,this._dirtyMap.markAllDirty(),this._hasData=
!0,b.end&&this.ready()):this._data?e&&e.tileDisplayData.displayObjects.length||c.length?this._doPatchData(b):b.end&&this.ready():b.end&&this.ready();b.end&&!this._data&&this.clear();this.requestRender();this.emit("change")}};h.commit=function(b){if(!b.time||b.time!==this._lastCommitTime)if(this._lastCommitTime=b.time,this.visible&&this._data&&(this._wglBuffers||(this._wglBuffers=new B(b.context)),this._dirtyMap.hasDirty()||this._invalidated))this._invalidated=!1,this._wglBuffers.upload(this._data.tileBufferData,
this._dirtyMap),this._displayList=this._data.tileDisplayData.displayList.clone(),this._displayObjects=this._data.tileDisplayData.displayObjects.slice(),this._dirtyMap.markAllClean()};h.clear=function(){this._dispRecStore=this._displayList=this._data=null;this._wglBuffers&&(this._wglBuffers.dispose(),this._wglBuffers=null)};h._doPatchData=function(b){this._invalidated=!0;this._patchData(b)||(this._dirtyMap.markAllDirty(),this._data.reshuffle(),this._dispRecStore=C.fromTileData(this._data,this._dirtyMap));
this.requestRender()};h._patchData=function(b){let e=!0;var c=b.addOrUpdate&&b.addOrUpdate.tileDisplayData&&b.addOrUpdate.tileDisplayData.displayObjects||[],q=(b.remove||[]).slice();for(var n of c)null!=n.insertAfter&&q.push(n.id);for(var a of q)if(q=this._data.tileDisplayData.displayObjectRegistry.get(a)){this._data.tileDisplayData.displayList.removeFromList(q.displayRecords);for(var f of q.displayRecords)this._dispRecStore.delete(f);this._data.tileDisplayData.displayObjectRegistry.delete(a);q=this._data.tileDisplayData.displayObjects.indexOf(q);
this._data.tileDisplayData.displayObjects.splice(q,1)}for(const g of c){c=this._data.tileDisplayData.displayObjectRegistry.get(g.id);let t;if(c){a=c.displayRecords;c.set(g);c.displayRecords=a;a=c.displayRecords.length;for(f=0;f<a;++f)if(q=c.displayRecords[f],n=g.displayRecords[f],f>=g.displayRecords.length||q.geometryType!==n.geometryType||q.symbolLevel!==n.symbolLevel||q.zOrder!==n.zOrder||q.materialKey!==n.materialKey)this._dispRecStore.delete(c.displayRecords[f]),f<g.displayRecords.length&&(c.displayRecords[f]=
void 0);c.displayRecords.length=g.displayRecords.length}else if(c=g.copy(),c.displayRecords=[],this._data.tileDisplayData.displayObjectRegistry.set(g.id,c),a=this._data.tileDisplayData.displayObjects,null!=c.insertAfter?(t={},0<=c.insertAfter?(f=this._data.tileDisplayData.displayObjectRegistry.get(c.insertAfter))?(n=a.indexOf(f)+1,n<a.length?a.splice(n,0,c):(a.push(c),n=a.length)):(a.push(c),n=a.length):(a.unshift(c),n=0)):(a.push(c),n=a.length),t)for(f=0<g.displayRecords.length?1:0,q=0,--n;0<=n&&
q<f;--n)for(var d=a[n].displayRecords.length-1;0<=d&&q<f;--d){var k=a[n].displayRecords[d],l=this._data.tileDisplayData.displayList.getDPInfoType();t[l]||(t[l]=k,++q)}a=g.displayRecords.length;for(f=0;f<a;++f){q=g.displayRecords[f];(n=c.displayRecords[f])?(n.meshData=q.meshData,n.materialKey=q.materialKey):(n=q.copy(),n.vertexFrom=void 0,n.indexFrom=void 0,c.displayRecords[f]=n);k=q.geometryType;d=this._data.tileDisplayData.displayList.getDPInfoType();l=b.addOrUpdate.tileBufferData.geometries[k];
k=l.vertexBuffer;l=l.indexBuffer;let r=void 0;t&&(r=t[d]?this._data.tileDisplayData.displayList.splitAfter(t[d]):-1);e=this._dispRecStore.setMeshData(n,q,k,l,r)&&e;t&&null!=n.indexFrom&&null!=n.indexFrom&&(t[d]=n)}}return e};F._createClass(p,[{key:"hasData",get:function(){return!!this._hasData}},{key:"displayObjects",get:function(){var b;return null!=(b=this._displayObjects)?b:[]}}]);return p}(x.WGLTile);A.GraphicTile=x;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/DirtyMap":function(){define(function(){return function(){function A(){this._dirties=
[{vertexFrom:-1,vertexCount:-1,indexFrom:-1,indexCount:-1,allDirty:!1},{vertexFrom:-1,vertexCount:-1,indexFrom:-1,indexCount:-1,allDirty:!1},{vertexFrom:-1,vertexCount:-1,indexFrom:-1,indexCount:-1,allDirty:!1},{vertexFrom:-1,vertexCount:-1,indexFrom:-1,indexCount:-1,allDirty:!1},{vertexFrom:-1,vertexCount:-1,indexFrom:-1,indexCount:-1,allDirty:!1}]}var F=A.prototype;F.hasDirty=function(){return this._dirties.some(E=>-1!==E.indexCount||E.allDirty)};F.markAllClean=function(){for(const E of this._dirties)E.indexFrom=
-1,E.indexCount=-1,E.vertexFrom=-1,E.vertexCount=-1,E.allDirty=!1};F.markAllDirty=function(){for(const E of this._dirties)E.allDirty=!0};F.forEach=function(E){for(let C=0;C<this._dirties.length;++C){const {indexCount:B,indexFrom:x,vertexCount:m,vertexFrom:p,allDirty:h}=this._dirties[C],b={};let e=void 0,c=!1;if(h||-1!==p&&0<m)b.geometry={count:m,from:p,allDirty:h},c=!0;if(h||-1!==x&&0<B)e={count:B,from:x,allDirty:h},c=!0;c&&E({indices:e,vertices:b},C)}};F.markDirtyIndices=function(E,C,B){E=this._dirties[E];
if(!E.allDirty)if(-1!==E.indexCount){const x=Math.min(E.indexFrom,C);C=Math.max(E.indexFrom+E.indexCount,C+B)-x;E.indexFrom=x;E.indexCount=C}else E.indexFrom=C,E.indexCount=B};F.markDirtyVertices=function(E,C,B,x){E=this._dirties[E];E.allDirty||(-1!==E.vertexCount?(C=Math.min(E.vertexFrom,B),B=Math.max(E.vertexFrom+E.vertexCount,B+x)-C,E.vertexFrom=C,E.vertexCount=B):(E.vertexFrom=B,E.vertexCount=x))};return A}()})},"esri/views/2d/engine/webgl/DisplayRecordStore":function(){define(["../../../../core/has",
"./FreeList","./Utils"],function(A,F,E){const C=["FILL","LINE","MARKER","TEXT","LABEL"];return function(){function B(m,p,h,b){this._strides=m;this._displayList=p;this._freeListsAndStorage={};this._dirtyMap=null;this._dirtyMap=h;for(const e in m){this._freeListsAndStorage[e]={vtxFreeList:b?new F.FreeList(b):null,idxFreeList:b?new F.FreeList(b):null,vertexBuffers:{},indexBuffer:b?new Uint32Array(b):null};for(const c in m[e])this._freeListsAndStorage[e].vertexBuffers[c]={data:b?E.allocateTypedArrayBuffer(b,
m[e][c]):null,stride:m[e][c]}}}B.fromTileData=function(m,p){var h,b=m.getStrides(),e={};for(h=0;h<b.length;h++)e[C[h]]=b[h];h=e;b=[0,0,0,0,0];e=[0,0,0,0,0];var c=m.tileDisplayData.displayObjects;for(var q of c)for(var n of q.displayRecords)b[n.geometryType]=Math.max(b[n.geometryType],n.vertexFrom+n.vertexCount),e[n.geometryType]=Math.max(e[n.geometryType],n.indexFrom+n.indexCount);p=new B(h,m.tileDisplayData.displayList,p,null);for(q=0;q<m.tileBufferData.geometries.length;++q){n=b[q];c=e[q];var a=
m.tileBufferData.geometries[q];h=p._storageFor(C[q]);const f=m.tileBufferData.geometries[q].indexBuffer;h.indexBuffer=f;h.idxFreeList=new F.FreeList(f.length);h.idxFreeList.allocate(c);let d;for(const k in a.vertexBuffer)c=m.tileBufferData.geometries[q].vertexBuffer[k],h.vertexBuffers[k].data=c.data,h.vertexBuffers[k].stride=c.stride,a=E.strideToPackingFactor(c.stride),c=c.data.length*a/c.stride,d||(d=c);h.vtxFreeList=new F.FreeList(d);h.vtxFreeList.allocate(n)}return p};var x=B.prototype;x.delete=
function(m){const p=C[m.geometryType];this._freeVertices(p,m.vertexFrom,m.vertexCount);this._freeIndices(p,m.indexFrom,m.indexCount);this._displayList.removeFromList(m);m.vertexFrom=void 0;m.indexFrom=void 0};x.setMeshData=function(m,p,h,b,e){const c=C[m.geometryType];m.meshData=null;let q=void 0,n=void 0;void 0===m.vertexFrom?(n=p.vertexCount,q=this._allocateVertices(c,n)):p.vertexCount>m.vertexCount?(this._freeVertices(c,m.vertexFrom,m.vertexCount),n=p.vertexCount,q=this._allocateVertices(c,n)):
p.vertexCount===m.vertexCount?(q=m.vertexFrom,n=m.vertexCount):(this._freeVertices(c,m.vertexFrom+p.vertexCount,m.vertexCount-p.vertexCount),q=m.vertexFrom,n=p.vertexCount);let a=!0,f=void 0,d=void 0,k=void 0;void 0===m.indexFrom?(f=e,k=p.indexCount,d=this._allocateIndices(c,k)):p.indexCount>m.indexCount?(f=this._displayList.removeFromList(m),this._freeIndices(c,m.indexFrom,m.indexCount),k=p.indexCount,d=this._allocateIndices(c,k)):p.indexCount===m.indexCount?(a=!1,d=m.indexFrom,k=m.indexCount):(f=
this._displayList.removeFromList(m),this._freeIndices(c,m.indexFrom+p.indexCount,m.indexCount-p.indexCount),d=m.indexFrom,k=p.indexCount);if(-1!==q&&-1!==d){e=this._storageFor(c);E.copyMeshData(q,d,e.vertexBuffers,e.indexBuffer,p,h,b);m.vertexFrom=q;m.indexFrom=d;m.vertexCount=p.vertexCount;m.indexCount=p.indexCount;if(this._dirtyMap){this._dirtyMap.markDirtyIndices(m.geometryType,m.indexFrom,m.indexCount);for(const l in h)this._dirtyMap.markDirtyVertices(m.geometryType,l,m.vertexFrom,m.vertexCount)}a&&
this._displayList.addToList(m,f);return!0}-1!==q&&this._freeVertices(c,q,n);-1!==d&&this._freeIndices(c,d,k);m.setMeshDataFromBuffers(p,h,b);m.vertexFrom=void 0;m.vertexCount=0;m.indexFrom=void 0;m.indexCount=0;return!1};x.tryAddMeshData=function(m,p){const h=p.vertexBuffer;p=p.indexBuffer;var b=C[m.geometryType];const e=this._allocateVertices(b,m.vertexCount);if(-1===e)return this._freeVertices(b,e,m.vertexCount),!1;const c=this._allocateIndices(b,m.indexCount);if(-1===c)return this._freeVertices(b,
e,m.vertexCount),this._freeIndices(b,c,m.indexCount),!1;b=this._storageFor(b);E.copyMeshData(e,c,b.vertexBuffers,b.indexBuffer,m,h,p);m.vertexFrom=e;m.indexFrom=c;if(this._dirtyMap){this._dirtyMap.markDirtyIndices(m.geometryType,m.indexFrom,m.indexCount);for(const q in h)this._dirtyMap.markDirtyVertices(m.geometryType,q,e,m.vertexCount)}this._displayList.addToList(m);return!0};x._allocateVertices=function(m,p){m=this._storageFor(m);p=m.vtxFreeList.allocate(p);return-1===p||.5<m.vtxFreeList.fragmentation?
-1:p};x._freeVertices=function(m,p,h){this._storageFor(m).vtxFreeList.free(p,h)};x._freeIndices=function(m,p,h){this._storageFor(m).idxFreeList.free(p,h)};x._allocateIndices=function(m,p){m=this._storageFor(m);p=m.idxFreeList.allocate(p);return-1===p||.5<m.idxFreeList.fragmentation?-1:p};x._storageFor=function(m){return this._freeListsAndStorage[m]};x._stridesFor=function(m,p){return this._strides[m][p]};return B}()})},"esri/views/2d/engine/webgl/FreeList":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers"],
function(A,F){let E=function(){function B(m){this._largestRange=null;this._parent=m;this._updateLargestRange()}var x=B.prototype;x.rangeCreated=function(m){if(!this._largestRange||m.count>this._largestRange.count)this._largestRange=m};x.rangeResized=function(m,p){if(m===this._largestRange)m.count<p&&this._updateLargestRange();else if(!this._largestRange||m.count>this._largestRange.count)this._largestRange=m};x.findBestRange=function(m){let p=this._parent._freeHead,h=null;for(;null!==p;)p.count>=m&&
(!h||p.count-m<h.count-m)&&(h=p),p=p.next;return h};x.findAdjacentRanges=function(m,p){let h=!0,b=!1,e=null,c=this._parent._freeHead;for(;h&&!b;){const q=null!==c?c.from:this._parent._size;m>=(null!==e?e.from+e.count:0)&&m+p<=q?(h=!1,b=!0):null!==c?(e=c,c=c.next):h=!1}return[e,c]};x._updateLargestRange=function(){let m=null,p=this._parent._freeHead;for(;null!==p;){if(!m||p.count>m.count)m=p;p=p.next}this._largestRange=m};F._createClass(B,[{key:"largestRange",get:function(){return this._largestRange}}]);
return B}(),C=function(){function B(m,p){this._allocated=0;this._size=m;this._freeHead=0<m?{from:0,count:m,prev:null,next:null}:null;this._bookKeeper=p||new E(this);this._freeHead&&this._bookKeeper.rangeCreated(this._freeHead)}var x=B.prototype;x.allocate=function(m){const p=this._bookKeeper.findBestRange(m);if(null===p)return-1;const h=p.from,b=p.count;p.from+=m;p.count-=m;this._bookKeeper.rangeResized(p,h,b);this._allocated+=m;0===p.count&&(m=null!==p.prev?this._freeHead:p.next,B._removeRange(p),
this._freeHead=m);return h};x.free=function(m,p){const [h,b]=this._bookKeeper.findAdjacentRanges(m,p);m={from:m,count:p,prev:h,next:b};null!==h&&(h.next=m);null!==b&&(b.prev=m);this._bookKeeper.rangeCreated(m);this._allocated-=p;if(null!==b&&m.from+m.count===b.from){p=m.from;var e=m.count;B._fuse(m,b);B._removeRange(b);this._bookKeeper.rangeResized(m,p,e);this._bookKeeper.rangeResized(b,void 0,0)}null!==h&&h.from+h.count===m.from&&(p=h.from,e=h.count,B._fuse(h,m),B._removeRange(m),this._bookKeeper.rangeResized(h,
p,e),this._bookKeeper.rangeResized(m,void 0,0));this._freeHead=null!==m.prev?this._freeHead:m};B._removeRange=function(m){null!==m.prev?null!==m.next?(m.prev.next=m.next,m.next.prev=m.prev):m.prev.next=null:null!==m.next&&(m.next.prev=null)};B._fuse=function(m,p){m.count+=p.count;m.next=p.next;p.from+=p.count;p.count=0;null!==p.next&&(p.next.prev=m)};F._createClass(B,[{key:"fragmentation",get:function(){const m=this._size-this._allocated;return 0===m?0:1-this._bookKeeper.largestRange.count/m}}]);
return B}();A.FreeList=C;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/WGLBuffers":function(){define("../../../webgl/BufferObject ../../../webgl/FramebufferObject ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../webgl/checkWebGLError ../../../webgl/enums ../../../../chunks/builtins ../../../webgl/renderState ../../../webgl/Texture ../../../webgl/VertexArrayObject ./Utils".split(" "),function(A,F,E,C,B,x,m,p,h,b,e){return function(){function c(n){this.geometryMap=
e.createGeometryData(()=>({indexBuffer:A.createIndex(n,35044),vao:null}),(a,f)=>({vertexBuffer:A.createVertex(n,e.C_VBO_INFO[f])}))}var q=c.prototype;q.dispose=function(){for(let n=0;5>n;n++){const a=this.geometryMap[n];if(a){a.data.vao&&a.data.vao.dispose(!1);a.data.indexBuffer&&a.data.indexBuffer.dispose();for(const f in a.buffers)a.buffers[f]&&a.buffers[f].data.vertexBuffer.dispose()}}};q.get=function(n){const a=this.geometryMap[n];return{draw(f,d,k,l,g){if(!a.data.vao){const t={};for(const r in a.buffers)t[r]=
a.buffers[r].data.vertexBuffer;a.data.vao=new b(f,k,d,t,a.data.indexBuffer)}f.bindVAO(a.data.vao);f.drawElements(4,g,5125,Uint32Array.BYTES_PER_ELEMENT*l);f.bindVAO(null)}}};q.has=function(n){return null!=this.geometryMap[n]};q.upload=function(n,a){a.forEach((f,d)=>{this._upload(f,d,n)})};q._upload=function(n,a,f){n.indices&&(n.indices.allDirty?this._uploadIndices(f,a):null!=n.indices.from&&null!=n.indices.count&&this._uploadIndices(f,a,n.indices.from,n.indices.count));if(n.vertices){n=n.vertices;
for(const d in n){const k=n[d];k.allDirty?this._uploadVertices(f,a,d):null!=k.from&&null!=k.count&&this._uploadVertices(f,a,d,k.from,k.count)}}};q._uploadVertices=function(n,a,f,d,k){const l=this.geometryMap[a];l&&(a=n.geometries[a].vertexBuffer[f])&&(n=a.stride,a=a.data.buffer,l.buffers[f]&&0<a.byteLength&&(null!=d&&null!=k?l.buffers[f].data.vertexBuffer.setSubData(a,d*n,d*n,(d+k)*n):l.buffers[f].data.vertexBuffer.setData(a)))};q._uploadIndices=function(n,a,f,d){const k=this.geometryMap[a];k&&(n=
n.geometries[a].indexBuffer.buffer,k.data.indexBuffer&&0<n.byteLength&&(null!=f&&null!=d?k.data.indexBuffer.setSubData(n,4*f,4*f,4*(f+d)):k.data.indexBuffer.setData(n)))};return c}()})},"esri/views/2d/engine/webgl/WGLTile":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/mat2d ../../../../chunks/mat3 ../../../../chunks/mat3f32 ../../../../chunks/vec2 ../../../../chunks/vec2f32 ./definitions ./TiledDisplayObject".split(" "),function(A,F,E,C,B,x,m,p,h){let b=
function(){function e(){}var c=e.prototype;c.acquire=function(q){return{refCount:1,version:-1,labelMat2d:B.create(),tileMat3:B.create(),dvs:B.create()}};c.release=function(q){};return e}();h=function(e){function c(n,a,f){return e.call(this,n,a,f,p.TILE_SIZE,p.TILE_SIZE)||this}F._inheritsLoose(c,e);var q=c.prototype;q.destroy=function(){e.prototype.destroy.call(this);this._transforms&&c.TransformCache.release(this.key.hash)};q.setTransform=function(n,a){if(n.version!==this.transforms.version){this.transforms.version=
n.version;var f=a/(n.resolution*n.pixelRatio),d=this.transforms.tileMat3,[k,l]=n.toScreenNoRotation([0,0],[this.x,this.y]);C.set(d,this.width/this.rangeX*f,0,0,0,this.height/this.rangeY*f,0,k,l,1);C.multiply(this.transforms.dvs,n.displayViewMat3,d);f=this.transforms.labelMat2d;a=n.getScreenTransform(f,a);d=m.create();x.transformMat2d(d,[this.x,this.y],a);E.identity(f);E.translate(f,f,d);E.multiply(f,n.viewMat2d,f)}};q._createTransforms=function(){return c.TransformCache.acquire(this.key.hash)};return c}(h.TiledDisplayObject);
h.TransformCache=new b;A.WGLTile=h;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/TiledDisplayObject":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../chunks/mat3","../DisplayObject","../../tiling/TileKey"],function(A,F,E,C,B){C=function(x){function m(h,b,e,c,q,n=c,a=q){var f=x.call(this)||this;f.triangleCountReportedInDebug=0;f.triangleCount=0;f.texture=null;f.key=new B(h);f.x=b;f.y=e;f.width=c;f.height=q;f.rangeX=n;f.rangeY=
a;return f}F._inheritsLoose(m,x);var p=m.prototype;p.destroy=function(){this.texture&&(this.texture.dispose(),this.texture=null)};p.setTransform=function(h,b){b/=h.resolution*h.pixelRatio;const e=this.transforms.tileMat3,[c,q]=h.toScreenNoRotation([0,0],[this.x,this.y]);E.set(e,this.width/this.rangeX*b,0,0,0,this.height/this.rangeY*b,0,c,q,1);E.multiply(this.transforms.dvs,h.displayViewMat3,e)};return m}(C.DisplayObject);A.TiledDisplayObject=C;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/TileData":function(){define("exports ../../../../core/maybe ./MemoryRequirements ./TileBufferData ./TileDisplayData ./Utils ./WGLDisplayRecord ./cpuMapped/DisplayRecordReader ./mesh/VertexBuffer ./mesh/VertexVector ./util/Writer".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e){const c=new E,q=new E;E=function(){function n(){this.tileBufferData=this.tileDisplayData=null}var a=n.prototype;a.reshuffle=function(){c.reset();const f=B.groupRecordsByGeometryType(this.tileDisplayData.displayObjects);for(var d of f)for(var k of d)k&&c.needMore(k.geometryType,k.meshData?k.meshData.vertexCount:k.vertexCount,k.meshData?k.meshData.indexData.length:k.indexCount);d=f.length;k=new C;for(var l=0;l<d;++l){k.geometries[l].indexBuffer=new Uint32Array(Math.round(1.5*
c.indicesFor(l)));var g=[];for(var t in this.tileBufferData.geometries[l].vertexBuffer)g.push(this.tileBufferData.geometries[l].vertexBuffer[t].stride);g=n._computeVertexAlignment(g);var r=Math.round(1.5*c.verticesFor(l));g=n._align(r,g);for(var w in this.tileBufferData.geometries[l].vertexBuffer)r=this.tileBufferData.geometries[l].vertexBuffer[w].stride,k.geometries[l].vertexBuffer[w]={stride:r,data:x.allocateTypedArrayBuffer(g,r)}}q.reset();this.tileDisplayData.displayList.clear();for(t=0;t<d;++t){w=
f[t];for(const v of w){if(v.meshData)v.writeMeshDataToBuffers(q.verticesFor(t),k.geometries[t].vertexBuffer,q.indicesFor(t),k.geometries[t].indexBuffer),v.meshData=null;else{w=this.tileBufferData.geometries[t].vertexBuffer;l=this.tileBufferData.geometries[t].indexBuffer;g=k.geometries[t].vertexBuffer;r=k.geometries[t].indexBuffer;const z=q.verticesFor(t),u=q.indicesFor(t);x.copyMeshData(z,u,g,r,v,w,l);v.vertexFrom=z;v.indexFrom=u}q.needMore(t,v.vertexCount,v.indexCount)}}for(const v of this.tileDisplayData.displayObjects)this.tileDisplayData.displayList.addToList(v.displayRecords);
this.tileBufferData=k};a.getStrides=function(){const f=[];for(let d=0;d<this.tileBufferData.geometries.length;++d){const k=this.tileBufferData.geometries[d];f[d]={};for(const l in k.vertexBuffer)f[d][l]=k.vertexBuffer[l].stride}return f};a.clone=function(){const f=new n;f.tileBufferData=this.tileBufferData.clone();f.tileDisplayData=this.tileDisplayData.clone();return f};a._guessSize=function(){const {displayObjects:f}=this.tileDisplayData,d=Math.min(f.length,4);let k=0;for(let l=0;l<d;l++)k=Math.max(k,
f[l].displayRecords.length);return 2*(12*f.length+f.length*k*40)};a.serialize=function(){const f=this.tileBufferData.serialize(),d=this.tileBufferData.getBuffers(),k=this.tileDisplayData.serialize(new e(Int32Array,this._guessSize())).buffer();d.push(k);return{result:{displayData:k,bufferData:f},transferList:d}};n.fromVertexData=function(f,d){const k={},l=new Map;for(const g of d)l.set(g.id,g);x.forEachGeometryType(g=>{const t=f.data[g];if(F.isSome(t)){const w=p.DisplayRecordReader.from(t.records).getCursor();
for(;w.next();){var r=w.id;const v=w.materialKey,z=w.indexFrom,u=w.indexCount,y=w.vertexFrom,D=w.vertexCount,G=l.get(r);r=new m(r,g,v);r.indexFrom=z;r.indexCount=u;r.vertexFrom=y;r.vertexCount=D;G.displayRecords.push(r)}k[g]=h.VertexBuffers.fromVertexData(t,g)}else k[g]=(new b.VertexVectors(g,0)).intoBuffers()});return n.fromMeshData({displayObjects:d,vertexBuffersMap:k})};n.fromMeshData=function(f){const d=new n,k=new B["default"],l=new C;k.displayObjects=f.displayObjects;for(const g in f.vertexBuffersMap){const t=
f.vertexBuffersMap[g];l.geometries[g].indexBuffer=t.indexBuffer;l.geometries[g].vertexBuffer=t.namedBuffers}d.tileDisplayData=k;d.tileBufferData=l;return d};n.bind=function(f,d){const k=new n;k.tileDisplayData=f;k.tileBufferData=d;return k};n.create=function(f,d){const k=new n;k.tileDisplayData=new B["default"];k.tileDisplayData.displayObjects=f;const l=[0,0,0,0,0],g=[0,0,0,0,0],t=[[],[],[],[],[]];for(var r of f)for(var w of r.displayRecords)t[w.geometryType].push(w),l[w.geometryType]+=w.meshData.vertexCount,
g[w.geometryType]+=w.meshData.indexData.length;f=new C;d=[d.fill||{},d.line||{},d.icon||{},d.text||{},d.label||{}];for(r=0;5>r;r++){w=new Uint32Array(g[r]);{var v=d[r];var z=l[r];const u={};for(const y in v){const D={data:x.allocateTypedArrayBuffer(z,v[y]),stride:v[y]};u[y]=D}v=u}m.writeAllMeshDataToBuffers(t[r],v,w);f.geometries[r]={indexBuffer:w,vertexBuffer:v}}k.tileBufferData=f;return k};n._align=function(f,d){const k=f%d;return 0===k?f:f+(d-k)};n._computeVertexAlignment=function(f){let d=!1,
k=!1;for(const l of f)2===l%4?d=!0:0!==l%4&&(k=!0);return k?4:d?2:1};return n}();A.TileData=E;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/MemoryRequirements":function(){define(["../../../../chunks/_rollupPluginBabelHelpers"],function(A){return function(){function F(){this._byGeometryType=null}var E=F.prototype;E.reset=function(){this._byGeometryType=null};E.verticesFor=function(C){return this._byGeometryType?this._byGeometryType[C].vertices:0};E.indicesFor=function(C){return this._byGeometryType?
this._byGeometryType[C].indices:0};E.needMore=function(C,B,x){if(B||x)this._byGeometryType||(this._byGeometryType=[{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0}]),C=this._byGeometryType[C],C.vertices+=B,C.indices+=x};A._createClass(F,[{key:"satisfied",get:function(){return!this._byGeometryType}}]);return F}()})},"esri/views/2d/engine/webgl/TileBufferData":function(){define(["./Utils"],function(A){return function(){function F(){this.geometries=
[{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}}]}var E=F.prototype;E.clone=function(){const C=new F;for(let B=0;B<this.geometries.length;B++){const x=this.geometries[B],m=C.geometries[B];m.indexBuffer=x.indexBuffer.slice();m.vertexBuffer={};for(const p in x.vertexBuffer){const {data:h,stride:b}=x.vertexBuffer[p];m.vertexBuffer[p]={data:h.slice(),stride:b}}}return C};
F.deserialize=function(C){const B=new F;for(let x=0;5>x;++x){B.geometries[x].indexBuffer=new Uint32Array(C.geometries[x].indexBuffer);B.geometries[x].vertexBuffer={};for(const m in C.geometries[x].vertexBuffer)B.geometries[x].vertexBuffer[m]={data:A.allocateTypedArrayBufferwithData(C.geometries[x].vertexBuffer[m].data,C.geometries[x].vertexBuffer[m].stride),stride:C.geometries[x].vertexBuffer[m].stride}}return B};E.serialize=function(){const C={geometries:[{indexBuffer:this.geometries[0].indexBuffer.buffer,
vertexBuffer:{}},{indexBuffer:this.geometries[1].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[2].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[3].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[4].indexBuffer.buffer,vertexBuffer:{}}]};for(let B=0;5>B;++B)for(const x in this.geometries[B].vertexBuffer)C.geometries[B].vertexBuffer[x]={data:this.geometries[B].vertexBuffer[x].data.buffer,stride:this.geometries[B].vertexBuffer[x].stride};return C};
E.getBuffers=function(){const C=[];for(let B=0;5>B;++B){C.push(this.geometries[B].indexBuffer.buffer);for(const x in this.geometries[B].vertexBuffer)C.push(this.geometries[B].vertexBuffer[x].data.buffer)}return C};return F}()})},"esri/views/2d/engine/webgl/TileDisplayData":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","./GraphicDisplayList","./WGLDisplayObject","./util/serializationUtils"],function(A,F,E,C,B){let x=function(){function m(){}var p=m.prototype;p.computeDisplayList=
function(){this._displayList=new E;for(const h of this.displayObjects)for(const b of h.displayRecords)this._displayList.addToList(b)};p.clone=function(){const h=new m;this.displayObjects&&(h.displayObjects=this.displayObjects.map(b=>b.clone()));return h};p.serialize=function(h){B.serializeList(h,this.displayObjects);return h};p._deserializeObjects=function(h){var b=h.readInt32();b=Array(b);const e=new Map;for(let c=0;c<b.length;++c){const q=C.deserialize(h);b[c]=q;e.set(q.id,q)}this.displayObjects=
b;this._displayList=null;this._displayObjectRegistry=e};m.deserialize=function(h){const b=new m;b._deserializeObjects(h);return b};F._createClass(m,[{key:"displayObjectRegistry",get:function(){if(!this._displayObjectRegistry){this._displayObjectRegistry=new Map;for(const h of this.displayObjects)this._displayObjectRegistry.set(h.id,h)}return this._displayObjectRegistry}},{key:"displayList",get:function(){return this._displayList}}]);return m}();A["default"]=x;A.groupRecordsByGeometryType=function(m){const p=
[[],[],[],[],[]];for(const h of m)for(const b of h.displayRecords)p[b.geometryType].push(b);return p};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/GraphicDisplayList":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","./enums"],function(A,F){function E(h,b,e,...c){b<h.length?h.splice(b,e,...c):h.push(...c)}const C=new Map;C.set(F.WGLDrawPhase.MAP,[F.WGLGeometryType.FILL,F.WGLGeometryType.LINE,F.WGLGeometryType.MARKER,F.WGLGeometryType.TEXT]);C.set(F.WGLDrawPhase.LABEL,
[F.WGLGeometryType.LABEL]);C.set(F.WGLDrawPhase.LABEL_ALPHA,[F.WGLGeometryType.LABEL]);F=function(){function h(){this.symbolLevels=[]}var b=h.prototype;b.replay=function(e,c,q){for(const a of this.symbolLevels)for(const f of a.zLevels){var n=f.geometryDPInfo.unified;if(n)for(const d of n){n=e.painter.getGeometryBrush(d.geometryType);const k=c.getGeometry(d.geometryType),l={geometryType:d.geometryType,materialKey:d.materialKey,indexFrom:d.indexFrom,indexCount:d.indexCount,draw:(g,t,r)=>{k.draw(g,t,
r,d.indexFrom,d.indexCount)}};n.prepareState(e,c);n.drawGeometry(e,c,l,q)}}};b.clear=function(){this.symbolLevels.length=0};b.addToList=function(e,c){if(Array.isArray(e))for(const q of e)this._addToList(q,c);else this._addToList(e,c)};b.removeFromList=function(e){Array.isArray(e)||(e=[e]);let c=null;for(const q of e)c=this._removeFromList(q);return c};b.clone=function(){const e=new h;for(const c of this.symbolLevels)e.symbolLevels.push(c.clone());return e};b.splitAfter=function(e){const c=this._getDisplayList(e.symbolLevel,
e.zOrder),q=c.length,n=e.indexFrom+e.indexCount;for(let a=0;a<q;++a){const f=c[a];if(f.geometryType===e.geometryType&&n>f.indexFrom&&n<=f.indexFrom+f.indexCount)return n<f.indexFrom+f.indexCount&&(e=new B,e.geometryType=f.geometryType,e.materialKey=f.materialKey,e.indexFrom=n,e.indexCount=f.indexFrom+f.indexCount-n,c.splice(a+1,0,e),f.indexCount=n-f.indexFrom),a}};b._addToList=function(e,c){const q=this._getDisplayList(e.symbolLevel,e.zOrder);c=null!=c?c:q.length-1;var n=0<=c&&c<q.length?q[c]:null;
null!==n&&n.materialKey===e.materialKey&&n.indexFrom+n.indexCount===e.indexFrom&&n.geometryType===e.geometryType?n.indexCount+=e.indexCount:(n=new B,n.indexFrom=e.indexFrom,n.indexCount=e.indexCount,n.materialKey=e.materialKey,n.geometryType=e.geometryType,E(q,c+1,0,n))};b._removeFromList=function(e){const c=this._getDisplayList(e.symbolLevel,e.zOrder);var q=c.length;let n=void 0;for(var a=0;a<q;++a){var f=c[a];if(e.indexFrom+e.indexCount>f.indexFrom&&e.indexFrom<f.indexFrom+f.indexCount&&f.geometryType===
e.geometryType){n=a;break}}if(void 0!==n){q=c[n];if(e.indexFrom===q.indexFrom)return q.indexCount-=e.indexCount,q.indexFrom+=e.indexCount,0===q.indexCount&&E(c,n,1),n-1;if(e.indexFrom+e.indexCount===q.indexFrom+q.indexCount)return q.indexCount-=e.indexCount,0===q.indexCount?(E(c,n,1),n-1):n;{a=q.indexFrom;f=e.indexFrom-q.indexFrom;const d=e.indexCount;e=q.indexFrom+q.indexCount-(e.indexFrom+e.indexCount);q.indexCount=f;const k=new B;k.geometryType=q.geometryType;k.materialKey=q.materialKey;k.indexFrom=
a+f+d;k.indexCount=e;E(c,n+1,0,k);return n}}return null};b._getDisplayList=function(e,c){let q;var n=this.symbolLevels.length;for(let f=0;f<n;f++)if(this.symbolLevels[f].symbolLevel===e){q=this.symbolLevels[f];break}q||(q=new p,q.symbolLevel=e,this.symbolLevels.push(q));let a;e=q.zLevels.length;for(n=0;n<e;n++)if(q.zLevels[n].zLevel===c){a=q.zLevels[n];break}a||(a=new m,a.geometryDPInfo=new x,a.zLevel=c,q.zLevels.push(a));a.geometryDPInfo.unified||(a.geometryDPInfo.unified=[]);return a.geometryDPInfo.unified};
b.getDPInfoType=function(){return"unified"};A._createClass(h,[{key:"empty",get:function(){return!this.symbolLevels||0===this.symbolLevels.length}}]);return h}();let B=function(){function h(){this.materialKey=null;this.indexCount=this.indexFrom=0}h.prototype.clone=function(){const b=new h;b.geometryType=this.geometryType;b.materialKey=this.materialKey;b.indexFrom=this.indexFrom;b.indexCount=this.indexCount;return b};return h}(),x=function(){function h(){this.unified=this.label=this.text=this.marker=
this.line=this.fill=null}h.prototype.clone=function(){const b=new h;b.fill=this.fill&&this.fill.map(e=>e.clone());b.line=this.line&&this.line.map(e=>e.clone());b.marker=this.marker&&this.marker.map(e=>e.clone());b.text=this.text&&this.text.map(e=>e.clone());b.label=this.label&&this.label.map(e=>e.clone());b.unified=this.unified&&this.unified.map(e=>e.clone());return b};return h}(),m=function(){function h(){this.geometryDPInfo=new x}h.prototype.clone=function(){const b=new h;b.zLevel=this.zLevel;b.geometryDPInfo=
this.geometryDPInfo.clone();return b};return h}(),p=function(){function h(){this.zLevels=[]}h.prototype.clone=function(){const b=new h;b.symbolLevel=this.symbolLevel;for(const e of this.zLevels)b.zLevels.push(e.clone());return b};return h}();return F})},"esri/views/2d/engine/webgl/WGLDisplayObject":function(){define(["./WGLDisplayRecord","./util/serializationUtils"],function(A,F){return function(){function E(B){this.insertAfter=null;this.id=B;this.displayRecords=[]}var C=E.prototype;C.copy=function(){const B=
new E(this.id);B.set(this);return B};C.clone=function(){const B=new E(this.id);B.displayRecords=this.displayRecords.map(x=>x.clone());B.insertAfter=this.insertAfter;return B};C.set=function(B){this.id=B.id;this.displayRecords=B.displayRecords;this.insertAfter=B.insertAfter};C.serialize=function(B){B.push(this.id);F.serializeList(B,this.displayRecords);return B};E.deserialize=function(B){const x=B.readInt32(),m=new E(x);m.displayRecords=F.deserializeList(B,A,{id:x});return m};return E}()})},"esri/views/2d/engine/webgl/WGLDisplayRecord":function(){define(["../../../../chunks/_rollupPluginBabelHelpers",
"./MeshData","./Utils"],function(A,F,E){return function(){function C(x,m,p,h=0,b=0){this.id=x;this.geometryType=m;this.materialKey=p;this.minZoom=h;this.maxZoom=b;this.meshData=null;this.indexCount=this.indexFrom=this.vertexCount=this.vertexFrom=this.zOrder=this.symbolLevel=0}var B=C.prototype;B.clone=function(){return this.copy()};B.copy=function(){const x=new C(this.id,this.geometryType,this.materialKey);x.vertexFrom=this.vertexFrom;x.vertexCount=this.vertexCount;x.indexFrom=this.indexFrom;x.indexCount=
this.indexCount;x.zOrder=this.zOrder;x.symbolLevel=this.symbolLevel;x.meshData=this.meshData;x.minZoom=this.minZoom;x.maxZoom=this.maxZoom;return x};B.setMeshDataFromBuffers=function(x,m,p){const h=new F;for(const b in m){const e=m[b].stride,c=m[b].data,q=[],n=E.strideToPackingFactor(e);for(let a=0;a<e*x.vertexCount/n;++a)q[a]=c[a+e*x.vertexFrom/n];h.vertexData.set(b,q)}h.indexData.length=0;for(m=0;m<x.indexCount;++m)h.indexData[m]=p[m+x.indexFrom]-x.vertexFrom;h.vertexCount=x.vertexCount;this.meshData=
h};B.readMeshDataFromBuffers=function(x,m){this.meshData?this.meshData.clear():this.meshData=new F;for(const p in x){const h=x[p].stride,b=x[p].data,e=[],c=E.strideToPackingFactor(h);for(let q=0;q<h*this.vertexCount/c;++q)e[q]=b[q+h*this.vertexFrom/c];this.meshData.vertexData.set(p,e)}this.meshData.indexData.length=0;for(x=0;x<this.indexCount;++x)this.meshData.indexData[x]=m[x+this.indexFrom]-this.vertexFrom;this.meshData.vertexCount=this.vertexCount};B.writeMeshDataToBuffers=function(x,m,p,h){for(const b in m){const e=
m[b].stride,c=this.meshData.vertexData.get(b),q=m[b].data,n=E.strideToPackingFactor(e);for(let a=0;a<e*this.meshData.vertexCount/n;++a)q[a+e*x/n]=c[a]}for(m=0;m<this.meshData.indexData.length;++m)h[m+p]=this.meshData.indexData[m]+x;this.vertexFrom=x;this.vertexCount=this.meshData.vertexCount;this.indexFrom=p;this.indexCount=this.meshData.indexData.length};C.writeAllMeshDataToBuffers=function(x,m,p){let h=0,b=0;for(const e of x)e.writeMeshDataToBuffers(h,m,b,p),h+=e.vertexCount,b+=e.indexCount};B._computeSortKey=
function(){this._sortKey=(this.symbolLevel&31)<<12|(this.zOrder&127)<<4|this.geometryType&7};B.serialize=function(x){x.push(this.geometryType);x.push(this.materialKey);x.push(this.vertexFrom);x.push(this.vertexCount);x.push(this.indexFrom);x.push(this.indexCount);x.push(this.minZoom);x.push(this.maxZoom);return x};C.deserialize=function(x,m){const p=x.readInt32(),h=x.readInt32();m=new C(m.id,p,h);m.vertexFrom=x.readInt32();m.vertexCount=x.readInt32();m.indexFrom=x.readInt32();m.indexCount=x.readInt32();
m.minZoom=x.readInt32();m.maxZoom=x.readInt32();return m};A._createClass(C,[{key:"sortKey",get:function(){void 0===this._sortKey&&this._computeSortKey();return this._sortKey}}]);return C}()})},"esri/views/2d/engine/webgl/MeshData":function(){define(function(){return function(){function A(){this.vertexData=new Map;this.vertexCount=0;this.indexData=[]}var F=A.prototype;F.clear=function(){this.vertexData.clear();this.vertexCount=0;this.indexData=[]};F.update=function(E,C,B){for(const x in E)this.vertexData.set(x,
E[x]);for(const x in this.vertexData)null===E[x]&&this.vertexData.delete(x);this.vertexCount=C;this.indexData=B};return A}()})},"esri/views/2d/engine/webgl/util/serializationUtils":function(){define(["exports"],function(A){A.deserializeList=function(F,E,C){var B=F.readInt32();B=Array(B);for(let x=0;x<B.length;x++)B[x]=E.deserialize(F,C);return B};A.serializeList=function(F,E){if(null===E)F.push(0);else{F.push(E.length);for(const C of E)C.serialize(F);return F}};Object.defineProperty(A,"__esModule",
{value:!0})})},"esri/views/2d/engine/webgl/cpuMapped/DisplayRecordReader":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe","../definitions"],function(A,F,E,C){let B=function(){function m(h){this._cursor=this._head=h}m.from=function(h,b=0,e=h.byteLength/x.BYTES_PER_RECORD-b){h=new x(new Int32Array(h,b*x.BYTES_PER_RECORD,e*x.ELEMENTS_PER_RECORD));return new m(h)};var p=m.prototype;p.size=function(){let h=this._cursor,b=0;for(;h;)b+=h.size(),
h=h._link;return b};p.seekIndex=function(h){for(this._cursor=this._head;this._cursor;){const b=this._cursor.size();if(h<b)return this._cursor._index=h,!0;h-=b;this._cursor=this._cursor._link}return!1};p.forEach=function(h){const b=this.getCursor();for(;b.next();)h(b)};p.link=function(h){if(this._head){for(var b=this._head;b._link;)b=b._link;b._link=h._head;b._link._indexStart=b._indexStart+b.size()}else this._head=h._head};p.getCursor=function(){return this.copy()};p.lookup=function(h){for(this._cursor=
this._head;this._cursor&&!this._cursor.lookup(h);){if(!this._cursor._link)return!1;this._cursor=this._cursor._link}return!!this._cursor};p.copy=function(){var h;const b=new m(null==(h=this._head)?void 0:h.copy());if(!b._head)return b;h=b._head;let e=b._head._link;for(;e;)h._link=e.copy(),h=e,e=h._link;return b};p.next=function(){if(!this._cursor)return!1;if(!this._cursor.next()){if(!this._cursor._link)return!1;this._cursor=this._cursor._link;return this.next()}return!0};p.peekId=function(){var h;
return null!=(h=this._cursor.peekId())?h:this._cursor._link.peekId()};p.delete=function(h){let b=this._head,e=null;for(;b;){if(b.delete(h))return b.isEmpty()&&(E.isSome(e)&&(e._link=b._link),b===this._head&&(this._head=b._link),b===this._cursor&&(this._cursor=b._link)),!0;e=b;b=b._link}return!1};F._createClass(m,[{key:"id",get:function(){return this._cursor.id},set:function(h){this._cursor.id=h}},{key:"materialKey",get:function(){return this._cursor.materialKey},set:function(h){this._cursor.materialKey=
h}},{key:"insertAfter",get:function(){return this._cursor.insertAfter}},{key:"indexFrom",get:function(){return this._cursor.indexFrom},set:function(h){this._cursor.indexFrom=h}},{key:"indexCount",get:function(){return this._cursor.indexCount},set:function(h){this._cursor.indexCount=h}},{key:"vertexFrom",get:function(){return this._cursor.vertexFrom},set:function(h){this._cursor.vertexFrom=h}},{key:"vertexCount",get:function(){return this._cursor.vertexCount},set:function(h){this._cursor.vertexCount=
h}},{key:"sortKey",get:function(){return this._cursor.sortKey},set:function(h){this._cursor.sortKey=h}},{key:"index",get:function(){return this._cursor._indexStart+this._cursor._index}}]);return m}();B.ELEMENTS_PER_RECORD=C.DISPLAY_RECORD_INT_PER_ELEMENT;B.BYTES_PER_RECORD=B.ELEMENTS_PER_RECORD*Int32Array.BYTES_PER_ELEMENT;let x=function(){function m(h){this._link=null;this._index=-1;this._deletedCount=this._indexStart=0;this._offsets={instance:null};this._packedRecords=h}m.from=function(h,b=0,e=
h.byteLength/this.BYTES_PER_RECORD-b){return new m(new Int32Array(h,b*this.BYTES_PER_RECORD,e*this.ELEMENTS_PER_RECORD))};var p=m.prototype;p.delete=function(h){const b=this._index,e=this.lookup(h);if(e)for(this.id=2147483647,++this._deletedCount;this.next()&&this.id===h;)this.id=2147483647,++this._deletedCount;this._index=b;return e};p.isEmpty=function(){return this._deletedCount===this.size()};p.link=function(h){this._link?this._link.link(h):this._link=h};p.lookup=function(h){if(E.isNone(this._offsets.instance)){this._offsets.instance=
new Map;var b=this.copy();b._index=-1;let e=0;for(;b.next();)b.id!==e&&(this._offsets.instance.set(b.id,b._index),e=b.id)}if(!this._offsets.instance.has(h))return!1;b=this._index;this._index=this._offsets.instance.get(h);return 2147483647===this.id?(this._index=b,!1):!0};p.size=function(){return this._packedRecords.length/m.ELEMENTS_PER_RECORD};p.next=function(){for(;++this._index<this.size()&&2147483647===this.id;);return this._index<this.size()};p.peekId=function(){const h=(this._index+1)*m.ELEMENTS_PER_RECORD;
return h>=this._packedRecords.length?0:this._packedRecords[h]};p.getCursor=function(){return this.copy()};p.copy=function(){const h=new m(this._packedRecords);h._indexStart=this._indexStart;h._link=this._link;h._index=this._index;h._offsets=this._offsets;h._deletedCount=this._deletedCount;return h};F._createClass(m,[{key:"id",get:function(){return this._packedRecords[this._index*m.ELEMENTS_PER_RECORD]},set:function(h){this._packedRecords[this._index*m.ELEMENTS_PER_RECORD]=h}},{key:"materialKey",get:function(){return this._packedRecords[this._index*
m.ELEMENTS_PER_RECORD+1]},set:function(h){this._packedRecords[this._index*m.ELEMENTS_PER_RECORD+1]=h}},{key:"insertAfter",get:function(){return this._packedRecords[this._index*m.ELEMENTS_PER_RECORD+2]}},{key:"indexFrom",get:function(){return this._packedRecords[this._index*m.ELEMENTS_PER_RECORD+3]},set:function(h){this._packedRecords[this._index*m.ELEMENTS_PER_RECORD+3]=h}},{key:"indexCount",get:function(){return this._packedRecords[this._index*m.ELEMENTS_PER_RECORD+4]},set:function(h){this._packedRecords[this._index*
m.ELEMENTS_PER_RECORD+4]=h}},{key:"vertexFrom",get:function(){return this._packedRecords[this._index*m.ELEMENTS_PER_RECORD+5]},set:function(h){this._packedRecords[this._index*m.ELEMENTS_PER_RECORD+5]=h}},{key:"vertexCount",get:function(){return this._packedRecords[this._index*m.ELEMENTS_PER_RECORD+6]},set:function(h){this._packedRecords[this._index*m.ELEMENTS_PER_RECORD+6]=h}},{key:"sortKey",get:function(){this._packedRecordsF32||(this._packedRecordsF32=new Float32Array(this._packedRecords.buffer));
return this._packedRecordsF32[this._index*m.ELEMENTS_PER_RECORD+7]},set:function(h){this._packedRecordsF32||(this._packedRecordsF32=new Float32Array(this._packedRecords.buffer));this._packedRecordsF32[this._index*m.ELEMENTS_PER_RECORD+7]=h}},{key:"index",get:function(){return this._index}}]);return m}();x.ELEMENTS_PER_RECORD=C.DISPLAY_RECORD_INT_PER_ELEMENT;x.BYTES_PER_RECORD=x.ELEMENTS_PER_RECORD*Int32Array.BYTES_PER_ELEMENT;A.DisplayRecordReader=B;Object.defineProperty(A,"__esModule",{value:!0})})},
"esri/views/2d/engine/webgl/mesh/VertexBuffer":function(){define(["exports","../Utils"],function(A,F){let E=function(){function B(x,m){this.data=x;this.stride=m}B.decode=function(x){const m=F.allocateTypedArrayBufferwithData(x.data,x.stride);return new B(m,x.stride)};B.fromVertexVector=function(x){const m=F.allocateTypedArrayBufferwithData(x.data.buffer(),x.stride);return new B(m,x.stride)};return B}(),C=function(){function B(x,m,p){this.geometryType=x;this.indexBuffer=new Uint32Array(m);this.namedBuffers=
p}B.decode=function(x){const m=x.geometryType,p=x.indexBuffer,h={};for(const b in x.namedBuffers)h[b]=E.decode(x.namedBuffers[b]);return new B(m,p,h)};B.fromVertexData=function(x,m){const p=x.indices,h=F.allocateTypedArrayBufferwithData(x.vertices,x.stride);x={geometry:new E(h,x.stride)};return new B(m,p,x)};B.fromVertexVectors=function(x){const m=x.geometryType,p=x.indexVector.buffer(),h={};for(const b in x.namedVectors)h[b]=E.fromVertexVector(x.namedVectors[b]);return new B(m,p,h)};return B}();
A.VertexBuffers=C;A["default"]=E;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/VertexVector":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../Utils","./VertexBuffer","../util/Writer"],function(A,F,E,C,B){let x=function(){function p(h,b){this.data=h;this.stride=b}p.prototype.transfer=function(h,b){const e=this.data.buffer();h.vertexCount=this.vertexCount;h.data=e;h.stride=this.stride;b.push(e)};F._createClass(p,[{key:"vertexCount",
get:function(){const h=this.data.length/(this.stride/4);h!==(h|0)&&console.debug("Corrupted stride");return h}}]);return p}(),m=function(){function p(b,e,c=!1){this.geometryType=b;this.indexVector=new B(Uint32Array,6*e);this.namedVectors={};b=E.getStrides(b,c);for(const q in b){c=b[q];let n;switch(c%4){case 0:case 2:n=new B(Uint32Array,c*e);break;case 1:case 3:n=new B(Uint8Array,c*e)}this.namedVectors[q]=new x(n,c)}}var h=p.prototype;h.get=function(b){return this.namedVectors[b].data};h.getVector=
function(b){return this.namedVectors[b]};h.transfer=function(b,e){const c=this.indexVector.buffer(),q={};e.push(c);for(const n in this.namedVectors){const a=this.namedVectors[n];q[n]={};a.transfer(q[n],e)}b.geometryType=this.geometryType;b.indexBuffer=c;b.namedBuffers=q;this.destroy()};h.intoBuffers=function(){const b=C.VertexBuffers.fromVertexVectors(this);this.destroy();return b};h.destroy=function(){this.namedVectors=this.indexVector=null};return p}();A.VertexVectors=m;A["default"]=x;Object.defineProperty(A,
"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/util/Writer":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers"],function(A){return function(){function F(C,B){this._pos=0;B=B?this._roundToNearest(B,C.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(B);this._buffer=new C(this._array);this._ctor=C;this._i16View=new Int16Array(this._array)}var E=F.prototype;E._roundToNearest=function(C,B){C=Math.round(C);return C+(B-C%B)};E._ensureSize=function(C){if(this._pos+C>=this._buffer.length){C=
this._roundToNearest(1.5*(this._array.byteLength+C*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT);C=new ArrayBuffer(C);const B=new this._ctor(C);B.set(this._buffer,0);this._array=C;this._buffer=B;this._i16View=new Int16Array(this._array)}};E.ensureSize=function(C){this._ensureSize(C)};E.writeF32=function(C){this._ensureSize(1);const B=this._pos;(new Float32Array(this._array,4*this._pos,1))[0]=C;this._pos++;return B};E.push=function(C){this._ensureSize(1);const B=this._pos;this._buffer[this._pos++]=
C;return B};E.writeFixed=function(C){this._buffer[this._pos++]=C};E.setValue=function(C,B){this._buffer[C]=B};E.i1616Add=function(C,B,x){this._i16View[2*C]+=B;this._i16View[2*C+1]+=x};E.getValue=function(C){return this._buffer[C]};E.incr=function(C){if(this._buffer.length<C)throw Error("Increment index overflows the target buffer");this._buffer[C]++};E.decr=function(C){this._buffer[C]--};E.writeRegion=function(C){this._ensureSize(C.length);const B=this._pos;this._buffer.set(C,this._pos);this._pos+=
C.length;return B};E.writeManyFrom=function(C,B,x){for(this._ensureSize(x-B);B!==x;B++)this.writeFixed(C._buffer[B])};E.buffer=function(){const C=this._array.slice(0,4*this._pos);this.destroy();return C};E.toArray=function(){const C=this._array,B=[];for(let x=0;x<C.byteLength/4;x++)B.push(C[x]);return B};E.seek=function(C){this._pos=C};E.destroy=function(){this._buffer=this._array=null};A._createClass(F,[{key:"length",get:function(){return this._pos}}]);return F}()})},"esri/views/2d/engine/webgl/mesh/MeshData":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../tiling/PagedTileQueue ../../../tiling/TileInfoView ../../../tiling/TileKey ../../../tiling/TileQueue ../../../tiling/TileStrategy ../definitions ../enums ../Utils ./VertexDataWriter ../../../layers/features/support/AttributeStore ../../../layers/features/support/tileUtils".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c,q){function n(f){switch(f){case 1:case 8:case 32:return-1;case 2:case 64:return 0;case 4:case 16:case 128:return 1}}function a(f){switch(f){case 1:case 2:case 4:return-1;case 8:case 16:return 0;case 32:case 64:case 128:return 1}}E=function(){function f(k,l,g,t,r){this.hasRecords=this._hasAggregate=this._hasDotDensity=!1;this._data={self:new Map,neighbors:[]};this._current={geometryType:0,writer:null,overlaps:0,start:0,insertAfter:0,sortKey:0,id:0,materialKey:0,indexStart:0,
vertStart:0,isDotDensity:!1,bufferingEnabled:!1,metricBoxLenPointer:0};this.hint=l;this.tileKey=k;this._hasDotDensity=g;this._hasAggregate=t;this._pixelBufferEnabled=r}var d=f.prototype;d.serialize=function(k){const l=[];l.push(this._serializeTileVertexData(this.tileKey,this.tileKey,this._data.self));this._data.neighbors.forEach((g,t)=>{var r=1<<t;t=n(r);r=a(r);t=q.getPow2NeighborKey(new B(this.tileKey),t,r,k);t=this._serializeTileVertexData(this.tileKey,t.id,g.vertexData);t.message.bufferIds=g.displayIds;
l.push(t)});return l};d._serializeTileVertexData=function(k,l,g){var t,r,w,v,z;const u=[];g={[h.WGLGeometryType.MARKER]:null==(t=g.get(h.WGLGeometryType.MARKER))?void 0:t.serialize(u),[h.WGLGeometryType.FILL]:null==(r=g.get(h.WGLGeometryType.FILL))?void 0:r.serialize(u),[h.WGLGeometryType.LINE]:null==(w=g.get(h.WGLGeometryType.LINE))?void 0:w.serialize(u),[h.WGLGeometryType.TEXT]:null==(v=g.get(h.WGLGeometryType.TEXT))?void 0:v.serialize(u),[h.WGLGeometryType.LABEL]:null==(z=g.get(h.WGLGeometryType.LABEL))?
void 0:z.serialize(u)};return{message:{tileKeyOrigin:k,tileKey:l,data:g},transferList:u}};d.featureStart=function(k,l){this._current.insertAfter=k;this._current.sortKey=l};d.featureEnd=function(){};d.recordStart=function(k,l,g,t,r){this._current.writer=this._getVertexWriter(g,t);this._current.overlaps=0;this._current.indexStart=this._current.writer.indexCount;this._current.vertStart=this._current.writer.vertexCount;this._current.bufferingEnabled=r;this._current.id=k;this._current.materialKey=l;this._current.geometryType=
g;this._current.isDotDensity=!1;this._current.writer.recordStart()};d.recordCount=function(){return this._current.writer.recordCount};d.vertexCount=function(){return this._current.writer.vertexCount};d.indexCount=function(){return this._current.writer.indexCount};d.vertexEnsureSize=function(k){this._current.writer.vertexEnsureSize(k)};d.indexEnsureSize=function(k){this._current.writer.indexEnsureSize(k)};d.vertexBounds=function(k,l,g,t){this._current.bufferingEnabled&&this._addOverlap(k,l,g,t)};d.vertexWrite=
function(k){this._current.writer.writeVertex(k)};d.vertexWriteF32=function(k){this._current.writer.writeVertexF32(k)};d.vertexEnd=function(){};d.vertexWriter=function(){return this._current.writer.vertexWriter};d.indexWrite=function(k){this._current.writer.writeIndex(k)};d.indexWriter=function(){return this._current.writer.indexWriter};d.metricWriter=function(){return this._current.writer.metricWriter};d.metricStart=function(k,l,g,t,r,w,v,z){this._current.writer=this._getVertexWriter(h.WGLGeometryType.LABEL,
!1);const u=this._current.writer.metricWriter;u.push(c.getDisplayIdTexel(k));u.push(l);u.push(g);u.push(t);u.push(r);u.push(w);u.push(v);u.push(z);u.push(255);this._current.metricBoxLenPointer=u.push(0)};d.metricEnd=function(){const k=this._current.writer.metricWriter;0===k.getValue(this._current.metricBoxLenPointer)&&k.seek(k.length-10)};d.metricBoxWrite=function(k,l,g,t){const r=this._current.writer.metricWriter;r.incr(this._current.metricBoxLenPointer);r.push(0);r.push(0);r.push(k);r.push(l);r.push(g);
r.push(t)};d.recordEnd=function(){var k=this._current.indexStart,l=this._current.writer.indexCount;if(k===l)return!1;this.hasRecords=!0;var g=this._current.vertStart;this._current.writer.recordEnd(this._current.id,this._current.materialKey,this._current.insertAfter,k,l-k,g,this._current.writer.vertexCount-g,this._current.sortKey);if(!this._pixelBufferEnabled||this._hasAggregate||0===this._current.overlaps||this._current.geometryType===h.WGLGeometryType.LABEL)return!0;k=this._current.writer;for(l=
0;8>l;l++){var t=1<<l;if(this._current.overlaps&t){this._data.neighbors[l]||(this._data.neighbors[l]={vertexData:new Map,displayIds:new Set});g=this._data.neighbors[l];var r=this._current.geometryType;if(!g.vertexData.has(r)){var w=b.getStrides(r,this._current.isDotDensity).geometry;w=new e.VertexDataWriter(r,w,p.PATCH_PIXEL_BUFFER_ALLOC_SIZE);g.vertexData.set(r,w)}r=g.vertexData.get(this._current.geometryType);w=4096*-n(t);t=4096*-a(t);r.copyLastFrom(k,w,t);g.displayIds.add(this._current.id)}}return!0};
d._addOverlap=function(k,l,g,t){this._current.overlaps|=255^((k<0+g?148:k>=p.TILE_SIZE-g?41:189)|(l<0+t?224:l>=p.TILE_SIZE-t?7:231))};d._getVertexWriter=function(k,l){if(!this._data.self.has(k)){l=this._data.self;const g=b.getStrides(k,this._hasDotDensity).geometry;l.set(k,new e.VertexDataWriter(k,g,this.hint.records))}return this._data.self.get(k)};F._createClass(f,[{key:"hasAggregates",get:function(){return this._hasAggregate}},{key:"hasPixelBufferEnabled",get:function(){return this._pixelBufferEnabled}}]);
return f}();A.MeshData=E;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/VertexDataWriter":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../definitions","./heuristics","../util/Writer"],function(A,F,E,C,B){let x=function(){function m(h,b,e){this._start={index:0,vertex:0};e=C.getMeshSizeHint(h,b,e);b/=4;this.geometryType=h;this._records=new B(Int32Array,e.recordBytes);this._indices=new B(Uint32Array,e.indexBytes);this._vertices=
new B(Uint32Array,e.vertexBytes);this._metrics=new B(Float32Array,0);this._strideInt=b}var p=m.prototype;p.serialize=function(h){const b=this._records.buffer(),e=this._indices.buffer(),c=this._vertices.buffer(),q=this._metrics.length?this._metrics.buffer():null,n=4*this._strideInt;h.push(b,e,c);return{stride:n,records:b,indices:e,vertices:c,metrics:q}};p.vertexEnsureSize=function(h){this._vertices.ensureSize(h)};p.indexEnsureSize=function(h){this._indices.ensureSize(h)};p.recordStart=function(){this._start.index=
this._indices.length;this._start.vertex=this._vertices.length};p.recordEnd=function(h,b,e,c,q,n,a,f){this._records.push(h);this._records.push(b);this._records.push(e);this._records.push(c);this._records.push(q);this._records.push(n);this._records.push(a);this._records.writeF32(f)};p.writeIndex=function(h){this._indices.push(h)};p.writeVertex=function(h){this._vertices.push(h)};p.writeVertexF32=function(h){this._vertices.writeF32(h)};p.copyLastFrom=function(h,b,e){var c=h._records.length-E.DISPLAY_RECORD_INT_PER_ELEMENT;
const q=h._records.getValue(c),n=h._records.getValue(c+1),a=h._records.getValue(c+2),f=h._records.getValue(c+4),d=h._records.getValue(c+6);c=h._records.getValue(c+7);const k=this._vertices.length;var l=(h._start.vertex-this._vertices.length)/this._strideInt;const g=this._indices.length,t=this.vertexCount;for(var r=h._start.index;r!==h._indices.length;r++){const w=h._indices.getValue(r);this._indices.push(w-l)}for(l=h._start.vertex;l!==h._vertices.length;l++)r=h._vertices.getValue(l),this._vertices.push(r);
for(h=k;h<=this._vertices.length;h+=this._strideInt)this._vertices.i1616Add(h,b,e);this._records.push(q);this._records.push(n);this._records.push(a);this._records.push(g);this._records.push(f);this._records.push(t);this._records.push(d);this._records.push(c)};F._createClass(m,[{key:"strideInt",get:function(){return this._strideInt}},{key:"recordCount",get:function(){return this._records.length/E.DISPLAY_RECORD_INT_PER_ELEMENT}},{key:"vertexCount",get:function(){return this._vertices.length/this._strideInt}},
{key:"indexCount",get:function(){return this._indices.length}},{key:"indexWriter",get:function(){return this._indices}},{key:"vertexWriter",get:function(){return this._vertices}},{key:"metricWriter",get:function(){return this._metrics}}]);return m}();A.VertexDataWriter=x;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/heuristics":function(){define(["exports","../definitions","../enums"],function(A,F,E){const C=new Map;C.set(E.WGLGeometryType.MARKER,{multiplier:1,
indicesPerRecord:6,verticesPerRecord:4});C.set(E.WGLGeometryType.LINE,{multiplier:1,indicesPerRecord:24,verticesPerRecord:8});C.set(E.WGLGeometryType.FILL,{multiplier:1,indicesPerRecord:10,verticesPerRecord:10});C.set(E.WGLGeometryType.TEXT,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4});C.set(E.WGLGeometryType.LABEL,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4});A.getMeshHeuristic=function(B){return C.get(B)};A.getMeshSizeHint=function(B,x,m){const {indicesPerRecord:p,multiplier:h,
verticesPerRecord:b}=C.get(B);return{recordBytes:m*F.DISPLAY_RECORD_INT_PER_ELEMENT*Uint32Array.BYTES_PER_ELEMENT,indexBytes:h*p*m*Uint32Array.BYTES_PER_ELEMENT,vertexBytes:h*b*m*x}};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/AttributeStore":function(){define("require exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/accessorSupport/diffUtils ../../../../../layers/support/FieldsIndex ../../../engine/webgl/definitions ../../../engine/webgl/Utils ../../../engine/webgl/util/debug ../tileRenderers/support/visualVariablesUtils".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c,q,n,a){function f(w,v){return z=>v(w(z))}const d=x.getLogger("esri.views.layers.2d.features.support.AttributeStore"),k=n.createDebugLogger(n.DEBUG_ATTR_UPDATES,d),l=w=>1===(w&2147483648)>>>31?254:255;var g=B("esri-shared-array-buffer"),t=B("esri-atomics");let r=function(){function w(z,u,y,D){this.size=0;this.texelSize=4;const {pixelType:G,layout:H,textureOnly:J}=D;this.textureOnly=J||!1;this.pixelType=G;this._ctype=u;this.layout=H;this._resetRange();this._shared=z;
this.size=y;J||(this.data=this._initData(G,y,z,u))}var v=w.prototype;v.unsetComponentAllTexels=function(z,u){const y=p.unwrap(this.data);for(let D=0;D<this.size*this.size;D++)y[D*this.texelSize+z]&=~u;this.dirtyStart=0;this.dirtyEnd=this.size*this.size-1};v.setComponentAllTexels=function(z,u){const y=p.unwrap(this.data);for(let D=0;D<this.size*this.size;D++)y[D*this.texelSize+z]|=255&u;this.dirtyStart=0;this.dirtyEnd=this.size*this.size-1};v.setComponent=function(z,u,y){const D=p.unwrap(this.data);
for(const G of y)D[G*this.texelSize+z]|=u,this.dirtyStart=Math.min(this.dirtyStart,G),this.dirtyEnd=Math.max(this.dirtyEnd,G)};v.setComponentTexel=function(z,u,y){p.unwrap(this.data)[y*this.texelSize+z]|=u;this.dirtyStart=Math.min(this.dirtyStart,y);this.dirtyEnd=Math.max(this.dirtyEnd,y)};v.unsetComponentTexel=function(z,u,y){p.unwrap(this.data)[y*this.texelSize+z]&=~u;this.dirtyStart=Math.min(this.dirtyStart,y);this.dirtyEnd=Math.max(this.dirtyEnd,y)};v.getData=function(z,u){z&=2147483647;return p.unwrap(this.data)[z*
this.texelSize+u]};v.setData=function(z,u,y){z&=2147483647;0===(this.layout&1<<u)?d.error("mapview-attributes-store","Tried to set a value for a texel's readonly component"):(this.data[z*this.texelSize+u]=y,this.dirtyStart=Math.min(this.dirtyStart,z),this.dirtyEnd=Math.max(this.dirtyEnd,z))};v.lock=function(){5121===this.pixelType&&this._shared&&t&&"local"!==this._ctype&&Atomics.store(this.data,0,1)};v.unlock=function(){5121===this.pixelType&&this._shared&&t&&"local"!==this._ctype&&Atomics.store(this.data,
0,0)};v.expand=function(z){this.size=z;if(!this.textureOnly){z=this._initData(this.pixelType,z,this._shared,this._ctype);const u=p.unwrap(this.data);z.set(u);this.data=z}};v.toMessage=function(){const z=this.dirtyStart,u=this.dirtyEnd;var y=this.texelSize;if(z>u)return null;this._resetRange();const D=!this._shared&&"local"!==this._ctype,G=this.pixelType,H=this.layout,J=p.unwrap(this.data);y=D&&J.slice(z*y,(u+1)*y)||null;return{start:z,end:u,data:y,pixelType:G,layout:H}};v._initData=function(z,u,y,
D){y=y&&"local"!==D?SharedArrayBuffer:ArrayBuffer;z=q.getPixelArrayCtor(z);u=new z(new y(u*u*4*z.BYTES_PER_ELEMENT));for(z=0;z<u.length;z+=4)u[z+1]=255;return u};v._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};E._createClass(w,[{key:"buffer",get:function(){return p.andThen(this.data,z=>z.buffer)}}]);return w}();x=function(){function w(z,u){this._client=z;this.config=u;this._attributeComputeMap=new Map;this._blocks=[];this._filters=Array(c.MAX_FILTERS);this._targetType=0;this._abortController=
h.createAbortController();this._hasScaleExpr=!1;this._size=32;this._idsToHighlight=new Set;z=u.supportsTextureFloat?5126:5121;k(`Creating AttributeStore ${g?"with":"without"} shared memory`);this._blockDescriptors=[{pixelType:5121,layout:1},{pixelType:5121,layout:15,textureOnly:!0},{pixelType:z,layout:15},{pixelType:z,layout:15}];this._blocks=this._blockDescriptors.map(()=>null)}var v=w.prototype;v.destroy=function(){this._abortController.abort()};v.update=function(z,u){this.config=u;u=u.schema.processors[0].storage;
const y=b.diff(this._schema,u);if(z.targets.feature||z.targets.aggregate)z.storage.data=!0;if(y&&(B("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:",y),z.storage.data=!0,this._schema=u,this._attributeComputeMap.clear(),!p.isNone(u))){switch(u.target){case "feature":this._targetType=0;break;case "aggregate":this._targetType=1}if("subtype"===u.type)for(const D in u.mapping){if(z=u.mapping[D],p.isSome(z))for(const G of z.mapping)this._bindAttribute(G)}else for(const D of u.mapping)this._bindAttribute(D)}};
v.onTileData=function(z,u){if(!p.isNone(u.addOrUpdate))for(z=u.addOrUpdate.getCursor();z.next();)u=z.getDisplayId(),this.setAttributeData(u,z)};v.invalidateResources=function(){this._createResourcesPromise=null;this._abortController.abort();this._abortController=h.createAbortController()};v.setHighlight=function(){var z=E._asyncToGenerator(function*(u,y){const D=this._getBlock(0);y=y.map(G=>G&2147483647);D.lock();D.unsetComponentAllTexels(0,1);D.setComponent(0,1,y);D.unlock();this._idsToHighlight.clear();
for(const G of u)this._idsToHighlight.add(G);yield this.sendUpdates()});return function(u,y){return z.apply(this,arguments)}}();v.updateFilters=function(){var z=E._asyncToGenerator(function*(u,y){const {config:D,service:G,spatialReference:H}=y;({filters:y}=D);y=y.map((J,K)=>this._updateFilter(J,K,G,H));(yield Promise.all(y)).some(J=>J)&&(u.storage.filters=!0,B("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:","Filters changed"))});return function(u,y){return z.apply(this,
arguments)}}();v.setData=function(z,u,y,D){this._ensureSizeForTexel(z&2147483647);this._getBlock(u).setData(z,y,D)};v.getData=function(z,u,y){return this._getBlock(u).getData(z,y)};v.getHighlightFlag=function(z){return this._idsToHighlight.has(z)?c.HIGHLIGHT_FLAG:0};v.unsetAttributeData=function(z){z&=2147483647;this._getBlock(0).setData(z,0,0)};v.setAttributeData=function(z,u){const y=z&2147483647;this._ensureSizeForTexel(y);this._getBlock(0).setData(y,0,this.getFilterFlags(u));if(this._targetType===
(z&2147483648)>>>31){z=this._attributeComputeMap;var D=this.config.supportsTextureFloat?1:2;z.size&&z.forEach((G,H)=>{const J=H*D%4;H=this._getBlock(Math.floor(H*D/4)+c.ATTRIBUTE_DATA_VV);G=G(u);if(this.config.supportsTextureFloat)H.setData(y,J,G);else if(G===c.NAN_MAGIC_NUMBER)H.setData(y,J,255),H.setData(y,J+1,255);else{G=m.clamp(Math.round(G),-32767,32766)+32768;const K=(G&65280)>>8;H.setData(y,J,G&255);H.setData(y,J+1,K)}})}};v.sendUpdates=function(){if(this._nextUpdate)return this._nextUpdate.promise;
if(this._currUpdate)return this._nextUpdate=h.createResolver(),this._nextUpdate.promise;const z={blocks:this._blocks.map(u=>p.isSome(u)?u.toMessage():null)};return this._currUpdate=this._createResources().then(()=>{var u=()=>{this._currUpdate=null;if(this._nextUpdate){const y=this._nextUpdate;this._nextUpdate=null;this.sendUpdates().then(()=>y.resolve())}};u=this._client.update(z,this._signal).then(u).catch(u);this._client.render(this._signal);return u}).catch(u=>{if(h.isAbortError(u))return this._createResourcesPromise=
null,this._createResources();d.error(new C("mapview-attribute-store","Encountered an error during client update",u));return Promise.resolve()})};v._ensureSizeForTexel=function(z){for(;z>=this._size*this._size&&!this._expand(););};v._bindAttribute=function(z){function u(){return z.normalizationField?G=>{const H=G.readAttribute(z.normalizationField);return H?G.readAttribute(z.field)/H:null}:G=>G.readAttribute(z.field)}function y(){z.normalizationField&&d.warn("mapview-arcade","Ignoring normalizationField specified with an arcade expression which is not supported.");
return G=>G.getComputedNumericAtIndex(z.fieldIndex)}let D;if(null!=z.fieldIndex)D=y();else if(z.field)D=u();else return;z.valueRepresentation&&(D=f(D,G=>a.getVisualVariableSizeValueRepresentationRatio(G,z.valueRepresentation)));this._attributeComputeMap.set(z.binding,f(D,G=>null===G||isNaN(G)||Infinity===G?c.NAN_MAGIC_NUMBER:G))};v._createResources=function(){if(p.isSome(this._createResourcesPromise))return this._createResourcesPromise;this._getBlock(c.ATTRIBUTE_DATA_ANIMATION);k("Initializing AttributeStore");
var z={shared:g&&"local"!==this._client.type,size:this._size,blocks:p.mapMany(this._blocks,u=>({textureOnly:u.textureOnly,buffer:u.buffer,pixelType:u.pixelType}))};this._createResourcesPromise=z=this._client.initialize(z,this._signal).catch(u=>{h.isAbortError(u)?this._createResourcesPromise=null:d.error(new C("mapview-attribute-store","Encountered an error during client initialization",u))});z.then(()=>p.isNone(this._createResourcesPromise)?this._createResources():void 0);return z};v._getBlock=function(z){var u=
this._blocks[z];if(p.isSome(u))return u;k(`Initializing AttributeBlock at index ${z}`);u=new r(g,this._client.type,this._size,this._blockDescriptors[z]);this._blocks[z]=u;this._createResourcesPromise=null;return u};v._expand=function(){if(this._size<this.config.maxTextureSize){const z=this._size<<=1;k("Expanding block size to",z,this._blocks);p.forEachSome(this._blocks,u=>u.expand(z));this._createResourcesPromise=null;this._size=z;return 0}d.error(new C("mapview-limitations","Maximum number of onscreen features exceeded."));
return-1};v._updateFilter=function(){var z=E._asyncToGenerator(function*(u,y,D,G){const H=this._filters[y],J=p.isSome(H)&&H.hash;if(!H&&!u||J===JSON.stringify(u))return!1;if(p.isNone(u)){if(!H)return!1;u=1<<y+1;D=this._getBlock(0);this._filters[y]=null;D.setComponentAllTexels(0,u);this.sendUpdates();return!0}yield(yield this._getFilter(y,D)).update(u,G);return!0});return function(u,y,D,G){return z.apply(this,arguments)}}();v._getFilter=function(){var z=E._asyncToGenerator(function*(u,y){var D=this._filters[u];
if(p.isSome(D))return D;({default:D}=yield new Promise(function(G,H){A(["../../../../../layers/graphics/data/FeatureFilter"],function(J){G(Object.freeze({__proto__:null,default:J}))},H)}));y=new D({geometryType:y.geometryType,hasM:!1,hasZ:!1,timeInfo:y.timeInfo,fieldsIndex:new e(y.fields)});return this._filters[u]=y});return function(u,y){return z.apply(this,arguments)}}();v.isVisible=function(z){return!!(this._getBlock(0).getData(z,0)&2)};v.getFilterFlags=function(z){let u=0;var y=l(z.getDisplayId());
for(let G=0;G<this._filters.length;G++){var D=this._filters[G];D=!(y&1<<G)||p.isNone(D)||D.check(z);u|=(D?1:0)<<G}y=0;this._idsToHighlight.size&&(z=z.getObjectId(),y=this.getHighlightFlag(z));return u<<1|y};E._createClass(w,[{key:"hasScaleExpr",get:function(){return this._hasScaleExpr}},{key:"_signal",get:function(){return this._abortController.signal}}]);return w}();F.DISPLAY_ID_TYPE_AGGREGATE=1;F.DISPLAY_ID_TYPE_FEATURE=0;F["default"]=x;F.getDisplayIdFilterMask=l;F.getDisplayIdTexel=w=>w&2147483647;
F.getDisplayIdType=w=>(w&2147483648)>>>31;F.isAggregateId=function(w){return 1===(w&2147483648)>>>31};Object.defineProperty(F,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/util/debug":function(){define(["exports"],function(A){A.DEBUG_ATTR_UPDATES=!1;A.createDebugLogger=(F,E)=>F&&((...C)=>E.warn("DEBUG:",...C))||(()=>null);Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/layers/features/tileRenderers/support/visualVariablesUtils":function(){define("exports ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../engine/webgl/color ../../../../engine/webgl/definitions ../../../../engine/webgl/enums ../../../../engine/webgl/visualVariablesUtils".split(" "),
function(A,F,E,C,B,x,m){function p(a){return{value:a.value,size:E.toPt(a.size)}}function h(a){return a.map(f=>p(f))}function b(a){return"string"===typeof a||"number"===typeof a?E.toPt(a):{type:"size",expression:a.expression,stops:h(a.stops)}}function e(a){const f={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if("string"===typeof a.field)if(a.stops){if(8<a.stops.length)return null;a=a.stops;for(var d=0;8>d;++d){const k=a[Math.min(d,a.length-1)];f.values[d]=k.value;f.opacities[d]=k.opacity}}else return null;
else if(a.stops&&0<=a.stops.length)for(a=a.stops&&0<=a.stops.length&&a.stops[0].opacity,d=0;8>d;d++)f.values[d]=Infinity,f.opacities[d]=a;else return null;return f}function c(a,f,d){a[4*f]=d.r/255;a[4*f+1]=d.g/255;a[4*f+2]=d.b/255;a[4*f+3]=d.a}function q(a){if(F.isNone(a)||a.normalizationField)return null;const f={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};if("string"===typeof a.field)if(a.stops){if(8<a.stops.length)return null;f.field=
a.field;a=a.stops;for(var d=0;8>d;++d){const k=a[Math.min(d,a.length-1)];f.values[d]=k.value;c(f.colors,d,k.color)}}else return null;else if(a.stops&&0<=a.stops.length)for(a=a.stops&&0<=a.stops.length&&a.stops[0].color,d=0;8>d;d++)f.values[d]=Infinity,c(f.colors,d,a);else return null;for(a=0;32>a;a+=4)C.premultiplyAlpha(f.colors,a,!0);return f}const n=a=>{const f=[],d=[];a=h(a);const k=a.length;for(let l=0;6>l;l++){const g=a[Math.min(l,k-1)];f.push(g.value);d.push(null==g.size?B.NAN_MAGIC_NUMBER:
E.pt2px(g.size))}return{values:new Float32Array(f),sizes:new Float32Array(d)}};A.convertColorVariable=q;A.convertVisualVariables=function(a){const f=a&&0<a.length?{}:null,d=f?{}:null;if(!f)return{vvFields:f,vvRanges:d};for(const k of a)if(k.field&&(f[k.type]=k.field),"size"===k.type)switch(d.size||(d.size={}),a=k,m.getTypeOfSizeVisualVariable(a)){case x.WGLVVFlag.SIZE_MINMAX_VALUE:d.size.minMaxValue={minDataValue:a.minDataValue,maxDataValue:a.maxDataValue,minSize:b(a.minSize),maxSize:b(a.maxSize)};
break;case x.WGLVVFlag.SIZE_SCALE_STOPS:d.size.scaleStops={stops:h(a.stops)};break;case x.WGLVVFlag.SIZE_FIELD_STOPS:if(a.levels){const l={};for(const g in a.levels)l[g]=n(a.levels[g]);d.size.fieldStops={type:"level-dependent",levels:l}}else d.size.fieldStops={type:"static",...n(a.stops)};break;case x.WGLVVFlag.SIZE_UNIT_VALUE:d.size.unitValue={unit:a.valueUnit,valueRepresentation:a.valueRepresentation}}else"color"===k.type?d.color=q(k):"opacity"===k.type?d.opacity=e(k):"rotation"===k.type&&(d.rotation=
{type:k.rotationType});return{vvFields:f,vvRanges:d}};A.getVisualVariableSizeValueRepresentationRatio=function(a,f){if(!a||!f)return a;switch(f){case "radius":case "distance":return 2*a;case "area":return Math.sqrt(a)}return a};A.getVisualVariablesFields=function(a){const f=a&&0<a.length?{}:null;f&&a.forEach(d=>{const k=d.type;d.field&&(f[k]=d.field)});return f};A.normalizeSizeElement=b;A.normalizeSizeStops=h;A.stopToSizeStop=p;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/visualVariablesUtils":function(){define(["exports",
"../../../../core/Error","../../../../core/Logger","./enums","./Utils"],function(A,F,E,C,B){const x=E.getLogger("esri.views.2d.engine.webgl");A.getTypeOfSizeVisualVariable=function(m){if(B.isNumber(m.minDataValue)&&B.isNumber(m.maxDataValue)&&null!=m.minSize&&null!=m.maxSize)return C.WGLVVFlag.SIZE_MINMAX_VALUE;if((m.expression&&"view.scale"===m.expression||m.valueExpression&&"$view.scale"===m.valueExpression)&&Array.isArray(m.stops))return C.WGLVVFlag.SIZE_SCALE_STOPS;if((null!=m.field||m.expression&&
"view.scale"!==m.expression||m.valueExpression&&"$view.scale"!==m.valueExpression)&&(Array.isArray(m.stops)||"levels"in m&&m.levels))return C.WGLVVFlag.SIZE_FIELD_STOPS;if((null!=m.field||m.expression&&"view.scale"!==m.expression||m.valueExpression&&"$view.scale"!==m.valueExpression)&&null!=m.valueUnit)return C.WGLVVFlag.SIZE_UNIT_VALUE;x.error(new F("mapview-bad-type","Found invalid size VisualVariable",m));return C.WGLVVFlag.NONE};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/tileUtils":function(){define(["exports",
"./Tile"],function(A,F){function E(C,B,x,m){C=C.clone();const p=1<<C.level;B=C.col+B;x=C.row+x;m&&0>B?(C.col=B+p,--C.world):B>=p?(C.col=B-p,C.world+=1):C.col=B;C.row=x;return C}A.getPow2NeighborKey=E;A.getPow2NeighborTile=function(C,B,x){B=E(C.key,B,x,C.tileInfoView.tileInfo.isWrappable);return new F.Tile(C.tileInfoView,B)};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/factories/WGLMeshFactory":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/has ../../../../../../core/maybe ../../../../../../core/promiseUtils ../../../../../../geometry/libtess ../templates/WGLLabelTemplate ../templates/WGLMarkerTemplate ../templates/WGLTemplateStore ../../../../layers/features/support/AttributeStore".split(" "),
function(A,F,E,C,B,x,m,p,h,b){E=function(){function e(q,n,a){this._loadPromise=x.loadLibtess();this._geometryType=q;this._idField=n;this._templateStore=a}var c=e.prototype;c.update=function(q,n){C.isSome(q.mesh.labels)&&(this._labelTemplates=this._createLabelTemplates(q.mesh.labels,n));this._schema=q};c._createLabelTemplates=function(q,n){const a=new Map;if("simple"===q.type){for(var f of q.classes)q=m.fromLabelClass(f,n),a.set(f.index,q);return a}for(const d in q.classes){f=q.classes[d];for(const k of f)f=
m.fromLabelClass(k,n),a.set(k.index,f)}return a};c.analyze=function(){var q=F._asyncToGenerator(function*(n,a,f,d,k,l){if(!B.isAborted(l)){var g;"dictionary"===a.type&&(g=yield a.analyze(this._idField,n.copy(),d,k,l));for(var t=0;n.next();){var r=void 0;r=g?g[t++]:C.isSome(f)&&b.isAggregateId(n.getDisplayId())&&1!==n.readAttribute("cluster_count")?f.match(this._idField,n,this._geometryType,d,k):a.match(this._idField,n,this._geometryType,d,k);n.setGroupId(r);if(h.isDynamicId(r)){r=this._templateStore.getDynamicTemplateGroup(r);
for(const w of r)w&&w.analyze&&w.analyze(this._templateStore,n,d,k)}}yield this._loadPromise;return this._templateStore.finalize(l)}});return function(n,a,f,d,k,l){return q.apply(this,arguments)}}();c.analyzeGraphics=function(){var q=F._asyncToGenerator(function*(n,a,f,d,k){if(!B.isAborted(k)){n=n.getCursor();for(a&&(yield a.analyze(this._idField,n.copy(),f,d,k));n.next();){let l=n.getGroupId();if(null==l||-1===l)l=a.match(this._idField,n,n.geometryType,f,d),n.setGroupId(l);if(h.isDynamicId(l)){const g=
this._templateStore.getDynamicTemplateGroup(l);for(const t of g)t&&t.analyze&&t.analyze(this._templateStore,n,f,d)}n.setGroupId(l)}yield this._loadPromise;return this._templateStore.finalize(k)}});return function(n,a,f,d,k){return q.apply(this,arguments)}}();c.writeGraphic=function(q,n,a){const f=n.getGroupId(),d=n.getDisplayId(),k=this._templateStore.getTemplateGroup(f);q.featureStart(n.insertAfter,0);if(null!=d){if(h.isDynamicId(f))for(const l of k)l.bindFeature(n,null,null);if(k){for(const l of k)l&&
l.write(q,n,a);q.featureEnd()}}};c.writeCursor=function(q,n,a,f,d,k){const l=n.getGroupId(),g=n.getDisplayId(),t=this._templateStore.getTemplateGroup(l),r=this._schema.mesh.sortKey;let w=0;C.isSome(r)&&(w=null!=r.fieldIndex?n.getComputedNumericAtIndex(r.fieldIndex):null!=r.field?n.readAttribute(r.field):n.readAttribute(this._idField),w*="asc"===r.order?1:-1);q.featureStart(0,null==w||isNaN(w)?0:w);if(null!=g&&t){if(h.isDynamicId(l))for(const v of t)v.bindFeature(n,a,f);for(const v of t)v.write(q,
n,d);C.isSome(k)&&q.hasRecords&&(a=k&&this._findLabelRef(t),this._writeLabels(q,n,k,a,d));q.featureEnd()}};c._findLabelRef=function(q){for(const n of q)if(n instanceof p)return n;return null};c._writeLabels=function(q,n,a,f,d){for(const k of a)if(C.isSome(k)&&k){const {glyphs:l,rtl:g,index:t}=k;a=this._labelTemplates.get(t);a.setZoomLevel(d);a.bindReferenceTemplate(f);a.bindTextInfo(l,g);a.write(q,n,null)}};F._createClass(e,[{key:"templates",get:function(){return this._templateStore}}]);return e}();
A.WGLMeshFactory=E;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/geometry/libtess":function(){define(["require","exports","../chunks/_rollupPluginBabelHelpers","../assets","../core/has"],function(A,F,E,C,B){function x(){x=E._asyncToGenerator(function*(){h||(h=m());return h});return x.apply(this,arguments)}function m(){return p.apply(this,arguments)}function p(){p=E._asyncToGenerator(function*(){b=yield(B("csp-restrictions")?yield(new Promise(function(e,c){A(["../chunks/libtess-asm"],e,
c)})).then(function(e){return e.libtessAsm}):yield(new Promise(function(e,c){A(["../chunks/libtess"],e,c)})).then(function(e){return e.libtess})).load({locateFile:()=>C.getAssetUrl("esri/core/libs/libtess/libtess.wasm")})});return p.apply(this,arguments)}let h=null,b=null;F.loadLibtess=function(){return x.apply(this,arguments)};F.triangulate=function(e,c){return b.triangulate(e,c,Math.max(e.length,128E3))};Object.defineProperty(F,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLLabelTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/mathUtils ../../../../../../core/maybe ../../../../../../core/screenUtils ../../alignmentUtils ../../color ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./meshUtils ./segmentUtils ./WGLTextTemplate".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c,q,n,a){const f=E.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate"),d=(l,g="mapview-labeling")=>f.error(new F(g,l)),k=function(l){const g=new Map;return t=>{g.has(t)||g.set(t,l(t));return g.get(t)}}(l=>{let g=0;if(0===l)return Infinity;for(;!(l%2);)g++,l/=2;return g});return function(l){function g(r,w,v,z){var u=l.call(this,r,v.font.size,v.haloSize||0,v.color&&p.premultiplyAlphaRGBAArray(v.color)||0,v.haloColor&&p.premultiplyAlphaRGBAArray(v.haloColor)||0,v.horizontalAlignment,
v.verticalAlignment,q.isMapAligned(w.labelPlacement)?1:0,v.font.decoration,!1,v.angle||0,v.xoffset,v.yoffset,v.lineWidth,v.lineHeight,null,null,null,null,null)||this;u._outLineLabelAngle=0;u._refPlacementPadding=0;u._refPlacementDirX=0;u._refPlacementDirY=0;u._refOffsetX=0;u._refOffsetY=0;u._zoomLevel=0;u.geometryType=b.WGLGeometryType.LABEL;var y=!!w.minScale&&z.scaleToZoom(w.minScale)||0;y=C.clamp(y,0,25.5);z=!!w.maxScale&&z.scaleToZoom(w.maxScale)||255;z=C.clamp(z,0,25.5);const [D,G]=m.getAlignmentFromPlacement(w.labelPlacement);
u._xAlignD=D;u._yAlignD=G;u._minZoom=y;u._maxZoom=z;u._refPlacementPadding=x.pt2px(v.haloSize)+h.TEXT_PLACEMENT_PADDING;r=c.LabelMaterialKey.load(r);r.sdf=!0;u._materialKey=r.data;return u}A._inheritsLoose(g,l);g.fromLabelClass=function(r,w){if("esriServerLinePlacementCenterAlong"===r.labelPlacement){const v=r.symbol;v.xoffset=0;v.yoffset=0;v.angle=0;v.font.decoration="none"}return new g(r.materialKey,r,r.symbol,w)};var t=g.prototype;t.setZoomLevel=function(r){this._zoomLevel=r};t.bindReferenceTemplate=
function(r){let w=m.getXDirection(this._xAlignD),v=m.getYDirection(this._yAlignD);this._refOffsetY=this._refOffsetX=0;if(B.isNone(r))this._refSymbolAndPlacementOffset=e.i8888to32(0,0,Math.floor(127*w+127),Math.floor(127*v+127));else{if("circle"===r.boundsType&&(w||v)){var z=Math.sqrt(w*w+v*v);w/=z;v/=z}z=Math.max(r.height,r.width);this._refSymbolAndPlacementOffset=e.i8888to32(4*this._refPlacementPadding,z,Math.floor(127*w+127),Math.floor(127*v+127));this._referenceSize=z;this._refPlacementDirX=w;
this._refPlacementDirY=v;this._refOffsetX=r.xOffset;this._refOffsetY=r.yOffset}};t._write=function(r,w){if(!B.isNone(this._shapingInfo)){var v=this._shapingInfo,z=w.getDisplayId(),u="esriGeometryPolygon"===w.geometryType?w.readLegacyCentroid():w.readLegacyGeometry();if(u)switch(this.current={out:r,inId:z,inShaping:v,zoomLevel:this._zoomLevel},w.geometryType){case "esriGeometryPolyline":this._placeLineLabels(u);break;case "esriGeometryPoint":case "esriGeometryPolygon":this._placePointLabels(u);break;
default:d("mapview-labeling",`Geometry of type ${w.geometryType} is not supported`)}}};t._isVisible=function(r,w){const v=Math.floor(10*this.current.zoomLevel);return Math.floor(10*r)<=v&&v<=Math.floor(10*w)};t._placePointLabels=function(r){const {out:w,inId:v,inShaping:z}=this.current;this._writeGlyphs(w,v,r,z)};t._placeLineLabels=function(r){r=n.smoothPaths(r.paths,this.current.inShaping.bounds.width);const w=this._placeSubdivGlyphs.bind(this),v=(this._shapedBox.width+128)/2;for(const z of r)n.pathDivide(z,
v,w)};t._placeSubdivGlyphs=function(r,w,v,z){var u=k(w);v=C.log2(Math.min(v,z-v)/(8+this._shapedBox.width/2/2));u=Math.max(this._minZoom,this.current.zoomLevel+1-(0===w?v:Math.min(u,v)));v=this._shapedBox.width/2*2**(this.current.zoomLevel-u);this.current.inShaping.isMultiline?0===w&&this._placeStraight(r,u):this._placeCurved(r,u,v)};t._placeStraight=function(r,w){const {out:v,inId:z,inShaping:u}=this.current;this._writeGlyphs(v,z,r,u,w)};t._placeCurved=function(r,w,v){const {out:z,inId:u}=this.current;
z.metricStart(u,w,r.x,r.y,0,0,0,0);const y=r.clone(),D=(180/Math.PI*r.angle+180)%360;this._outLineLabelAngle=Math.round(180/Math.PI*r.angle%360*(254/360));this._placeFirst(y,w,1);this._placeBack(r,y,w,v,1);this._placeForward(r,y,w,v,1);this._outLineLabelAngle=Math.round(254/360*D);this._placeFirst(y,w,0);this._placeBack(r,y,w,v,0);this._placeForward(r,y,w,v,0);z.metricEnd()};t._placeBack=function(r,w,v,z,u){const y=r.clone();for(r=r.backwardLength+0;y.prev()&&!(r>=z);)this._placeOnSegment(y,w,r,v,
-1,u),r+=y.length+0};t._placeForward=function(r,w,v,z,u){const y=r.clone();for(r=r.remainingLength+0;y.next()&&!(r>=z);)this._placeOnSegment(y,w,r,v,1,u),r+=y.length+0};t._placeFirst=function(r,w,v){const z=this.current.inShaping;var u=z.glyphs;const y=this.current.zoomLevel,{out:D,inId:G}=this.current;for(const H of u)u=H.x>z.bounds.x?v:1-v,u=Math.max(0,y+C.log2(Math.abs(H.x+H.width/2-z.bounds.x)/(u*r.remainingLength+(1-u)*r.backwardLength))),u=Math.max(w,u),H.maxZoom=25,H.angle=r.angle+(1-v)*Math.PI,
H.minZoom=u,this._writeGlyph(D,G,r.x,r.y,H),v&&this._isVisible(H.minZoom,H.maxZoom)&&(u=H.bounds,D.metricBoxWrite(u.center[0],u.center[1],u.width,u.height))};t._placeOnSegment=function(r,w,v,z,u,y){var D=this.current.inShaping.glyphs;const {out:G,inId:H}=this.current,J=this.current.inShaping,K=this.current.zoomLevel;var L=r.x+r.dx/r.length*-u*v,M=r.y+r.dy/r.length*-u*v;for(const P of D)if((D=P.x>J.bounds.x?y:1-y)&&1===u||!D&&-1===u){var N=Math.abs(P.x+P.width/2-J.bounds.x);D=Math.max(0,K+C.log2(N/
v)-.1);N=Math.max(z,K+C.log2(N/(v+r.length+0)));0!==D&&(P.angle=r.angle+(1-y)*Math.PI,P.minZoom=N,P.maxZoom=D,this._writeGlyph(G,H,L,M,P),y&&this._isVisible(P.minZoom,P.maxZoom)&&(D=P.bounds,G.metricBoxWrite(D.center[0]+(r.x-w.x),D.center[1]+(r.y-w.y),D.width,D.height)))}};t._writeGlyphs=function(r,w,v,z,u=this._minZoom){if(!(0>v.x||512<=v.x||0>v.y||512<=v.y)){var y=v.x+this._refOffsetX;v=v.y-this._refOffsetY;for(const D of z.glyphs)D.minZoom=u,D.maxZoom=this._maxZoom,this._writeGlyph(r,w,y,v,D);
z=z.boundsT;r.metricStart(w,u,y,v,this._refPlacementDirX,this._refPlacementDirY,this._referenceSize,this._materialKey);r.metricBoxWrite(z.center[0],z.center[1],z.width,z.height);r.metricEnd()}};t._writeVertexCommon=function(r,w,v,z){const u=this._color,y=this._haloColor,D=e.i8888to32(0,0,this._size,this._haloSize);z=e.i8888to32(Math.floor(10*Math.max(z.minZoom,this._minZoom)),Math.floor(10*Math.min(z.maxZoom,this._maxZoom)),this._outLineLabelAngle,0);r.vertexWrite(v);r.vertexWrite(w);r.vertexWrite(u);
r.vertexWrite(y);r.vertexWrite(D);r.vertexWrite(this._refSymbolAndPlacementOffset);r.vertexWrite(z)};A._createClass(g,[{key:"_shapedBox",get:function(){return B.unwrap(this._shapingInfo).bounds}}]);return g}(a)})},"esri/views/2d/engine/webgl/alignmentUtils":function(){define(["exports"],function(A){A.HAlign=void 0;(function(F){F[F.Left=-1]="Left";F[F.Center=0]="Center";F[F.Right=1]="Right"})(A.HAlign||(A.HAlign={}));A.VAlign=void 0;(function(F){F[F.Top=1]="Top";F[F.Center=0]="Center";F[F.Bottom=-1]=
"Bottom";F[F.Baseline=2]="Baseline"})(A.VAlign||(A.VAlign={}));A.getAlignmentFromPlacement=function(F){switch(F){case "above-left":case "esriServerPointLabelPlacementAboveLeft":return[A.HAlign.Right,A.VAlign.Bottom];case "above-center":case "above-along":case "esriServerPointLabelPlacementAboveCenter":case "esriServerLinePlacementAboveAlong":return[A.HAlign.Center,A.VAlign.Bottom];case "above-right":case "esriServerPointLabelPlacementAboveRight":return[A.HAlign.Left,A.VAlign.Bottom];case "center-left":case "esriServerPointLabelPlacementCenterLeft":return[A.HAlign.Right,
A.VAlign.Center];case "center-center":case "center-along":case "esriServerPointLabelPlacementCenterCenter":case "esriServerLinePlacementCenterAlong":return[A.HAlign.Center,A.VAlign.Center];case "center-right":case "esriServerPointLabelPlacementCenterRight":return[A.HAlign.Left,A.VAlign.Center];case "below-left":case "esriServerPointLabelPlacementBelowLeft":return[A.HAlign.Right,A.VAlign.Top];case "below-center":case "below-along":case "esriServerPointLabelPlacementBelowCenter":case "esriServerLinePlacementBelowAlong":return[A.HAlign.Center,
A.VAlign.Top];case "below-right":case "esriServerPointLabelPlacementBelowRight":return[A.HAlign.Left,A.VAlign.Top];case "always-horizontal":case "esriServerPolygonPlacementAlwaysHorizontal":return[A.HAlign.Center,A.VAlign.Baseline];default:return console.debug(`Found invalid placement type ${F}`),[A.HAlign.Center,A.VAlign.Center]}};A.getJustification=function(F){switch(F){case "left":return A.HAlign.Left;case "right":return A.HAlign.Right;case "center":case "justify":return A.HAlign.Center}};A.getXAnchorDirection=
function(F){switch(F){case "left":return A.HAlign.Left;case "right":return A.HAlign.Right;case "center":case "justify":return A.HAlign.Center}};A.getXDirection=function(F){switch(F){case A.HAlign.Right:return-1;case A.HAlign.Center:return 0;case A.HAlign.Left:return 1;default:return console.debug(`Found invalid horizontal alignment ${F}`),0}};A.getYAnchorDirection=function(F){switch(F){case "top":return A.VAlign.Top;case "middle":return A.VAlign.Center;case "baseline":return A.VAlign.Baseline;case "bottom":return A.VAlign.Bottom}};
A.getYDirection=function(F){switch(F){case A.VAlign.Top:return 1;case A.VAlign.Center:return 0;case A.VAlign.Bottom:case A.VAlign.Baseline:return-1;default:return console.debug(`Found invalid vertical alignment ${F}`),0}};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/segmentUtils":function(){define(["exports","../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/maybe","./util"],function(A,F,E,C){function B(b){return b.length-
1}function x(b){let e=0;for(let c=0;c<B(b);c++)e+=m(b,c);return e}function m(b,e,c=1){const [q,n]=b[e+1];return Math.sqrt(q*q+n*n)*c}function p(b,e,c,q,n){if(!(c<e)){var a=q.clone().seek(c/2);E.isNone(a)||(b(a.clone(),c,n),c=(c-e)/2,a=E.unwrap(a.seek(e/2)),p(b,e,c,q,n+1),p(b,e,c,a,n+1))}}let h=function(){function b(c,q,n,a,f){this._segments=c;this._index=q;this._distance=n;this._xStart=a;this._yStart=f;this._done=!1}b.create=function(c){return new b(c,0,0,c[0][0],c[0][1])};var e=b.prototype;e.clone=
function(){return new b(this._segments,this._index,this._distance,this.xStart,this.yStart)};e.equals=function(c){return this._index===c._index||c._index===this._index-1&&(0===this._distance||1===c._distance)||c._index===this._index+1&&(1===this._distance||0===c._distance)};e.leq=function(c){return this._index<c._index||this._index===c._index&&this._distance<=c._distance};e.geq=function(c){return this._index>c._index||this._index===c._index&&this._distance>=c._distance};e.hasPrev=function(){return 0<=
this._index-1};e.hasNext=function(){return this._index+1<B(this._segments)};e.next=function(){if(!this.hasNext())return null;this._xStart+=this.dx;this._yStart+=this.dy;this._distance=0;this._index+=1;return this};e.prev=function(){if(!this.hasPrev())return this._done=!0,null;--this._index;this._xStart-=this.dx;this._yStart-=this.dy;this._distance=1;return this};e._seekBackwards=function(c,q){var n=this.backwardLength;if(c<=n)return this._distance=(n-c)/this.length,this;for(n=this.backwardLength;this.prev();){if(n+
this.length>c)return this._seekBackwards(c-n);n+=this.length}this._distance=0;return q?this:null};e.seek=function(c,q=!1){if(0>c)return this._seekBackwards(Math.abs(c),q);if(c<=this.remainingLength)return this._distance=(this.backwardLength+c)/this.length,this;let n=this.remainingLength;for(;this.next();){if(n+this.length>c)return this.seek(c-n,q);n+=this.length}this._distance=1;return q?this:null};F._createClass(b,[{key:"_segment",get:function(){return this._segments[this._index+1]}},{key:"angle",
get:function(){const c=this.dy;let q=Math.acos((0*c+-1*-this.dx)/(1*this.length));0<c&&(q=2*Math.PI-q);return q}},{key:"xStart",get:function(){return this._xStart}},{key:"yStart",get:function(){return this._yStart}},{key:"x",get:function(){return this.xStart+this.distance*this.dx}},{key:"y",get:function(){return this.yStart+this.distance*this.dy}},{key:"dx",get:function(){return this._segment[0]}},{key:"dy",get:function(){return this._segment[1]}},{key:"xMidpoint",get:function(){return this.xStart+
.5*this.dx}},{key:"yMidpoint",get:function(){return this.yStart+.5*this.dy}},{key:"xEnd",get:function(){return this.xStart+this.dx}},{key:"yEnd",get:function(){return this.yStart+this.dy}},{key:"length",get:function(){const {dx:c,dy:q}=this;return Math.sqrt(c*c+q*q)}},{key:"remainingLength",get:function(){return this.length*(1-this._distance)}},{key:"backwardLength",get:function(){return this.length*this._distance}},{key:"distance",get:function(){return this._distance}},{key:"done",get:function(){return this._done}}]);
return b}();A.SegmentCursor=h;A.pathDivide=function(b,e,c){const q=x(b);b=h.create(b);const n=q/2,a=Math.floor((q-e)/2/e);b.seek(n-a*e);for(let f=-a;f<=a;f++)512>b.x&&0<=b.x&&512>b.y&&0<=b.y&&c(b.clone(),f,n+f*e,q),b.seek(e)};A.pathLength=x;A.pathSubdivide=function(b,e,c){p(c,e,x(b),h.create(b),0)};A.segmentAt=function(b,e){return b[e+1]};A.segmentCount=B;A.segmentLength=m;A.smoothPaths=function(b,e){for(let y=0;y<b.length;y++){var c=b[y];const D=[];D.push(c[0]);for(var q=1;q<c.length;q++){let [G,
H]=D[q-1];G+=c[q][0];H+=c[q][1];D.push([G,H])}a:{c=D;q=e;if(0>=q)break a;const G=c.length;if(3>G)break a;const H=[];var n=0;H.push(0);for(var a=1;a<G;a++)n+=C.dist(c[a],c[a-1]),H.push(n);q=Math.min(q,.2*n);n=[];n.push(c[0][0]);n.push(c[0][1]);a=c[G-1][0];const J=c[G-1][1];var f=C.sub([0,0],c[0],c[1]);C.normalize(f);c[0][0]+=q*f[0];c[0][1]+=q*f[1];C.sub(f,c[G-1],c[G-2]);C.normalize(f);c[G-1][0]+=q*f[0];c[G-1][1]+=q*f[1];for(f=1;f<G;f++)H[f]+=q;H[G-1]+=q;f=.5*q;for(let K=1;K<G-1;K++){let L=0,M=0,N=
0;for(var d=K-1;0<=d&&!(H[d+1]<H[K]-f);d--){var k=f+H[d+1]-H[K],l=H[d+1]-H[d],g=H[K]-H[d]<f?1:k/l;if(1E-6>Math.abs(g))break;var t=g*g,r=g*k-.5*t*l,w=g*l/q,v=c[d+1],z=c[d][0]-v[0],u=c[d][1]-v[1];L+=w/r*(v[0]*g*k+.5*t*(k*z-l*v[0])-t*g*l*z/3);M+=w/r*(v[1]*g*k+.5*t*(k*u-l*v[1])-t*g*l*u/3);N+=w}for(d=K+1;d<G&&!(H[d-1]>H[K]+f);d++){k=f-H[d-1]+H[K];l=H[d]-H[d-1];g=H[d]-H[K]<f?1:k/l;if(1E-6>Math.abs(g))break;t=g*g;r=g*k-.5*t*l;w=g*l/q;v=c[d-1];z=c[d][0]-v[0];u=c[d][1]-v[1];L+=w/r*(v[0]*g*k+.5*t*(k*z-l*v[0])-
t*g*l*z/3);M+=w/r*(v[1]*g*k+.5*t*(k*u-l*v[1])-t*g*l*u/3);N+=w}n.push(L/N);n.push(M/N)}n.push(a);n.push(J);for(let K=0,L=0;K<G;K++)c[K][0]=n[L++],c[K][1]=n[L++]}c=[];c.push(D[0]);for(q=1;q<D.length;q++){const [G,H]=D[q-1],[J,K]=D[q];c.push([Math.round(J-G),Math.round(K-H)])}b[y]=c}return b};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/util":function(){define(["exports"],function(A){function F(E,C){return Math.sqrt(E*E+C*C)}A.DEFAULT_MAX_ZOOM=100;A.DEFAULT_MIN_ZOOM=
0;A.dist=function(E,C){return F(E[0]-C[0],E[1]-C[1])};A.getLimitCosine=function(E=2){return 1/Math.max(E,1)};A.getMinMaxZoom=function(E,C){const B=!!E.minScale&&C.scaleToZoom(E.minScale)||0;E=!!E.maxScale&&C.scaleToZoom(E.maxScale)||100;return[B,E]};A.isExtent=function(E){return void 0!==E.xmin&&void 0!==E.ymin&&void 0!==E.xmax&&void 0!==E.ymax};A.isFunction=function(E){return"function"===typeof E};A.isMultipoint=function(E){return void 0!==E.points};A.isPoint=function(E){return void 0!==E.x&&void 0!==
E.y};A.isPolygon=function(E){return void 0!==E.rings};A.isPolyline=function(E){return void 0!==E.paths};A.len=F;A.normalize=function(E){const C=F(E[0],E[1]);E[0]/=C;E[1]/=C};A.sub=function(E,C,B){E[0]=C[0]-B[0];E[1]=C[1]-B[1];return E};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/screenUtils ../../alignmentUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLMeshTemplate ../../util/BidiText".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e){return function(c){function q(n,a,f,d,k,l,g,t,r,w,v,z,u,y,D,G,H,J=!1,K,L){var M=c.call(this)||this;M._xOffset=F.pt2px(z);M._yOffset=F.pt2px(u);M._decoration=r||"none";M._color=d;M._haloColor=k;M._haloSize=Math.min(Math.floor(5*F.pt2px(F.toPt(f))),127);M._size=Math.min(Math.round(F.pt2px(a)),127);a=Math.min(Math.round(F.pt2px(a)),127);M._referenceSize=Math.round(Math.sqrt(256*a));M._scale=M._size/24;M._angle=v;M._justify=E.getJustification(l||"center");M._xAlignD=E.getXAnchorDirection(l||
"center");M._yAlignD=E.getYAnchorDirection(g||"baseline");M._baseline="baseline"===(g||"baseline");M._bitset=(1===t?1:0)|(w?1:0)<<1;n=m.MaterialKeyBase.load(n);n.sdf=!0;M._materialKey=n.data;M._lineWidth=F.pt2px(y)||512;M._lineHeight=D||1;M._textPlacement=G;M._effects=H;M._isCIM=J;M._minMaxZoom=x.i1616to32(Math.round(K*B.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(L*B.MIN_MAX_ZOOM_PRECISION_FACTOR));return M}A._inheritsLoose(q,c);q.fromText=function(n,a){const f=new q(n.materialKey,n.font.size,n.haloSize||
0,n.color&&C.premultiplyAlphaRGBAArray(n.color)||0,n.haloColor&&C.premultiplyAlphaRGBAArray(n.haloColor)||0,n.horizontalAlignment,n.verticalAlignment,0,n.font.decoration,!1,n.angle||0,n.xoffset,n.yoffset,n.lineWidth,n.lineHeight,null,null,!1,p.DEFAULT_MIN_ZOOM,p.DEFAULT_MAX_ZOOM),[,d]=e.bidiText(n.text);f.bindTextInfo(a,d);f._vertexBoundsScale=n.maxVVSize?n.maxVVSize/n.font.size:1;return f};q.fromCIMText=function(n,a,f){var d=n.scaleFactor||1;const k=n.size*n.sizeRatio*d,[l,g]=p.getMinMaxZoom(n.scaleInfo,
f);f=new q(n.materialKey,k,n.outlineSize*n.sizeRatio,C.premultiplyAlphaRGBA(n.color),C.premultiplyAlphaRGBA(n.outlineColor),n.horizontalAlignment,n.verticalAlignment,n.alignment,n.decoration,n.colorLocked,n.angle,n.offsetX*n.sizeRatio*d,n.offsetY*n.sizeRatio*d,512,1,n.markerPlacement,n.effects,!0,l,g);[,d]=e.bidiText(n.text);f.bindTextInfo(a,d);f._vertexBoundsScale=n.maxVVSize?n.maxVVSize/k:1;return f};return q}(h(b))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../layers/graphics/featureConversionUtils ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./shapingUtils".split(" "),
function(A,F,E,C,B,x,m,p,h,b){return e=>function(c){function q(...a){a=c.call(this,...a)||this;a._isCIM=!1;a._vertexBoundsScale=1;a.geometryType=m.WGLGeometryType.TEXT;a._aux=p.i8888to32(0,0,a._referenceSize,a._bitset);return a}A._inheritsLoose(q,c);var n=q.prototype;n.bindTextInfo=function(a,f){this._shapingInfo=a&&a.length?F.andThen(a,d=>b.shapeGlyphs(d,f,{scale:this._scale,angle:this._angle,xOffset:this._xOffset,yOffset:this._yOffset,hAlign:this._xAlignD,vAlign:this._yAlignD,maxLineWidth:Math.max(32,
Math.min(this._lineWidth,512)),lineHeight:x.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(this._lineHeight,4)),decoration:this._decoration,isCIM:this._isCIM})):null};n._write=function(a,f,d){const k=f.getDisplayId();this._writeGeometry(a,f,k,d)};n._writeGeometry=function(a,f,d,k){const l=this._shapingInfo;if(!F.isNone(l)){if(F.isSome(this._textPlacement))return f=null!=k?k:f.readLegacyGeometryForDisplay(),this._writePlacedText(a,d,f,l);f=k?C.deltaDecodeGeometry(C.convertFromGeometry(k),2):"esriGeometryPolygon"===
f.geometryType?f.readCentroid():f.readGeometryForDisplay();if(!F.isNone(f)){if(f.isPoint){const [g,t]=f.coords;return this._writeGlyphs(a,d,{x:g,y:t},l)}f.forEachVertex((g,t)=>this._writeGlyphs(a,d,{x:g,y:t},l))}}};n._writePlacedText=function(a,f,d,k){var l=F.unwrap(this._textPlacement);if(d=B.CIMMarkerPlacementHelper.getPlacement(d,l,E.pt2px(1)))for(var g=d.next();null!=g;){l=g.getAngle();k.setRotation(l);const t=g.tx;g=g.ty;0>t||512<=t||0>g||512<=g||(this._writeGlyphs(a,f,{x:t,y:g},k),k.setRotation(-l));
g=d.next()}};n._writeGlyphs=function(a,f,d,k){const l=h.MaterialKeyBase.load(this._materialKey),g=p.i1616to32(Math.round(8*d.x),Math.round(8*d.y)),t=this._vertexBoundsScale,r=k.bounds,w=2*Math.max(r.width,r.height);for(const v of k.glyphs)l.textureBinding=v.textureBinding,a.recordStart(f,l.data,this.geometryType,!1,!0),a.vertexBounds(d.x+r.x+this._xOffset,d.y+r.y-this._yOffset,w*t,w*t),this._writeVertices(a,f,g,v),a.recordEnd()};n._writeGlyph=function(a,f,d,k,l){var g=h.MaterialKeyBase.load(this._materialKey);
const t=p.i1616to32(Math.round(8*d),Math.round(8*k));g.textureBinding=l.textureBinding;a.recordStart(f,g.data,this.geometryType,!1,!0);g=l.bounds;const r=this._vertexBoundsScale;a.vertexBounds(d+g.x*r,k+g.y*r,g.width*r,g.height*r);this._writeVertices(a,f,t,l);a.recordEnd()};n._writeVertices=function(a,f,d,k){const l=a.vertexCount();this._writeVertexCommon(a,f,d,k);a.vertexWrite(k.offsets.upperLeft);a.vertexWrite(k.texcoords.upperLeft);a.vertexEnd();this._writeVertexCommon(a,f,d,k);a.vertexWrite(k.offsets.upperRight);
a.vertexWrite(k.texcoords.upperRight);a.vertexEnd();this._writeVertexCommon(a,f,d,k);a.vertexWrite(k.offsets.lowerLeft);a.vertexWrite(k.texcoords.lowerLeft);a.vertexEnd();this._writeVertexCommon(a,f,d,k);a.vertexWrite(k.offsets.lowerRight);a.vertexWrite(k.texcoords.lowerRight);a.vertexEnd();a.indexWrite(l+0);a.indexWrite(l+1);a.indexWrite(l+2);a.indexWrite(l+1);a.indexWrite(l+3);a.indexWrite(l+2)};n._writeVertexCommon=function(a,f,d,k){k=this._color;const l=this._haloColor,g=p.i8888to32(0,0,this._referenceSize,
this._bitset),t=p.i8888to32(0,0,this._size,this._haloSize);a.vertexWrite(d);a.vertexWrite(f);a.vertexWrite(k);a.vertexWrite(l);a.vertexWrite(t);a.vertexWrite(g);a.vertexWrite(this._minMaxZoom)};return q}(e)})},"esri/symbols/cim/placements/CIMMarkerPlacementHelper":function(){define(["exports","../CIMCursor","../CIMOperators"],function(A,F,E){let C=function(){function B(){}B.getPlacement=function(x,m,p){const h=E.getPlacementOperator(m);if(!h)return null;x=F.cloneAndDecodeGeometry(x);return h.execute(x,
m,p)};return B}();A.CIMMarkerPlacementHelper=C;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/shapingUtils":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../chunks/mat2d ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2 ../../../../../../chunks/vec2f32 ../../alignmentUtils ../../number ../../Rect ../../collisions/BoundingBox".split(" "),function(A,F,E,C,B,x,m,p,h,b){const e=Math.PI/180;let c=
function(){function f(k,l,g,t){this._rotationT=C.create();this.minZoom=this._yBounds=this._xBounds=0;this.maxZoom=255;this._bounds=null;const r=g.rect,w=new Float32Array(8);k*=t;l*=t;const v=g.code?r.width*t:g.metrics.width,z=g.code?r.height*t:g.metrics.height;w[0]=k;w[1]=l;w[2]=k+v;w[3]=l;w[4]=k;w[5]=l+z;w[6]=k+v;w[7]=l+z;this._data=w;this._setTextureCoords(r);this._scale=t;this._mosaic=g;this.x=k;this.y=l;this.maxOffset=Math.max(k+v,l+z)}var d=f.prototype;d.setTransform=function(k){this._T=k;this._offsets=
null};d._setOffsets=function(k){this._offsets||(this._offsets={upperLeft:0,upperRight:0,lowerLeft:0,lowerRight:0});const l=this._offsets,g=new Float32Array(8),t=E.multiply(C.create(),this._rotationT,this._T);C.transformMany(g,k,t);l.upperLeft=p.i1616to32(8*g[0],8*g[1]);l.upperRight=p.i1616to32(8*g[2],8*g[3]);l.lowerLeft=p.i1616to32(8*g[4],8*g[5]);l.lowerRight=p.i1616to32(8*g[6],8*g[7])};d._setTextureCoords=function({x:k,y:l,width:g,height:t}){this._texcoords={upperLeft:p.i1616to32(k,l),upperRight:p.i1616to32(k+
g,l),lowerLeft:p.i1616to32(k,l+t),lowerRight:p.i1616to32(k+g,l+t)}};F._createClass(f,[{key:"width",get:function(){return this._mosaic.metrics.width*this._scale}},{key:"mosaic",get:function(){return this._mosaic}},{key:"angle",get:function(){return this._angle},set:function(k){this._angle=k;E.identity(this._rotationT);E.rotate(this._rotationT,this._rotationT,-k);this._setOffsets(this._data)}},{key:"xTopLeft",get:function(){return this._data[0]}},{key:"yTopLeft",get:function(){return this._data[1]}},
{key:"xBottomRight",get:function(){return this._data[6]}},{key:"yBottomRight",get:function(){return this._data[7]}},{key:"texcoords",get:function(){return this._texcoords}},{key:"textureBinding",get:function(){return this._mosaic.textureBinding}},{key:"offsets",get:function(){this._offsets||this._setOffsets(this._data);return this._offsets}},{key:"char",get:function(){return String.fromCharCode(this._mosaic.code)}},{key:"code",get:function(){return this._mosaic.code}},{key:"bounds",get:function(){if(!this._bounds){const {height:r,
width:w}=this._mosaic.metrics;var k=w*this._scale,l=Math.abs(r)*this._scale,g=new Float32Array(8);g[0]=this.x;g[1]=this.y;g[2]=this.x+k;g[3]=this.y;g[4]=this.x;g[5]=this.y+l;g[6]=this.x+k;g[7]=this.y+l;k=E.multiply(C.create(),this._rotationT,this._T);C.transformMany(g,g,k);l=k=Infinity;let v=0;var t=0;for(let z=0;4>z;z++){const u=g[2*z],y=g[2*z+1];k=Math.min(k,u);l=Math.min(l,y);v=Math.max(v,u);t=Math.max(t,y)}g=v-k;t-=l;this._bounds=new b(k+g/2,l+t/2,g,t)}return this._bounds}}]);return f}();const q=
(f,d)=>({code:0,page:0,sdf:!0,rect:new h(0,0,11,8),textureBinding:d,metrics:{advance:0,height:4,width:f,left:0,top:0}});let n=function(){function f(k,l,g){this._rotation=0;this._decorate(k,l,g);this.glyphs=k;this.bounds=this._createBounds(k);this.isMultiline=1<l.length;this._hasRotation=0!==g.angle;this._T=this._createGlyphTransform(this.bounds,g);for(const t of k)t.setTransform(this._T)}var d=f.prototype;d.setRotation=function(k){if(0!==k||0!==this._rotation){this._rotation=k;var l=this._T;k=E.fromRotation(C.create(),
k);E.multiply(l,k,l);for(const g of this.glyphs)g.setTransform(this._T)}};d._decorate=function(k,l,g){if(g.decoration&&"none"!==g.decoration&&k.length){var t=g.scale;g="underline"===g.decoration?30:20;var r=k[0].textureBinding;for(const w of l)k.push(new c(w.startX*t,w.startY*t+g*t,q((w.width+w.glyphWidthEnd)*t,r),1))}};d._createBounds=function(k){let l=Infinity,g=Infinity,t=0;var r=0;for(const w of k)l=Math.min(l,w.xTopLeft),g=Math.min(g,w.yTopLeft),t=Math.max(t,w.xTopLeft+w.width),r=Math.max(r,
w.yBottomRight);k=t-l;r-=g;return new b(l+k/2,g+r/2,k,r)};d._createGlyphTransform=function(k,l){const g=e*l.angle,t=C.create(),r=x.create();E.translate(t,t,B.set(r,l.xOffset,-l.yOffset));l.isCIM?E.rotate(t,t,g):(E.translate(t,t,B.set(r,k.x,k.y)),E.rotate(t,t,g),E.translate(t,t,B.set(r,-k.x,-k.y)));return t};F._createClass(f,[{key:"boundsT",get:function(){var k=this.bounds;const l=B.set(x.create(),k.x,k.y);B.transformMat2d(l,l,this._T);return this._hasRotation?(k=Math.max(k.width,k.height),new b(l[0],
l[1],k,k)):new b(l[0],l[1],k.width,k.height)}}]);return f}(),a=function(f,d,k,l,g,t){this.startY=this.startX=this.glyphWidthEnd=0;this.start=Math.max(0,Math.min(d,k));this.end=Math.max(0,Math.max(d,k));this.end<f.length&&(this.glyphWidthEnd=f[this.end].metrics.width);this.width=l;this.yMin=g;this.yMax=t};A.ShapedGlyph=c;A.ShapingInfo=n;A.shapeGlyphs=function(f,d,k){const l=k.scale,g=[];{var t=[];var r=1/k.scale*k.maxLineWidth;var w=d?f.length-1:0;var v=d?-1:f.length;d=d?-1:1;var z=w,u=0,y=0;let J=
z,K=J,L=0,M=Infinity,N=0;for(;z!==v;){const {code:P,metrics:I}=f[z];var D=Math.abs(I.top);10!==P&&32!==P&&(M=Math.min(M,D),N=Math.max(N,D+I.height));10===P?(z!==w&&(t.push(new a(f,J,z-d,u,M,N)),M=Infinity,N=0),u=0,J=z+d,K=z+d,y=0):32===P?(K=z+d,y=0,L=I.advance,u+=I.advance):(u>r&&(K!==J?(D=K-2*d,u-=L,t.push(new a(f,J,D,u-y,M,N)),M=Infinity,N=0,J=K,u=y):(t.push(new a(f,J,z-d,u,M,N)),M=Infinity,N=0,K=J=z,u=0)),u+=I.advance,y+=I.advance);z+=d}r=new a(f,J,z-d,u,M,N);0<=r.start&&r.end<f.length&&t.push(r)}for(r=
0;r<t.length;r++);r=w=t[0].yMin;w=t[t.length-1].yMax+k.lineHeight*(t.length-1)+("underline"===k.decoration?4:0)-w;const {vAlign:G,hAlign:H}=k;v=G===m.VAlign.Baseline?1:0;r=(1-v)*-r+w/2*(v?0:G-1)+-26*(v?1:0);for(w=0;w<t.length;w++){const {start:J,end:K,width:L}=t[w];v=L/2*(H+1)*-1-3;d=w*k.lineHeight+r-3;t[w].startX=v;t[w].startY=d;for(z=J;z<=K;z++)u=f[z],10!==u.code&&(y=new c(v+u.metrics.left,d-u.metrics.top,u,l),v+=u.metrics.advance,g.push(y))}return new n(g,t,k)};Object.defineProperty(A,"__esModule",
{value:!0})})},"esri/views/2d/engine/webgl/collisions/BoundingBox":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/mathUtils","../../../../../chunks/vec2f32"],function(A,F,E){return function(){function C(x,m,p,h){this.center=E.fromValues(x,m);this.centerT=E.create();this.halfWidth=p/2;this.halfHeight=h/2;this.width=p;this.height=h}var B=C.prototype;B.clone=function(){return new C(this.x,this.y,this.width,this.height)};B.serialize=function(x){x.writeF32(this.center[0]);
x.writeF32(this.center[1]);x.push(this.width);x.push(this.height);return x};B.findCollisionDelta=function(x,m=4){return F.log2(Math.min((x.halfWidth+this.halfWidth+m)/Math.abs(x.centerT[0]-this.centerT[0]),(x.halfHeight+this.halfHeight+m)/Math.abs(x.centerT[1]-this.centerT[1])))};B.extend=function(x){const m=Math.min(this.xmin,x.xmin),p=Math.min(this.ymin,x.ymin),h=Math.max(this.xmax,x.xmax)-m;x=Math.max(this.ymax,x.ymax)-p;this.width=h;this.height=x;this.halfWidth=h/2;this.halfHeight=x/2;this.x=
m+h/2;this.y=p+x/2};C.deserialize=function(x){const m=x.readF32(),p=x.readF32(),h=x.readInt32();x=x.readInt32();return new C(m,p,h,x)};A._createClass(C,[{key:"x",get:function(){return this.center[0]},set:function(x){this.center[0]=x}},{key:"y",get:function(){return this.center[1]},set:function(x){this.center[1]=x}},{key:"blX",get:function(){return this.center[0]+this.halfWidth}},{key:"blY",get:function(){return this.center[1]+this.halfHeight}},{key:"trX",get:function(){return this.center[0]-this.halfWidth}},
{key:"trY",get:function(){return this.center[1]-this.halfHeight}},{key:"xmin",get:function(){return this.x-this.halfWidth}},{key:"xmax",get:function(){return this.x+this.halfWidth}},{key:"ymin",get:function(){return this.y-this.halfHeight}},{key:"ymax",get:function(){return this.y+this.halfHeight}}]);return C}()})},"esri/views/2d/engine/webgl/mesh/templates/WGLMeshTemplate":function(){define(["../../../../../../core/maybe","../../../../../../symbols/cim/effects/CIMEffectHelper"],function(A,F){return function(){function E(){}
var C=E.prototype;C.bindFeature=function(B,x,m){};C.write=function(B,x,m){if(A.isNone(this._effects))return this._write(B,x);m=F.CIMEffectHelper.executeEffects(this._effects,x.readLegacyGeometryForDisplay());let p=F.CIMEffectHelper.next(m);for(;p;)this._write(B,x,p),p=F.CIMEffectHelper.next(m)};C._write=function(B,x,m){};return E}()})},"esri/symbols/cim/effects/CIMEffectHelper":function(){define(["exports","../CIMCursor","../CIMEffects","../CIMOperators"],function(A,F,E,C){const B=96/72;let x=function(){function m(){}
m.executeEffects=function(p,h){h=F.cloneAndDecodeGeometry(h);h=new E.SimpleGeometryCursor(h);for(const b of p)(p=C.getEffectOperator(b))&&(h=p.execute(h,b,B));return h};m.next=function(p){p=p.next();F.deltaEncodeGeometry(p);return p};return m}();A.CIMEffectHelper=x;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLMeshTemplate".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c){return function(q){function n(a,f,d,k,l,g,t,r,w,v,z,u,y,D,G,H,J,K,L,M,N,P,I){var O=q.call(this)||this;O.angle=k;O.height=t;O.width=g;O.xOffset=f*L;O.yOffset=d*L;O._markerPlacement=M;O._effects=N;O._anchorX=.5-(.5+H)*G.width/G.width;O._anchorY=.5-(.5+J)*G.height/G.height;O._minMaxZoom=p.i1616to32(Math.round(P*m.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(I*m.MIN_MAX_ZOOM_PRECISION_FACTOR));f=(1===D?1:0)|(z?1:0)<<1|(y?1:0)<<2|(u?1:0)<<3;d=G&&G.sdf;a=h.MarkerMaterialKey.load(a);
a.sdf=d;a.pattern=!0;a.textureBinding=G.textureBinding;O._materialKey=a.data;O._fillColor=l;O._outlineColor=w;O._sizeOutlineWidth=p.i8888to32(Math.round(Math.min(Math.sqrt(128*g),255)),Math.round(Math.min(Math.sqrt(128*t),255)),Math.round(Math.min(Math.sqrt(128*v),255)),Math.round(Math.min(Math.sqrt(128*r),255)));l=G.rect.x+m.SPRITE_PADDING;r=G.rect.y+m.SPRITE_PADDING;w=l+G.width;G=r+G.height;O._offsets.xUpperLeft=l;O._offsets.yUpperLeft=r;O._offsets.xUpperRight=w;O._offsets.yUpperRight=r;O._offsets.xBottomLeft=
l;O._offsets.yBottomLeft=G;O._offsets.xBottomRight=w;O._offsets.yBottomRight=G;O._texUpperLeft=p.i1616to32(l,r);O._texUpperRight=p.i1616to32(w,r);O._texBottomLeft=p.i1616to32(l,G);O._texBottomRight=p.i1616to32(w,G);g=g*K*L;t=t*K*L;O._bitestAndDistRatio=p.i1616to32(f,Math.round(64*K));O._computedWidth=g;O._computedHeight=t;g=B.create();t=C.create();O._applyTransformation(t,g);return O}A._inheritsLoose(n,q);n.fromCIMMarker=function(a,f,d){const k=a.size,l=(f&&f.width||1)/(f&&f.height||1)*a.scaleX;var g=
a.scaleSymbolsProportionally&&a.frameHeight?k/a.frameHeight:1;const t=x.premultiplyAlphaRGBA(a.color),r=x.premultiplyAlphaRGBA(a.outlineColor),w=E.pt2px(k),v=w*l,z=E.pt2px(a.offsetX||0),u=E.pt2px(a.offsetY||0);g*=E.pt2px(a.outlineWidth||0);const y=a.alignment||0,D=E.pt2px(a.referenceSize),[G,H]=b.getMinMaxZoom(a.scaleInfo,d);d=a.rotation||0;a.rotateClockwise||(d=-d);let J=0,K=0;const L=a.anchorPoint;L&&(a.isAbsoluteAnchorPoint?k&&(J=-L.x/(k*l),K=L.y/k):(J=L.x,K=L.y));f=new n(a.materialKey,z,u,d,t,
v,w,D,r,g,a.colorLocked,a.scaleSymbolsProportionally,!1,y,f,J,K,a.sizeRatio,F.unwrapOr(a.scaleFactor,1),a.markerPlacement,a.effects,G,H);f._vertexBoundsScaleX=a.maxVVSize?a.maxVVSize/v:1;f._vertexBoundsScaleY=a.maxVVSize?a.maxVVSize/w:1;return f};n.fromPictureMarker=function(a,f){const d=Math.round(E.pt2px(a.width)),k=Math.round(E.pt2px(a.height)),l=m.PICTURE_FILL_COLOR,g=Math.round(E.pt2px(a.xoffset||0)),t=Math.round(E.pt2px(a.yoffset||0));f=new n(a.materialKey,g,t,a.angle,l,d,k,k,0,0,!1,!1,!1,0,
f,0,0,1,1,null,null,b.DEFAULT_MIN_ZOOM,b.DEFAULT_MAX_ZOOM);f._vertexBoundsScaleX=a.maxVVSize?a.maxVVSize/a.width:1;f._vertexBoundsScaleY=a.maxVVSize?a.maxVVSize/a.height:1;return f};n.fromSimpleMarker=function(a,f){const d=x.premultiplyAlphaRGBAArray(a.color),k=Math.round(E.pt2px(a.size)),l=Math.round(E.pt2px(a.xoffset||0)),g=Math.round(E.pt2px(a.yoffset||0)),t=a.style;var r=a.outline;const w=(r&&r.color&&x.premultiplyAlphaRGBAArray(r.color))|0;r=(r&&r.width&&Math.round(E.pt2px(r.width)))|0;f=new n(a.materialKey,
l,g,a.angle,d,k,k,k,w,r,!1,!1,"esriSMSCross"===t||"esriSMSX"===t,0,f,0,0,1.96875,1,null,null,b.DEFAULT_MIN_ZOOM,b.DEFAULT_MAX_ZOOM);f.boundsType="esriSMSCircle"===t?"circle":"square";f._vertexBoundsScaleX=a.maxVVSize?a.maxVVSize/a.size:1;f._vertexBoundsScaleY=a.maxVVSize?a.maxVVSize/a.size:1;return f};n.fromLineSymbolMarker=function(a,f){const d=x.premultiplyAlphaRGBAArray(a.color),k=Math.round(E.pt2px(6*a.lineWidth)),l="cross"===a.style||"x"===a.style;switch(a.placement){case "begin-end":var g="Both";
break;case "begin":g="JustBegin";break;case "end":g="JustEnd";break;default:g="None"}g={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:g,offsetAlongLine:0};f=new n(a.materialKey,0,0,0,d,k,k,k/6,d,l?Math.round(E.pt2px(a.lineWidth)):0,!1,!1,l,1,f,0,0,1.96875,1,g,null,b.DEFAULT_MIN_ZOOM,b.DEFAULT_MAX_ZOOM);f.boundsType="circle"===a.style?"circle":"square";return f};return n}(e(c))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2d ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2 ../../../../../../chunks/vec2f32 ../../../../../../layers/graphics/featureConversionUtils ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper ../../enums ../../number".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e){const c=3.14159265359/180;return q=>function(n){function a(...d){d=n.call(this,...d)||this;d.angle=0;d.xOffset=0;d.yOffset=0;d.width=0;d.height=0;d.boundsType="square";d._anchorX=0;d._anchorY=0;d._computedWidth=0;d._computedHeight=0;d._vertexBoundsScaleX=1;d._vertexBoundsScaleY=1;d._offsets={xUpperLeft:0,yUpperLeft:0,xUpperRight:0,yUpperRight:0,xBottomLeft:0,yBottomLeft:0,xBottomRight:0,yBottomRight:0};d.geometryType=b.WGLGeometryType.MARKER;return d}A._inheritsLoose(a,
n);var f=a.prototype;f._write=function(d,k,l){const g=k.getDisplayId();d.recordStart(g,this._materialKey,this.geometryType,!1,!0);this._writeGeometry(d,k,g,l);d.recordEnd()};f._writeGeometry=function(d,k,l,g){if(F.isSome(this._markerPlacement))return this._writePlacedMarkers(d,k,g);k=g?p.deltaDecodeGeometry(p.convertFromGeometry(g),2):"esriGeometryPolygon"===k.geometryType?k.readCentroid():k.readGeometryForDisplay();if(!F.isNone(k)){if(k.isPoint){const [t,r]=k.coords;return!d.hasAggregates&&d.hasPixelBufferEnabled&&
(-1>t||513<=t||-1>r||513<=r)?void 0:this._writeVertices(d,l,this._getPos(t,r),t,r)}k.forEachVertex((t,r)=>this._writeVertices(d,l,this._getPos(t,r),t,r))}};f._writePlacedMarkers=function(d,k,l){l=null!=l?l:k.readLegacyGeometryForDisplay();if(l=h.CIMMarkerPlacementHelper.getPlacement(l,F.unwrap(this._markerPlacement),E.pt2px(1))){k=k.getDisplayId();for(var g=m.create(),t=B.create(),r=l.next();null!=r;){const {tx:w,ty:v}=r;-128<=w&&640>=w&&-128<=v&&640>=v&&(this._applyTransformation(t,g,r.getAngle()/
c),this._writeVertices(d,k,this._getPos(w,v),w,v));r=l.next()}}};f._writeVertices=function(d,k,l,g,t){const r=d.vertexCount();d.vertexBounds(g+this.xOffset,t-this.yOffset,this._computedWidth*this._vertexBoundsScaleX,this._computedHeight*this._vertexBoundsScaleY);d.vertexWrite(l);d.vertexWrite(this._offsetUpperLeft);d.vertexWrite(this._texUpperLeft);d.vertexWrite(this._bitestAndDistRatio);d.vertexWrite(k);d.vertexWrite(this._fillColor);d.vertexWrite(this._outlineColor);d.vertexWrite(this._sizeOutlineWidth);
d.vertexWrite(this._minMaxZoom);d.vertexEnd();d.vertexWrite(l);d.vertexWrite(this._offsetUpperRight);d.vertexWrite(this._texUpperRight);d.vertexWrite(this._bitestAndDistRatio);d.vertexWrite(k);d.vertexWrite(this._fillColor);d.vertexWrite(this._outlineColor);d.vertexWrite(this._sizeOutlineWidth);d.vertexWrite(this._minMaxZoom);d.vertexEnd();d.vertexWrite(l);d.vertexWrite(this._offsetBottomLeft);d.vertexWrite(this._texBottomLeft);d.vertexWrite(this._bitestAndDistRatio);d.vertexWrite(k);d.vertexWrite(this._fillColor);
d.vertexWrite(this._outlineColor);d.vertexWrite(this._sizeOutlineWidth);d.vertexWrite(this._minMaxZoom);d.vertexEnd();d.vertexWrite(l);d.vertexWrite(this._offsetBottomRight);d.vertexWrite(this._texBottomRight);d.vertexWrite(this._bitestAndDistRatio);d.vertexWrite(k);d.vertexWrite(this._fillColor);d.vertexWrite(this._outlineColor);d.vertexWrite(this._sizeOutlineWidth);d.vertexWrite(this._minMaxZoom);d.vertexEnd();d.indexWrite(r+0);d.indexWrite(r+1);d.indexWrite(r+2);d.indexWrite(r+1);d.indexWrite(r+
3);d.indexWrite(r+2)};f._applyTransformation=function(d,k,l=0){C.identity(d);C.translate(d,d,m.fromValues(this.xOffset,-this.yOffset));0!==this.angle+l&&C.rotate(d,d,c*(this.angle+l));l=this._computedWidth;const g=this._computedHeight,t=(this._anchorX-.5)*l,r=(this._anchorY-.5)*g;x.set(k,t,r);x.transformMat2d(k,k,d);this._offsetUpperLeft=e.i1616to32(16*k[0],16*k[1]);this._offsets.xUpperLeft=k[0];this._offsets.yUpperLeft=k[1];x.set(k,t+l,r);x.transformMat2d(k,k,d);this._offsetUpperRight=e.i1616to32(16*
k[0],16*k[1]);this._offsets.xUpperRight=k[0];this._offsets.yUpperRight=k[1];x.set(k,t,r+g);x.transformMat2d(k,k,d);this._offsetBottomLeft=e.i1616to32(16*k[0],16*k[1]);this._offsets.xBottomLeft=k[0];this._offsets.yBottomLeft=k[1];x.set(k,t+l,r+g);x.transformMat2d(k,k,d);this._offsetBottomRight=e.i1616to32(16*k[0],16*k[1]);this._offsets.xBottomRight=k[0];this._offsets.yBottomRight=k[1]};f._getPos=function(d,k){return e.i1616to32(Math.round(8*d),Math.round(8*k))};return a}(q)})},"esri/views/2d/engine/webgl/mesh/templates/WGLTemplateStore":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/promiseUtils ../../../../../../symbols/support/defaults ./WGLDynamicFillTemplate ./WGLDynamicLineTemplate ./WGLDynamicMarkerTemplate ./WGLDynamicTextTemplate ./WGLFillTemplate ./WGLLineTemplate ./WGLMarkerTemplate ./WGLTextTemplate ../../util/Lock ../../util/Result ../../../../layers/features/schemaUtils ../../../../layers/features/textUtils".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c,q,n,a,f,d,k){function l(w,v){const z=w.length;w.push(null);v.then(u=>w[z]=u);return w}function g(w){return!!(w&1)}const t=C.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLTemplateStore"),r=[];C=function(){function w(z,u){this._templateIdCounter=this._idCounter=1;this._idToTemplateGroup=new Map;this._symbolToTemplate=new Map;this._fetchQueue=[];this._idToResolver=new Map;this._cimTemplateCache=new Map;this._cimAnalyses=[];this._lock=new a["default"];this._fetchResource=
z;this._tileInfo=u}var v=w.prototype;v.createTemplateGroup=function(z,u){this._initErrorTemplates();const y=z.hash;if(this._symbolToTemplate.has(y))return this._symbolToTemplate.get(y);const D=[];u&&this._createMeshTemplates(D,u,!0);this._createMeshTemplates(D,z,!1);z=this._createGroupId("expanded-cim"===z.type);this._idToTemplateGroup.set(z,D);this._symbolToTemplate.set(y,z);return z};v.getTemplateGroup=function(z){return this._idToTemplateGroup.has(z)?this._idToTemplateGroup.get(z):r};v.getDynamicTemplateGroup=
function(z){if(!this._idToTemplateGroup.has(z))return r;g(z)||t.error("mapview-template-store",`Id ${z} does not refer to a dynamic template`);return this._idToTemplateGroup.get(z)};v.getMosaicItem=function(z,u){const y=this._createTemplateId(),D=new Promise(G=>this._idToResolver.set(y,G));this._fetchQueue.push({symbol:z,id:y,glyphIds:u});return D};v.finalize=function(z){return this._fetchQueue.length||this._lock.isHeld()?a.withLock(this._lock,this._fetchAllQueuedResources.bind(this),z):Promise.resolve()};
v._initErrorTemplates=function(){this._errorTemplates||(this._errorTemplates={fill:this._createMeshTemplates([],d.createSymbolSchema(x.errorPolygonSymbol2D),!1),marker:this._createMeshTemplates([],d.createSymbolSchema(x.errorPointSymbol2D),!1),line:this._createMeshTemplates([],d.createSymbolSchema(x.errorPolylineSymbol2D),!1)})};v._fetchAllQueuedResources=function(z){if(!this._fetchQueue.length)return Promise.resolve();const u=this._fetchQueue,y=this._cimAnalyses;this._fetchQueue=[];this._cimAnalyses=
[];return Promise.all(y).then(()=>this._fetchResource(u,z).then(D=>{for(const {id:G,mosaicItem:H}of D)this._idToResolver.get(G)(H),this._idToResolver.delete(G)})).catch(D=>{B.isAbortError(D)?this._fetchQueue=this._fetchQueue.concat(u):"worker:port-closed"!==D.name&&t.error(new E("mapview-template-store","Unable to fetch requested texture resources",D))})};v._createGroupId=function(z){return this._idCounter++<<1|(z?1:0)};v._createTemplateId=function(){return this._templateIdCounter++};v._createSMS=
function(){var z=F._asyncToGenerator(function*(u){const {spriteMosaicItem:y}=yield this.getMosaicItem(u);return f.ok(y,t)?q.fromSimpleMarker(u,y):this._markerError});return function(u){return z.apply(this,arguments)}}();v._createPMS=function(){var z=F._asyncToGenerator(function*(u){const {spriteMosaicItem:y}=yield this.getMosaicItem(u);return f.ok(y,t)?q.fromPictureMarker(u,y):this._markerError});return function(u){return z.apply(this,arguments)}}();v._createSFS=function(){var z=F._asyncToGenerator(function*(u,
y){const {spriteMosaicItem:D}=yield this.getMosaicItem(u);return f.ok(D,t)?e.fromSimpleFill(u,D,y):this._fillError});return function(u,y){return z.apply(this,arguments)}}();v._createPFS=function(){var z=F._asyncToGenerator(function*(u,y){const {spriteMosaicItem:D}=yield this.getMosaicItem(u);return f.ok(D,t)?e.fromPictureFill(u,D,y):this._fillError});return function(u,y){return z.apply(this,arguments)}}();v._createSLS=function(){var z=F._asyncToGenerator(function*(u,y){({spriteMosaicItem:y}=yield this.getMosaicItem(u));
return f.ok(y,t)?c.fromSimpleLine(u,y):this._lineError});return function(u,y){return z.apply(this,arguments)}}();v._createLMS=function(){var z=F._asyncToGenerator(function*(u){const {spriteMosaicItem:y}=yield this.getMosaicItem(u);return f.ok(y,t)?q.fromLineSymbolMarker(u,y):this._markerError});return function(u){return z.apply(this,arguments)}}();v._createTS=function(){var z=F._asyncToGenerator(function*(u){const {glyphMosaicItems:y}=yield this.getMosaicItem(u);return n.fromText(u,y)});return function(u){return z.apply(this,
arguments)}}();v._createCIMText=function(){var z=F._asyncToGenerator(function*(u){const {glyphMosaicItems:y}=yield this.getMosaicItem(u.cim,k.codepoints(u.text));return f.ok(y,t)?n.fromCIMText(u,y,this._tileInfo):this._textError});return function(u){return z.apply(this,arguments)}}();v._createCIMFill=function(){var z=F._asyncToGenerator(function*(u){const {spriteMosaicItem:y}=yield this.getMosaicItem(u.cim);return f.ok(y,t)?e.fromCIMFill(u,y,this._tileInfo):this._fillError});return function(u){return z.apply(this,
arguments)}}();v._createCIMLine=function(){var z=F._asyncToGenerator(function*(u){const {spriteMosaicItem:y}=yield this.getMosaicItem(u.cim);return f.ok(y,t)?c.fromCIMLine(u,y,this._tileInfo):this._lineError});return function(u){return z.apply(this,arguments)}}();v._createCIMMarker=function(){var z=F._asyncToGenerator(function*(u){const {spriteMosaicItem:y}=yield this.getMosaicItem(u.cim);return f.ok(y,t)?q.fromCIMMarker(u,y,this._tileInfo):this._markerError});return function(u){return z.apply(this,
arguments)}}();v._createCIM=function(){var z=F._asyncToGenerator(function*(u){const y=u.templateHash;if(this._cimTemplateCache.has(y))return this._cimTemplateCache.get(y);u={...u,cim:{...u.cim,mosaicHash:u.materialHash}};let D;switch(u.type){case "marker":D=this._createCIMMarker(u);break;case "line":D=this._createCIMLine(u);break;case "fill":D=this._createCIMFill(u);break;case "text":D=this._createCIMText(u)}D.then(G=>this._cimTemplateCache.set(y,G));return D});return function(u){return z.apply(this,
arguments)}}();v._createDynamicCIM=function(z){const u=z.templateHash;if(this._cimTemplateCache.has(u))return this._cimTemplateCache.get(u);let y;switch(z.type){case "marker":y=h.fromCIMMarker(z,this._tileInfo);break;case "line":y=p.fromCIMLine(z,this._tileInfo);break;case "fill":y=m.fromCIMFill(z,this._tileInfo);break;case "text":y=b.fromCIMText(z,this._tileInfo)}this._cimTemplateCache.set(u,y);return y};v._createPrimitiveMeshTemplates=function(z,u,y){switch(u.type){case "esriSMS":return l(z,this._createSMS(u));
case "esriPMS":return l(z,this._createPMS(u));case "esriSFS":return l(z,this._createSFS(u,y));case "line-marker":return l(z,this._createLMS(u));case "esriPFS":return l(z,this._createPFS(u,y));case "esriSLS":return l(z,this._createSLS(u,!1));case "esriTS":return l(z,this._createTS(u));default:return t.error("Unable to create mesh template for unknown symbol type {: $ }{symbol.type}"),z}};v._createMeshTemplates=function(z,u,y){if(-1!==u.type.indexOf("3d"))return t.error("3D symbols are not supported with MapView"),
z;if("expanded-cim"===u.type){for(const D of u.layers)"function"===typeof D.materialHash?z.push(this._createDynamicCIM(D)):l(z,this._createCIM(D));return z}if("composite-symbol"===u.type){for(const D of u.layers)this._createPrimitiveMeshTemplates(z,D,y);return z}return"cim"===u.type||"label"===u.type||"web-style"===u.type?z:this._createPrimitiveMeshTemplates(z,u,y)};F._createClass(w,[{key:"_markerError",get:function(){return this._errorTemplates.marker[0]}},{key:"_fillError",get:function(){return this._errorTemplates.fill[0]}},
{key:"_lineError",get:function(){return this._errorTemplates.line[0]}},{key:"_textError",get:function(){return this._errorTemplates.line[0]}}]);return w}();A.WGLTemplateStore=C;A.isDynamicId=g;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/mathUtils ../../../../../../core/screenUtils ../../color ../../definitions ../../GeometryUtils ../../number ../../materialKey/MaterialKey ./util ./WGLBaseFillTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c){return function(q){function n(a,f,d){var k;var l=q.call(this,a)||this;l._minMaxZoom=m.i1616to32(Math.round(f*B.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(d*B.MIN_MAX_ZOOM_PRECISION_FACTOR));h.isFunction(a.color)?l._dynamicPropertyMap.set("fillColor",(u,y,D)=>(u=a.color(u,y,D))&&C.premultiplyAlphaRGBA(u)||0):(f=a.color,l.fillColor=f&&C.premultiplyAlphaRGBA(f)||0);let g=0;h.isFunction(a.height)||(g=a.height||0);const t="CIMMarkerPlacementInsidePolygon"===(null==(k=a.cim.placement)?
void 0:k.type)&&a.cim.placement.shiftOddRows?2:1;l._dynamicPropertyMap.set("_height",(u,y,D)=>h.isFunction(a.height)?a.height(u,y,D)*t:g*t);let r=0;h.isFunction(a.offsetX)||(r=E.pt2px(a.offsetX||0)+128,255<r&&(r=255));l._dynamicPropertyMap.set("_offsetX",(u,y,D)=>h.isFunction(a.offsetX)?(u=E.pt2px(a.offsetX(u,y,D))+128,255<u&&(u=255),u):r);let w=1;h.isFunction(a.scaleX)||(w=a.scaleX||1);l._dynamicPropertyMap.set("_scaleX",(u,y,D)=>h.isFunction(a.scaleX)?a.scaleX(u,y,D):w);let v=0;h.isFunction(a.offsetY)||
(v=E.pt2px(-a.offsetY||0)+128,255<v&&(v=255));l._dynamicPropertyMap.set("_offsetY",(u,y,D)=>h.isFunction(a.offsetY)?(u=E.pt2px(-a.offsetY(u,y,D))+128,255<u&&(u=255),u):v);let z=0;h.isFunction(a.angle)||(z=x.radToByte(a.angle)||0);l._dynamicPropertyMap.set("_angle",(u,y,D)=>h.isFunction(a.angle)?x.radToByte(a.angle(u,y,D)):z);l._effects=a.effects;l._cimFillLayer=a;l._fillMaterialKey=p.FillMaterialKey.load(a.materialKey);return l}A._inheritsLoose(n,q);n.fromCIMFill=function(a,f){const [d,k]=h.getMinMaxZoom(a.scaleInfo,
f);return new n(a,d,k)};n.prototype.bindFeature=function(a,f,d){const k=a.readLegacyFeature();this._dynamicPropertyMap.forEach((t,r)=>{this[r]=t(k,f,d)});a=this._fillMaterialKey;var l=this._materialCache,g=this._cimFillLayer;this.aux3=m.i8888to32(0,0,this._angle,g.colorLocked?1:0);g=g.materialHash;g=g(k,f,d);g=l.get(g);l=null;g&&c.ok(g.spriteMosaicItem)&&(l=g.spriteMosaicItem);if(l){const {rect:t,width:r,height:w}=l;g=t.x+B.SPRITE_PADDING;const v=t.y+B.SPRITE_PADDING,z=g+r,u=v+w;let y=F.nextHighestPowerOfTwo(E.pt2px(this._height));
255<y?y=255:0>=y&&(y=F.nextHighestPowerOfTwo(u-v));let D=F.nextHighestPowerOfTwo(E.pt2px(this._height/w*r||0));255<D?D=255:0>=D&&(D=F.nextHighestPowerOfTwo(z-g));const G=this._scaleX;this.tl=m.i1616to32(g,v);this.br=m.i1616to32(z,u);this.aux1=m.i8888to32(D,y,this._offsetX,this._offsetY);this.aux2=m.i1616to32(128*G,128);a.sdf=l.sdf;a.pattern=!0;a.textureBinding=l.textureBinding}else this.aux2=this.aux1=this.br=this.tl=0,a.sdf=!1,a.pattern=!1,a.textureBinding=0;this._materialKey=a.data};return n}(b(e))})},
"esri/views/2d/engine/webgl/mesh/templates/WGLBaseFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../layers/graphics/featureConversionUtils ../../enums ../../number ../../materialKey/MaterialKey ./templateUtils".split(" "),function(A,F,E,C,B,x,m){return p=>function(h){function b(...c){c=h.call(this,...c)||this;c.forceLibtess=!1;c.geometryType=C.WGLGeometryType.FILL;return c}A._inheritsLoose(b,h);var e=b.prototype;e._write=
function(c,q,n){const a="esriGeometryPoint"===q.geometryType,f=x.FillMaterialKey.load(this._materialKey);c.recordStart(q.getDisplayId(),this._materialKey,this.geometryType,f.dotDensity,a);this._writeGeometry(c,q,f,n,a);c.recordEnd()};e._writeGeometry=function(c,q,n,a,f){f=this._getGeometry(q,a,f);if(!F.isNone(f))if(a=c.indexCount(),100<f.maxLength||this.forceLibtess||!m.triangulate(c,f)){f=m.triangulateLibtess(c,f);var d=c.indexCount();a!==d&&this._writeVertices(c,q,f,[f.length/2],n)}else d=c.indexCount(),
a!==d&&this._writeVertices(c,q,f.coords,f.lengths,n)};e._writeVertices=function(c,q,n,a,f){const d=q.getDisplayId();let k=0;var l=a.reduce((g,t)=>g+t);c.vertexEnsureSize((f.dotDensity?4:10)*l);for(const g of a){l=k;for(a=g+k;l<a;l++){const t=n[2*l],r=n[2*l+1],w=B.i1616to32(1*t,1*r);c.vertexBounds(t,r,0,0);c.vertexWrite(w);c.vertexWrite(d);f.dotDensity?c.vertexWriteF32(1/Math.abs(q.readGeometryArea())):(c.vertexWrite(this.fillColor),c.vertexWrite(this.tl),c.vertexWrite(this.br),c.vertexWrite(this.aux1),
c.vertexWrite(this.aux2),c.vertexWrite(this.aux3),c.vertexWrite(this._minMaxZoom))}k+=g}};e._getGeometry=function(c,q,n){return(c=q?E.deltaDecodeGeometry(E.convertFromGeometry(q),2):c.readGeometryForDisplay())?m.clipMarshall(c,n?256:8):null};return b}(p)})},"esri/views/2d/engine/webgl/mesh/templates/templateUtils":function(){define("exports ../../../../../../core/maybe ../../../../../../chunks/earcut ../../../../../../geometry/libtess ../../../../../../layers/graphics/OptimizedGeometry ../../definitions ../../TileClipper ../bufcut".split(" "),
function(A,F,E,C,B,x,m,p){function h(q,n,a){let f=0;for(let d=1;d<a;d++)f+=(q[2*(n+d)]-q[2*(n+d-1)])*(q[2*(n+d)+1]+q[2*(n+d-1)+1]);return f}function b(q,n,a,f,d){let k=0;for(;a<f;a+=3){const l=2*(q.getValue(a)-d),g=2*(q.getValue(a+1)-d),t=2*(q.getValue(a+2)-d);k+=Math.abs((n[l]-n[t])*(n[g+1]-n[l+1])-(n[l]-n[g])*(n[t+1]-n[l+1]))}return k}const e=new m.TileClipper(0,0,0,1,0),c=new m.TileClipper(0,0,0,1,0);e.setExtent(x.TILE_SIZE);c.setExtent(x.TILE_SIZE);A.area=h;A.clipLinesMarshall=function(q,n){c.setPixelMargin(n);
const a=-n;n=x.TILE_SIZE+n;let f=[];var d=!1;let k=0;for(;k<q.length;){const l=[],g=q[k];if(!g)return null;c.reset(2);let [t,r]=g[0];if(d)c.moveTo(t,r);else{if(t<a||t>n||r<a||r>n){d=!0;continue}l.push({x:t,y:r})}let w=!1;const v=g.length;for(let z=1;z<v;++z)if(t+=g[z][0],r+=g[z][1],d)c.lineTo(t,r);else{if(t<a||t>n||r<a||r>n){w=!0;break}l.push({x:t,y:r})}if(w)d=!0;else{if(d){if(d=c.resultWithStarts())for(const z of d)f.push(z)}else f.push({line:l,start:0});k++;d=!1}}f=f.filter(l=>1<l.line.length);
return 0===f.length?null:f};A.clipMarshall=function(q,n){if(F.isNone(q))return null;a:{var a=x.TILE_SIZE+128;var f=0;for(var d=0;d<q.lengths.length;d++){var k=q.lengths[d];for(var l=0;l<k;l++){const g=q.coords[2*(l+f)],t=q.coords[2*(l+f)+1];if(-128>g||g>a||-128>t||t>a){a=!0;break a}}f+=k}a=!1}if(!a)return q;e.setPixelMargin(n);e.reset(3);n=0;for(a=0;a<q.lengths.length;a++){f=q.lengths[a];d=q.coords[2*(0+n)];k=q.coords[2*(0+n)+1];e.moveTo(d,k);for(l=1;l<f;l++)d=q.coords[2*(l+n)],k=q.coords[2*(l+n)+
1],e.lineTo(d,k);e.close();n+=f}a=e.result(!1);if(!a)return null;q=[];n=[];for(const g of a){a=0;for(const t of g)n.push(t.x),n.push(t.y),a++;q.push(a)}return new B(q,n)};A.triangleArea=b;A.triangulate=function(q,n){const {coords:a,lengths:f,hasIndeterminateRingOrder:d}=n;n=q.indexWriter();q=q.vertexCount();if(d)return!1;const k=n.length;let l=0;for(var g=0;g<f.length;){let w=g,v=f[g];g=h(a,l,v);for(var t=[];++w<f.length;){var r=f[w];const z=h(a,l+v,r);if(!(0<z))break;g+=z;t.push(l+v);v+=r}r=n.length;
p.bufcut(n,a,l,l+v,t,2,q);t=b(n,a,r,n.length,q);g=Math.abs(g);if(1E-5<Math.abs((t-g)/Math.max(1E-7,g)))return n.seek(k),!1;g=w;l+=v}return!0};A.triangulateEarcut=function(q,n,a){const {coords:f,lengths:d,hasIndeterminateRingOrder:k}=n;if(k)return!1;let l=0;for(var g=0;g<d.length;){let r=g,w=d[g];for(g=[];++r<d.length;){var t=d[r];if(!(0<h(f,l+w,t)))break;g.push(l+w-l);w+=t}t=n.coords.slice(2*l,2*(l+w));g=E.earcut(t,g,2);for(const v of g)q.push(v+a+l);g=r;l+=w}return!0};A.triangulateLibtess=function(q,
n){const a=q.indexWriter();q=q.vertexCount();const {coords:f,lengths:d}=n,{buffer:k,vertexCount:l}=C.triangulate(f,d);a.ensureSize(l);for(n=0;n<l;n++)a.push(n+q);return k};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/chunks/earcut":function(){define(["exports"],function(A){var F={exports:{}};(function(E){(function(C){C=C();void 0!==C&&(E.exports=C)})(function(){function C(y,D,G){G=G||2;var H=D&&D.length,J=H?D[0]*G:y.length,K=B(y,0,J,G,!0),L=[];if(!K||K.next===K.prev)return L;var M;if(H){var N=
K;var P=G;K=[];var I;H=0;for(I=D.length;H<I;H++){var O=D[H]*P;var Q=H<I-1?D[H+1]*P:y.length;O=B(y,O,Q,P,!1);O===O.next&&(O.steiner=!0);K.push(n(O))}K.sort(h);for(H=0;H<K.length;H++)P=K[H],D=N,(N=e(P,D))?(I=r(N,P),P=x(N,N.next),I=b(I),x(I,I.next),P=b(P),N=b(D===N?P:D)):N=D,N=x(N,N.next);K=N}if(y.length>80*G){var T=M=y[0];var V=H=y[1];for(P=G;P<J;P+=G)D=y[P],N=y[P+1],D<T&&(T=D),N<V&&(V=N),D>M&&(M=D),N>H&&(H=N);M=Math.max(M-T,H-V);M=0!==M?1/M:0}m(K,L,G,T,V,M);return L}function B(y,D,G,H,J){if(J===0<
u(y,D,G,H))for(J=D;J<G;J+=H)var K=w(J,y[J],y[J+1],K);else for(J=G-H;J>=D;J-=H)K=w(J,y[J],y[J+1],K);K&&d(K,K.next)&&(y=K.next,v(K),K=y);return K}function x(y,D){if(!y)return y;D||(D=y);do{var G=!1;if(y.steiner||!d(y,y.next)&&0!==f(y.prev,y,y.next))y=y.next;else{D=y.prev;v(y);y=D;if(y===y.next)break;G=!0}}while(G||y!==D);return D}function m(y,D,G,H,J,K,L){if(y){!L&&K&&c(y,H,J,K);for(var M=y,N,P;y.prev!==y.next;){N=y.prev;P=y.next;if(K)var I=p(y,H,J,K);else a:{I=y;var O=I.prev,Q=I,T=I.next;if(0<=f(O,
Q,T))I=!1;else{for(var V=I.next.next;V!==I.prev;){if(a(O.x,O.y,Q.x,Q.y,T.x,T.y,V.x,V.y)&&0<=f(V.prev,V,V.next)){I=!1;break a}V=V.next}I=!0}}if(I)D.push(N.i/G),D.push(y.i/G),D.push(P.i/G),v(y),M=y=P.next;else if(y=P,y===M){if(!L)m(x(y),D,G,H,J,K,1);else if(1===L){y=x(y);L=D;M=G;N=y;do P=N.prev,I=N.next.next,!d(P,I)&&k(P,N,N.next,I)&&t(P,I)&&t(I,P)&&(L.push(P.i/M),L.push(N.i/M),L.push(I.i/M),v(N),v(N.next),N=y=I),N=N.next;while(N!==y);y=x(N);m(y,D,G,H,J,K,2)}else if(2===L)a:{L=y;do{for(M=L.next.next;M!==
L.prev;){if(N=L.i!==M.i){I=I=I=I=void 0;N=L;P=M;if(I=N.next.i!==P.i&&N.prev.i!==P.i){b:{I=N;do{if(I.i!==N.i&&I.next.i!==N.i&&I.i!==P.i&&I.next.i!==P.i&&k(I,I.next,N,P)){I=!0;break b}I=I.next}while(I!==N);I=!1}I=!I}if(I){if(I=t(N,P)&&t(P,N)){I=N;O=!1;Q=(N.x+P.x)/2;T=(N.y+P.y)/2;do I.y>T!==I.next.y>T&&I.next.y!==I.y&&Q<(I.next.x-I.x)*(T-I.y)/(I.next.y-I.y)+I.x&&(O=!O),I=I.next;while(I!==N);I=O}I=I&&(f(N.prev,N,P.prev)||f(N,P.prev,P))||d(N,P)&&0<f(N.prev,N,N.next)&&0<f(P.prev,P,P.next)}N=I}if(N){y=r(L,
M);L=x(L,L.next);y=x(y,y.next);m(L,D,G,H,J,K);m(y,D,G,H,J,K);break a}M=M.next}L=L.next}while(L!==y)}break}}}}function p(y,D,G,H){var J=y.prev,K=y.next;if(0<=f(J,y,K))return!1;var L=J.x>y.x?J.x>K.x?J.x:K.x:y.x>K.x?y.x:K.x,M=J.y>y.y?J.y>K.y?J.y:K.y:y.y>K.y?y.y:K.y,N=q(J.x<y.x?J.x<K.x?J.x:K.x:y.x<K.x?y.x:K.x,J.y<y.y?J.y<K.y?J.y:K.y:y.y<K.y?y.y:K.y,D,G,H);D=q(L,M,D,G,H);G=y.prevZ;for(H=y.nextZ;G&&G.z>=N&&H&&H.z<=D;){if(G!==y.prev&&G!==y.next&&a(J.x,J.y,y.x,y.y,K.x,K.y,G.x,G.y)&&0<=f(G.prev,G,G.next))return!1;
G=G.prevZ;if(H!==y.prev&&H!==y.next&&a(J.x,J.y,y.x,y.y,K.x,K.y,H.x,H.y)&&0<=f(H.prev,H,H.next))return!1;H=H.nextZ}for(;G&&G.z>=N;){if(G!==y.prev&&G!==y.next&&a(J.x,J.y,y.x,y.y,K.x,K.y,G.x,G.y)&&0<=f(G.prev,G,G.next))return!1;G=G.prevZ}for(;H&&H.z<=D;){if(H!==y.prev&&H!==y.next&&a(J.x,J.y,y.x,y.y,K.x,K.y,H.x,H.y)&&0<=f(H.prev,H,H.next))return!1;H=H.nextZ}return!0}function h(y,D){return y.x-D.x}function b(y){if(y.next.prev===y)return y;let D=y;do{const G=D.next;if(G.prev===D||G===D||G===y)break;D=G}while(1);
return D}function e(y,D){var G=D,H=y.x,J=y.y,K=-Infinity;do{if(J<=G.y&&J>=G.next.y&&G.next.y!==G.y){var L=G.x+(J-G.y)*(G.next.x-G.x)/(G.next.y-G.y);if(L<=H&&L>K){K=L;if(L===H){if(J===G.y)return G;if(J===G.next.y)return G.next}var M=G.x<G.next.x?G:G.next}}G=G.next}while(G!==D);if(!M)return null;if(H===K)return M;D=M;L=M.x;var N=M.y,P=Infinity;G=M;do{if(H>=G.x&&G.x>=L&&H!==G.x&&a(J<N?H:K,J,L,N,J<N?K:H,J,G.x,G.y)){var I=Math.abs(J-G.y)/(H-G.x);var O;if((O=t(G,y))&&!(O=I<P)&&(O=I===P)&&!(O=G.x>M.x)&&
(O=G.x===M.x)){O=M;var Q=G;O=0>f(O.prev,O,Q.prev)&&0>f(Q.next,O,O.next)}O&&(M=G,P=I)}G=G.next}while(G!==D);return M}function c(y,D,G,H){var J=y;do{null===J.z&&(J.z=q(J.x,J.y,D,G,H));if(J.prev.next!==J||J.next.prev!==J)return J.prev.next=J,J.next.prev=J,c(y,D,G,H);J.prevZ=J.prev;J=J.nextZ=J.next}while(J!==y);J.prevZ.nextZ=null;J.prevZ=null;y=J;var K,L,M,N=1;do{D=y;H=y=null;for(J=0;D;){J++;G=D;for(K=L=0;K<N&&(L++,G=G.nextZ,G);K++);for(M=N;0<L||0<M&&G;)0!==L&&(0===M||!G||D.z<=G.z)?(K=D,D=D.nextZ,L--):
(K=G,G=G.nextZ,M--),H?H.nextZ=K:y=K,K.prevZ=H,H=K;D=G}H.nextZ=null;N*=2}while(1<J)}function q(y,D,G,H,J){y=32767*(y-G)*J;D=32767*(D-H)*J;y=(y|y<<8)&16711935;y=(y|y<<4)&252645135;y=(y|y<<2)&858993459;D=(D|D<<8)&16711935;D=(D|D<<4)&252645135;D=(D|D<<2)&858993459;return(y|y<<1)&1431655765|((D|D<<1)&1431655765)<<1}function n(y){var D=y,G=y;do{if(D.x<G.x||D.x===G.x&&D.y<G.y)G=D;D=D.next}while(D!==y);return G}function a(y,D,G,H,J,K,L,M){return 0<=(J-L)*(D-M)-(y-L)*(K-M)&&0<=(y-L)*(H-M)-(G-L)*(D-M)&&0<=
(G-L)*(K-M)-(J-L)*(H-M)}function f(y,D,G){return(D.y-y.y)*(G.x-D.x)-(D.x-y.x)*(G.y-D.y)}function d(y,D){return y.x===D.x&&y.y===D.y}function k(y,D,G,H){var J=g(f(y,D,G)),K=g(f(y,D,H)),L=g(f(G,H,y)),M=g(f(G,H,D));return J!==K&&L!==M||0===J&&l(y,G,D)||0===K&&l(y,H,D)||0===L&&l(G,y,H)||0===M&&l(G,D,H)?!0:!1}function l(y,D,G){return D.x<=Math.max(y.x,G.x)&&D.x>=Math.min(y.x,G.x)&&D.y<=Math.max(y.y,G.y)&&D.y>=Math.min(y.y,G.y)}function g(y){return 0<y?1:0>y?-1:0}function t(y,D){return 0>f(y.prev,y,y.next)?
0<=f(y,D,y.next)&&0<=f(y,y.prev,D):0>f(y,D,y.prev)||0>f(y,y.next,D)}function r(y,D){var G=new z(y.i,y.x,y.y),H=new z(D.i,D.x,D.y),J=y.next,K=D.prev;y.next=D;D.prev=y;G.next=J;J.prev=G;H.next=G;G.prev=H;K.next=H;H.prev=K;return H}function w(y,D,G,H){y=new z(y,D,G);H?(y.next=H.next,y.prev=H,H.next.prev=y,H.next=y):(y.prev=y,y.next=y);return y}function v(y){y.next.prev=y.prev;y.prev.next=y.next;y.prevZ&&(y.prevZ.nextZ=y.nextZ);y.nextZ&&(y.nextZ.prevZ=y.prevZ)}function z(y,D,G){this.i=y;this.x=D;this.y=
G;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}function u(y,D,G,H){for(var J=0,K=G-H;D<G;D+=H)J+=(y[K]-y[D])*(y[D+1]+y[K+1]),K=D;return J}C.deviation=function(y,D,G,H){var J=D&&D.length,K=Math.abs(u(y,0,J?D[0]*G:y.length,G));if(J){J=0;for(var L=D.length;J<L;J++)K-=Math.abs(u(y,D[J]*G,J<L-1?D[J+1]*G:y.length,G))}for(J=D=0;J<H.length;J+=3){L=H[J]*G;var M=H[J+1]*G,N=H[J+2]*G;D+=Math.abs((y[L]-y[N])*(y[M+1]-y[L+1])-(y[L]-y[M])*(y[N+1]-y[L+1]))}return 0===K&&0===D?0:Math.abs((D-
K)/K)};C.flatten=function(y){for(var D=y[0][0].length,G={vertices:[],holes:[],dimensions:D},H=0,J=0;J<y.length;J++){for(var K=0;K<y[J].length;K++)for(var L=0;L<D;L++)G.vertices.push(y[J][K][L]);0<J&&(H+=y[J-1].length,G.holes.push(H))}return G};return C})})(F);A.earcut=F.exports})},"esri/views/2d/engine/webgl/TileClipper":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","./definitions","./Geometry","./GeometryUtils"],function(A,F,E,C,B){let x=function(b,e,c){this.ratio=b;
this.x=e;this.y=c},m=function(){function b(c,q,n,a=8,f=8){this.lines=[];this.starts=[];this.validateTessellation=!0;this.pixelRatio=a;this.pixelMargin=f;this.tileSize=E.TILE_SIZE*a;this.dz=c;this.yPos=q;this.xPos=n}var e=b.prototype;e.setPixelMargin=function(c){c!==this.pixelMargin&&(this.pixelMargin=c,this.setExtent(this._extent))};e.setExtent=function(c){this._extent=c;this.finalRatio=this.tileSize/c*(1<<this.dz);let q=this.pixelRatio*this.pixelMargin;q/=this.finalRatio;c>>=this.dz;q>c&&(q=c);this.margin=
q;this.xmin=c*this.xPos-q;this.ymin=c*this.yPos-q;this.xmax=this.xmin+c+2*q;this.ymax=this.ymin+c+2*q};e.reset=function(c){this.type=c;this.lines=[];this.starts=[];this.line=null;this.start=0};e.moveTo=function(c,q){this._pushLine();this._prevIsIn=this._isIn(c,q);this._moveTo(c,q,this._prevIsIn);this._prevPt=new C.Point(c,q);this._firstPt=new C.Point(c,q);this._dist=0};e.lineTo=function(c,q){const n=this._isIn(c,q),a=new C.Point(c,q),f=C.Point.distance(this._prevPt,a);if(n)if(this._prevIsIn)this._lineTo(c,
q,!0);else{var d=this._prevPt;var k=a;c=this._intersect(k,d);this.start=this._dist+f*(1-this._r);this._lineTo(c.x,c.y,!0);this._lineTo(k.x,k.y,!0)}else if(this._prevIsIn)k=this._prevPt,d=a,c=this._intersect(k,d),this._lineTo(c.x,c.y,!0),this._lineTo(d.x,d.y,!1);else{const g=this._prevPt;if(!(g.x<=this.xmin&&a.x<=this.xmin||g.x>=this.xmax&&a.x>=this.xmax||g.y<=this.ymin&&a.y<=this.ymin||g.y>=this.ymax&&a.y>=this.ymax)){c=[];if(g.x<this.xmin&&a.x>this.xmin||g.x>this.xmin&&a.x<this.xmin){q=(this.xmin-
g.x)/(a.x-g.x);var l=g.y+q*(a.y-g.y);l<=this.ymin?k=!1:l>=this.ymax?k=!0:c.push(new x(q,this.xmin,l))}if(g.x<this.xmax&&a.x>this.xmax||g.x>this.xmax&&a.x<this.xmax)q=(this.xmax-g.x)/(a.x-g.x),l=g.y+q*(a.y-g.y),l<=this.ymin?k=!1:l>=this.ymax?k=!0:c.push(new x(q,this.xmax,l));if(g.y<this.ymin&&a.y>this.ymin||g.y>this.ymin&&a.y<this.ymin)q=(this.ymin-g.y)/(a.y-g.y),l=g.x+q*(a.x-g.x),l<=this.xmin?d=!1:l>=this.xmax?d=!0:c.push(new x(q,l,this.ymin));if(g.y<this.ymax&&a.y>this.ymax||g.y>this.ymax&&a.y<this.ymax)q=
(this.ymax-g.y)/(a.y-g.y),l=g.x+q*(a.x-g.x),l<=this.xmin?d=!1:l>=this.xmax?d=!0:c.push(new x(q,l,this.ymax));if(0===c.length)d?k?this._lineTo(this.xmax,this.ymax,!0):this._lineTo(this.xmax,this.ymin,!0):k?this._lineTo(this.xmin,this.ymax,!0):this._lineTo(this.xmin,this.ymin,!0);else if(1<c.length&&c[0].ratio>c[1].ratio)this.start=this._dist+f*c[1].ratio,this._lineTo(c[1].x,c[1].y,!0),this._lineTo(c[0].x,c[0].y,!0);else for(this.start=this._dist+f*c[0].ratio,d=0;d<c.length;d++)this._lineTo(c[d].x,
c[d].y,!0)}this._lineTo(a.x,a.y,!1)}this._dist+=f;this._prevIsIn=n;this._prevPt=a};e.close=function(){if(2<this.line.length){var c=this._firstPt,q=this._prevPt;c.x===q.x&&c.y===q.y||this.lineTo(c.x,c.y);c=this.line;for(q=c.length;4<=q;)if(c[0].x===c[1].x&&c[0].x===c[q-2].x||c[0].y===c[1].y&&c[0].y===c[q-2].y)c.pop(),c[0].x=c[q-2].x,c[0].y=c[q-2].y,--q;else break}};e.result=function(c=!0){this._pushLine();if(0===this.lines.length)return null;3===this.type&&c&&h.simplify(this.tileSize,this.margin*this.finalRatio,
this.lines);return this.lines};e.resultWithStarts=function(){if(2!==this.type)throw Error("Only valid for lines");this._pushLine();const c=this.lines,q=c.length;if(0===q)return null;const n=[];for(let a=0;a<q;a++)n.push({line:c[a],start:this.starts[a]||0});return n};e._isIn=function(c,q){return c>=this.xmin&&c<=this.xmax&&q>=this.ymin&&q<=this.ymax};e._intersect=function(c,q){let n,a,f;if(q.x>=this.xmin&&q.x<=this.xmax)a=q.y<=this.ymin?this.ymin:this.ymax,f=(a-c.y)/(q.y-c.y),n=c.x+f*(q.x-c.x);else if(q.y>=
this.ymin&&q.y<=this.ymax)n=q.x<=this.xmin?this.xmin:this.xmax,f=(n-c.x)/(q.x-c.x),a=c.y+f*(q.y-c.y);else{a=q.y<=this.ymin?this.ymin:this.ymax;n=q.x<=this.xmin?this.xmin:this.xmax;const d=(n-c.x)/(q.x-c.x),k=(a-c.y)/(q.y-c.y);d<k?(f=d,a=c.y+d*(q.y-c.y)):(f=k,n=c.x+k*(q.x-c.x))}this._r=f;return new C.Point(n,a)};e._pushLine=function(){this.line&&(1===this.type?0<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)):2===this.type?1<this.line.length&&(this.lines.push(this.line),
this.starts.push(this.start)):3===this.type&&3<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)));this.line=[];this.start=0};e._moveTo=function(c,q,n){3!==this.type?n&&(c=Math.round((c-(this.xmin+this.margin))*this.finalRatio),q=Math.round((q-(this.ymin+this.margin))*this.finalRatio),this.line.push(new C.Point(c,q))):(n||(c<this.xmin&&(c=this.xmin),c>this.xmax&&(c=this.xmax),q<this.ymin&&(q=this.ymin),q>this.ymax&&(q=this.ymax)),c=Math.round((c-(this.xmin+this.margin))*this.finalRatio),
q=Math.round((q-(this.ymin+this.margin))*this.finalRatio),this.line.push(new C.Point(c,q)),this._is_v=this._is_h=!1)};e._lineTo=function(c,q,n){if(3!==this.type)if(n){c=Math.round((c-(this.xmin+this.margin))*this.finalRatio);q=Math.round((q-(this.ymin+this.margin))*this.finalRatio);if(0<this.line.length&&(n=this.line[this.line.length-1],n.equals(c,q)))return;this.line.push(new C.Point(c,q))}else this.line&&0<this.line.length&&this._pushLine();else if(n||(c<this.xmin&&(c=this.xmin),c>this.xmax&&(c=
this.xmax),q<this.ymin&&(q=this.ymin),q>this.ymax&&(q=this.ymax)),c=Math.round((c-(this.xmin+this.margin))*this.finalRatio),q=Math.round((q-(this.ymin+this.margin))*this.finalRatio),this.line&&0<this.line.length){n=this.line[this.line.length-1];const a=n.x===c,f=n.y===q;a&&f||(this._is_h&&a?(n.x=c,n.y=q,n=this.line[this.line.length-2],n.x===c&&n.y===q?(this.line.pop(),1>=this.line.length?this._is_v=this._is_h=!1:(n=this.line[this.line.length-2],this._is_h=n.x===c,this._is_v=n.y===q)):(this._is_h=
n.x===c,this._is_v=n.y===q)):this._is_v&&f?(n.x=c,n.y=q,n=this.line[this.line.length-2],n.x===c&&n.y===q?(this.line.pop(),1>=this.line.length?this._is_v=this._is_h=!1:(n=this.line[this.line.length-2],this._is_h=n.x===c,this._is_v=n.y===q)):(this._is_h=n.x===c,this._is_v=n.y===q)):(this.line.push(new C.Point(c,q)),this._is_h=a,this._is_v=f))}else this.line.push(new C.Point(c,q))};return b}(),p=function(){function b(){}var e=b.prototype;e.setExtent=function(c){this._ratio=4096===c?1:4096/c};e.reset=
function(c){this.lines=[];this.line=null};e.moveTo=function(c,q){this.line&&this.lines.push(this.line);this.line=[];const n=this._ratio;this.line.push(new C.Point(c*n,q*n))};e.lineTo=function(c,q){const n=this._ratio;this.line.push(new C.Point(c*n,q*n))};e.close=function(){const c=this.line;c&&!c[0].isEqual(c[c.length-1])&&c.push(c[0])};e.result=function(){this.line&&this.lines.push(this.line);return 0===this.lines.length?null:this.lines};F._createClass(b,[{key:"validateTessellation",get:function(){return 1>
this._ratio}}]);return b}(),h=function(){function b(){}b.simplify=function(e,c,q){if(q){var n=-c,a=e+c,f=-c,d=e+c;e=[];c=[];var k=q.length;for(let l=0;l<k;++l){const g=q[l];if(!g||2>g.length)continue;let t=g[0],r;const w=g.length;for(let v=1;v<w;++v)r=g[v],t.x===r.x&&(t.x<=n&&(t.y>r.y?(e.push(l),e.push(v),e.push(0),e.push(-1)):(c.push(l),c.push(v),c.push(0),c.push(-1))),t.x>=a&&(t.y<r.y?(e.push(l),e.push(v),e.push(1),e.push(-1)):(c.push(l),c.push(v),c.push(1),c.push(-1)))),t.y===r.y&&(t.y<=f&&(t.x<
r.x?(e.push(l),e.push(v),e.push(2),e.push(-1)):(c.push(l),c.push(v),c.push(2),c.push(-1))),t.y>=d&&(t.x>r.x?(e.push(l),e.push(v),e.push(3),e.push(-1)):(c.push(l),c.push(v),c.push(3),c.push(-1)))),t=r}0!==e.length&&0!==c.length&&(b.fillParent(q,c,e),b.fillParent(q,e,c),n=[],b.calcDeltas(n,c,e),b.calcDeltas(n,e,c),b.addDeltas(n,q))}};b.fillParent=function(e,c,q){const n=q.length,a=c.length;for(let g=0;g<a;g+=4){var f=c[g],d=c[g+1];const t=c[g+2],r=e[f][d-1];f=e[f][d];d=8092;let w=-1;for(let v=0;v<n;v+=
4){if(q[v+2]!==t)continue;var k=q[v];const z=q[v+1];var l=e[k][z-1];k=e[k][z];switch(t){case 0:case 1:B.between(r.y,l.y,k.y)&&B.between(f.y,l.y,k.y)&&(l=Math.abs(k.y-l.y),l<d&&(d=l,w=v));break;case 2:case 3:B.between(r.x,l.x,k.x)&&B.between(f.x,l.x,k.x)&&(l=Math.abs(k.x-l.x),l<d&&(d=l,w=v))}}c[g+3]=w}};b.calcDeltas=function(e,c,q){const n=c.length;for(let a=0;a<n;a+=4){const f=b.calcDelta(a,c,q,[]);e.push(c[a]);e.push(c[a+1]);e.push(c[a+2]);e.push(f)}};b.calcDelta=function(e,c,q,n){e=c[e+3];if(-1===
e)return 0;const a=n.length;if(1<a&&n[a-2]===e)return 0;n.push(e);return b.calcDelta(e,q,c,n)+1};b.addDeltas=function(e,c){const q=e.length;let n=0;for(var a=0;a<q;a+=4){var f=e[a+3];f>n&&(n=f)}for(a=0;a<q;a+=4){f=c[e[a]];const d=e[a+1],k=n-e[a+3];switch(e[a+2]){case 0:f[d-1].x-=k;f[d].x-=k;1===d&&(f[f.length-1].x-=k);d===f.length-1&&(f[0].x-=k);break;case 1:f[d-1].x+=k;f[d].x+=k;1===d&&(f[f.length-1].x+=k);d===f.length-1&&(f[0].x+=k);break;case 2:f[d-1].y-=k;f[d].y-=k;1===d&&(f[f.length-1].y-=k);
d===f.length-1&&(f[0].y-=k);break;case 3:f[d-1].y+=k,f[d].y+=k,1===d&&(f[f.length-1].y+=k),d===f.length-1&&(f[0].y+=k)}}};return b}();A.SimpleBuilder=p;A.TileClipper=m;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/Geometry":function(){define(["exports"],function(A){let F=function(){function E(B,x){this.x=B;this.y=x}var C=E.prototype;C.clone=function(){return new E(this.x,this.y)};C.equals=function(B,x){return B===this.x&&x===this.y};C.isEqual=function(B){return B.x===
this.x&&B.y===this.y};C.setCoords=function(B,x){this.x=B;this.y=x};C.normalize=function(){var B=this.x;const x=this.y;B=Math.sqrt(B*B+x*x);this.x/=B;this.y/=B};C.rightPerpendicular=function(){const B=this.x;this.x=this.y;this.y=-B};C.move=function(B,x){this.x+=B;this.y+=x};C.assign=function(B){this.x=B.x;this.y=B.y};C.assignAdd=function(B,x){this.x=B.x+x.x;this.y=B.y+x.y};C.assignSub=function(B,x){this.x=B.x-x.x;this.y=B.y-x.y};C.rotate=function(B,x){const m=this.x,p=this.y;this.x=m*B-p*x;this.y=
m*x+p*B};C.scale=function(B){this.x*=B;this.y*=B};C.length=function(){const B=this.x,x=this.y;return Math.sqrt(B*B+x*x)};E.distance=function(B,x){const m=x.x-B.x;B=x.y-B.y;return Math.sqrt(m*m+B*B)};E.add=function(B,x){return new E(B.x+x.x,B.y+x.y)};E.sub=function(B,x){return new E(B.x-x.x,B.y-x.y)};return E}();A.Point=F;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/bufcut":function(){define(["exports"],function(A){function F(r,w,v,z,u,y,D){let G;v=0;for(let H=
z,J=u-y;H<u;H+=y)v+=(r[J+w*y]-r[H+w*y])*(r[H+1+w*y]+r[J+1+w*y]),J=H;if(D===0<v)for(;z<u;z+=y)G=x(z+w*y,r[z+w*y],r[z+1+w*y],G);else for(u-=y;u>=z;u-=y)G=x(u+w*y,r[u+w*y],r[u+1+w*y],G);G&&f(G,G.next)&&(m(G),G=G.next);return G}function E(r,w=r){if(!r)return r;let v;do if(v=!1,r.steiner||!f(r,r.next)&&0!==e(r.prev,r,r.next))r=r.next;else{m(r);r=w=r.prev;if(r===r.next)break;v=!0}while(v||r!==w);return w}function C(r,w,v,z,u,y,D,G){if(r){!G&&y&&(r=b(r,z,u,y));for(var H=r;r.prev!==r.next;){var J=r.prev,
K=r.next;if(y)var L=B(r,z,u,y);else a:{L=r;var M=L.prev,N=L;const P=L.next;if(0<=e(M,N,P)){L=!1;break a}let I=L.next.next;const O=I;let Q=0;for(;I!==L.prev&&(0===Q||I!==O);){Q++;if(q(M.x,M.y,N.x,N.y,P.x,P.y,I.x,I.y)&&0<=e(I.prev,I,I.next)){L=!1;break a}I=I.next}L=!0}if(L)w.push(J.index/v+D),w.push(r.index/v+D),w.push(K.index/v+D),m(r),H=r=K.next;else if(r=K,r===H){if(!G)C(E(r),w,v,z,u,y,D,1);else if(1===G){G=w;H=v;J=D;K=r;do L=K.prev,M=K.next.next,!f(L,M)&&c(L,K,K.next,M)&&n(L,M)&&n(M,L)&&(G.push(L.index/
H+J),G.push(K.index/H+J),G.push(M.index/H+J),m(K),m(K.next),K=r=M),K=K.next;while(K!==r);r=K;C(r,w,v,z,u,y,D,2)}else if(2===G)a:{G=r;do{for(H=G.next.next;H!==G.prev;){if(J=G.index!==H.index){L=L=L=void 0;J=G;K=H;if(L=J.next.index!==K.index&&J.prev.index!==K.index){b:{L=J;do{if(L.index!==J.index&&L.next.index!==J.index&&L.index!==K.index&&L.next.index!==K.index&&c(L,L.next,J,K)){L=!0;break b}L=L.next}while(L!==J);L=!1}L=!L}if(L=L&&n(J,K)&&n(K,J)){L=J;M=!1;N=(J.x+K.x)/2;K=(J.y+K.y)/2;do L.y>K!==L.next.y>
K&&L.next.y!==L.y&&N<(L.next.x-L.x)*(K-L.y)/(L.next.y-L.y)+L.x&&(M=!M),L=L.next;while(L!==J);L=M}J=L}if(J){r=k(G,H);G=E(G,G.next);r=E(r,r.next);C(G,w,v,z,u,y,D,0);C(r,w,v,z,u,y,D,0);break a}H=H.next}G=G.next}while(G!==r)}break}}}}function B(r,w,v,z){const u=r.prev,y=r.next;if(0<=e(u,r,y))return!1;const D=u.x>r.x?u.x>y.x?u.x:y.x:r.x>y.x?r.x:y.x,G=u.y>r.y?u.y>y.y?u.y:y.y:r.y>y.y?r.y:y.y,H=a(u.x<r.x?u.x<y.x?u.x:y.x:r.x<y.x?r.x:y.x,u.y<r.y?u.y<y.y?u.y:y.y:r.y<y.y?r.y:y.y,w,v,z);w=a(D,G,w,v,z);v=r.prevZ;
for(z=r.nextZ;v&&v.z>=H&&z&&z.z<=w;){if(v!==r.prev&&v!==r.next&&q(u.x,u.y,r.x,r.y,y.x,y.y,v.x,v.y)&&0<=e(v.prev,v,v.next))return!1;v=v.prevZ;if(z!==r.prev&&z!==r.next&&q(u.x,u.y,r.x,r.y,y.x,y.y,z.x,z.y)&&0<=e(z.prev,z,z.next))return!1;z=z.nextZ}for(;v&&v.z>=H;){if(v!==r.prev&&v!==r.next&&q(u.x,u.y,r.x,r.y,y.x,y.y,v.x,v.y)&&0<=e(v.prev,v,v.next))return!1;v=v.prevZ}for(;z&&z.z<=w;){if(z!==r.prev&&z!==r.next&&q(u.x,u.y,r.x,r.y,y.x,y.y,z.x,z.y)&&0<=e(z.prev,z,z.next))return!1;z=z.nextZ}return!0}function x(r,
w,v,z){r=l.create(r,w,v);z?(r.next=z.next,r.prev=z,z.next.prev=r,z.next=r):(r.prev=r,r.next=r);return r}function m(r){r.next.prev=r.prev;r.prev.next=r.next;r.prevZ&&(r.prevZ.nextZ=r.nextZ);r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function p(r){let w=r,v=r;do{if(w.x<v.x||w.x===v.x&&w.y<v.y)v=w;w=w.next}while(w!==r);return v}function h(r,w){let v=w;const z=r.x,u=r.y;let y=-Infinity,D;do{if(u<=v.y&&u>=v.next.y&&v.next.y!==v.y){var G=v.x+(u-v.y)*(v.next.x-v.x)/(v.next.y-v.y);if(G<=z&&G>y){y=G;if(G===z){if(u===
v.y)return v;if(u===v.next.y)return v.next}D=v.x<v.next.x?v:v.next}}v=v.next}while(v!==w);if(!D)return null;if(z===y)return D.prev;w=D;G=D.x;const H=D.y;let J=Infinity,K;for(v=D.next;v!==w;)z>=v.x&&v.x>=G&&z!==v.x&&q(u<H?z:y,u,G,H,u<H?y:z,u,v.x,v.y)&&(K=Math.abs(u-v.y)/(z-v.x),(K<J||K===J&&v.x>D.x)&&n(v,r)&&(D=v,J=K)),v=v.next;return D}function b(r,w,v,z){for(var u;u!==r;u=u.next){u=u||r;null===u.z&&(u.z=a(u.x,u.y,w,v,z));if(u.prev.next!==u||u.next.prev!==u)return u.prev.next=u,u.next.prev=u,b(r,
w,v,z);u.prevZ=u.prev;u.nextZ=u.next}r.prevZ.nextZ=null;r.prevZ=null;a:for(v=1;;){z=r;w=r=null;let y=0;for(;z;){y++;u=z;let D=0;for(;D<v&&u;D++)u=u.nextZ;let G=v;for(;0<D||0<G&&u;){let H;0===D?(H=u,u=u.nextZ,G--):0!==G&&u?z.z<=u.z?(H=z,z=z.nextZ,D--):(H=u,u=u.nextZ,G--):(H=z,z=z.nextZ,D--);w?w.nextZ=H:r=H;H.prevZ=w;w=H}z=u}w.nextZ=null;v*=2;if(2>y)break a}return r}function e(r,w,v){return(w.y-r.y)*(v.x-w.x)-(w.x-r.x)*(v.y-w.y)}function c(r,w,v,z){return f(r,w)&&f(v,z)||f(r,z)&&f(v,w)?!0:0<e(r,w,v)!==
0<e(r,w,z)&&0<e(v,z,r)!==0<e(v,z,w)}function q(r,w,v,z,u,y,D,G){return 0<=(u-D)*(w-G)-(r-D)*(y-G)&&0<=(r-D)*(z-G)-(v-D)*(w-G)&&0<=(v-D)*(y-G)-(u-D)*(z-G)}function n(r,w){return 0>e(r.prev,r,r.next)?0<=e(r,w,r.next)&&0<=e(r,r.prev,w):0>e(r,w,r.prev)||0>e(r,r.next,w)}function a(r,w,v,z,u){r=32767*(r-v)*u;w=32767*(w-z)*u;r=(r|r<<8)&16711935;r=(r|r<<4)&252645135;r=(r|r<<2)&858993459;w=(w|w<<8)&16711935;w=(w|w<<4)&252645135;w=(w|w<<2)&858993459;return(r|r<<1)&1431655765|((w|w<<1)&1431655765)<<1}function f(r,
w){return r.x===w.x&&r.y===w.y}function d(r,w){return r.x-w.x}function k(r,w){const v=l.create(r.index,r.x,r.y),z=l.create(w.index,w.x,w.y),u=r.next,y=w.prev;r.next=w;w.prev=r;v.next=u;u.prev=v;z.next=v;v.prev=z;y.next=z;z.prev=y;return z}let l=function(){function r(){this.y=this.x=this.index=0;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}r.create=function(w,v,z){const u=t<g.length?g[t++]:new r;u.index=w;u.x=v;u.y=z;u.prev=null;u.next=null;u.z=null;u.prevZ=null;u.nextZ=null;
u.steiner=!1;return u};return r}();const g=[];let t=0;for(let r=0;8096>r;r++)g.push(new l);A.bufcut=function(r,w,v,z,u,y,D){t=0;var G=(z-v)*y,H=u&&u.length;const J=H?(u[0]-v)*y:G;var K=F(w,v,z,0,J,y,!0);if(K&&K.next!==K.prev){var L;if(H){H=[];for(let I=0,O=u.length;I<O;I++){const Q=F(w,v,z,u[I]*y,I<O-1?u[I+1]*y:z*y,y,!1);Q===Q.next&&(Q.steiner=!0);H.push(p(Q))}H.sort(d);for(var M of H){z=M;u=K;if(u=h(z,u))z=k(u,z),E(z,z.next);K=E(K,K.next)}}if(G>80*y){var N=G=w[v*y];var P=L=w[1+v*y];for(M=y;M<J;M+=
y)z=w[M+v*y],u=w[M+1+v*y],N=Math.min(N,z),P=Math.min(P,u),G=Math.max(G,z),L=Math.max(L,u);L=Math.max(G-N,L-P);L=0!==L?1/L:0}C(K,r,y,N,P,L,D,0)}};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMeshTemplate":function(){define(["../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/Logger","../../../../../../symbols/cim/cimAnalyzer","./WGLMeshTemplate"],function(A,F,E,C){const B=F.getLogger("esri.views.2d.engine.webgl.WGLDynamicMeshTemplate");
return function(x){function m(p){var h=x.call(this)||this;h._ongoingMaterialRequestMap=new Map;h._materialCache=new Map;h._dynamicPropertyMap=new Map;h._cimLayer=p;return h}A._inheritsLoose(m,x);m.prototype.analyze=function(p,h,b,e){h=h.readLegacyFeature();const c=this._materialCache,q=this._cimLayer.materialHash;if(!q)return B.error("A Dynamic mesh template must have a material hash value or function!"),Promise.reject(null);const n="function"===typeof q?q(h,b,e):q;if(c.has(n))return p=c.get(n),Promise.resolve(p);
if(this._ongoingMaterialRequestMap.has(n))return this._ongoingMaterialRequestMap.get(n);b=E.analyzeCIMResource(this._cimLayer.cim,this._cimLayer.materialOverrides);b.mosaicHash=n;p=p.getMosaicItem(b).then(a=>{this._ongoingMaterialRequestMap.delete(n);c.set(n,a);return a}).catch(a=>{this._ongoingMaterialRequestMap.delete(n);B.error(".analyze()",a.message);return null});this._ongoingMaterialRequestMap.set(n,p);return p};return m}(C)})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/screenUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(A,F,E,C,B,x,m,p,h,b){return function(e){function c(q,n,a){var f=e.call(this,q)||this;f._minMaxZoom=B.i1616to32(Math.round(n*C.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(a*C.MIN_MAX_ZOOM_PRECISION_FACTOR));f._cimLineLayer=q;let d=0;m.isFunction(q.width)||(d=.5*F.pt2px(q.width));f._dynamicPropertyMap.set("_halfWidth",(k,l,g)=>m.isFunction(q.width)?.5*F.pt2px(q.width(k,l,g)):d);m.isFunction(q.cap)?f._dynamicPropertyMap.set("_capType",q.cap):f._capType=q.cap;m.isFunction(q.join)?f._dynamicPropertyMap.set("_joinType",
q.join):f._joinType=q.join;m.isFunction(q.color)?f._dynamicPropertyMap.set("_fillColor",(k,l,g)=>(k=q.color(k,l,g))&&E.premultiplyAlphaRGBA(k)||0):(n=q.color,f._fillColor=n&&E.premultiplyAlphaRGBA(n)||0);m.isFunction(q.miterLimit)?f._dynamicPropertyMap.set("_miterLimitCosine",(k,l,g)=>m.getLimitCosine(q.miterLimit(k,l,g))):f._miterLimitCosine=m.getLimitCosine(q.miterLimit);f._scaleFactor=q.scaleFactor||1;f._isDashed=q.isDashed;f._effects=q.effects;f.tessellationProperties._bitset=q.colorLocked?1:
0;f._materialKey=q.materialKey;f._initializeTessellator(!0);return f}A._inheritsLoose(c,e);c.fromCIMLine=function(q,n){const [a,f]=m.getMinMaxZoom(q.scaleInfo,n);return new c(q,a,f)};c.prototype.bindFeature=function(q,n,a){const f=q.readLegacyFeature();this._dynamicPropertyMap.forEach((k,l)=>{this[l]=k(f,n,a)});this._halfWidth*=this._scaleFactor;q=this._materialCache;var d=this._cimLineLayer.materialHash;d=d(f,n,a);d=q.get(d);q=null;d&&b.ok(d.spriteMosaicItem)&&(q=d.spriteMosaicItem);if(q){this._hasPattern=
!0;const {rect:k,width:l,height:g}=q;d=k.x+C.SPRITE_PADDING;const t=k.y+C.SPRITE_PADDING,r=d+l,w=t+g;this.tessellationProperties._tl=B.i1616to32(d,t);this.tessellationProperties._br=B.i1616to32(r,w)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._fillColor=this._fillColor;this.tessellationProperties._halfWidth=this._halfWidth;this.tessellationProperties.offset=0;this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;
d=x.LineMaterialKey.load(this._materialKey);q&&(d.sdf=q.sdf,d.pattern=!0,d.textureBinding=q.textureBinding);this._materialKey=d.data};return c}(p(h))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../definitions ../../enums ../../number ../../TurboLine ../../materialKey/MaterialKey ./templateUtils".split(" "),function(A,F,E,C,B,x,m,p){const h=(e,c,q)=>(n,a,f,d,k,l,g,t,r,w,v)=>
{f=B.i1616to32(v,Math.ceil(1024*e._halfWidth));g=B.i8888to32(Math.round(31*g),Math.round(31*t),Math.round(31*r),Math.round(31*w));k=B.i8888to32(31*k,31*l,0,e._bitset);l=e.out;l.vertexBounds(n,a,c,q);l.vertexWrite(B.i1616to32(8*n,8*a));l.vertexWrite(e.id);l.vertexWrite(e._fillColor);l.vertexWrite(g);l.vertexWrite(f);l.vertexWrite(e._tl);l.vertexWrite(e._br);l.vertexWrite(k);l.vertexWrite(B.i1616to32(Math.ceil(1024*e._halfReferenceWidth),0));l.vertexWrite(e.minMaxZoom);l.vertexEnd();return e.offset+
e.vertexCount++},b=e=>(c,q,n)=>{const a=e.out;a.indexWrite(c);a.indexWrite(q);a.indexWrite(n);e.indexCount+=3};return e=>function(c){function q(...a){a=c.call(this,...a)||this;a.tessellationProperties={};a._tessellationOptions={halfWidth:0,pixelCoordRatio:1,offset:0};a.geometryType=C.WGLGeometryType.LINE;return a}A._inheritsLoose(q,c);var n=q.prototype;n._initializeTessellator=function(a){var f=m.LineMaterialKey.load(this._materialKey),d=this._tessellationOptions;f=f.vvSizeFieldStops||f.vvSizeMinMaxValue||
f.vvSizeScaleStops||f.vvSizeUnitValue;const k=this.tessellationProperties._halfWidth<E.THIN_LINE_HALF_WIDTH_THRESHOLD;this.tessellationProperties.minMaxZoom=this._minMaxZoom;a=k&&!a&&!f;d.wrapDistance=65535;d.textured=this._isDashed||this._hasPattern;d.offset=this.tessellationProperties.offset;d.halfWidth=this.tessellationProperties._halfWidth;d=a?0:1;this._lineTessellator=new x.LineTessellation(h(this.tessellationProperties,d,d),b(this.tessellationProperties),a)};n._write=function(a,f,d){const k=
"esriGeometryPoint"===f.geometryType;a.recordStart(f.getDisplayId(),this._materialKey,this.geometryType,!1,k);this._writeGeometry(a,f,d,k);a.recordEnd()};n._writeGeometry=function(a,f,d,k){d=null!=d?d:f.readLegacyGeometryForDisplay();k=this._getLines(d,k);F.isNone(k)||this._writeVertices(a,f,k)};n._getLines=function(a,f){if(F.isNone(a))return null;a=a.paths||a.rings;return F.isNone(a)?null:p.clipLinesMarshall(a,f?256:16)};n._writeVertices=function(a,f,d){f=f.getDisplayId();const k=a.vertexCount(),
l=this.tessellationProperties,g=this._tessellationOptions;l.out=a;l.id=f;l.indexCount=0;l.vertexCount=0;l.offset=k;g.capType=this._capType;g.joinType=this._joinType;for(const {line:t,start:r}of d)g.initialDistance=r%65535,this._lineTessellator.tessellate(t,g)};return q}(e)})},"esri/views/2d/engine/webgl/TurboLine":function(){define(["exports","./definitions"],function(A,F){function E(e,c){return e.x===c.x&&e.y===c.y}function C(e,c){e.x=c.y;e.y=-c.x;return e}function B(e,c){e.x=-c.y;e.y=c.x;return e}
function x(e,c){e.x=c.x;e.y=c.y;return e}function m(e,c){e.x=-c.x;e.y=-c.y;return e}function p(e){return Math.sqrt(e.x*e.x+e.y*e.y)}function h(e,c,q,n){e.x=c.x*q+c.y*n;e.y=c.x*n-c.y*q;return e}let b=function(){function e(q,n,a){this.writeVertex=q;this.writeTriangle=n;this.canUseThinTessellation=a;this.prevNormal={x:void 0,y:void 0};this.nextNormal={x:void 0,y:void 0};this.textureNormalLeft={x:0,y:1};this.textureNormalRight={x:0,y:-1};this.textureNormal={x:void 0,y:void 0};this.joinNormal={x:void 0,
y:void 0};this.inner={x:void 0,y:void 0};this.outer={x:void 0,y:void 0};this.roundStart={x:void 0,y:void 0};this.roundEnd={x:void 0,y:void 0};this.startBreak={x:void 0,y:void 0};this.endBreak={x:void 0,y:void 0};this.innerPrev={x:void 0,y:void 0};this.innerNext={x:void 0,y:void 0};this.bevelStart={x:void 0,y:void 0};this.bevelEnd={x:void 0,y:void 0};this.bevelMiddle={x:void 0,y:void 0}}var c=e.prototype;c.tessellate=function(q,n){if(q){var a=q.length;if(!(1>=a)){var f=0;for(let d=1;d<a;d++)E(q[d],
q[f])||++f===d||(q[f]=q[d]);q.length=f+1}}this.canUseThinTessellation&&n.halfWidth<F.THIN_LINE_HALF_WIDTH_THRESHOLD&&!n.offset?this.tessellateThin_(q,n):this.tessellate_(q,n)};c.tessellateThin_=function(q,n){if(!(2>q.length)){var a=n.wrapDistance||65535;n=n.initialDistance||0;var f=!1,d=q[0].x,k=q[0].y,l=q.length;for(let w=1;w<l;++w){f&&(f=!1,n=0);let v=q[w].x,z=q[w].y;var g=v-d;let u=z-k;var t=Math.sqrt(g*g+u*u);g/=t;u/=t;if(n+t>a){f=!0;var r=(a-n)/t;t=a-n;v=(1-r)*d+r*v;z=(1-r)*k+r*z;--w}r=this.writeVertex(d,
k,0,0,g,u,u,-g,0,-1,n);d=this.writeVertex(d,k,0,0,g,u,-u,g,0,1,n);n+=t;t=this.writeVertex(v,z,0,0,g,u,u,-g,0,-1,n);g=this.writeVertex(v,z,0,0,g,u,-u,g,0,1,n);this.writeTriangle(r,d,t);this.writeTriangle(d,t,g);d=v;k=z}}};c.tessellate_=function(q,n){var a=q[q.length-1];const f=E(q[0],a);if(!(q.length<(f?3:2))){var d=n.pixelCoordRatio,k=null!=n.capType?n.capType:0,l=null!=n.joinType?n.joinType:2,g=null!=n.miterLimit?Math.min(n.miterLimit,4):2,t=null!=n.roundLimit?Math.min(n.roundLimit,1.05):1.05,r=
null!=n.halfWidth?n.halfWidth:2,w=!!n.textured,v=null,z=null,u=this.prevNormal,y=this.nextNormal,D=-1,G=-1,H=this.joinNormal,J=this.textureNormalLeft,K=this.textureNormalRight,L=this.textureNormal,M=-1,N=-1,P=n.wrapDistance||65535,I=n.initialDistance||0,O=this.writeVertex,Q=this.writeTriangle;n=function(da,ia,ja,ka,la,ma){da=O(T,V,R,S,ja,ka,da,ia,la,ma,I);0<=M&&0<=N&&0<=da&&Q(M,N,da);M=N;return N=da};f&&(v=q[q.length-2],y.x=a.x-v.x,y.y=a.y-v.y,G=p(y),y.x/=G,y.y/=G);a=!1;for(let da=0;da<q.length;++da){a&&
(a=!1,I=0);v&&(u.x=-y.x,u.y=-y.y,D=G,I+D>P&&(a=!0));a?(z=(P-I)/D,D=P-I,v={x:(1-z)*v.x+z*q[da].x,y:(1-z)*v.y+z*q[da].y},--da):v=q[da];var T=v.x;var V=v.y;var aa=0>=da&&!a,Z=da===q.length-1;aa||(I+=D);(z=Z?f?q[1]:null:q[da+1])?(y.x=z.x-T,y.y=z.y-V,G=p(y),y.x/=G,y.y/=G):(y.x=void 0,y.y=void 0);if(!f){if(aa){B(H,y);var R=H.x;var S=H.y;2===k&&(n(-y.y-y.x,y.x-y.y,y.x,y.y,0,-1),n(y.y-y.x,-y.x-y.y,y.x,y.y,0,1));1===k&&(n(-y.y-y.x,y.x-y.y,y.x,y.y,-1,-1),n(y.y-y.x,-y.x-y.y,y.x,y.y,-1,1));if(1===k||0===k)n(-y.y,
y.x,y.x,y.y,0,-1),n(y.y,-y.x,y.x,y.y,0,1);continue}if(Z){C(H,u);R=H.x;S=H.y;if(1===k||0===k)n(u.y,-u.x,-u.x,-u.y,0,-1),n(-u.y,u.x,-u.x,-u.y,0,1);2===k&&(n(u.y-u.x,-u.x-u.y,-u.x,-u.y,0,-1),n(-u.y-u.x,u.x-u.y,-u.x,-u.y,0,1));1===k&&(n(u.y-u.x,-u.x-u.y,-u.x,-u.y,1,-1),n(-u.y-u.x,u.x-u.y,-u.x,-u.y,1,1));continue}}var U=void 0;aa=-(u.x*y.y-u.y*y.x);.01>Math.abs(aa)?0<u.x*y.x+u.y*y.y?(H.x=u.x,H.y=u.y,aa=1,U=Number.MAX_VALUE,z=!0):(B(H,y),U=aa=1,z=!1):(H.x=(u.x+y.x)/aa,H.y=(u.y+y.y)/aa,U=p(H),z=(U-1)*r*
d,z=4<U||z>D&&z>G);R=H.x;S=H.y;var X=l;switch(l){case 0:1.05>U&&(X=2);break;case 1:U<t&&(X=2);break;case 2:U>g&&(X=0)}switch(X){case 2:n(H.x,H.y,-u.x,-u.y,0,-1);n(-H.x,-H.y,-u.x,-u.y,0,1);if(Z)break;w&&(z=a?0:I,M=this.writeVertex(T,V,R,S,y.x,y.y,H.x,H.y,0,-1,z),N=this.writeVertex(T,V,R,S,y.x,y.y,-H.x,-H.y,0,1,z));break;case 0:aa=0>aa;var fa=void 0;aa?(X=M,M=N,N=X,fa=J,X=K):(fa=K,X=J);var ea=void 0,ha=void 0;z?(ea=aa?B(this.innerPrev,u):C(this.innerPrev,u),ha=aa?C(this.innerNext,y):B(this.innerNext,
y)):ea=ha=aa?m(this.inner,H):x(this.inner,H);U=aa?C(this.bevelStart,u):B(this.bevelStart,u);n(ea.x,ea.y,-u.x,-u.y,fa.x,fa.y);ea=n(U.x,U.y,-u.x,-u.y,X.x,X.y);if(Z)break;Z=aa?B(this.bevelEnd,y):C(this.bevelEnd,y);z?(z=this.writeVertex(T,V,R,S,-u.x,-u.y,0,0,0,0,I),M=this.writeVertex(T,V,R,S,y.x,y.y,ha.x,ha.y,fa.x,fa.y,I),N=this.writeVertex(T,V,R,S,y.x,y.y,Z.x,Z.y,X.x,X.y,I),this.writeTriangle(ea,z,N)):(w?(z=this.bevelMiddle,z.x=(U.x+Z.x)/2,z.y=(U.y+Z.y)/2,h(L,z,-u.x,-u.y),n(z.x,z.y,-u.x,-u.y,L.x,L.y),
h(L,z,y.x,y.y),M=this.writeVertex(T,V,R,S,y.x,y.y,z.x,z.y,L.x,L.y,I),N=this.writeVertex(T,V,R,S,y.x,y.y,ha.x,ha.y,fa.x,fa.y,I)):(z=M,M=N,N=z),n(Z.x,Z.y,y.x,y.y,X.x,X.y));aa&&(z=M,M=N,N=z);break;case 1:{aa=0>aa;var W=void 0;aa?(X=M,M=N,N=X,X=J,W=K):(X=K,W=J);var Y=aa?m(this.inner,H):x(this.inner,H);z?(ha=aa?B(this.innerPrev,u):C(this.innerPrev,u),fa=aa?C(this.innerNext,y):B(this.innerNext,y)):fa=ha=Y;ea=aa?C(this.roundStart,u):B(this.roundStart,u);var ba=aa?B(this.roundEnd,y):C(this.roundEnd,y);ha=
n(ha.x,ha.y,-u.x,-u.y,X.x,X.y);ea=n(ea.x,ea.y,-u.x,-u.y,W.x,W.y);if(Z)break;Z=this.writeVertex(T,V,R,S,-u.x,-u.y,0,0,0,0,I);z||this.writeTriangle(M,N,Z);Y=m(this.outer,Y);W=this.writeVertex(T,V,R,S,y.x,y.y,ba.x,ba.y,W.x,W.y,I);let ia,ja;if(ba=2<U){var ca=void 0;U!==Number.MAX_VALUE?(Y.x/=U,Y.y/=U,ca=u.x*Y.x+u.y*Y.y,ca=(U*(ca*ca-1)+1)/ca):ca=-1;ia=aa?C(this.startBreak,u):B(this.startBreak,u);ia.x+=u.x*ca;ia.y+=u.y*ca;ja=aa?B(this.endBreak,y):C(this.endBreak,y);ja.x+=y.x*ca;ja.y+=y.y*ca}h(L,Y,-u.x,
-u.y);U=this.writeVertex(T,V,R,S,-u.x,-u.y,Y.x,Y.y,L.x,L.y,I);h(L,Y,y.x,y.y);Y=w?this.writeVertex(T,V,R,S,y.x,y.y,Y.x,Y.y,L.x,L.y,I):U;ca=Z;const ka=w?this.writeVertex(T,V,R,S,y.x,y.y,0,0,0,0,I):Z;let la=-1,ma=-1;ba&&(h(L,ia,-u.x,-u.y),la=this.writeVertex(T,V,R,S,-u.x,-u.y,ia.x,ia.y,L.x,L.y,I),h(L,ja,y.x,y.y),ma=this.writeVertex(T,V,R,S,y.x,y.y,ja.x,ja.y,L.x,L.y,I));w?ba?(this.writeTriangle(ca,ea,la),this.writeTriangle(ca,la,U),this.writeTriangle(ka,Y,ma),this.writeTriangle(ka,ma,W)):(this.writeTriangle(ca,
ea,U),this.writeTriangle(ka,Y,W)):ba?(this.writeTriangle(Z,ea,la),this.writeTriangle(Z,la,ma),this.writeTriangle(Z,ma,W)):(this.writeTriangle(Z,ea,U),this.writeTriangle(Z,Y,W));z?M=this.writeVertex(T,V,R,S,y.x,y.y,fa.x,fa.y,X.x,X.y,I):(M=w?this.writeVertex(T,V,R,S,y.x,y.y,fa.x,fa.y,X.x,X.y,I):ha,this.writeTriangle(M,ka,W));N=W;aa&&(z=M,M=N,N=z)}}}}};return e}();A.LineTessellation=b;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c,q,n,a){const f=m.create(),d=x.create(),k=E.getLogger("esri.views.2d.engine.webgl.WGLDynamicMarkerTemplate");return function(l){function g(t,r,w){var v=l.call(this,t)||this;v._cimMarkerLayer=t;v._minMaxZoom=b.i1616to32(Math.round(r*h.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(w*h.MIN_MAX_ZOOM_PRECISION_FACTOR));c.isFunction(t.color)?v._dynamicPropertyMap.set("_fillColor",(z,u,y)=>p.premultiplyAlphaRGBA(t.color(z,u,y))):v._fillColor=p.premultiplyAlphaRGBA(t.color);c.isFunction(t.outlineColor)?
v._dynamicPropertyMap.set("_outlineColor",(z,u,y)=>p.premultiplyAlphaRGBA(t.outlineColor(z,u,y))):v._outlineColor=p.premultiplyAlphaRGBA(t.outlineColor);c.isFunction(t.size)?v._dynamicPropertyMap.set("_size",(z,u,y)=>B.pt2px(t.size(z,u,y))):v._size=B.pt2px(t.size)||0;c.isFunction(t.scaleX)?v._dynamicPropertyMap.set("_scaleX",t.scaleX):v._scaleX=t.scaleX||1;c.isFunction(t.offsetX)?v._dynamicPropertyMap.set("xOffset",(z,u,y)=>B.pt2px(t.offsetX(z,u,y))):v.xOffset=B.pt2px(t.offsetX)||0;c.isFunction(t.offsetY)?
v._dynamicPropertyMap.set("yOffset",(z,u,y)=>B.pt2px(t.offsetY(z,u,y))):v.yOffset=B.pt2px(t.offsetY)||0;c.isFunction(t.outlineWidth)?v._dynamicPropertyMap.set("_outlineWidth",(z,u,y)=>B.pt2px(t.outlineWidth(z,u,y))):v._outlineWidth=B.pt2px(t.outlineWidth)||0;c.isFunction(t.rotation)?v._dynamicPropertyMap.set("_angle",t.rotation):v._angle=t.rotation||0;v._scaleFactor=C.unwrapOr(t.scaleFactor,1);v._markerPlacement=t.markerPlacement;v._effects=t.effects;v._bitSet=(1===t.alignment?1:0)|(t.colorLocked?
1:0)<<1|(t.scaleSymbolsProportionally?1:0)<<3;v._materialKey=t.materialKey;return v}A._inheritsLoose(g,l);g.fromCIMMarker=function(t,r){const [w,v]=c.getMinMaxZoom(t.scaleInfo,r);return new g(t,w,v)};g.prototype.bindFeature=function(t,r,w){const v=t.readLegacyFeature();this._dynamicPropertyMap.forEach((I,O)=>{this[O]=I(v,r,w)});t=this._cimMarkerLayer.materialHash;t="function"===typeof t?t(v,r,w):t;if((t=this._materialCache.get(t))&&a.ok(t.spriteMosaicItem)&&t.spriteMosaicItem){t=t.spriteMosaicItem;
var z=this._cimMarkerLayer.sizeRatio,u=t.width/t.height*this._scaleX,y=this._cimMarkerLayer.rotateClockwise?this._angle:-this._angle,D=this._size,G=D*u,H=this.xOffset,J=this.yOffset;this.xOffset*=this._scaleFactor;this.yOffset*=this._scaleFactor;var K=this._cimMarkerLayer.scaleSymbolsProportionally&&this._cimMarkerLayer.frameHeight?this._size/B.pt2px(this._cimMarkerLayer.frameHeight):1,L=this._outlineWidth*K,M=B.pt2px(this._cimMarkerLayer.referenceSize),N=K=0,P=this._cimMarkerLayer.anchorPoint;P&&
(this._cimMarkerLayer.isAbsoluteAnchorPoint?this._size&&(K=-P.x/(this._size*u),N=P.y/this._size):(K=P.x,N=P.y));this._sizeOutlineWidth=b.i8888to32(Math.round(Math.min(Math.sqrt(128*G),255)),Math.round(Math.min(Math.sqrt(128*D),255)),Math.round(Math.min(Math.sqrt(128*L),255)),Math.round(Math.min(Math.sqrt(128*M),255)));this.angle=y;this._bitestAndDistRatio=b.i1616to32(this._bitSet,Math.round(64*z));u=t.rect.x+h.SPRITE_PADDING;y=t.rect.y+h.SPRITE_PADDING;L=u+t.width;M=y+t.height;this._texUpperLeft=
b.i1616to32(u,y);this._texUpperRight=b.i1616to32(L,y);this._texBottomLeft=b.i1616to32(u,M);this._texBottomRight=b.i1616to32(L,M);u=e.MarkerMaterialKey.load(this._materialKey);u.sdf=t.sdf;u.pattern=!0;u.textureBinding=t.textureBinding;this._materialKey=u.data;this._anchorX=.5-(.5+K)*t.width/t.width;this._anchorY=.5-(.5+N)*t.height/t.height;G=G*z*this._scaleFactor;D=D*z*this._scaleFactor;G*=t.rect.width/t.width;D*=t.rect.height/t.height;this._computedWidth=G;this._computedHeight=D;this._applyTransformation(d,
f);this.xOffset=H;this.yOffset=J}else k.error(new F("mapview-cim","Encountered an error when binding feature"))};return g}(q(n))})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/screenUtils ../../alignmentUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLDynamicMeshTemplate ../../../../layers/features/textUtils".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e){return function(c){function q(a,f,d){var k=c.call(this,a)||this;k._horizontalAlignment="center";k._verticalAlignment="middle";k._textToGlyphs=new Map;k._minMaxZoom=x.i1616to32(Math.round(f*B.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(d*B.MIN_MAX_ZOOM_PRECISION_FACTOR));f=a.scaleFactor||1;k._cimTextLayer=a;p.isFunction(a.color)?k._dynamicPropertyMap.set("_color",(r,w,v)=>C.premultiplyAlphaRGBA(a.color(r,w,v))):k._color=C.premultiplyAlphaRGBA(a.color);p.isFunction(a.color)?
k._dynamicPropertyMap.set("_haloColor",(r,w,v)=>C.premultiplyAlphaRGBA(a.outlineColor(r,w,v))):k._haloColor=C.premultiplyAlphaRGBA(a.outlineColor);let l;p.isFunction(a.size)||(l=Math.min(Math.round(F.pt2px(a.size*a.sizeRatio)),127));k._dynamicPropertyMap.set("_size",(r,w,v)=>p.isFunction(a.size)?Math.min(Math.round(F.pt2px(a.size(r,w,v)*a.sizeRatio)),127):l);p.isFunction(a.outlineSize)?k._dynamicPropertyMap.set("_haloSize",(r,w,v)=>Math.min(Math.floor(5*F.pt2px(a.outlineSize(r,w,v)*a.sizeRatio)),
127)):k._haloSize=Math.min(Math.floor(5*F.pt2px(a.outlineSize*a.sizeRatio)),127);let g;p.isFunction(a.offsetX)||(g=Math.round(F.pt2px(a.offsetX*a.sizeRatio)));k._dynamicPropertyMap.set("_xOffset",(r,w,v)=>p.isFunction(a.offsetX)?Math.round(F.pt2px(a.offsetX(r,w,v)*a.sizeRatio)):g);let t;p.isFunction(a.offsetY)||(t=Math.round(F.pt2px(a.offsetY*a.sizeRatio)));k._dynamicPropertyMap.set("_yOffset",(r,w,v)=>p.isFunction(a.offsetY)?Math.round(F.pt2px(a.offsetY(r,w,v)*a.sizeRatio)):t);p.isFunction(a.angle)?
k._dynamicPropertyMap.set("_angle",a.angle):k._angle=a.angle;p.isFunction(a.horizontalAlignment)?k._dynamicPropertyMap.set("_horizontalAlignment",a.horizontalAlignment):k._horizontalAlignment=a.horizontalAlignment;p.isFunction(a.verticalAlignment)?k._dynamicPropertyMap.set("_verticalAlignment",a.verticalAlignment):k._verticalAlignment=a.verticalAlignment;k._scaleFactor=f;p.isFunction(a.text)?k._dynamicPropertyMap.set("_text",a.text):k._text=a.text;f=Math.min(Math.round(F.pt2px(a.referenceSize*a.sizeRatio)),
127);k._referenceSize=Math.round(Math.sqrt(256*f));k._materialKey=a.materialKey;f=m.TextMaterialKey.load(k._materialKey);f.sdf=!0;k._bitset=(1===a.alignment?1:0)|(a.colorLocked?1:0)<<1;k._materialKey=f.data;k._decoration="none";k._lineHeight=1;k._lineWidth=512;k._textPlacement=a.markerPlacement;k._effects=a.effects;k._isCIM=!0;return k}A._inheritsLoose(q,c);q.fromCIMText=function(a,f){const [d,k]=p.getMinMaxZoom(a.scaleInfo,f);return new q(a,d,k)};var n=q.prototype;n.analyze=function(){var a=A._asyncToGenerator(function*(f,
d,k,l){d=d.readLegacyFeature();var g=this._cimTextLayer;k="string"===typeof g.text?g.text:"function"===typeof g.text?g.text(d,k,l):"";f=yield f.getMosaicItem(this._cimTextLayer.cim,e.codepoints(k));this._textToGlyphs.set(k,f.glyphMosaicItems);return f});return function(f,d,k,l){return a.apply(this,arguments)}}();n.bindFeature=function(a,f,d){const k=a.readLegacyFeature();this._dynamicPropertyMap.forEach((l,g)=>{this[g]=l(k,f,d)});this._text&&0!==this._text.length?(this._size*=this._scaleFactor,this._scale=
this._size/24,this._xOffset*=this._scaleFactor,this._yOffset*=this._scaleFactor,this._xAlignD=E.getXAnchorDirection(this._horizontalAlignment||"center"),this._yAlignD=E.getYAnchorDirection(this._verticalAlignment||"baseline"),a=this._textToGlyphs.get(this._text),this.bindTextInfo(a,!1)):this._shapingInfo=null};return q}(h(b))})},"esri/views/2d/layers/features/textUtils":function(){define(["exports"],function(A){A.codepoints=function(F){const E=Array(F.length);for(let C=0;C<F.length;C++)E[C]=F.charCodeAt(C);
return E};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/mathUtils ../../../../../../core/screenUtils ../../color ../../definitions ../../GeometryUtils ../../number ../../materialKey/MaterialKey ./util ./WGLBaseFillTemplate ./WGLMeshTemplate".split(" "),function(A,F,E,C,B,x,m,p,h,b,e){return function(c){function q(n,a,f,d,k,l,g,t,r,w,v){var z=
c.call(this)||this;z._effects=r;n=p.FillMaterialKey.load(n);a&&(n.sdf=a.sdf,n.pattern=!0,n.textureBinding=a.textureBinding);z.fillColor=f;z.tl=d;z.br=k;z.aux1=l;z.aux2=g;z.aux3=t;z._minMaxZoom=m.i1616to32(Math.round(w*B.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(v*B.MIN_MAX_ZOOM_PRECISION_FACTOR));z._materialKey=n.data;return z}A._inheritsLoose(q,c);q.fromCIMFill=function(n,a,f){var d=n.color;d=d&&C.premultiplyAlphaRGBA(d)||0;const k=n.materialKey,[l,g]=h.getMinMaxZoom(n.scaleInfo,f);if(!a)return a=
m.i8888to32(0,0,0,n.colorLocked?1:0),new q(k,null,d,0,0,0,0,a,n.effects,l,g);const {rect:t,width:r,height:w}=a;var v=t.x+B.SPRITE_PADDING;const z=t.y+B.SPRITE_PADDING;var u=v+r;const y=z+w;var D=F.nextHighestPowerOfTwo(w);255<D?D=255:0>=D&&(D=F.nextHighestPowerOfTwo(y-z));var G=F.nextHighestPowerOfTwo(r||0);255<G?G=255:0>=G&&(G=F.nextHighestPowerOfTwo(u-v));let H=E.pt2px(n.offsetX||0)+128;255<H&&(H=255);let J=E.pt2px(-n.offsetY||0)+128;255<J&&(J=255);f=n.scaleX||1;v=m.i1616to32(v,z);u=m.i1616to32(u,
y);D=m.i8888to32(G,D,H,J);f=m.i1616to32(128*f,128);G=m.i8888to32(0,0,x.degToByte(n.angle),n.colorLocked?1:0);return new q(k,a,d,v,u,D,f,G,n.effects,l,g)};q.fromSimpleFill=function(n,a,f=!1){var {color:d}=n;d=d&&"esriSFSNull"!==n.style&&C.premultiplyAlphaRGBAArray(d)||0;f=m.i8888to32(0,0,0,f?255:0);n=n.materialKey;if(!a)return new q(n,null,d,0,0,0,0,f,null,h.DEFAULT_MIN_ZOOM,h.DEFAULT_MAX_ZOOM);const {rect:k,width:l,height:g}=a;var t=k.x+B.SPRITE_PADDING,r=k.y+B.SPRITE_PADDING;const w=t+l,v=r+g,z=
m.i1616to32(t,r),u=m.i1616to32(w,v);t=m.i8888to32(F.nextHighestPowerOfTwo(w-t),F.nextHighestPowerOfTwo(v-r),0,0);r=m.i1616to32(128,128);return new q(n,a,d,z,u,t,r,f,null,h.DEFAULT_MIN_ZOOM,h.DEFAULT_MAX_ZOOM)};q.fromPictureFill=function(n,a,f=!1){const d=B.PICTURE_FILL_COLOR,{rect:k,width:l,height:g}=a;var t=k.x+B.SPRITE_PADDING,r=k.y+B.SPRITE_PADDING,w=t+l,v=r+g;t=m.i1616to32(t,r);w=m.i1616to32(w,v);v=F.nextHighestPowerOfTwo(E.pt2px(n.width));255<v&&(v=255);r=F.nextHighestPowerOfTwo(E.pt2px(n.height));
255<r&&(r=255);let z=E.pt2px(n.xoffset)+128;255<z&&(z=255);let u=E.pt2px(-n.yoffset)+128;255<u&&(u=255);v=m.i8888to32(v,r,z,u);r=m.i1616to32(128*n.xscale,128*n.yscale);f=m.i8888to32(0,0,0,f?255:0);return new q(n.materialKey,a,d,t,w,v,r,f,null,h.DEFAULT_MIN_ZOOM,h.DEFAULT_MAX_ZOOM)};return q}(b(e))})},"esri/views/2d/engine/webgl/mesh/templates/WGLLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Logger ../../../../../../core/screenUtils ../../color ../../definitions ../../number ../../Utils ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLMeshTemplate".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e){const c=F.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate");return function(q){function n(a,f,d,k,l,g,t,r,w,v,z,u,y,D,G,H,J){var K=q.call(this)||this;a=p.LineMaterialKey.load(a);f&&(a.sdf=f.sdf,a.pattern=!0,a.textureBinding=f.textureBinding);K._capType=k;K._joinType=l;K._miterLimitCosine=h.getLimitCosine(g);K.tessellationProperties._fillColor=t;K.tessellationProperties._tl=r;K.tessellationProperties._br=w;K._hasPattern=v;K._isDashed=z;K._isColorLocked=u;K._zOrder=
D;K._effects=G;K._minMaxZoom=x.i1616to32(Math.round(H*B.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(J*B.MIN_MAX_ZOOM_PRECISION_FACTOR));K._materialKey=a.data;K.tessellationProperties._bitset=u?1:0;K.tessellationProperties._halfWidth=.5*d;K.tessellationProperties._halfReferenceWidth=.5*y;K.tessellationProperties.offset=0;K._initializeTessellator(!1);return K}A._inheritsLoose(n,q);n.fromCIMLine=function(a,f,d){var k=a.color,l=a.scaleFactor||1;const g=a.isDashed;let t=a.cap;g&&1===t&&(t=2);const r=a.join;
l*=E.pt2px(a.width);const w=E.pt2px(a.referenceWidth),v=E.pt2px(a.miterLimit);k=k&&C.premultiplyAlphaRGBA(k)||0;const [z,u]=h.getMinMaxZoom(a.scaleInfo,d);if(!f)return new n(a.materialKey,f,l,t,r,v,k,0,0,!1,g,a.colorLocked,w,a.zOrder,a.effects,z,u);const {rect:y,width:D,height:G}=f;var H=y.x+B.SPRITE_PADDING;const J=y.y+B.SPRITE_PADDING;d=H+D;const K=J+G;H=x.i1616to32(H,J);d=x.i1616to32(d,K);return new n(a.materialKey,f,l,t,r,v,k,H,d,!0,g,a.colorLocked,w,a.zOrder,a.effects,z,u)};n.fromSimpleLine=
function(a,f){var {color:d}=a;const k="esriSLSSolid"!==a.style&&"esriSLSNull"!==a.style,l=m.getCapType(a.cap||"round"),g=m.getJoinType(a.join||"round");d=d&&"esriSLSNull"!==a.style&&C.premultiplyAlphaRGBAArray(d)||0;"esriSLSNull"===a.style&&(d=0);const t=E.pt2px(a.width),r=a.miterLimit;if(!f)return new n(a.materialKey,f,t,l,g,r,d,0,0,!1,k,!1,t,0,null,h.DEFAULT_MIN_ZOOM,h.DEFAULT_MAX_ZOOM);const {rect:w,width:v,height:z}=f;var u=w.x+B.SPRITE_PADDING;const y=w.y+B.SPRITE_PADDING;var D=u+v;const G=y+
z;u=x.i1616to32(u,y);D=x.i1616to32(D,G);return new n(a.materialKey,f,t,l,g,r,d,u,D,!0,k,!1,t,0,null,h.DEFAULT_MIN_ZOOM,h.DEFAULT_MAX_ZOOM)};n.fromPictureLineSymbol=function(a,f,d,k){c.error("PictureLineSymbol support does not exist!");return null};return n}(b(e))})},"esri/views/2d/engine/webgl/util/Lock":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/promiseUtils"],function(A,F,E){function C(){C=F._asyncToGenerator(function*(x,m,p){try{yield x.acquire(),
yield m(p),x.release()}catch(h){throw x.release(),h;}});return C.apply(this,arguments)}let B=function(){function x(){this._resolver=null}var m=x.prototype;m.isHeld=function(){return!!this._resolver};m.acquire=function(){var p=F._asyncToGenerator(function*(){if(!this._resolver)return this._resolver=E.createResolver(),Promise.resolve();yield this._resolver.promise;yield this.acquire()});return function(){return p.apply(this,arguments)}}();m.release=function(){const p=this._resolver;this._resolver=null;
p.resolve()};return x}();A["default"]=B;A.withLock=function(x,m,p){return C.apply(this,arguments)};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/layers/features/schemaUtils":function(){define("exports ../../../../renderers/ClassBreaksRenderer ../../../../renderers/DictionaryRenderer ../../../../renderers/DotDensityRenderer ../../../../renderers/HeatmapRenderer ../../../../renderers/Renderer ../../../../renderers/SimpleRenderer ../../../../renderers/UniqueValueRenderer ../../../../renderers/support/jsonUtils ../../../../core/Error ../../../../core/has ../../../../core/lang ../../../../core/Logger ../../../../core/maybe ../../../../core/screenUtils ../../../../symbols/support/jsonUtils ../../engine/webgl/enums ../../engine/webgl/Utils ../../engine/webgl/materialKey/MaterialKey ../../engine/webgl/util/vvFlagUtils ./support/pixelBuffering ./support/rendererUtils ../support/clusterUtils ../support/util".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c,q,n,a,f,d,k,l,g,t,r,w,v){function z(W){switch(W.type){case "line-marker":var Y;return{type:"line-marker",color:null==(Y=W.color)?void 0:Y.toJSON(),placement:W.placement,style:W.style};default:return f.fromJSON(W.toJSON()).toJSON()}}function u(W,Y,ba){if(!W)return null;var ca=0;let da=!1,ia=0;n.isSome(Y)&&(ia=t.getPtMaxVVSize(Y),"visualVariables"in Y&&(ca=g.getVVFlags(Y.visualVariables||[]),da="dot-density"===Y.type));switch(W.type){case "simple-fill":case "picture-fill":return y(W,
ca,da,ba);case "simple-marker":case "picture-marker":return Y=ia,ca=l.createMaterialKey(d.WGLGeometryType.MARKER,ca,!1,!1),ba=ba?l.hydrateMaterialKey(ca):ca,ca=z(W),W={materialKey:ba,hash:W.hash(),...ca,angle:W.angle,maxVVSize:Y};case "simple-line":return D(W,ca,ba);case "text":return Y=ia,ca=l.createMaterialKey(d.WGLGeometryType.TEXT,ca,!1,!1),ba=ba?l.hydrateMaterialKey(ca):ca,ca=z(W),W={materialKey:ba,hash:W.hash(),...ca,angle:W.angle,maxVVSize:Y};case "label":return Y=ca,ca=W.toJSON(),Y=l.createMaterialKey(d.WGLGeometryType.LABEL,
Y,!1,!1,ca.labelPlacement),W={materialKey:ba?l.hydrateMaterialKey(Y):Y,hash:W.hash(),...ca,labelPlacement:ca.labelPlacement};case "cim":return{type:"cim",rendererKey:ca,data:W.data,maxVVSize:ia};case "web-style":return{...z(W),type:"web-style",hash:W.hash(),rendererKey:ca,maxVVSize:ia};default:throw Error(`symbol not supported ${W.type}`);}}function y(W,Y,ba,ca){ba=l.createMaterialKey(d.WGLGeometryType.FILL,Y,!1,ba);var da=ca?l.hydrateMaterialKey(ba):ba;const ia=W.clone();ba=ia.outline;ia.outline=
null;W=[];da={materialKey:da,hash:ia.hash(),...z(ia)};W.push(da);ba&&(Y=l.createMaterialKey(d.WGLGeometryType.LINE,Y,!0,!1),ca={materialKey:ca?l.hydrateMaterialKey(Y):Y,hash:ba.hash(),...z(ba)},W.push(ca));return{type:"composite-symbol",layers:W,hash:W.reduce((ja,ka)=>ka.hash+ja,"")}}function D(W,Y,ba){var ca=l.createMaterialKey(d.WGLGeometryType.LINE,Y,!1,!1);const da=ba?l.hydrateMaterialKey(ca):ca;W=W.clone();ca=W.marker;W.marker=null;const ia=[];ia.push({materialKey:da,hash:W.hash(),...z(W)});
if(ca){var ja;Y=l.createMaterialKey(d.WGLGeometryType.MARKER,Y,!1,!1);ba=ba?l.hydrateMaterialKey(Y):Y;ca.color=null!=(ja=ca.color)?ja:W.color;ia.push({materialKey:ba,hash:ca.hash(),lineWidth:W.width,...z(ca)})}return{type:"composite-symbol",layers:ia,hash:ia.reduce((ka,la)=>la.hash+ka,"")}}function G(W,Y){const ba=W.labelPlacement;var ca=ha[Y];if(!W.symbol)return ea.warn("No ILabelClass symbol specified."),!0;if(!ca)return ea.error(new b("mapview-labeling:unsupported-geometry-type",`Unable to create labels for Feature Layer, ${Y} is not supported`)),
!0;ca.some(da=>da===ba)||(ca=ca[0],ba&&ea.warn(`Found invalid label placement type ${ba} for ${Y}. Defaulting to ${ca}`),W.labelPlacement=ca);return!1}function H(W,Y){W=c.clone(W);return W.some(ba=>G(ba,Y))?[]:W}function J(W,Y=!1){try{var ba,ca;const da=I(W,Y),ia={};da.map(ja=>{a:{switch(ja.target){case "feature":M(ia,L(W),ja);ja=void 0;break a;case "aggregate":if(!("featureReduction"in W)){ja=void 0;break a}var ka=W.featureReduction;if("selection"===ka.type)throw new b("ValidationError","Mapview does not support `selection` reduction type",
ka);M(ia,L(W),ja);ia.aggregate||(ia.aggregate={name:"aggregate",input:"feature",filters:null,attributes:{},params:{clusterRadius:a.pt2px(ka.clusterRadius/2),clusterPixelBuffer:64*Math.ceil(a.pt2px(ka.clusterMaxSize)/64),fields:ja.aggregateFields}});K(ia.aggregate,ja.attributes.fields);ja=void 0;break a}ja=void 0}return ja});return{source:{definitionExpression:W.definitionExpression,fields:W.fields.map(ja=>ja.toJSON()),gdbVersion:W.gdbVersion,historicMoment:null==(ba=W.historicMoment)?void 0:ba.getTime(),
outFields:W.availableFields,pixelBuffer:W.pixelBuffer,spatialReference:W.spatialReference.toJSON(),timeExtent:null==(ca=W.timeExtent)?void 0:ca.toJSON(),customParameters:W.customParameters},attributes:{fields:{},indexCount:0},processors:da,targets:ia}}catch(da){if("ValidationError"===da.fieldName)return ea.error(da),null;throw da;}}function K(W,Y){for(const ba in Y){const ca=Y[ba];if(ca.target!==W.name)continue;const da=W.attributes[ba];da?(da.context.mesh=da.context.mesh||ca.context.mesh,da.context.storage=
da.context.storage||ca.context.storage):W.attributes[ba]=ca}return W}function L(W){var Y,ba,ca,da,ia;return[null!=(Y=null==(ba=W.filter)?void 0:ba.toJSON())?Y:null,null!=(ca=null==(da=W.effect)?void 0:null==(ia=da.filter)?void 0:ia.toJSON())?ca:null]}function M(W,Y,ba){W.feature||(W.feature={name:"feature",input:"source",filters:Y,attributes:{}});K(W.feature,ba.attributes.fields);return W}function N(W,Y){return Y.field?P(W,{...Y,type:"field",field:Y.field}):Y.valueExpression?P(W,{...Y,type:"expression",
valueExpression:Y.valueExpression}):{field:null,fieldIndex:null}}function P(W,Y){switch(Y.type){case "expression":var ba=Y.valueExpression;if(!W.fields[ba]){var ca=W.indexCount++;W.fields[ba]={...Y,name:ba,fieldIndex:ca}}return{fieldIndex:W.fields[ba].fieldIndex};case "label-expression":return ba=JSON.stringify(Y.label),W.fields[ba]||(ca=W.indexCount++,W.fields[ba]={...Y,name:ba,fieldIndex:ca}),{fieldIndex:W.fields[ba].fieldIndex};case "field":ba=Y.field;if("aggregate"===Y.target&&W.fields[ba])return{field:ba};
W.fields[ba]={...Y,name:ba};return{field:ba};case "statistic":return W.fields[Y.name]={...Y},{field:Y.name}}}function I(W,Y=!1){const ba=[];let ca=0;ba.push(Q(W,ca++,Y));return ba}function O(W,Y,ba,ca,da,ia=!1){Y=P(Y,{type:"label-expression",target:ca,context:{mesh:!0},resultType:"string",label:{labelExpression:ba.labelExpression,labelExpressionInfo:ba.labelExpressionInfo?{expression:ba.labelExpressionInfo.expression}:null,symbol:!!ba.symbol,where:ba.where}});({fieldIndex:Y}=Y);return{...u(ba,W,ia),
fieldIndex:Y,target:ca,index:da}}function Q(W,Y,ba=!1){const ca={indexCount:0,fields:{}};var da="featureReduction"in W&&W.featureReduction;Y=da?"aggregate":"feature";if("sublayers"in W){var ia={type:"subtype",subtypeField:W.subtypeField,renderers:{}},ja={type:"subtype",mapping:{},target:"feature"},ka={type:"subtype",classes:{}},la={type:"symbol",target:"feature",aggregateFields:[],attributes:ca,storage:ja,mesh:{matcher:ia,aggregateMatcher:null,labels:ka,sortKey:null}};da=new Set;let qa=0;for(const {renderer:na,
subtypeCode:oa,labelingInfo:sa,labelsVisible:ra}of W.sublayers){W=S(ca,Y,na,ba);var ma=aa(ca,Y,na),pa=ra&&sa;if("visualVariables"in na&&na.visualVariables&&na.visualVariables.length)throw new b("ValidationError","Visual variables are currently not supported for subtype layers");if("dictionary"===W.type)throw new b("ValidationError","Dictionary renderer is not supported in subtype layers");if("subtype"===W.type)throw new b("ValidationError","Nested subtype renderers is not supported");if(n.isSome(ma)&&
"subtype"===ma.type)throw new b("ValidationError","Nested subtype storage is not supported");if(n.isSome(ma)&&"dot-density"===ma.type)throw new b("ValidationError","Dot density attributes are not supported in subtype layers");if(da.has(oa))throw new b("ValidationError","Subtype codes for sublayers must be unique");da.add(oa);ia.renderers[oa]=W;ja.mapping[oa]=ma;pa&&(ka.classes[oa]=pa.map(ta=>O(na,ca,ta,"feature",qa++,ba)))}return la}switch(W.renderer.type){case "heatmap":{const {blurRadius:qa,fieldOffset:na,
field:oa}=W.renderer;return{type:"heatmap",aggregateFields:[],attributes:ca,target:Y,storage:null,mesh:{blurRadius:qa,fieldOffset:na,field:N(ca,{target:Y,field:oa,resultType:"numeric"}).field}}}default:{ia=[];const qa="aggregate"===Y?w.createClusterRenderer(ia,W.renderer,da,null):W.renderer;V(ca,ia);ja=S(ca,Y,qa,ba);la=null;ka=aa(ca,Y,qa);ma=v.toJSONGeometryType(W.geometryType);pa=W.labelsVisible&&W.labelingInfo||[];let na=[];if(da){if("selection"===da.type)throw new b("ValidationError","Mapview does not support `selection` reduction type",
da);da.symbol&&(la=new m({symbol:da.symbol,visualVariables:"visualVariables"in qa?qa.visualVariables:null}),la=S(ca,Y,la,ba));na=da&&da.labelsVisible&&da.labelingInfo||[]}pa=H(pa,ma);na=H(na,ma);let oa=0;da=[...pa.map(sa=>O(qa,ca,sa,"feature",oa++,ba)),...na.map(sa=>O(qa,ca,sa,"aggregate",oa++,ba))];W=T(ca,W.orderBy);return{type:"symbol",target:Y,attributes:ca,aggregateFields:ia,storage:ka,mesh:{matcher:ja,labels:{type:"simple",classes:da},aggregateMatcher:la,sortKey:W}}}}}function T(W,Y){if(n.isNone(Y)||
!Y.length)return null;1<Y.length&&ea.warn(`Layer rendering currently only supports ordering by 1 orderByInfo, but found ${Y.length}. All but the first will be discarded`);Y=Y[0];const ba="ascending"===Y.order?"asc":"desc";if(Y.field)return{field:Y.field,order:ba};if(Y.valueExpression)return{fieldIndex:P(W,{type:"expression",target:"feature",valueExpression:Y.valueExpression,resultType:"numeric"}).fieldIndex,order:ba};ea.error(new b("ValidationError","Expected to find a field or valueExpression for OrderByInfo",
Y));return null}function V(W,Y){const ba={mesh:!0,storage:!0};for(const ca of Y){const {name:da,outStatistic:ia}=ca,{statisticType:ja,onStatisticField:ka}=ia;let la=Y=null,ma=null;"onStatisticValueExpression"in ia?la=P(W,{type:"expression",target:"feature",valueExpression:ia.onStatisticValueExpression,resultType:"numeric"}).fieldIndex:"onStatisticNormalizationField"in ia?(Y=P(W,{type:"field",target:"feature",field:ka,resultType:"numeric"}).field,ma=ia.onStatisticNormalizationField):Y=P(W,{type:"field",
target:"feature",field:ka,resultType:"numeric"}).field;P(W,{type:"statistic",target:"aggregate",name:da,context:ba,inField:Y,inNormalizationField:ma,inFieldIndex:la,statisticType:ja})}}function aa(W,Y,ba){switch(ba.type){case "dot-density":return Z(W,Y,ba.attributes);case "simple":case "class-breaks":case "unique-value":case "dictionary":return R(W,Y,ba.visualVariables);case "heatmap":return null}}function Z(W,Y,ba){return ba&&ba.length?{type:"dot-density",mapping:ba.map((ca,da)=>{const {field:ia,
fieldIndex:ja}=N(W,{valueExpression:ca.valueExpression,field:ca.field,resultType:"numeric",target:Y});return{binding:da,field:ia,fieldIndex:ja}}),target:Y}:{type:"dot-density",mapping:[],target:Y}}function R(W,Y,ba){if(!ba||!ba.length)return{type:"visual-variable",mapping:[],target:Y};const ca={storage:!0};return{type:"visual-variable",mapping:r.simplifyVisualVariables(ba).map(da=>{var ia;const ja=k.getVVType(da.type),{field:ka,fieldIndex:la}=N(W,{target:Y,valueExpression:da.valueExpression,field:da.field,
context:ca,resultType:"numeric"});switch(da.type){case "size":return"$view.scale"===da.valueExpression?null:{type:"size",binding:ja,field:ka,fieldIndex:la,normalizationField:N(W,{target:Y,field:da.normalizationField,context:ca,resultType:"numeric"}).field,valueRepresentation:null!=(ia=da.valueRepresentation)?ia:null};case "color":return{type:"color",binding:ja,field:ka,fieldIndex:la,normalizationField:N(W,{target:Y,field:da.normalizationField,context:ca,resultType:"numeric"}).field};case "opacity":return{type:"opacity",
binding:ja,field:ka,fieldIndex:la,normalizationField:N(W,{target:Y,field:da.normalizationField,context:ca,resultType:"numeric"}).field};case "rotation":return{type:"rotation",binding:ja,field:ka,fieldIndex:la}}}).filter(da=>da),target:Y}}function S(W,Y,ba,ca=!1){W=n.unwrapOr(W,{indexCount:0,fields:{}});switch(ba.type){case "simple":case "dot-density":return U(W,ba,"dot-density"===ba.type,ca);case "class-breaks":return X(W,Y,ba,ca);case "unique-value":return fa(W,Y,ba,ca);case "dictionary":return{type:"dictionary",
renderer:ba.toJSON()}}}function U(W,Y,ba,ca=!1){W=Y.getSymbols();return{type:"simple",symbol:u(W.length?W[0]:null,Y,ca),isDotDensity:ba}}function X(W,Y,ba,ca=!1){const da=ba.backgroundFillSymbol,{field:ia,fieldIndex:ja}=N(W,{target:Y,field:ba.field,valueExpression:ba.valueExpression,resultType:"numeric",context:{mesh:!0,use:"renderer.field"}});Y=ba.normalizationType;Y="log"===Y?"esriNormalizeByLog":"percent-of-total"===Y?"esriNormalizeByPercentOfTotal":"field"===Y?"esriNormalizeByField":null;const ka=
ba.classBreakInfos.map(la=>({symbol:u(la.symbol,ba,ca),min:la.minValue,max:la.maxValue})).sort((la,ma)=>la.min-ma.min);return{type:"interval",attributes:W.fields,field:ia,fieldIndex:ja,backgroundFillSymbol:u(da,ba,ca),defaultSymbol:u(ba.defaultSymbol,ba,ca),intervals:ka,normalizationField:ba.normalizationField,normalizationTotal:ba.normalizationTotal,normalizationType:Y,isMaxInclusive:ba.isMaxInclusive}}function fa(W,Y,ba,ca=!1){const da=[],ia=ba.backgroundFillSymbol;Y={target:Y,context:{mesh:!0},
resultType:"string"};if(ba.field&&"string"!==typeof ba.field)throw new b("ValidationError","Expected renderer.field to be a string",ba);const {field:ja,fieldIndex:ka}=N(W,{...Y,field:ba.field,valueExpression:ba.valueExpression});for(const la of ba.uniqueValueInfos)da.push({value:""+la.value,symbol:u(la.symbol,ba,ca)});return{type:"map",attributes:W.fields,field:ja,fieldIndex:ka,field2:N(W,{...Y,field:ba.field2}).field,field3:N(W,{...Y,field:ba.field3}).field,fieldDelimiter:ba.fieldDelimiter,backgroundFillSymbol:u(ia,
ba),defaultSymbol:u(ba.defaultSymbol,ba),map:da}}const ea=q.getLogger("esri.views.2d.layers.features.schemaUtils"),ha={esriGeometryPoint:"above-right above-center above-left center-center center-left center-right below-center below-left below-right".split(" "),esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along"],esriGeometryMultipoint:null};A.addAggregateFields=V;A.createMatcherSchema=S;A.createSchema=function(W){e("esri-2d-update-debug")&&console.debug("Created new schema",
J(W,!0));return J(W)};A.createSymbolSchema=u;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/util/vvFlagUtils":function(){define(["exports","../enums","../visualVariablesUtils"],function(A,F,E){A.getVVFlags=function(C){if(!C)return F.WGLVVFlag.NONE;let B=0;for(const x of C)"size"===x.type?(C=E.getTypeOfSizeVisualVariable(x),B|=C,"outline"===x.target&&(B|=C<<4)):"color"===x.type?B|=F.WGLVVFlag.COLOR:"opacity"===x.type?B|=F.WGLVVFlag.OPACITY:"rotation"===x.type&&(B|=
F.WGLVVFlag.ROTATION);return B};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/pixelBuffering":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/screenUtils ../../../../../symbols/cim/CIMSymbolHelper ../../../../../symbols/cim/Rect ../../../engine/webgl/definitions ../../graphics/graphicsUtils".split(" "),function(A,F,E,C,B,x,m){function p(g){if(!("visualVariables"in g&&g.hasVisualVariables("size")))return 0;
g=g.getVisualVariablesForType("size");if(!g[0])return 0;g=g[0];if("outline"===g.target)return 0;if("stops"===g.transformationType)return g.stops.map(t=>t.size).reduce(f,0);if("clamped-linear"===g.transformationType){let t=-Infinity,r=-Infinity;t="number"===typeof g.maxSize?g.maxSize:g.maxSize.stops.map(w=>w.size).reduce(f,0);r="number"===typeof g.minSize?g.minSize:g.minSize.stops.map(w=>w.size).reduce(f,0);return Math.max(t,r)}if("real-world-size"===g.transformationType)return 30}function h(){h=F._asyncToGenerator(function*(g,
t,r){if(!g||r&&"cluster"===r.type)return 0;if("heatmap"===g.type)return Math.round(3*g.blurRadius);if("dot-density"===g.type)return 0;if("dictionary"===g.type)return"esriGeometryPoint"===t||"esriGeometryMultipoint"===t?100:200;t=g.getSymbols();g=p(g);r=[];for(var w of t)r.push(q(w,g));w=yield Promise.all(r);return E.pt2px(w.reduce(f,0))});return h.apply(this,arguments)}function b(g,t){return null==g?t:g}function e(g,t){return c.apply(this,arguments)}function c(){c=F._asyncToGenerator(function*(g,
t){if("simple-marker"===g.type)return t=Math.max(b(g.size,12),t),a(g)+.707*t;if("picture-marker"===g.type){var r=Math.max(b(g.height,12),t);t=b(g.width,12)*(r/b(g.height,12))/2;r/=2;return a(g)+Math.sqrt(t*t+r*r)}if("text"===g.type){if(r=g.text&&g.text.length){t=[];for(let w=0;w<r;w++)t.push({...l,code:g.text.charCodeAt(w)});t={glyphMosaicItems:t}}else t={glyphMosaicItems:[l]};m.getTextSymbolSize(k,g.toJSON(),t);return Math.max(Math.abs(k[0]),Math.abs(k[1]))+Math.max(k[2],k[3])}return"simple-line"===
g.type?(r=Math.max(b(g.width,.75),t)/2,g.marker?Math.max(6*g.width,2*t):r):"simple-fill"===g.type||"picture-fill"===g.type?Math.max(null==g.outline?0:b(g.outline.width,0),t)/2:"cim"===g.type?(g=C.CIMSymbolHelper.getEnvelope(g.data))?Math.sqrt(g.width*g.width+g.height*g.height):0:"web-style"===g.type?e(yield g.fetchCIMSymbol(),t):0});return c.apply(this,arguments)}function q(g,t){return n.apply(this,arguments)}function n(){n=F._asyncToGenerator(function*(g,t){return g.type in d?Math.min(yield e(g,
t),75):0});return n.apply(this,arguments)}function a(g){const t=b(g.xoffset,0);g=b(g.yoffset,0);return Math.sqrt(t*t+g*g)}function f(g,t){return Math.max(g,t)}const d={"simple-marker":1,"picture-marker":1,text:0,"simple-line":0,"simple-fill":0,"picture-fill":0,cim:1,"web-style":1},k=[0,0,0,0],l={sdf:!0,code:99,metrics:x.AVERAGE_GLYPH_MOSAIC_ITEM.metrics,rect:new B(0,0,24,24),page:0,textureBinding:2};A.computePxBuffer=function(g,t,r){return h.apply(this,arguments)};A.getPtMaxVVSize=p;Object.defineProperty(A,
"__esModule",{value:!0})})},"esri/views/2d/layers/graphics/graphicsUtils":function(){define("exports ../../../../core/has ../../../../core/maybe ../../../../core/screenUtils ../../../../chunks/mat2d ../../../../chunks/mat2df32 ../../../../chunks/vec2 ../../../../chunks/vec2f32 ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/boundsUtils ../../../../geometry/support/jsonUtils ../../../../geometry/support/normalizeUtils ../../../../geometry/support/normalizeUtilsCommon ../../../../geometry/support/spatialReferenceUtils ../../../../symbols/cim/CIMSymbolHelper ../../engine/webgl/alignmentUtils ../../engine/webgl/mesh/templates/shapingUtils ../../engine/webgl/util/BidiText".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c,q,n,a,f,d,k){function l(M,N,P,I,O,Q){let T,V;var aa=C.pt2px(P.xoffset);const Z=C.pt2px(P.yoffset),R=v*P.angle;Q*=v;switch(P.type){case "esriSMS":T=V=C.pt2px(P.size);break;case "esriPMS":T=C.pt2px(P.width),V=C.pt2px(P.height)}.04>O&&(I=.04*I/O);P=B.identity(z);B.translate(P,P,m.set(u,M,N));B.rotate(P,P,Q-R);B.scale(P,P,m.set(u,I,-I));B.translate(P,P,m.set(u,aa,-Z));M=[0,0];m.transformMat2d(M,m.set(u,-.5*T,-.5*V),P);N=[0,0];m.transformMat2d(N,m.set(u,-.5*T,.5*V),P);
I=[0,0];m.transformMat2d(I,m.set(u,.5*T,-.5*V),P);aa=[0,0];m.transformMat2d(aa,m.set(u,.5*T,.5*V),P);return{rings:[[M,I,aa,N,M]]}}function g(M,N,P,I,O,Q){var T=a.CIMSymbolHelper.getEnvelope(P.data);if(!T)return null;.04>O&&(I=.04*I/O);O=C.pt2px(T.width);var V=C.pt2px(T.height);P=C.pt2px(T.x);T=C.pt2px(T.y);const aa=0*v,Z=v*Q;Q=B.identity(z);B.translate(Q,Q,m.set(u,M,N));B.rotate(Q,Q,Z-aa);B.scale(Q,Q,m.set(u,I,I));M=[0,0];m.transformMat2d(M,m.set(u,P,T+V),Q);N=[0,0];m.transformMat2d(N,m.set(u,P,T),
Q);I=[0,0];m.transformMat2d(I,m.set(u,P+O,T+V),Q);V=[0,0];m.transformMat2d(V,m.set(u,P+O,T),Q);return{rings:[[M,I,V,N,M]]}}function t(M,N,P,I,O,Q){var T=C.pt2px(P.xoffset),V=C.pt2px(P.yoffset);P=v*P.angle;const aa=v*Q;Q=B.identity(z);B.translate(Q,Q,m.set(u,M,N));B.rotate(Q,Q,aa);B.scale(Q,Q,m.set(u,O,-O));M=I[0]+I[2]/2;N=I[1]+I[3]/2;B.translate(Q,Q,m.set(u,T,-V));B.translate(Q,Q,m.set(u,M,N));B.rotate(Q,Q,P);B.translate(Q,Q,m.set(u,-M,-N));T=[0,0];m.transformMat2d(T,m.set(u,I[0],I[1]),Q);V=[0,0];
m.transformMat2d(V,m.set(u,I[0],I[1]+I[3]),Q);P=[0,0];m.transformMat2d(P,m.set(u,I[0]+I[2],I[1]),Q);M=[0,0];m.transformMat2d(M,m.set(u,I[0]+I[2],I[1]+I[3]),Q);return{rings:[[T,P,M,V,T]]}}function r(M){switch(M.symbol.type){case "esriSFS":case "esriPFS":return(M=M.symbol.outline)?M.width:0;case "esriSLS":return C.pt2px(M.symbol.width);case "esriSMS":M=M.symbol;var N=C.pt2px(M.xoffset),P=C.pt2px(M.yoffset);return C.pt2px(M.size)+Math.sqrt(N*N+P*P);case "esriPMS":return M=M.symbol,N=C.pt2px(M.xoffset),
P=C.pt2px(M.yoffset),C.pt2px(Math.max(M.width,M.height))+Math.sqrt(N*N+P*P);case "esriTS":return N=[0,0,0,0],w(N,M.symbol,M.mosaicItem),Math.max(N[2],N[3])+Math.max(Math.abs(N[0]),Math.abs(N[1]));case "expanded-cim":M=a.CIMSymbolHelper.getEnvelope(M.symbol.data);if(-Infinity===M.width||-Infinity===M.height)M.width=10,M.height=10,M.x=0,M.y=0;return C.pt2px(Math.sqrt(M.width*M.width+M.height*M.height));case "composite-symbol":return M.symbol.layers.length?r({symbol:M.symbol.layers[M.symbol.layers.length-
1],mosaicItem:null}):0;default:return 0}}function w(M,N,P){if(!P||0===P.glyphMosaicItems.length)return M;const I=k.bidiText(N.text)[1];N=d.shapeGlyphs(P.glyphMosaicItems,I,{scale:C.pt2px(N.font.size)/24,angle:N.angle,xOffset:N.xoffset,yOffset:N.yoffset,hAlign:f.getXAnchorDirection(N.horizontalAlignment||"center"),vAlign:f.getYAnchorDirection(N.verticalAlignment||"baseline"),maxLineWidth:Math.max(32,Math.min(N.lineWidth||512,512)),lineHeight:30*Math.max(.25,Math.min(N.lineHeight||1,4)),decoration:N.font.decoration||
"none",isCIM:!1}).bounds;M[0]=C.pt2px(N.x-N.halfWidth);M[1]=C.pt2px(N.y-N.halfHeight);M[2]=C.pt2px(N.width);M[3]=C.pt2px(N.height);return M}const v=Math.PI/180,z=x.create(),u=p.create(),y=p.create(),D=p.create(),G=p.create(),H=p.create(),J=p.create(),K=p.create(),L=p.create();A.PIXEL_BUFFER=50;A.TILE_SIZE=512;A.getBounds=function(M,N,P,I,O,Q,T){if(!I||!P.symbol)return M[0]=M[1]=M[2]=M[3]=0,N[0]=N[1]=N[2]=N[3]=0,M;if(e.isPoint(I)){var V=I.x;const Z=I.y;"esriTS"===P.symbol.type&&0===N[2]&&0===N[3]&&
w(N,P.symbol,P.mosaicItem);I=V;V=Z;P=P.symbol;switch(P.type){case "esriSMS":case "esriPMS":var aa=l(I,V,P,O,Q,0);break;case "esriTS":aa=t(I,V,P,N,O,0);break;case "cim":case "CIMSymbolReference":case "expanded-cim":aa=g(I,V,P,O,Q,0)}N=0;for(O=0;O<aa.rings[0].length-1;O++)P=aa.rings[0][O],P=(I-P[0])*(I-P[0])+(V-P[1])*(V-P[1]),N=Math.max(N,P);N=Math.sqrt(N);aa=c.normalizeMapX(I-N,T);I=c.normalizeMapX(I+N,T);if(aa>I&&(T=n.getInfo(T))){const [R,S]=T.valid;aa=R;I=S}M[0]=aa;M[1]=V-N;M[2]=I;M[3]=V+N}else b.getBoundsXY(M,
I),T=N[0],0===T&&(T=r(P),N[0]=T),T=O*T/2,M[0]-=T,M[1]-=T,M[2]+=T,M[3]+=T;return M};A.getCIMMarkerBounds=g;A.getMarkerSymbolBounds=l;A.getTextSymbolBounds=t;A.getTextSymbolSize=w;A.graphicGeometryToNumber=function(M){switch(E.unwrap(M.geometry).type){case "polyline":return 1;case "polygon":case "extent":return 2}return 0};A.intersectingInternationalDateline=function(M,N){if(!N.isWrappable)return null;const [P,I]=q.getSpatialReferenceMinMaxX(N);return M[2]>I?[h.create([M[0],M[1],I,M[3]]),h.create([P,
M[1],P+M[2]-I,M[3]])]:M[0]<P?[h.create([P,M[1],M[2],M[3]]),h.create([I-(P-M[0]),M[1],I,M[3]])]:null};A.isMarkerSymbol=function(M){return"simple-marker"===M||"picture-marker"===M||"esriSMS"===M||"esriPMS"===M};A.isPointOnPolyline=function(M,N,P,I){m.set(G,N,P);M=M.paths;let O,Q,T,V,aa,Z,R,S=Infinity;for(let X=0;X<M.length;X++){const fa=M[X];if(!(2>fa.length))for(let ea=1;ea<fa.length;ea++){var U=fa[ea-1][0];Q=fa[ea-1][1];O=fa[ea][0];T=fa[ea][1];V=Math.min(U,O)-I;aa=Math.min(Q,T)-I;Z=Math.max(U,O)+
I;R=Math.max(Q,T)+I;N<V||N>Z||P<aa||P>R||(m.set(y,U,Q),m.set(D,O,T),m.subtract(H,D,y),m.subtract(J,y,G),m.scale(K,H,m.dot(H,J)/m.dot(H,H)),m.subtract(L,J,K),U=m.dot(L,L),S>U&&(S=U))}}return Math.sqrt(S)<=I};A.isTextSymbol=function(M){return"text"===M||"esriTS"===M};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/rendererUtils":function(){define(["exports","../../../../../core/Logger","../../../../../core/screenUtils"],function(A,F,E){function C(m){return("size"===
m.type||"color"===m.type||"opacity"===m.type)&&null!=m.stops}function B(m){var p=m.type;var h=m.stops;if(8>=h.length)p=h;else if(x.warn(`Found ${h.length} Visual Variable stops, but MapView only supports ${8}. Displayed stops will be simplified.`),16<h.length){{const [k,...l]=h;var b=l.pop(),e=l[0].value,c=l[l.length-1].value,q=(c-e)/6;const g=[];for(;e<c;e+=q){for(var n=0;e>=l[n].value;)n++;var a=l[n],f=h[n-1],d=e-f.value;a=a.value===f.value?1:d/(a.value-f.value);"color"===p?(f=l[n],n=h[n-1],d=f.color.clone(),
d.r=(1-a)*n.color.r+a*d.r,d.g=(1-a)*n.color.g+a*d.g,d.b=(1-a)*n.color.b+a*d.b,d.a=(1-a)*n.color.a+a*d.a,g.push({value:e,color:d,label:f.label})):"size"===p?(f=l[n],d=h[n-1],n=E.toPt(f.size),d=E.toPt(d.size),g.push({value:e,size:(1-a)*d+a*n,label:f.label})):(f=l[n],g.push({value:e,opacity:(1-a)*h[n-1].opacity+a*f.opacity,label:f.label}))}p=[k,...g,b]}}else{{const [k,...l]=h;for(p=l.pop();6<l.length;){b=h=0;for(c=1;c<l.length;c++)q=Math.abs(l[c].value-l[c-1].value),q>b&&(b=q,h=c);l.splice(h,1)}p=[k,
...l,p]}}m.stops=p;return m}const x=F.getLogger("esri.renderers.visualVariables.support.utils");A.simplifyVVRenderer=m=>{if(!("visualVariables"in m&&m.visualVariables&&m.visualVariables.length))return m;m=m.clone();const p=m.visualVariables.map(h=>C(h)?B(h):h);m.visualVariables=p;return m};A.simplifyVisualVariables=function(m){return m.map(p=>C(p)?B(p.clone()):p)};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/layers/support/clusterUtils":function(){define("exports ../../../../core/Error ../../../../core/has ../../../../core/Logger ../../../../core/maybe ../../../../core/MD5 ../../../../renderers/visualVariables/SizeVariable ../../../../renderers/visualVariables/support/SizeStop ../../engine/LevelDependentSizeVariable".split(" "),
function(A,F,E,C,B,x,m,p,h){function b(g,t,r){switch(g){case "avg":case "avg_angle":return`cluster_avg_${t}`;case "mode":return`cluster_type_${t}`;case "norm":return g=t.toLowerCase()+",norm:field,"+r.toLowerCase(),"cluster_avg_"+x.createMD5Hash(g)}}function e(g,t){const {name:r,outStatistic:w}=t,{onStatisticField:v,onStatisticValueExpression:z,statisticType:u}=w;z?(t=x.createMD5Hash(z.toLowerCase()),g.push({name:r,outStatistic:{onStatisticField:t,onStatisticValueExpression:z,statisticType:u}})):
v?g.push({name:r,outStatistic:{onStatisticField:v,statisticType:u}}):n.error(new F("mapview-unsupported-field","Unable to handle field",{field:t}))}function c(g,t,r){const w=x.createMD5Hash(t),v="mode"===r?`cluster_type_${w}`:`cluster_avg_${w}`;g.some(z=>z.name===v)||g.push({name:v,outStatistic:{onStatisticField:w,onStatisticValueExpression:t,statisticType:r}});return v}function q(g,t,r,w){if("cluster_count"===t||g.some(z=>z.name===t))return t;const v=b(r,t,w);g.some(z=>z.name===v)||("norm"===r?g.push({name:v,
outStatistic:{onStatisticField:t,onStatisticNormalizationField:w,statisticType:r}}):g.push({name:v,outStatistic:{onStatisticField:t,statisticType:r}}));return v}const n=C.getLogger("esri.views.2d.layers.support.clusterUtils");E.add("esri-cluster-arcade-enabled",!0);const a=E("esri-cluster-arcade-enabled"),f=g=>{for(const t of g)if("size"===t.type)return t;return null},d=g=>{for(const t of g)if("cluster_count"===t.field)return!0;return!1},k=(g,t)=>{const r=[new p({value:0,size:0}),new p({value:1})];
if(B.isNone(t))return new m({field:"cluster_count",stops:[...r,new p({value:2,size:0})]});const w=Object.keys(t).reduce((v,z)=>({...v,[z]:[...r,new p({value:Math.max(2,t[z].minValue),size:g.clusterMinSize}),new p({value:Math.max(3,t[z].maxValue),size:g.clusterMaxSize})]}),{});return new h.LevelDependentSizeVariable({field:"cluster_count",levels:w})},l=g=>{const t=r=>n.error(new F("Unsupported-renderer",r,{renderer:g}));if("unique-value"===g.type){if(g.field2||g.field3)return t("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),
!1}else if("class-breaks"===g.type){if(g.normalizationField){const r=g.normalizationType;if("field"!==r)return t(`FeatureReductionCluster does not support a normalizationType of ${r}`),!1}}else if("simple"!==g.type)return t(`FeatureReductionCluster does not support renderers of type ${g.type}`),!1;if(!a){if("valueExpression"in g&&g.valueExpression)return t("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if(("visualVariables"in
g&&g.visualVariables||[]).some(r=>!!("valueExpression"in r&&r.valueExpression)))return t("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),!1}return!0};A.createClusterCountSizeVariable=k;A.createClusterRenderer=(g,t,r,w)=>{t=t.clone();if(!l(t))return t;if(r.fields)for(var v of r.fields)e(g,v);if("visualVariables"in t){v=(t.visualVariables||[]).filter(u=>"$view.scale"!==u.valueExpression);const z=f(v);v.forEach(u=>
{"rotation"===u.type?u.field?u.field=q(g,u.field,"avg_angle"):u.valueExpression&&(u.field=c(g,u.valueExpression,"avg_angle"),u.valueExpression=null):u.normalizationField?(u.field=q(g,u.field,"norm",u.normalizationField),u.normalizationField=null):u.field?u.field=q(g,u.field,"avg"):(u.field=c(g,u.valueExpression,"avg"),u.valueExpression=null)});B.isNone(z)&&!d(v)&&(v.push(k(r,w)),t.dynamicClusterSize=!0);t.visualVariables=v}switch(t.type){case "unique-value":t.field?t.field=q(g,t.field,"mode"):t.valueExpression&&
(t.field=c(g,t.valueExpression,"mode"),t.valueExpression=null);break;case "class-breaks":t.normalizationField?(t.field=q(g,t.field,"norm",t.normalizationField),t.normalizationField=null):t.field?t.field=q(g,t.field,"avg"):(t.field=c(g,t.valueExpression,"avg"),t.valueExpression=null)}return t};A.findSizeVV=f;A.hasClusterCountVV=d;A.isClusterCompatibleRenderer=l;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/core/MD5":function(){define(["exports"],function(A){function F(p,h){const b=(p&65535)+
(h&65535);return(p>>16)+(h>>16)+(b>>16)<<16|b&65535}function E(p,h,b,e,c,q){p=F(F(h,p),F(e,q));return F(p<<c|p>>>32-c,b)}function C(p,h,b,e,c,q,n){return E(h&b|~h&e,p,h,c,q,n)}function B(p,h,b,e,c,q,n){return E(h&e|b&~e,p,h,c,q,n)}function x(p,h,b,e,c,q,n){return E(b^(h|~e),p,h,c,q,n)}const m={Base64:0,Hex:1,String:2,Raw:3};A.createMD5Hash=function(p,h=m.Hex){h=h||m.Base64;var b=[];for(let c=0,q=8*p.length;c<q;c+=8)b[c>>5]|=(p.charCodeAt(c/8)&255)<<c%32;{p=8*p.length;b[p>>5]|=128<<p%32;b[(p+64>>>
9<<4)+14]=p;p=1732584193;var e=-271733879;let c=-1732584194,q=271733878;for(let n=0;n<b.length;n+=16){const a=p,f=e,d=c,k=q;p=C(p,e,c,q,b[n+0],7,-680876936);q=C(q,p,e,c,b[n+1],12,-389564586);c=C(c,q,p,e,b[n+2],17,606105819);e=C(e,c,q,p,b[n+3],22,-1044525330);p=C(p,e,c,q,b[n+4],7,-176418897);q=C(q,p,e,c,b[n+5],12,1200080426);c=C(c,q,p,e,b[n+6],17,-1473231341);e=C(e,c,q,p,b[n+7],22,-45705983);p=C(p,e,c,q,b[n+8],7,1770035416);q=C(q,p,e,c,b[n+9],12,-1958414417);c=C(c,q,p,e,b[n+10],17,-42063);e=C(e,c,
q,p,b[n+11],22,-1990404162);p=C(p,e,c,q,b[n+12],7,1804603682);q=C(q,p,e,c,b[n+13],12,-40341101);c=C(c,q,p,e,b[n+14],17,-1502002290);e=C(e,c,q,p,b[n+15],22,1236535329);p=B(p,e,c,q,b[n+1],5,-165796510);q=B(q,p,e,c,b[n+6],9,-1069501632);c=B(c,q,p,e,b[n+11],14,643717713);e=B(e,c,q,p,b[n+0],20,-373897302);p=B(p,e,c,q,b[n+5],5,-701558691);q=B(q,p,e,c,b[n+10],9,38016083);c=B(c,q,p,e,b[n+15],14,-660478335);e=B(e,c,q,p,b[n+4],20,-405537848);p=B(p,e,c,q,b[n+9],5,568446438);q=B(q,p,e,c,b[n+14],9,-1019803690);
c=B(c,q,p,e,b[n+3],14,-187363961);e=B(e,c,q,p,b[n+8],20,1163531501);p=B(p,e,c,q,b[n+13],5,-1444681467);q=B(q,p,e,c,b[n+2],9,-51403784);c=B(c,q,p,e,b[n+7],14,1735328473);e=B(e,c,q,p,b[n+12],20,-1926607734);p=E(e^c^q,p,e,b[n+5],4,-378558);q=E(p^e^c,q,p,b[n+8],11,-2022574463);c=E(q^p^e,c,q,b[n+11],16,1839030562);e=E(c^q^p,e,c,b[n+14],23,-35309556);p=E(e^c^q,p,e,b[n+1],4,-1530992060);q=E(p^e^c,q,p,b[n+4],11,1272893353);c=E(q^p^e,c,q,b[n+7],16,-155497632);e=E(c^q^p,e,c,b[n+10],23,-1094730640);p=E(e^c^
q,p,e,b[n+13],4,681279174);q=E(p^e^c,q,p,b[n+0],11,-358537222);c=E(q^p^e,c,q,b[n+3],16,-722521979);e=E(c^q^p,e,c,b[n+6],23,76029189);p=E(e^c^q,p,e,b[n+9],4,-640364487);q=E(p^e^c,q,p,b[n+12],11,-421815835);c=E(q^p^e,c,q,b[n+15],16,530742520);e=E(c^q^p,e,c,b[n+2],23,-995338651);p=x(p,e,c,q,b[n+0],6,-198630844);q=x(q,p,e,c,b[n+7],10,1126891415);c=x(c,q,p,e,b[n+14],15,-1416354905);e=x(e,c,q,p,b[n+5],21,-57434055);p=x(p,e,c,q,b[n+12],6,1700485571);q=x(q,p,e,c,b[n+3],10,-1894986606);c=x(c,q,p,e,b[n+10],
15,-1051523);e=x(e,c,q,p,b[n+1],21,-2054922799);p=x(p,e,c,q,b[n+8],6,1873313359);q=x(q,p,e,c,b[n+15],10,-30611744);c=x(c,q,p,e,b[n+6],15,-1560198380);e=x(e,c,q,p,b[n+13],21,1309151649);p=x(p,e,c,q,b[n+4],6,-145523070);q=x(q,p,e,c,b[n+11],10,-1120210379);c=x(c,q,p,e,b[n+2],15,718787259);e=x(e,c,q,p,b[n+9],21,-343485551);p=F(p,a);e=F(e,f);c=F(c,d);q=F(q,k)}b=[p,e,c,q]}switch(h){case m.Raw:return b;case m.Hex:h=[];for(let c=0,q=4*b.length;c<q;c++)h.push("0123456789abcdef".charAt(b[c>>2]>>c%4*8+4&15)+
"0123456789abcdef".charAt(b[c>>2]>>c%4*8&15));return h=h.join("");case m.String:h=[];for(let c=0,q=32*b.length;c<q;c+=8)h.push(String.fromCharCode(b[c>>5]>>>c%32&255));return h=h.join("");case m.Base64:h=[];for(let c=0,q=4*b.length;c<q;c+=3)for(p=(b[c>>2]>>c%4*8&255)<<16|(b[c+1>>2]>>(c+1)%4*8&255)<<8|b[c+2>>2]>>(c+2)%4*8&255,e=0;4>e;e++)8*c+6*e>32*b.length?h.push("\x3d"):h.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(p>>6*(3-e)&63));return h=h.join("")}};A.outputTypes=
m;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/LevelDependentSizeVariable":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ../../../renderers/visualVariables/SizeVariable ../../../renderers/visualVariables/support/sizeVariableUtils".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c){var q;A.LevelDependentSizeVariable=q=function(n){function a(){return n.apply(this,arguments)||this}F._inheritsLoose(a,n);var f=a.prototype;f.writeLevels=function(d,k,l){for(const g in d){k.stops=this.levels[g];break}};f.clone=function(){return new q({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:c.isSizeVariable(this.maxSize)?this.maxSize.clone():this.maxSize,
minDataValue:this.minDataValue,minSize:c.isSizeVariable(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map(d=>d.clone()),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone(),levels:C.clone(this.levels)})};return a}(e);E.__decorate([B.property()],A.LevelDependentSizeVariable.prototype,"levels",void 0);
E.__decorate([b.writer("levels")],A.LevelDependentSizeVariable.prototype,"writeLevels",null);A.LevelDependentSizeVariable=q=E.__decorate([h.subclass("esri.views.2d.engine.LevelDependentSizeVariable")],A.LevelDependentSizeVariable);Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/layers/support/util":function(){define(["exports","../../../../core/jsonMap"],function(A,F){const E=new F.JSONMap({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",
esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});A.analyzeRings=function(C,B,x){const m=[],p=[];let h=0,b=0;for(const e of C){C=b;let c=e[0][0],q=e[0][1];m[b++]=c;m[b++]=q;let n=0;for(let a=1;a<e.length;++a){const f=c,d=q;c=e[a][0];q=e[a][1];n+=q*f-c*d;m[b++]=c;m[b++]=q}B(n/2);0<n?(0<C-h&&(x(h,C,m,p),h=C),p.length=0):0>n?0<C-h?p.push(.5*(C-h)):b=C:b=C}0<b-h&&x(h,b,m,p)};A.toJSONGeometryType=function(C){return E.toJSON(C)};Object.defineProperty(A,"__esModule",{value:!0})})},
"esri/views/2d/engine/webgl/util/Matcher":function(){define("require exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/Logger ../../../../../core/LRUCache ../../../../../support/arcadeOnDemand ../../../../../symbols/cim/cimSymbolUtils ../../../../../symbols/cim/utils ../../../arcade/callExpressionWithFeature ../../../layers/features/schemaUtils".split(" "),function(A,F,E,C,B,x,m,p,h,b,e){function c(r,w,v){return q.apply(this,arguments)}function q(){q=
E._asyncToGenerator(function*(r,w,v){switch(r.type){case "simple":return d.fromBasicRenderer(r,w,v);case "map":return g.fromUVRenderer(r,w,v);case "interval":return l.fromCBRenderer(r,w,v);case "dictionary":return t.fromDictionaryRenderer(r,w,v);case "subtype":return k.fromSubtypes(r,w,v)}});return q.apply(this,arguments)}function n(r,w){return a.apply(this,arguments)}function a(){a=E._asyncToGenerator(function*(r,w){const v=r||1;if("number"===typeof v)return(u,y,D)=>v;const z=yield m.createRendererExpression(v,
w.spatialReference,w.fields);return(u,y,D)=>b(z,u,{$view:D},w.geometryType,y)||1});return a.apply(this,arguments)}const f=B.getLogger("esri/views/2d/engine/webgl/util/Matcher");let d=function(){function r(){this.type="feature";this._defaultResult=null}r.fromBasicRenderer=function(){var v=E._asyncToGenerator(function*(z,u,y){const D=new r;z.symbol&&(z=yield p.expandSymbol(z.symbol,y),u=u.createTemplateGroup(z,null),D.setDefault(u));return D});return function(z,u,y){return v.apply(this,arguments)}}();
var w=r.prototype;w.size=function(){return 1};w.getDefault=function(){return this._defaultResult};w.setDefault=function(v){this._defaultResult=v};w.match=function(v,z,u,y,D){return this.getDefault()};w.analyze=function(){var v=E._asyncToGenerator(function*(z,u,y,D,G){return null});return function(z,u,y,D,G){return v.apply(this,arguments)}}();return r}(),k=function(r){function w(v,z){var u=r.call(this)||this;u._subMatchers=v;u._subtypeField=z;return u}E._inheritsLoose(w,r);w.fromSubtypes=function(){var v=
E._asyncToGenerator(function*(z,u,y){const D=new Map,G=[];for(const H in z.renderers){const J=parseInt(H,10),K=c(z.renderers[H],u,y).then(L=>D.set(J,L));G.push(K)}yield Promise.all(G);return new w(D,z.subtypeField)});return function(z,u,y){return v.apply(this,arguments)}}();w.prototype.match=function(v,z,u,y,D){var G=z.readAttribute(this._subtypeField);return(G=this._subMatchers.get(G))?G.match(v,z,u,y,D):null};return w}(d),l=function(r){function w(z,u,y,D){var G=r.call(this)||this;G.type="interval";
G._intervals=[];G._isMaxInclusive=u;G._fieldIndex=D;G._field=z;G._normalizationInfo=y;return G}E._inheritsLoose(w,r);w.fromCBRenderer=function(){var z=E._asyncToGenerator(function*(u,y,D){const {isMaxInclusive:G,normalizationField:H,normalizationTotal:J,normalizationType:K}=u,L=new w(u.field,G,{normalizationField:H,normalizationTotal:J,normalizationType:K},u.fieldIndex),M=yield p.expandSymbol(u.backgroundFillSymbol,D);yield Promise.all(u.intervals.map(function(){var N=E._asyncToGenerator(function*(P){var I=
yield p.expandSymbol(P.symbol,D);I=yield y.createTemplateGroup(I,M);L.add({min:P.min,max:P.max},I)});return function(P){return N.apply(this,arguments)}}()));if(u=yield p.expandSymbol(u.defaultSymbol,D))u=yield y.createTemplateGroup(u,M),L.setDefault(u);return L});return function(u,y,D){return z.apply(this,arguments)}}();var v=w.prototype;v.add=function(z,u){this._intervals.push({interval:z,result:u});this._intervals.sort((y,D)=>y.interval.min-D.interval.min)};v.size=function(){return r.prototype.size.call(this)+
this._intervals.length};v.match=function(z,u,y,D,G){if(null==this._fieldIndex&&!this._field)return this.getDefault();z=null!=this._fieldIndex?u.getComputedNumericAtIndex(this._fieldIndex):this._getValueFromField(u);if(!z&&(null===z||void 0===z||isNaN(z)))return this.getDefault();for(u=0;u<this._intervals.length;u++){const {interval:H,result:J}=this._intervals[u];y=this._isMaxInclusive?z<=H.max:z<H.max;if(z>=H.min&&y)return J}return this.getDefault()};v._needsNormalization=function(){const z=this._normalizationInfo;
return z&&(z.normalizationField||z.normalizationTotal||z.normalizationType)};v._getValueFromField=function(z){const u=z.readAttribute(this._field);if(!this._needsNormalization()||null==u)return u;const {normalizationField:y,normalizationTotal:D,normalizationType:G}=this._normalizationInfo;z=!!y&&z.readAttribute(y);if(G)switch(G){case "esriNormalizeByField":return(z||void 0)&&u/z;case "esriNormalizeByLog":return Math.log(u)*Math.LOG10E;case "esriNormalizeByPercentOfTotal":return u/D*100;default:f.error(`Found unknown normalization type: ${G}`)}else f.error("Normalization is required, but no type was set!")};
return w}(d),g=function(r){function w(z,u,y){var D=r.call(this)||this;D.type="map";D._nullResult=null;D._resultsMap=new Map;D._fieldsIndex=y;D._fields=z;D._seperator=u||"";return D}E._inheritsLoose(w,r);w.fromUVRenderer=function(){var z=E._asyncToGenerator(function*(u,y,D){const G=u.fieldDelimiter,H=[u.field];u.field2&&H.push(u.field2);u.field3&&H.push(u.field3);const J=yield p.expandSymbol(u.backgroundFillSymbol,D),K=new w(H,G,u.fieldIndex);yield Promise.all(u.map.map(function(){var L=E._asyncToGenerator(function*(M){var N=
yield p.expandSymbol(M.symbol,D);N=yield y.createTemplateGroup(N,J);"\x3cNull\x3e"===M.value?K.setNullResult(N):K.add(M.value,N)});return function(M){return L.apply(this,arguments)}}()));if(u=yield p.expandSymbol(u.defaultSymbol,D))u=yield y.createTemplateGroup(u,J),K.setDefault(u);return K});return function(u,y,D){return z.apply(this,arguments)}}();var v=w.prototype;v.setNullResult=function(z){this._nullResult=z};v.add=function(z,u){this._resultsMap.set(z.toString(),u)};v.size=function(){return r.prototype.size.call(this)+
this._resultsMap.size};v.match=function(z,u,y,D,G){if(null==this._fieldsIndex&&!this._fields)return this.getDefault();z=null!=this._fieldsIndex?u.getComputedStringAtIndex(this._fieldsIndex):this._getValueFromFields(u);if(null!==this._nullResult&&(null==z||""===z||"\x3cNull\x3e"===z))return this._nullResult;if(!z&&null==z)return this.getDefault();z=z.toString();return this._resultsMap.has(z)?this._resultsMap.get(z):this.getDefault()};v._getValueFromFields=function(z){const u=[];for(const y of this._fields){const D=
z.readAttribute(y);null==D||""===D?u.push("\x3cNull\x3e"):u.push(D)}return u.join(this._seperator)};return w}(d),t=function(r){function w(z,u,y,D){var G=r.call(this)||this;G.type="dictionary";G._groupIdCache=new x(100);G._renderer=z;G._fieldMap=z.fieldMap;G._symbolFields=z.getSymbolFields();G._templates=u;G._info=y;G._scaleFn=D;return G}E._inheritsLoose(w,r);w.fromDictionaryRenderer=function(){var z=E._asyncToGenerator(function*(u,y,D){u=(yield new Promise(function(H,J){A(["../../../../../renderers/DictionaryRenderer"],
function(K){H(Object.freeze({__proto__:null,default:K}))},J)})).default.fromJSON(u.renderer);yield u.fetchResources({spatialReference:D.spatialReference,fields:D.fields});const G=yield n(u.scaleExpression,D);return new w(u,y,D,G)});return function(u,y,D){return z.apply(this,arguments)}}();var v=w.prototype;v._analyzeFeature=function(){var z=E._asyncToGenerator(function*(u,y,D,G){u=u.readLegacyFeature();const H=this._scaleFn(u,y,D);y=this._attributeHash(u)+"-"+H;const J=this._groupIdCache.get(y);if(J)return J;
D=yield this._renderer.getSymbolAsync(u,{...D,spatialReference:this._info.spatialReference,abortOptions:G,fields:this._info.fields});D=e.createSymbolSchema(D,this._renderer);G=p.expandSymbol(D,this._info,G).then(K=>{if("expanded-cim"!==K.type)return f.error(new C("mapview-bad-type",`Found unexpected type ${K.type} in dictionary response`)),null;K.hash+="-"+H;for(const L of K.layers)L.scaleFactor=H,L.templateHash+="-"+H,"text"===L.type&&"string"===typeof L.text&&-1<L.text.indexOf("[")&&(L.text=h.createLabelOverrideFunction(this._fieldMap,
L.text,L.cim.textCase));return this._templates.createTemplateGroup(K,null)});this._groupIdCache.put(y,G,1);return G});return function(u,y,D,G){return z.apply(this,arguments)}}();v.analyze=function(){var z=E._asyncToGenerator(function*(u,y,D,G,H){u=y.getCursor();for(y=[];u.next();)y.push(this._analyzeFeature(u,D,G,H));return Promise.all(y)});return function(u,y,D,G,H){return z.apply(this,arguments)}}();v.match=function(z,u,y,D,G){return null};v._attributeHash=function(z){let u="";for(const y of this._symbolFields){const D=
this._fieldMap[y];D&&(u+=z.attributes[D]+"-")}return u};return w}(d);F.DictionaryMatcher=t;F.FeatureMatcher=d;F.IntervalMatcher=l;F.MapMatcher=g;F.SubtypeMatcher=k;F.createMatcher=c;Object.defineProperty(F,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/ComputedAttributeStorage":function(){define(["exports","./displayIdUtils","./StaticBitSet"],function(A,F,E){function C(x,m,p){if(!(x.length>m))for(;x.length<=m;)x.push(p)}let B=function(){function x(){this._numerics=[];this._strings=
[];this._idGenerator=new F.DisplayIdGenerator;this._allocatedSize=256;this._bitsets=[];this._instanceIds=[];this._bounds=[]}var m=x.prototype;m.createBitset=function(){const p=this._bitsets.length;this._bitsets.push(E.StaticBitSet.create(this._allocatedSize,2147483647));return p+1};m.getBitset=function(p){return this._bitsets[p-1]};m._expand=function(){this._allocatedSize<<=1;for(const p of this._bitsets)p.resize(this._allocatedSize)};m._ensureNumeric=function(p,h){this._numerics[p]||(this._numerics[p]=
[]);C(this._numerics[p],h,0)};m._ensureInstanceId=function(p){C(this._instanceIds,p,0)};m._ensureString=function(p,h){this._strings[p]||(this._strings[p]=[]);C(this._strings[p],h,null)};m.createDisplayId=function(p=!1){const h=this._idGenerator.createId();h>this._allocatedSize&&this._expand();return((p?2147483648:0)|h)>>>0};m.releaseDisplayId=function(p){for(const h of this._bitsets)h.unset(p);return this._idGenerator.releaseId(p&2147483647)};m.getComputedNumeric=function(p,h){return this.getComputedNumericAtIndex(p&
2147483647,0)};m.setComputedNumeric=function(p,h,b){return this.setComputedNumericAtIndex(p&2147483647,b,0)};m.getComputedString=function(p,h){return this.getComputedStringAtIndex(p&2147483647,0)};m.setComputedString=function(p,h,b){return this.setComputedStringAtIndex(p&2147483647,0,b)};m.getComputedNumericAtIndex=function(p,h){p&=2147483647;this._ensureNumeric(h,p);return this._numerics[h][p]};m.setComputedNumericAtIndex=function(p,h,b){p&=2147483647;this._ensureNumeric(h,p);this._numerics[h][p]=
b};m.getInstanceId=function(p){p&=2147483647;this._ensureInstanceId(p);return this._instanceIds[p]};m.setInstanceId=function(p,h){p&=2147483647;this._ensureInstanceId(p);this._instanceIds[p]=h};m.getComputedStringAtIndex=function(p,h){p&=2147483647;this._ensureString(h,p);return this._strings[h][p]};m.setComputedStringAtIndex=function(p,h,b){p&=2147483647;this._ensureString(h,p);this._strings[h][p]=b};m.getXMin=function(p){return this._bounds[4*(p&2147483647)]};m.getYMin=function(p){return this._bounds[4*
(p&2147483647)+1]};m.getXMax=function(p){return this._bounds[4*(p&2147483647)+2]};m.getYMax=function(p){return this._bounds[4*(p&2147483647)+3]};m.setBounds=function(p,h){h=h.readHydratedGeometry();if(!h||!h.coords.length)return!1;let b=Infinity,e=Infinity,c=-Infinity,q=-Infinity;h.forEachVertex((n,a)=>{b=Math.min(b,n);e=Math.min(e,a);c=Math.max(c,n);q=Math.max(q,a)});p&=2147483647;C(this._bounds,4*p+4,0);this._bounds[4*p]=b;this._bounds[4*p+1]=e;this._bounds[4*p+2]=c;this._bounds[4*p+3]=q;return!0};
return x}();A.ComputedAttributeStorage=B;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/displayIdUtils":function(){define(["exports"],function(A){let F=function(){function E(){this._freeIds=[];this._idCounter=1}var C=E.prototype;C.createId=function(B=!1){var x=this._getFreeId();return((B?2147483648:0)|x)>>>0};C.releaseId=function(B){this._freeIds.push(B)};C._getFreeId=function(){return this._freeIds.length?this._freeIds.pop():this._idCounter++};return E}();
A.DISPLAY_ID_TYPE_AGGREGATE=1;A.DISPLAY_ID_TYPE_FEATURE=0;A.DisplayIdGenerator=F;A.getDisplayIdIndex=function(E){return E&2147483647};A.getDisplayIdType=function(E){return(E&2147483648)>>>31};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/GraphicsReader":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../geometry/support/jsonUtils ../../../../../layers/graphics/featureConversionUtils ./FeatureSetReader ./FeatureSetReaderJSON".split(" "),
function(A,F,E,C,B,x){x=function(m){function p(b,e){return m.call(this,b,e,null)||this}F._inheritsLoose(p,m);p.from=function(b){const e=B.FeatureSetReader.createInstance(),c=[];b=b.filter(q=>!!q.geometry);for(const q of b)b=E.getJsonType(q.geometry),C.convertFromGraphics(c,[q],b,!1,!1,"uid");return new p(e,c)};var h=p.prototype;h.readGraphic=function(){return this._current};h.getCursor=function(){return this.copy()};h.copy=function(){const b=new p(this.instance,this._features);this.copyInto(b);return b};
F._createClass(p,[{key:"geometryType",get:function(){const b=this._current;return b?b.geometryType:null}},{key:"insertAfter",get:function(){return this._current.insertAfter}}]);return p}(x.FeatureSetReaderJSON);A.GraphicsReader=x;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/FeatureSetReader":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../geometry ../../../../../core/has ../../../../../core/maybe ../../../../../layers/graphics/centroid ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedGeometry ./StaticBitSet ../../../../../geometry/support/jsonUtils".split(" "),
function(A,F,E,C,B,x,m,p,h,b){var e,c;let q=0;E=null!=(e=C("featurelayer-simplify-thresholds"))?e:[.5,.5,.5,.5];const n=E[0],a=E[1],f=E[2],d=E[3];C=null!=(c=C("featurelayer-simplify-payload-size-factors"))?c:[1,2,4];const k=C[0],l=C[1],g=C[2];c=function(){function t(w){this.type="FeatureSetReader";this.seen=!1;this._ty=this._tx=this.instance=0;this._sy=this._sx=1;this._deleted=null;this._joined=[];this._objectIdToIndex=null;this._level=0;this.instance=w}t.createInstance=function(){q++;return q=65535<
q?0:q};var r=t.prototype;r.getAreaSimplificationThreshold=function(w,v){let z=1;4E6<v?z=g:1E6<v?z=l:5E5<v&&(z=k);v=0;4E3<w?v=d*z:2E3<w?v=f*z:100<w?v=a:15<w&&(v=n);w=8;4>this._level?w=1:5>this._level?w=2:6>this._level&&(w=4);return v*w};r.setArcadeSpatialReference=function(w){this._arcadeSpatialReference=w};r.attachStorage=function(w){this._storage=w};r.getQuantizationTransform=function(){throw Error("Unable to find transform for featureSet");};r.getStorage=function(){return this._storage};r.getComputedNumeric=
function(w){return this.getComputedNumericAtIndex(0)};r.setComputedNumeric=function(w,v){return this.setComputedNumericAtIndex(v,0)};r.getComputedString=function(w){return this.getComputedStringAtIndex(0)};r.setComputedString=function(w,v){return this.setComputedStringAtIndex(0,v)};r.getComputedNumericAtIndex=function(w){return this._storage.getComputedNumericAtIndex(this.getDisplayId(),w)};r.setComputedNumericAtIndex=function(w,v){this._storage.setComputedNumericAtIndex(this.getDisplayId(),w,v)};
r.getComputedStringAtIndex=function(w){return this._storage.getComputedStringAtIndex(this.getDisplayId(),w)};r.setComputedStringAtIndex=function(w,v){return this._storage.setComputedStringAtIndex(this.getDisplayId(),w,v)};r.transform=function(w,v,z,u){const y=this.copy();y._tx+=w;y._ty+=v;y._sx*=z;y._sy*=u;return y};r.readAttribute=function(w,v=!1){var z=this._readAttribute(w,v);if(void 0!==z)return z;for(const u of this._joined)if(u.setIndex(this.getIndex()),z=u._readAttribute(w,v),void 0!==z)return z};
r.readAttributes=function(){const w=this._readAttributes();for(const v of this._joined){v.setIndex(this.getIndex());const z=v._readAttributes();for(const u of Object.keys(z))w[u]=z[u]}return w};r.joinAttributes=function(w){this._joined.push(w)};r.readArcadeFeature=function(){return this};r.geometry=function(){var w=this.readHydratedGeometry();w=m.convertToGeometry(w,this.geometryType,this.hasZ,this.hasM);if(w=b.fromJSON(w))w.spatialReference=this._arcadeSpatialReference;return w};r.field=function(w){return this.readAttribute(w,
!0)};r.hasField=function(w){return!0};r.setField=function(w,v){};r.keys=function(){return[]};r.castToText=function(){return""};r.removeIds=function(w){if(B.isNone(this._objectIdToIndex)){var v=new Map;const z=this.getCursor();for(;z.next();)v.set(z.getObjectId(),z.getIndex());this._objectIdToIndex=v}v=this._objectIdToIndex;for(const z of w)v.has(z)&&this.removeAtIndex(v.get(z))};r.removeAtIndex=function(w){B.isNone(this._deleted)&&(this._deleted=h.StaticBitSet.create(this.getSize()));this._deleted.set(w)};
r.readGeometryForDisplay=function(){return this.readUnquantizedGeometry(!0)};r.readLegacyGeometryForDisplay=function(){return this.readLegacyGeometry(!0)};r.features=function*(){const w=this.getCursor();for(;w.next();)yield w.readOptimizedFeature()};r._getExists=function(){return B.isNone(this._deleted)||!this._deleted.has(this.getIndex())};r._computeCentroid=function(){if("esriGeometryPolygon"!==this.geometryType)return null;const w=this.readUnquantizedGeometry();if(!w||w.hasIndeterminateRingOrder)return null;
const v=B.unwrapOr(this.getQuantizationTransform(),null);return x.getCentroidOptimizedGeometry(new p,w,this.hasM,this.hasZ,v)};r.copyInto=function(w){w.seen=this.seen;w._storage=this._storage;w._arcadeSpatialReference=this._arcadeSpatialReference;w._joined=this._joined;w._tx=this._tx;w._ty=this._ty;w._sx=this._sx;w._sy=this._sy;w._deleted=this._deleted;w._objectIdToIndex=this._objectIdToIndex};F._createClass(t,[{key:"isEmpty",get:function(){return B.isSome(this._deleted)&&this._deleted.countSet()===
this.getSize()}},{key:"level",set:function(w){this._level=w}}]);return t}();A.FeatureSetReader=c;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/layers/graphics/centroid":function(){define(["exports","../../core/maybe"],function(A,F){function E(B,x,m,p,h,b,e=1){b=h?b?4:3:b?3:2;let c=m,q=m+b,n=0,a=0,f=m=0,d=0;for(let k=0,l=p-1;k<l;k++,c+=b,q+=b){p=x[c];const g=x[c+1],t=x[c+2],r=x[q],w=x[q+1],v=x[q+2];let z=p*w-r*g;f+=z;n+=(p+r)*z;a+=(g+w)*z;h&&(z=p*v-r*t,m+=(t+v)*z,d+=z);p<B[0]&&(B[0]=p);
p>B[1]&&(B[1]=p);g<B[2]&&(B[2]=g);g>B[3]&&(B[3]=g);h&&(t<B[4]&&(B[4]=t),t>B[5]&&(B[5]=t))}0<f*e&&(f*=-1);0<d*e&&(d*=-1);if(!f)return null;B=[n,a,.5*f];h&&(B[3]=m,B[4]=.5*d);return B}function C(B,x,m,p,h){h=p?h?4:3:h?3:2;let b=x,e=x+h,c=0,q=0,n=0,a=0;for(let l=0,g=m-1;l<g;l++,b+=h,e+=h){var f=B[b];const t=B[b+1],r=B[b+2],w=B[e],v=B[e+1],z=B[e+2];if(p){{var d=w-f;var k=v-t;const u=z-r;d=Math.sqrt(d*d+k*k+u*u)}}else d=w-f,k=v-t,d=Math.sqrt(d*d+k*k);d&&(c+=d,p?(f=[f+.5*(w-f),t+.5*(v-t),r+.5*(z-r)],q+=
d*f[0],n+=d*f[1],a+=d*f[2]):(f=[f+.5*(w-f),t+.5*(v-t)],q+=d*f[0],n+=d*f[1]))}return 0<c?p?[q/c,n/c,a/c]:[q/c,n/c]:0<m?p?[B[x],B[x+1],B[x+2]]:[B[x],B[x+1]]:null}A.getCentroidOptimizedGeometry=function(B,x,m,p,h){if(F.isNone(x)||!x.lengths.length)return null;const b="upperLeft"===(null==h?void 0:h.originPosition)?-1:1;B.lengths.length&&(B.lengths.length=0);B.coords.length&&(B.coords.length=0);h=B.coords;const e=[],c=m?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,
Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:q,coords:n}=x,a=m?p?4:3:p?3:2;let f=0;for(var d of q){const k=E(c,n,f,d,m,p,b);k&&e.push(k);f+=d*a}e.sort((k,l)=>{let g=b*k[2]-b*l[2];0===g&&m&&(g=k[4]-l[4]);return g});e.length&&(d=6*e[0][2],h[0]=e[0][0]/d,h[1]=e[0][1]/d,m&&(d=6*e[0][4],h[2]=0!==d?e[0][3]/d:0),h[0]<c[0]||h[0]>c[1]||h[1]<c[2]||h[1]>c[3]||m&&(h[2]<c[4]||h[2]>c[5]))&&(h.length=
0);if(!h.length)if(x=x.lengths[0]?C(n,0,q[0],m,p):null)h[0]=x[0],h[1]=x[1],m&&2<x.length&&(h[2]=x[2]);else return null;return B};A.lineCentroid=C;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/FeatureSetReaderJSON":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedFeature ./FeatureSetReader".split(" "),function(A,
F,E,C,B,x){function m({coords:h,lengths:b}){let e=0;for(const c of b){for(b=1;b<c;b++)h[2*(e+b)]+=h[2*(e+b)-2],h[2*(e+b)+1]+=h[2*(e+b)-1];e+=c}}let p=function(h){function b(c,q,n){c=h.call(this,c)||this;c._featureIndex=-1;c._dateFields=new Set;c._geometryType=n;c._features=q;return c}F._inheritsLoose(b,h);b.fromFeatures=function(c,q,n){n=C.convertFromFeatures([],c,q,!1,!1,n);for(let a=0;a<n.length;a++)n[a].displayId=c[a].displayId;return b.fromOptimizedFeatures(n,q)};b.fromFeatureSet=function(c,q){c=
C.convertFromFeatureSet(c,q);return b.fromOptimizedFeatureSet(c)};b.fromOptimizedFeatureSet=function(c){const {features:q,geometryType:n}=c,a=b.fromOptimizedFeatures(q,n);a._exceededTransferLimit=c.exceededTransferLimit;a._transform=c.transform;for(const f of c.fields)"esriFieldTypeDate"===f.type&&a._dateFields.add(f.name);return a};b.fromOptimizedFeatures=function(c,q,n){const a=x.FeatureSetReader.createInstance();c=new b(a,c,q);c._transform=n;return c};var e=b.prototype;e.removeIds=function(c){const q=
new Set(c);this._features=this._features.filter(n=>!q.has(n.objectId))};e.append=function(c){for(const q of c)this._features.push(q)};e.getSize=function(){return this._features.length};e.getCursor=function(){return this.copy()};e.getQuantizationTransform=function(){return this._transform};e.getAttributeHash=function(){let c="";for(const q in this._current.attributes)c+=this._current.attributes[q];return c};e.getIndex=function(){return this._featureIndex};e.setIndex=function(c){this._featureIndex=
c};e.getObjectId=function(){return this._current.objectId};e.getDisplayId=function(){return this._current.displayId};e.setDisplayId=function(c){this._current.displayId=c};e.getGroupId=function(){return this._current.groupId};e.setGroupId=function(c){this._current.groupId=c};e.copy=function(){const c=new b(this.instance,this._features,this.geometryType);this.copyInto(c);return c};e.next=function(){for(;++this._featureIndex<this._features.length&&!this._getExists(););return this._featureIndex<this._features.length};
e.readLegacyFeature=function(){return C.convertToFeature(this._current,this.geometryType,this.hasZ,this.hasM)};e.readOptimizedFeature=function(){return this._current};e.readLegacyPointGeometry=function(){return this.readGeometry()?{x:this.getX(),y:this.getY()}:null};e.readLegacyGeometry=function(){const c=this.readGeometry();return C.convertToGeometry(c,this.geometryType,this.hasZ,this.hasM)};e.readLegacyCentroid=function(){const c=this.readCentroid();return E.isNone(c)?null:{x:c.coords[0]*this._sx+
this._tx,y:c.coords[1]*this._sy+this._ty}};e.readGeometryArea=function(){return B.hasGeometry(this._current)?C.getQuantizedArea(this._current.geometry,2):0};e.readUnquantizedGeometry=function(){var c=this.readGeometry();if("esriGeometryPoint"===this.geometryType||!c)return c;c=c.clone();m(c);return c};e.readHydratedGeometry=function(){var c=this._current.geometry;if(E.isNone(c))return null;c=c.clone();E.isSome(this._transform)&&C.unquantizeOptimizedGeometry(c,c,this.hasZ,this.hasM,this._transform);
return c};e.getXHydrated=function(){if(!B.hasGeometry(this._current))return 0;const c=this._current.geometry.coords[0],q=this.getQuantizationTransform();return E.isNone(q)?c:c*q.scale[0]+q.translate[0]};e.getYHydrated=function(){if(!B.hasGeometry(this._current))return 0;const c=this._current.geometry.coords[1],q=this.getQuantizationTransform();return E.isNone(q)?c:q.translate[1]-c*q.scale[1]};e.getX=function(){return B.hasGeometry(this._current)?this._current.geometry.coords[0]*this._sx+this._tx:
0};e.getY=function(){return B.hasGeometry(this._current)?this._current.geometry.coords[1]*this._sy+this._ty:0};e.readGeometry=function(){if(!B.hasGeometry(this._current))return null;const c=this._current.geometry.clone();if(c.isPoint)return c.coords[0]=c.coords[0]*this._sx+this._tx,c.coords[1]=c.coords[1]*this._sy+this._ty,c;let q=0;for(const n of c.lengths)c.coords[2*q]=c.coords[2*q]*this._sx+this._tx,c.coords[2*q+1]=c.coords[2*q+1]*this._sy+this._ty,q+=n;return c};e.readCentroid=function(){if(!B.hasGeometry(this._current))return null;
if(!this._current.centroid){var c=this._computeCentroid();if(!c)return null;c.coords[0]=(c.coords[0]-this._tx)/this._sx;c.coords[1]=(c.coords[1]-this._ty)/this._sy;this._current.centroid=c}c=this._current.centroid.clone();c.coords[0]=c.coords[0]*this._sx+this._tx;c.coords[1]=c.coords[1]*this._sx+this._ty;return c};e._readAttribute=function(c,q){var n=this._current.attributes[c];if(void 0!==n)return null!=n&&q&&this._dateFields.has(c)?new Date(n):n;n=this.readAttributes();c=c.toLocaleLowerCase().trim();
for(const a in n)if(a.toLocaleLowerCase().trim()===c)return c=this._current.attributes[a],null!=c&&q&&this._dateFields.has(a)?new Date(c):c};e.copyInto=function(c){h.prototype.copyInto.call(this,c);c._featureIndex=this._featureIndex;c._transform=this._transform;c._dateFields=this._dateFields};e._readAttributes=function(){return this._current.attributes};F._createClass(b,[{key:"_current",get:function(){return this._features[this._featureIndex]}},{key:"geometryType",get:function(){return this._geometryType}},
{key:"hasFeatures",get:function(){return!!this._features.length}},{key:"hasNext",get:function(){return this._featureIndex+1<this._features.length}},{key:"exceededTransferLimit",get:function(){return this._exceededTransferLimit}},{key:"hasZ",get:function(){return!1}},{key:"hasM",get:function(){return!1}}]);return b}(x.FeatureSetReader);A.FeatureSetReaderJSON=p;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/layers/graphics/GraphicStore":function(){define("../../../../core/screenUtils ../../../../core/unitUtils ../../../../chunks/rbush ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/contains ../../../../geometry/support/extentUtils ../../../../geometry/support/jsonUtils ../../../../geometry/support/normalizeUtils ../../../../geometry/support/normalizeUtilsCommon ../../../../geometry/support/spatialReferenceUtils ../../../../symbols/cim/utils ./GraphicStoreItem ./graphicsUtils".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c,q){function n(k,l,g,t,r){f.minX=l;f.minY=g;f.maxX=t;f.maxY=r;return k.search(f)}function a(k){return{minX:k.bounds[0],minY:k.bounds[1],maxX:k.bounds[2],maxY:k.bounds[3]}}const f={minX:0,minY:0,maxX:0,maxY:0},d=C.create();return function(){function k(g,t,r,w,v,z){this._graphics=w;this._onAdd=v;this._onRemove=z;this._index=E.rbush(9,a);this._itemByGraphic=new Map;this._currentLevel=-Infinity;this._tileInfoView=g;this._uidFieldName=r;if(t=g.getClosestInfoForScale(t))this._currentLevel=
t.level,this._resolution=this._tileInfoView.getTileResolution(t.level);this._metersPerUnit=b.isValid(g.spatialReference)?F.getMetersPerUnit(g.spatialReference):1}var l=k.prototype;l.hitTest=function(g,t,r,w,v){g=p.normalizeMapX(g,this._tileInfoView.spatialReference);var z=.5*w*r;d[0]=g-z;d[1]=t-z;d[2]=g+z;d[3]=t+z;r=.5*w*(r+q.PIXEL_BUFFER);var u=n(this._index,g-r,t-r,g+r,t+r);if(!u||0===u.length)return[];r={x:g,y:t};z=[];for(const D of u)if(D.graphic.visible)switch(m.getJsonType(D.geometry)){case "esriGeometryPoint":{u=
D.symbol;if(!u)continue;const {x:G,y:H}=D.geometry;var y=w*this._metersPerUnit;let J;switch(u.type){case "esriTS":J=q.getTextSymbolBounds(G,H,u,D.size,w,v);break;case "expanded-cim":J=q.getCIMMarkerBounds(G,H,u,w,y,v);break;case "esriSMS":case "esriPMS":J=q.getMarkerSymbolBounds(G,H,u,w,y,v)}B.polygonContainsPoint(J,r)&&z.push(D)}break;case "esriGeometryPolyline":u=D.symbol;y=0;if("expanded-cim"===u.type){u=u.layers;if(!u||0===u.length)continue;y=u.findIndex(G=>"line"===G.type);if(-1===y)continue;
y=e.evaluateValueOrFunction(u[y].width,null,null)}else{u=u.layers;if(!u||0===u.length)continue;y=u[0].width}u=1.5*w*window.devicePixelRatio*A.pt2px(y);q.isPointOnPolyline(D.geometry,g,t,u)&&z.push(D);break;case "esriGeometryEnvelope":u=D.geometry;u=C.fromValues(u.xmin,u.ymin,u.xmax,u.ymax);C.intersects(u,d)&&z.push(D);break;case "esriGeometryPolygon":if(B.polygonContainsPoint(D.geometry,r)){z.push(D);break}u=x.getPolygonExtent(D.geometry);if(Math.abs(u.ymax-u.ymin)<5*w||Math.abs(u.xmax-u.xmin)<5*
w)u=C.fromValues(u.xmin,u.ymin,u.xmax,u.ymax),C.intersects(u,d)&&z.push(D);break;case "esriGeometryMultipoint":{u=D.symbol;if(!u)continue;y=D.geometry.points;let G;for(let H=0;H<y.length;H++)if(G="esriTS"===u.type?q.getTextSymbolBounds(y[H][0],y[H][1],u,D.size,w,v):q.getMarkerSymbolBounds(y[H][0],y[H][1],u,w,w*this._metersPerUnit,v),B.polygonContainsPoint(G,r)){z.push(D);break}}}z.sort((D,G)=>{const H=q.graphicGeometryToNumber(D.graphic),J=q.graphicGeometryToNumber(G.graphic);return H===J?G.zorder-
D.zorder:H-J});return z.map(D=>D.graphic)};l.getGraphicsData=function(g,t,r){const w=this._searchForItems(t);if(0===w.length||0===r.length)return[];w.sort((G,H)=>G.zorder-H.zorder);w[0].insertAfter=-1;for(var v=1;v<w.length;v++)w[v].insertAfter=w[v-1].graphic.uid;w.sort((G,H)=>G.graphic.uid-H.graphic.uid);r.sort((G,H)=>G.uid-H.uid);let z=v=0,u;const y=[],D={originPosition:"upperLeft",scale:[t.resolution,t.resolution],translate:[t.bounds[0],t.bounds[3]]};for(const G of r){for(z=-2;v<w.length;)if(u=
w[v],v++,G.uid===u.graphic.uid){z=u.insertAfter;break}if(!u.geometry||-2===z)continue;r=u.getGeometryQuantized(D,t.bounds,this._tileInfoView.spatialReference);const H={...u.graphic.attributes};H[this._uidFieldName]=G.uid;null==u.groupId&&(u.groupId=g.createTemplateGroup(u.symbol,null));y.push({centroid:c.getCentroidQuantized(u,D),geometry:r,attributes:H,symbol:u.symbol,groupId:u.groupId,insertAfter:z,zorder:u.zorder})}y.sort((G,H)=>G.zorder-H.zorder);return y};l.queryTileData=function(g,t){if(0===
this._graphics.length)return[];const {bounds:r,resolution:w}=t,v=this._searchForItems(t),z=[];if(0===v.length)return z;this._createTileGraphics(z,g,v,{originPosition:"upperLeft",scale:[w,w],translate:[r[0],r[3]]},t);return z};l.has=function(g){return this._itemByGraphic.has(g)};l.getBounds=function(g){return this._itemByGraphic.has(g)?this._itemByGraphic.get(g).bounds:null};l.addOrModify=function(g,t,r){if(g)return this.has(g)&&this.remove(g),this._onAdd(g),t=c.acquire(g,t,r,this._resolution,this._resolution*
this._metersPerUnit,this._tileInfoView.spatialReference),this._itemByGraphic.set(g,t),r&&this._index.insert(t),t.bounds};l.remove=function(g){if(this._itemByGraphic.has(g)){this._onRemove(g);var t=this._itemByGraphic.get(g);this._index.remove(t);this._itemByGraphic.delete(g)}};l.updateZ=function(){const g=this._graphics.items;for(let r=0;r<g.length;r++){var t=g[r];if(t=this._itemByGraphic.get(t))t.zorder=r}};l.update=function(g,t,r){const w=this._itemByGraphic.get(g);w.groupId=null;const v=C.clone(w.bounds);
w.size[0]=w.size[1]=0;this._index.remove(w);w.set(g,t,r,this._resolution,this._resolution*this._metersPerUnit,this._tileInfoView.spatialReference);r&&this._index.insert(w);return{oldBounds:v,newBounds:w.bounds}};l.updateLevel=function(g){if(this._currentLevel!==g){this._currentLevel=g;var t=this._tileInfoView;this._resolution=t.getTileResolution(g);this._index.clear();g=this._itemByGraphic;var r=[];for(const [,w]of g)w.updateBounds(this._resolution,this._resolution*this._metersPerUnit,t.spatialReference),
w.geometry&&r.push(w);this._index.load(r)}};l.clear=function(){this._itemByGraphic.clear();this._index.clear()};l._createTileGraphics=function(g,t,r,w,v){const z=this._uidFieldName,u=this._tileInfoView.spatialReference;({bounds:v}=v);r.sort((J,K)=>J.zorder-K.zorder);let y,D,G,H;for(let J=0;J<r.length;J++){G=r[J];y=G.graphic;D=G.getGeometryQuantized(w,v,u);H=0===J?-1:r[J-1].graphic.uid;const K={...G.graphic.attributes};K[z]=y.uid;null==G.groupId&&(G.groupId=t.createTemplateGroup(G.symbol,null));g.push({centroid:c.getCentroidQuantized(G,
w),geometry:D,attributes:K,symbol:G.symbol,groupId:G.groupId,insertAfter:H,zorder:G.zorder})}};l._searchForItems=function(g){var t=this._tileInfoView.spatialReference,r=g.bounds;if(t.isWrappable){const [w,v]=h.getSpatialReferenceMinMaxX(t);t=1E-5>Math.abs(r[2]-v);const z=1E-5>Math.abs(r[0]-w);if(!(t&&z||!t&&!z))return g=g.resolution,g=t?C.create([w,r[1],w+g*q.PIXEL_BUFFER,r[3]]):C.create([v-g*q.PIXEL_BUFFER,r[1],v,r[3]]),r=n(this._index,r[0],r[1],r[2],r[3]),g=n(this._index,g[0],g[1],g[2],g[3]),[...new Set([...r,
...g])]}return n(this._index,r[0],r[1],r[2],r[3])};return k}()})},"esri/views/2d/layers/graphics/GraphicStoreItem":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/centroid ../../../../geometry/support/jsonUtils ../../../../geometry/support/normalizeUtilsCommon ../../../../geometry/support/quantizationUtils ../../../../layers/graphics/featureConversionUtils ../../../../layers/graphics/OptimizedGeometry ./graphicsUtils".split(" "),
function(A,F,E,C,B,x,m,p,h,b){function e(n){n.coords.length=0;n.lengths.length=0}const c=new h,q=new h;h=function(){function n(){this.bounds=E.create();this.graphic=null;this.size=[0,0,0,0]}n.acquire=function(f=null,d,k,l,g,t){let r;0===n._pool.length?r=new n:(r=n._pool.pop(),this._set.delete(r));r.acquire(f,d,k,l,g,t);return r};n.release=function(f){f&&!this._set.has(f)&&(f.release(),this._pool.push(f),this._set.add(f))};n.getCentroidQuantized=function(f,d){if(B.isPolygon(f.geometry)){const k=f.symbol;
if(F.isNone(k))return null;if(b.isMarkerSymbol(k.type)||b.isTextSymbol(k.type))return f=C.polygonCentroid(f.geometry),m.quantizePoint(d,{},{x:f[0],y:f[1]},!1,!1)}return null};var a=n.prototype;a.acquire=function(f=null,d,k,l,g,t){f&&this.set(f,d,k,l,g,t)};a.release=function(){this.geometry=this.symbolResource=this.graphic=null};a.set=function(f,d,k,l,g,t){this.graphic=f;this.geometry=k;this.symbolResource=d;this.resolution=l;this.updateBounds(l,g,t)};a.updateBounds=function(f,d,k){b.getBounds(this.bounds,
this.size,this.symbolResource,this.geometry,f,d,k)};a.getGeometryQuantized=function(f,d,k){const l=this.geometry;if(B.isPolygon(l)){if(k=l.rings,1===k.length&&2===k[0].length)return m.quantizeGeometry(f,{paths:[[k[0][0],k[0][1]]]})}else{if(B.isPolyline(l))return e(c),e(q),p.convertFromPolyline(c,l),p.generalizeOptimizedGeometry(q,c,l.hasZ,l.hasM,"esriGeometryPolyline",f.scale[0]),p.quantizeOptimizedGeometry(c,q,l.hasZ,l.hasM,"esriGeometryPolyline",f),p.convertToPolyline(c,l.hasZ,l.hasM);if(B.isMultipoint(l)){const g=
this.resolution*this.size[0],[t,r]=x.getSpatialReferenceMinMaxX(k),w=r-t;k=l.points.filter(v=>{if(v[0]+g>r||v[0]-g<t){const z=[...v];z[0]=v[0]+g>r?z[0]-w:z[0]+w;return E.containsPointWithMargin(d,v,g)||E.containsPointWithMargin(d,z,g)}return E.containsPointWithMargin(d,v,g)});return 0===k.length?{points:k}:m.quantizeGeometry(f,{points:k})}}return m.quantizeGeometry(f,this.geometry)};A._createClass(n,[{key:"symbol",get:function(){return this.symbolResource.symbol}}]);return n}();h._pool=[];h._set=
new Set;return h})},"esri/views/layers/GraphicsView":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Identifiable ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/accessorSupport/decorators/subclass".split(" "),function(A,F,E,C,B,x,m,p,h){A.GraphicsView=b=>{b=function(e){function c(){var q=e.apply(this,arguments)||this;q.graphics=null;q.renderer=null;return q}F._inheritsLoose(c,
e);return c}(C.IdentifiableMixin(b));E.__decorate([B.property()],b.prototype,"graphics",void 0);E.__decorate([B.property()],b.prototype,"renderer",void 0);E.__decorate([B.property()],b.prototype,"updating",void 0);E.__decorate([B.property()],b.prototype,"view",void 0);return b=E.__decorate([h.subclass("esri.views.layers.GraphicsView")],b)};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/layers/graphics/GraphicContainer":function(){define(["../../../../chunks/_rollupPluginBabelHelpers",
"../../engine/webgl/enums","./BaseGraphicContainer"],function(A,F,E){return function(C){function B(){return C.apply(this,arguments)||this}A._inheritsLoose(B,C);var x=B.prototype;x.renderChildren=function(m){this.attributeView.bindTextures(m.context,!1);this.children.some(p=>p.hasData)&&(C.prototype.renderChildren.call(this,m),m.drawPhase===F.WGLDrawPhase.MAP&&this._renderChildren(m),this.hasHighlight()&&m.drawPhase===F.WGLDrawPhase.HIGHLIGHT&&this._renderHighlight(m))};x._renderHighlight=function(m){var {painter:p}=
m;p=p.effects.highlight;p.bind(m);this._renderChildren(m,p.defines);p.draw(m);p.unbind()};return B}(E)})},"esri/views/2d/layers/graphics/BaseGraphicContainer":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","../../engine/FeatureContainer"],function(A,F){return function(E){function C(x){x=E.call(this,x)||this;x.hasHighlight=()=>!0;return x}A._inheritsLoose(C,E);var B=C.prototype;B.onTileData=function(x,m){x.patch(m);this.contains(x)||this.addChild(x);this.requestRender()};B.onTileError=
function(x){x.clear();this.contains(x)||this.addChild(x)};B._renderChildren=function(x,m){for(const p of this.children)p.isReady&&p.hasData&&(p.commit(x),x.context.setStencilFunction(514,p.stencilRef,255),p._displayList.replay(x,p,m))};A._createClass(C,[{key:"hasLabels",get:function(){return!1}}]);return C}(F.FeatureContainer)})},"esri/views/2d/engine/FeatureContainer":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/promiseUtils ../../../core/Queue ./webgl/AttributeStoreView ./webgl/TileContainer ./webgl/WGLRendererInfo".split(" "),
function(A,F,E,C,B,x,m){x=function(p){function h(e){var c=p.call(this,e)||this;c._rendererInfo=new m.WGLRendererInfo;c._materialItemsRequestQueue=new C;c.attributeView=new B.AttributeStoreView(()=>c.onAttributeStoreUpdate());return c}F._inheritsLoose(h,p);var b=h.prototype;b.destroy=function(){this.removeAllChildren();this.children.forEach(e=>e.destroy());this.attributeView.destroy();this._materialItemsRequestQueue.clear()};b.setRendererInfo=function(e,c,q){this._rendererInfo.setInfo(e,c,q);this.requestRender()};
b.getMaterialItems=function(){var e=F._asyncToGenerator(function*(c,q){if(!c||0===c.length)return null;const n=E.createResolver();this._materialItemsRequestQueue.push({items:c,abortOptions:q,resolver:n});this.requestRender();return n.promise});return function(c,q){return e.apply(this,arguments)}}();b.doRender=function(e){e.context.capabilities.enable("textureFloat");e.context.capabilities.enable("vao");if(0<this._materialItemsRequestQueue.length){let c=this._materialItemsRequestQueue.pop();for(;c;)this._processMaterialItemRequest(e,
c),c=this._materialItemsRequestQueue.pop()}p.prototype.doRender.call(this,e)};b.renderChildren=function(e){for(const c of this.children)c.commit(e);this._rendererInfo.update(e.state);p.prototype.renderChildren.call(this,e)};b.createRenderParams=function(e){e=p.prototype.createRenderParams.call(this,e);e.rendererInfo=this._rendererInfo;e.attributeView=this.attributeView;return e};b.onAttributeStoreUpdate=function(){};b._processMaterialItemRequest=function(e,{items:c,abortOptions:q,resolver:n}){const {painter:a,
pixelRatio:f}=e;e=c.map(d=>a.textureManager.rasterizeItem(d.symbol,f,d.glyphIds,q));Promise.all(e).then(d=>{this.stage?(d=d.map((k,l)=>({id:c[l].id,mosaicItem:k})),n.resolve(d)):n.reject()},n.reject)};return h}(x["default"]);A.FeatureContainer=x;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/AttributeStoreView":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Error ../../../../core/has ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../webgl/BufferObject ../../../webgl/FramebufferObject ../../../webgl/checkWebGLError ../../../webgl/enums ../../../../chunks/builtins ../../../webgl/renderState ../../../webgl/Texture ../../../webgl/VertexArrayObject ./definitions ./Utils ./util/debug".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c,q,n,a,f,d,k){const l=B.getLogger("esri.views.2d.engine.webgl.AttributeStoreView"),g=k.createDebugLogger(k.DEBUG_ATTR_UPDATES,l);let t=function(){function r(v,z,u){this._lastTexture=this._texture=null;this._fbos={};this.texelSize=4;const {buffer:y,pixelType:D,textureOnly:G}=v;v=d.getPixelArrayCtor(D);this.shared=u;this.pixelType=D;this.size=z;this.textureOnly=G;G||(this.data=new v(x.unwrap(y)));this._resetRange()}var w=r.prototype;w.destroy=function(){x.andThen(this._texture,
v=>v.dispose());for(const v in this._fbos)x.andThen(this._fbos[v],z=>{"0"===v&&z.detachColorTexture();z.dispose()}),this._fbos[v]=null;this._texture=null};w.setData=function(v,z,u){v&=2147483647;const y=x.unwrap(this.data);z=v*this.texelSize+z;!y||z>=y.length||(y[z]=u,this.dirtyStart=Math.min(this.dirtyStart,v),this.dirtyEnd=Math.max(this.dirtyEnd,v))};w.getData=function(v,z){if(x.isNone(this.data))return null;v=(v&2147483647)*this.texelSize+z;return!this.data||v>=this.data.length?null:this.data[v]};
w.getTexture=function(v){return x.unwrapOr(this._texture,()=>this._initTexture(v))};w.getFBO=function(v,z=0){if(x.isNone(this._fbos[z])){const u=0===z?this.getTexture(v):this._textureDesc;this._fbos[z]=new h(v,{colorTarget:0,depthStencilTarget:0},u)}return this._fbos[z]};w.updateTexture=function(v,z){if(!this.locked){try{const u=this.dirtyStart,y=this.dirtyEnd;if(!this.hasDirty)return;this._resetRange();const D=x.unwrap(this.data).buffer,G=this.getTexture(v),H=(u-u%this.size)/this.size,J=(y-y%this.size)/
this.size,K=H*this.size*4,L=4*(this.size+J*this.size)-K,M=d.getPixelArrayCtor(this.pixelType),N=new M(D,K*M.BYTES_PER_ELEMENT,L),P=this.size;v=J-H+1;if(v>this.size){l.error(new E("mapview-webgl","Out-of-bounds index when updating AttributeData"));return}G.updateData(0,0,H,P,v,N)}catch(u){}z()}};w.update=function(v){const {data:z,start:u,end:y}=v;if(x.isSome(z)){const D=this.data,G=u*this.texelSize;for(let H=0;H<z.length;H++)v.layout&1<<H%this.texelSize&&(D[G+H]=z[H])}this.dirtyStart=Math.min(this.dirtyStart,
u);this.dirtyEnd=Math.max(this.dirtyEnd,y)};w.resize=function(v,z){const u=this.size;this.size=z;this.textureOnly?u!==this.size&&(this._lastTexture=this._texture,this._texture=null):(z=d.getPixelArrayCtor(this.pixelType),this.destroy(),this.data=new z(x.unwrap(v.buffer)))};w._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};w._initTexture=function(v){const z=new n(v,this._textureDesc,x.unwrapOr(this.data,void 0));if(x.isSome(this._lastTexture)&&this._fbos[0]){const D=this._lastTexture.descriptor.width,
G=this._lastTexture.descriptor.height,H=this._lastTexture.descriptor.dataType,J=this._lastTexture.descriptor.pixelFormat,K=this.getFBO(v);var u=d.getPixelBytes(H),y=d.getPixelArrayCtor(H);u=new ArrayBuffer(D*G*u*this.texelSize);y=new y(u);u=v.getBoundFramebufferObject();const {x:L,y:M,width:N,height:P}=v.getViewport();v.bindFramebuffer(K);K.readPixels(0,0,D,G,J,H,y);z.updateData(0,0,0,2*D,G/2,y);v.setViewport(L,M,N,P);v.bindFramebuffer(u)}this.destroy();return this._texture=z};F._createClass(r,[{key:"_textureDesc",
get:function(){return{target:3553,wrapMode:33071,pixelFormat:6408,dataType:this.pixelType,samplingMode:9728,width:this.size,height:this.size}}},{key:"locked",get:function(){return 5121===this.pixelType&&this.shared&&!this.textureOnly&&C("esri-atomics")&&this.data?1===Atomics.load(this.data,0):!1}},{key:"hasDirty",get:function(){return this.dirtyEnd>=this.dirtyStart}}]);return r}();B=function(){function r(v){this._onUpdate=v;this._locked=this._forceNextUpload=this._initialized=!1}var w=r.prototype;
w.initialize=function(v){const {blocks:z,shared:u,size:y}=v;this.shared=u;this.size=y;g("Initializing AttributeStoreView",v);if(x.isNone(this._data))this._data=x.mapMany(z,D=>new t(D,y,u));else for(v=0;v<this._data.length;v++){const D=this._data[v],G=z[v];x.isSome(G)&&(x.isNone(D)?this._data[v]=new t(G,y,u):D.resize(G,y))}this._initialized=!0};w.destroy=function(){x.andThen(this._data,v=>x.mapMany(v,z=>z.destroy()));x.andThen(this._defaultTexture,v=>v.dispose())};w.isUpdating=function(){if(x.isNone(this._data))return!0;
const v=x.isSome(this._pendingAttributeUpdate);C("esri-2d-log-updating")&&console.log(`Updating AttributeStoreView ${v}\n  -> hasPendingUpdate ${v}`);return v};w.getBlock=function(v){return x.isNone(this._data)?null:this._data[v]};w.setLabelMinZoom=function(v,z){this.setData(v,0,1,z)};w.getLabelMinZoom=function(v){return this.getData(v,0,1,255)};w.getFilterFlags=function(v){return this.getData(v,0,0,0)};w.getVVSize=function(v){return this.getData(v,f.ATTRIBUTE_DATA_VV,0,0)};w.getData=function(v,z,
u,y){if(!this._data)return 0;z=x.unwrap(this._data)[z];if(x.isNone(z))return 0;v=z.getData(v,u);return x.isSome(v)?v:y};w.setData=function(v,z,u,y){z=x.unwrap(this._data)[z];x.unwrap(z).setData(v,u,y)};w.lockTextureUpload=function(){this._locked=!0};w.unlockTextureUpload=function(){this._locked=!1};w.forceTextureUpload=function(){this._forceNextUpload=!0};w.requestUpdate=function(){var v=F._asyncToGenerator(function*(z){if(this._pendingAttributeUpdate)l.error(new E("mapview-webgl","Tried to update attribute data with a pending update"));
else{var u=m.createResolver();g("AttributeStoreView Update Requested",z);this._pendingAttributeUpdate={data:z,resolver:u};return u.promise}});return function(z){return v.apply(this,arguments)}}();w.update=function(){if(this._initialized&&x.isSome(this._pendingAttributeUpdate)){const {data:v,resolver:z}=this._pendingAttributeUpdate,u=x.unwrap(this._data);for(let y=0;y<v.blocks.length;y++){const D=v.blocks[y];x.andThen(u[y],G=>x.andThen(D,H=>{g(`Updating block ${y}`,H);G.update(H)}))}this._pendingAttributeUpdate=
null;z();this._onUpdate()}};w.bindTextures=function(v,z=!0){this.update();const u=this._getDefaultTexture(v);if(this._initialized){var y=x.unwrap(this._data);if(!this._locked||this._forceNextUpload)x.forEachSome(y,D=>D.updateTexture(v,()=>this._onUpdate())),this._forceNextUpload=!1;v.bindTexture(x.mapOr(y[0],u,D=>D.getTexture(v)),f.TEXTURE_BINDING_ATTRIBUTE_DATA_0);z&&(v.bindTexture(x.mapOr(y[1],u,D=>D.getTexture(v)),f.TEXTURE_BINDING_ATTRIBUTE_DATA_1),v.bindTexture(x.mapOr(y[2],u,D=>D.getTexture(v)),
f.TEXTURE_BINDING_ATTRIBUTE_DATA_2),v.bindTexture(x.mapOr(y[3],u,D=>D.getTexture(v)),f.TEXTURE_BINDING_ATTRIBUTE_DATA_3))}else v.bindTexture(u,f.TEXTURE_BINDING_ATTRIBUTE_DATA_0),z&&(v.bindTexture(u,f.TEXTURE_BINDING_ATTRIBUTE_DATA_1),v.bindTexture(u,f.TEXTURE_BINDING_ATTRIBUTE_DATA_2),v.bindTexture(u,f.TEXTURE_BINDING_ATTRIBUTE_DATA_3))};w._getDefaultTexture=function(v){x.isNone(this._defaultTexture)&&(this._defaultTexture=new n(v,{wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,
width:1,height:1},new Uint8Array(4)));return this._defaultTexture};return r}();A.AttributeStoreView=B;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/TileContainer":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ./enums ./WGLContainer ./brushes/WGLBrushInfo ./brushes/WGLBrushStencil".split(" "),function(A,F,E,C,B,x,m){const p=(h,b)=>0!==h.key.level-b.key.level?h.key.level-b.key.level:0!==h.key.row-b.key.row?h.key.row-b.key.row:
h.key.col-b.key.col;B=function(h){function b(c){var q=h.call(this)||this;q._tileInfoView=c;return q}F._inheritsLoose(b,h);var e=b.prototype;e.renderChildren=function(c){this.sortChildren(p);this.setStencilReference();h.prototype.renderChildren.call(this,c)};e.createRenderParams=function(c){const {state:q}=c;c=h.prototype.createRenderParams.call(this,c);c.requiredLevel=this._tileInfoView.getClosestInfoForScale(q.scale).level;c.displayLevel=this._tileInfoView.tileInfo.scaleToZoom(q.scale);return c};
e.prepareRenderPasses=function(c){const q=h.prototype.prepareRenderPasses.call(this,c);q.push(c.registerRenderPass({name:"stencil",brushes:[m],drawPhase:C.WGLDrawPhase.DEBUG|C.WGLDrawPhase.MAP|C.WGLDrawPhase.HIGHLIGHT,target:()=>this.getStencilTarget()}));E("esri-tiles-debug")&&q.push(c.registerRenderPass({name:"tileInfo",brushes:[x],drawPhase:C.WGLDrawPhase.DEBUG,target:()=>this.children}));return q};e.getStencilTarget=function(){return this.children};e.updateTransforms=function(c){for(const q of this.children){const n=
this._tileInfoView.getTileResolution(q.key);q.setTransform(c,n)}};e.setStencilReference=function(){let c=1;for(const q of this.children)q.stencilRef=c++};F._createClass(b,[{key:"requiresDedicatedFBO",get:function(){return!1}}]);return b}(B);A["default"]=B;A.sortByLevel=p;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/WGLContainer":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/maybe ../../../../chunks/mat3f32 ../brushes ../Container ./ClippingInfo ./enums".split(" "),
function(A,F,E,C,B,x,m,p){return function(h){function b(){var c=h.apply(this,arguments)||this;c.name=c.constructor.name;return c}A._inheritsLoose(b,h);var e=b.prototype;e._createTransforms=function(){return{dvs:C.create()}};e.doRender=function(c){const q=this.createRenderParams(c),{painter:n,globalOpacity:a,profiler:f,drawPhase:d}=q,k=d===p.WGLDrawPhase.LABEL?1:a*this.computedOpacity;f.recordContainerStart(this.name);n.beforeRenderLayer(q,this._clippingInfos?255:0,k);this.updateTransforms(c.state);
this.renderChildren(q);n.compositeLayer(q,k);f.recordContainerEnd()};e.renderChildren=function(c){E.isNone(this._renderPasses)&&(this._renderPasses=this.prepareRenderPasses(c.painter));for(const q of this.children)q.beforeRender(c);for(const q of this._renderPasses)try{q.render(c)}catch(n){}for(const q of this.children)q.afterRender(c)};e.createRenderParams=function(c){c.requireFBO=this.requiresDedicatedFBO;return c};e.prepareRenderPasses=function(c){return[c.registerRenderPass({name:"clip",brushes:[B.brushes.clip],
target:()=>this._clippingInfos,drawPhase:p.WGLDrawPhase.MAP|p.WGLDrawPhase.LABEL|p.WGLDrawPhase.LABEL_ALPHA|p.WGLDrawPhase.DEBUG|p.WGLDrawPhase.HIGHLIGHT})]};e.updateTransforms=function(c){for(const q of this.children)q.setTransform(c)};e.onAttach=function(){h.prototype.onAttach.call(this);this._updateClippingInfo()};e.onDetach=function(){h.prototype.onDetach.call(this);this._updateClippingInfo()};e._updateClippingInfo=function(){E.isSome(this._clippingInfos)&&(this._clippingInfos.forEach(q=>q.destroy()),
this._clippingInfos=null);if(this.stage){var c=this._clips;E.isSome(c)&&c.length&&(this._clippingInfos=c.items.map(q=>m.fromClipArea(this.stage,q)));this.requestRender()}};A._createClass(b,[{key:"clips",set:function(c){this._clips=c;this.children.forEach(q=>q.clips=c);this._updateClippingInfo()}}]);return b}(x.Container)})},"esri/views/2d/engine/webgl/ClippingInfo":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../chunks/mat3f32 ../DisplayObject ./Mesh2D ../../../webgl/VertexArrayObject".split(" "),
function(A,F,E,C,B,x,m,p){const h=E.getLogger("esri.views.2d.engine.webgl.ClippingInfo");return function(b){function e(q,n){var a=b.call(this)||this;a._clip=n;a._cache={};a.stage=q;a._handle=n.watch("version",()=>a._invalidate());a.ready();return a}A._inheritsLoose(e,b);e.fromClipArea=function(q,n){return new e(q,n)};var c=e.prototype;c._destroyGL=function(){C.isSome(this._cache.mesh)&&(this._cache.mesh.destroy(),this._cache.mesh=null);C.isSome(this._cache.vao)&&(this._cache.vao.dispose(),this._cache.vao=
null)};c.destroy=function(){this._destroyGL();this._handle.remove()};c.getVAO=function(q,n,a,f){const [d,k]=n.size;if("geometry"===this._clip.type||this._lastWidth!==d||this._lastHeight!==k)this._lastWidth=d,this._lastHeight=k,this._destroyGL();if(C.isNone(this._cache.vao)){n=this._createMesh(n,this._clip);const l=n.getIndexBuffer(q),g=n.getVertexBuffers(q);this._cache.mesh=n;this._cache.vao=new p(q,a,f,g,l)}return this._cache.vao};c._createTransforms=function(){return{dvs:B.create()}};c._invalidate=
function(){this._destroyGL();this.requestRender()};c._createScreenRect=function(q,n){const [a,f]=q.size;q="string"===typeof n.left?parseFloat(n.left)/100*a:n.left;const d="string"===typeof n.right?parseFloat(n.right)/100*a:n.right,k="string"===typeof n.top?parseFloat(n.top)/100*f:n.top;n="string"===typeof n.bottom?parseFloat(n.bottom)/100*f:n.bottom;return{x:q,y:k,width:Math.max(a-d-q,0),height:Math.max(f-n-k,0)}};c._createMesh=function(q,n){switch(n.type){case "rect":return m.fromRect(this._createScreenRect(q,
n));case "path":return m.fromPath(n);case "geometry":return m.fromGeometry(q,n);default:return h.error(new F("mapview-bad-type","Unable to create ClippingInfo mesh from clip of type: ${clip.type}")),m.fromRect({x:0,y:0,width:1,height:1})}};return e}(x.DisplayObject)})},"esri/views/2d/engine/webgl/Mesh2D":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../chunks/earcut ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../../../../layers/graphics/featureConversionUtils ../../../../layers/graphics/OptimizedGeometry ./number ../../../webgl/BufferObject".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e){const c=E.getLogger("esri.views.2d.engine.webgl.Mesh2D"),q=({coords:n,lengths:a},f)=>{const d=[];for(let g=0,t=0;g<a.length;t+=a[g],g+=1){const r=t;for(var k=[];g<a.length-1;g+=1,t+=a[g]){{var l=t+a[g];let w=0;for(let v=1;v<a[g+1];v++)w+=(n[2*(l+v)]-n[2*(l+v-1)])*(n[2*(l+v)+1]+n[2*(l+v-1)+1]);l=f?0<w:0>w}if(!l)break;k.push(t+a[g]-r)}l=n.slice(2*r,2*(t+a[g]));k=B.earcut(l,k,2);for(const w of k)d.push(w+r)}return d};return function(){function n(f,d,k,l=!1){this._cache=
{};this.vertices=f;this.indices=d;this.primitiveType=k;this.isMapSpace=l}n.fromRect=function({x:f,y:d,width:k,height:l}){return n.fromScreenExtent({xmin:f,ymin:d,xmax:f+k,ymax:d+l})};n.fromPath=function(f){var d=p.convertFromNestedArray(new h,f.path,!1,!1);f=d.coords;d=new Uint32Array(q(d,!0));const k=new Uint32Array(f.length/2);for(let l=0;l<k.length;l++)k[l]=b.i1616to32(Math.floor(f[2*l]),Math.floor(f[2*l+1]));return new n({geometry:k},d,4)};n.fromGeometry=function(f,d){const k=d.geometry.type;
switch(k){case "polygon":return n.fromPolygon(f,d.geometry);case "extent":return n.fromMapExtent(f,d.geometry);default:return c.error(new F("mapview-bad-type",`Unable to create a mesh from type ${k}`,d)),n.fromRect({x:0,y:0,width:1,height:1})}};n.fromPolygon=function(f,d){var k=p.convertFromPolygon(new h,d,!1,!1);d=k.coords;k=new Uint32Array(q(k,!1));const l=new Uint32Array(d.length/2),g=m.create(),t=m.create();for(let r=0;r<l.length;r++)x.set(g,d[2*r],d[2*r+1]),f.toScreen(t,g),l[r]=b.i1616to32(Math.floor(t[0]),
Math.floor(t[1]));return new n({geometry:l},k,4,!0)};n.fromScreenExtent=function({xmin:f,xmax:d,ymin:k,ymax:l}){f={geometry:new Uint32Array([b.i1616to32(f,k),b.i1616to32(d,k),b.i1616to32(f,l),b.i1616to32(f,l),b.i1616to32(d,k),b.i1616to32(d,l)])};d=new Uint32Array([0,1,2,3,4,5]);return new n(f,d,4)};n.fromMapExtent=function(f,d){const [k,l]=f.toScreen([0,0],[d.xmin,d.ymin]),[g,t]=f.toScreen([0,0],[d.xmax,d.ymax]);f={geometry:new Uint32Array([b.i1616to32(k,l),b.i1616to32(g,l),b.i1616to32(k,t),b.i1616to32(k,
t),b.i1616to32(g,l),b.i1616to32(g,t)])};d=new Uint32Array([0,1,2,3,4,5]);return new n(f,d,4)};var a=n.prototype;a.destroy=function(){C.isSome(this._cache.indexBuffer)&&this._cache.indexBuffer.dispose();for(const f in this._cache.vertexBuffers)C.isSome(this._cache.vertexBuffers[f])&&this._cache.vertexBuffers[f].dispose()};a.getIndexBuffer=function(f,d=35044){this._cache.indexBuffer||(this._cache.indexBuffer=e.createIndex(f,d,this.indices));return this._cache.indexBuffer};a.getVertexBuffers=function(f,
d=35044){this._cache.vertexBuffers||(this._cache.vertexBuffers=Object.keys(this.vertices).reduce((k,l)=>({...k,[l]:e.createVertex(f,d,this.vertices[l])}),{}));return this._cache.vertexBuffers};A._createClass(n,[{key:"elementType",get:function(){a:switch(this.indices.BYTES_PER_ELEMENT){case 1:var f=5121;break a;case 2:f=5123;break a;case 4:f=5125;break a;default:throw new F("Cannot get DataType of array");}return f}}]);return n}()})},"esri/views/2d/engine/webgl/WGLRendererInfo":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../Color ../../../../core/maybe ../../../../core/screenUtils ../../../../core/unitUtils ../../../../renderers/support/lengthUtils ./definitions ./Utils ../../../webgl/capabilities".split(" "),
function(A,F,E,C,B,x,m,p,h,b){function e(n,a){const f=a.length;if(n<a[0].value||1===f)return a[0].size;for(let d=1;d<f;d++)if(n<a[d].value)return a[d-1].size+(n-a[d-1].value)/(a[d].value-a[d-1].value)*(a[d].size-a[d-1].size);return a[f-1].size}function c(n,a,f=0){if(C.isNone(a))n[f+0]=0,n[f+1]=0,n[f+2]=0,n[f+3]=0;else{var {r:d,g:k,b:l,a:g}=a;n[f+0]=d*g/255;n[f+1]=k*g/255;n[f+2]=l*g/255;n[f+3]=g}}let q=function(){function n(){this.symbolLevels=[];this.vvColorValues=new Float32Array(8);this.vvColors=
new Float32Array(32);this.vvOpacityValues=new Float32Array(8);this.vvOpacities=new Float32Array(8);this.vvSizeMinMaxValue=new Float32Array(4);this.ddColors=new Float32Array(32);this.ddBackgroundColor=new Float32Array(4);this.ddActiveDots=new Float32Array(8);this._vvMaterialParameters={vvSizeEnabled:!1,vvColorEnabled:!1,vvRotationEnabled:!1,vvRotationType:"geographic",vvOpacityEnabled:!1}}var a=n.prototype;a.getSizeVVFieldStops=function(f){const d=this._vvSizeFieldStops;switch(d.type){case "static":return d;
case "level-dependent":return C.unwrapOr(d.levels[f],()=>{var k=Infinity,l=0;for(var g in d.levels){const t=parseFloat(g),r=Math.abs(f-t);r<k&&(k=r,l=t)}if(Infinity===k)return{sizes:new Float32Array([0,0,0,0,0,0]),values:new Float32Array([0,0,0,0,0,0])};k=2**((f-l)/2);l=C.unwrap(d.levels[l]);g=new Float32Array(l.values);g[2]*=k;g[3]*=k;return{sizes:C.unwrap(l.sizes),values:g}})}};a.update=function(f){C.isSome(this._vvInfo)&&this._updateVisualVariables(this._vvInfo.vvRanges,f)};a.setInfo=function(f,
d,k){C.isSome(k)&&k.forEach(l=>this._updateEffects(l));this._vvInfo=d;switch(f.type){case "dot-density":this._updateDotDensityInfo(f)}};a.getVariation=function(){return{ddDotBlending:this.ddDotBlending,outsideLabelsVisible:this.outsideLabelsVisible,oesTextureFloat:b().supportsTextureFloat}};a.getVariationHash=function(){return(this.ddDotBlending?1:0)|(this.outsideLabelsVisible?1:0)<<1};a._updateEffects=function(f){C.isSome(f)&&f.filter&&f.filter.enabled&&(this.outsideLabelsVisible=f.excludedLabelsVisible)};
a._updateVisualVariables=function(f,d){const k=this._vvMaterialParameters;k.vvOpacityEnabled=!1;k.vvSizeEnabled=!1;k.vvColorEnabled=!1;k.vvRotationEnabled=!1;if(f){var l=f.size;if(l){k.vvSizeEnabled=!0;if(l.minMaxValue){const t=l.minMaxValue;let r;if(h.isDefined(t.minSize)&&h.isDefined(t.maxSize))if(h.isNumber(t.minSize)&&h.isNumber(t.maxSize)){r=B.pt2px(t.minSize);var g=B.pt2px(t.maxSize)}else g=d.scale,r=B.pt2px(e(g,t.minSize.stops)),g=B.pt2px(e(g,t.maxSize.stops));this.vvSizeMinMaxValue.set([t.minDataValue,
t.maxDataValue,r,g])}l.scaleStops&&(this.vvSizeScaleStopsValue=B.pt2px(e(d.scale,l.scaleStops.stops)));l.unitValue&&(this.vvSizeUnitValueToPixelsRatio=x.getMetersPerUnitForSR(d.spatialReference)/m.meterIn[l.unitValue.unit]/d.resolution);l.fieldStops&&(this._vvSizeFieldStops=l.fieldStops)}if(d=f.color)k.vvColorEnabled=!0,this.vvColorValues.set(d.values),this.vvColors.set(d.colors);if(d=f.opacity)k.vvOpacityEnabled=!0,this.vvOpacityValues.set(d.values),this.vvOpacities.set(d.opacities);if(f=f.rotation)k.vvRotationEnabled=
!0,k.vvRotationType=f.type}};a._updateDotDensityInfo=function(f){var d=f.attributes;this.ddDotValue=f.dotValue;this.ddDotScale=f.referenceScale;this.ddDotSize=f.dotSize;this.ddDotBlending=f.dotBlendingEnabled;this.ddSeed=f.seed;for(let k=0;k<p.DOT_DENSITY_MAX_FIELDS;k++){const l=k>=d.length?new E([0,0,0,0]):d[k].color;c(this.ddColors,l,4*k)}for(d=0;8>d;d++)this.ddActiveDots[d]=d<f.attributes.length?1:0;c(this.ddBackgroundColor,f.backgroundColor)};F._createClass(n,[{key:"vvMaterialParameters",get:function(){return this._vvMaterialParameters}}]);
return n}();A.WGLRendererInfo=q;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/navigation/MapViewNavigation":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Viewpoint ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../../../geometry/Point ../viewpointUtils ./ZoomBox ./actions/Pan ./actions/Pinch ./actions/Rotate".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c,q,n,a){const f=new E({targetGeometry:new b}),d=[0,0];E=function(k){function l(t){t=k.call(this,t)||this;t._endTimer=null;t.animationManager=null;return t}A._inheritsLoose(l,k);var g=l.prototype;g.initialize=function(){this.pan=new q({navigation:this});this.rotate=new a({navigation:this});this.pinch=new n({navigation:this});this.zoomBox=new c({view:this.view,navigation:this})};g.destroy=function(){this.zoomBox.destroy();this.animationManager=this.zoomBox=null};g.begin=
function(){this._set("interacting",!0)};g.end=function(){this._lastEventTimestamp=performance.now();this._startTimer(250)};g.zoom=function(){var t=A._asyncToGenerator(function*(r,w=this._getDefaultAnchor()){this.stop();this.begin();if(this.view.constraints.snapToZoom&&this.view.constraints.effectiveLODs)return 1>r?this.zoomIn(w):this.zoomOut(w);this.setViewpoint(w,r,0,[0,0])});return function(r){return t.apply(this,arguments)}}();g.zoomIn=function(){var t=A._asyncToGenerator(function*(r){var w=this.view;
w=w.constraints.snapToNextScale(w.scale);return this._zoomToScale(w,r)});return function(r){return t.apply(this,arguments)}}();g.zoomOut=function(){var t=A._asyncToGenerator(function*(r){var w=this.view;w=w.constraints.snapToPreviousScale(w.scale);return this._zoomToScale(w,r)});return function(r){return t.apply(this,arguments)}}();g.setViewpoint=function(t,r,w,v){this.begin();this.view.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,t,r,w,v);this.end()};g.setViewpointImmediate=
function(t,r=0,w=[0,0],v=this._getDefaultAnchor()){this.view.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,v,t,r,w)};g.continousRotateClockwise=function(){const t=this.get("view.viewpoint");this.animationManager.animateContinous(t,r=>{e.rotateBy(r,r,-1)})};g.continousRotateCounterclockwise=function(){const t=this.get("view.viewpoint");this.animationManager.animateContinous(t,r=>{e.rotateBy(r,r,1)})};g.resetRotation=function(){this.view.rotation=0};g.continousPanLeft=function(){this._continuousPan([-10,
0])};g.continousPanRight=function(){this._continuousPan([10,0])};g.continousPanUp=function(){this._continuousPan([0,10])};g.continousPanDown=function(){this._continuousPan([0,-10])};g.stop=function(){this.pan.stopMomentumNavigation();this.animationManager.stop();this.end();null!==this._endTimer&&(clearTimeout(this._endTimer),this._endTimer=null,this._set("interacting",!1))};g._continuousPan=function(t){const r=this.get("view.viewpoint");this.animationManager.animateContinous(r,w=>{e.translateBy(w,
w,t);this.view.constraints.constrainByGeometry(w)})};g._startTimer=function(t){return null!==this._endTimer?this._endTimer:this._endTimer=setTimeout(()=>{this._endTimer=null;const r=performance.now()-this._lastEventTimestamp;250>r?this._endTimer=this._startTimer(r):this._set("interacting",!1)},t)};g._getDefaultAnchor=function(){const {size:t,padding:{left:r,right:w,top:v,bottom:z}}=this.view;d[0]=.5*(t[0]-w+r);d[1]=.5*(t[1]-z+v);return d};g._zoomToScale=function(){var t=A._asyncToGenerator(function*(r,
w=this._getDefaultAnchor()){const {view:v}=this,{constraints:z,scale:u,viewpoint:y,size:D,padding:G}=v,H=z.canZoomInTo(r),J=z.canZoomOutTo(r);if(!(r<u&&!H||r>u&&!J))return e.padAndScaleAndRotateBy(f,y,r/u,0,w,D,G),z.constrainByGeometry(f),v.goTo(f,{animate:!0})});return function(r){return t.apply(this,arguments)}}();g._scaleRotateTranslateViewpoint=function(t,r,w,v,z){var {view:u}=this;const {size:y,padding:D,constraints:G,scale:H,viewpoint:J}=u;var K=H*w;u=G.canZoomInTo(K);K=G.canZoomOutTo(K);if(1>
w&&!u||1<w&&!K)w=1;e.translateBy(J,J,z);e.padAndScaleAndRotateBy(t,J,w,v,r,y,D);return G.constrainByGeometry(t)};return l}(C);F.__decorate([B.property()],E.prototype,"animationManager",void 0);F.__decorate([B.property({type:Boolean,readOnly:!0})],E.prototype,"interacting",void 0);F.__decorate([B.property()],E.prototype,"pan",void 0);F.__decorate([B.property()],E.prototype,"pinch",void 0);F.__decorate([B.property()],E.prototype,"rotate",void 0);F.__decorate([B.property()],E.prototype,"view",void 0);
F.__decorate([B.property()],E.prototype,"zoomBox",void 0);return E=F.__decorate([h.subclass("esri.views.2d.navigation.MapViewNavigation")],E)})},"esri/views/2d/navigation/ZoomBox":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/screenUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../../input/InputManager".split(" "),
function(A,F,E,C,B,x,m,p,h,b){E=function(e){function c(n){n=e.call(this,n)||this;n._container=null;n._overlay=null;n._backgroundShape=null;n._boxShape=null;n._box={x:0,y:0,width:0,height:0};n._redraw=n._redraw.bind(A._assertThisInitialized(n));return n}A._inheritsLoose(c,e);var q=c.prototype;q.destroy=function(){this.view=null};q._start=function(){this._createContainer();this._createOverlay();this.navigation.begin()};q._update=function(n,a,f,d){this._box.x=n;this._box.y=a;this._box.width=f;this._box.height=
d;this._rafId||(this._rafId=requestAnimationFrame(this._redraw))};q._end=function(n,a,f,d,k){const l=this.view;n=l.toMap(C.createScreenPoint(n+.5*f,a+.5*d));f=Math.max(f/l.width,d/l.height);-1===k&&(f=1/f);this._destroyOverlay();this.navigation.end();l.goTo({center:n,scale:l.scale*f})};q._updateBox=function(n,a,f,d){const k=this._boxShape;k.setAttributeNS(null,"x",""+n);k.setAttributeNS(null,"y",""+a);k.setAttributeNS(null,"width",""+f);k.setAttributeNS(null,"height",""+d);k.setAttributeNS(null,"class",
"esri-zoom-box__outline")};q._updateBackground=function(n,a,f,d){this._backgroundShape.setAttributeNS(null,"d",this._toSVGPath(n,a,f,d,this.view.width,this.view.height))};q._createContainer=function(){const n=document.createElement("div");n.className="esri-zoom-box__container";this.view.root.appendChild(n);this._container=n};q._createOverlay=function(){var n=this.view.width,a=this.view.height;const f=document.createElementNS("http://www.w3.org/2000/svg","path");f.setAttributeNS(null,"d","M 0 0 L "+
n+" 0 L "+n+" "+a+" L 0 "+a+" Z");f.setAttributeNS(null,"class","esri-zoom-box__overlay-background");n=document.createElementNS("http://www.w3.org/2000/svg","rect");a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink");a.setAttributeNS(null,"class","esri-zoom-box__overlay");a.appendChild(f);a.appendChild(n);this._container.appendChild(a);this._backgroundShape=f;this._boxShape=n;this._overlay=a};
q._destroyOverlay=function(){this._container&&this._container.parentNode&&this._container.parentNode.removeChild(this._container);this._container=this._backgroundShape=this._boxShape=this._overlay=null};q._toSVGPath=function(n,a,f,d,k,l){f=n+f;d=a+d;return"M 0 0 L "+k+" 0 L "+k+" "+l+" L 0 "+l+" ZM "+n+" "+a+" L "+n+" "+d+" L "+f+" "+d+" L "+f+" "+a+" Z"};q._handleDrag=function(n,a){var f=n.x,d=n.y,k=n.origin.x;const l=n.origin.y;let g;f>k?(g=k,k=f-k):(g=f,k-=f);d>l?(f=l,d-=l):(f=d,d=l-d);switch(n.action){case "start":this._start();
break;case "update":this._update(g,f,k,d);break;case "end":this._end(g,f,k,d,a)}n.stopPropagation()};q._redraw=function(){if(this._rafId&&(this._rafId=null,this._overlay)){var {x:n,y:a,width:f,height:d}=this._box;this._updateBox(n,a,f,d);this._updateBackground(n,a,f,d);this._rafId=requestAnimationFrame(this._redraw)}};A._createClass(c,[{key:"view",set:function(n){this._handles&&this._handles.forEach(a=>{a.remove()});this._handles=null;this._destroyOverlay();this._set("view",n);n&&(n.on("drag",["Shift"],
a=>this._handleDrag(a,1),b.ViewEventPriorities.INTERNAL),n.on("drag",["Shift","Ctrl"],a=>this._handleDrag(a,-1),b.ViewEventPriorities.INTERNAL))}}]);return c}(E);F.__decorate([B.property()],E.prototype,"navigation",void 0);F.__decorate([B.property()],E.prototype,"view",null);return E=F.__decorate([h.subclass("esri.views.2d.navigation.ZoomBox")],E)})},"esri/views/2d/navigation/actions/Pan":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../geometry ../../../../Viewpoint ../../../../core/Accessor ../../../../core/screenUtils ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/accessorSupport/ensureType ../../../../core/Logger ../../../../core/accessorSupport/decorators/subclass ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../viewpointUtils ../../../navigation/PanPlanarMomentumEstimator ../../../../geometry/Point".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c,q,n,a,f){E=function(d){function k(g){var t=d.call(this,g)||this;t.animationTime=0;t.momentumEstimator=new a.PanPlanarMomentumEstimator(500,6,.92);t.momentum=null;t.tmpMomentum=q.create();t.momentumFinished=!1;t.viewpoint=new C({targetGeometry:new f,scale:0,rotation:0});t.watch("momentumFinished",r=>{r&&t.navigation.stop()});return t}A._inheritsLoose(k,d);var l=k.prototype;l.begin=function(g,t){this.navigation.begin();this.momentumEstimator.reset();this.addToEstimator(t);
this.previousDrag=t};l.update=function(g,t){this.addToEstimator(t);let r=t.center.x,w=t.center.y;const v=this.previousDrag;r=v?v.center.x-r:-r;w=v?w-v.center.y:w;g.viewpoint=n.translateBy(this.viewpoint,g.viewpoint,[r||0,w||0]);this.previousDrag=t};l.end=function(g,t){this.addToEstimator(t);this.momentum=g.navigation.momentumEnabled?this.momentumEstimator.evaluateMomentum():null;this.animationTime=0;if(this.momentum)this.onAnimationUpdate(g);this.previousDrag=null;this.navigation.end()};l.addToEstimator=
function(g){var t=g.center.x;const r=g.center.y,w=x.createScreenPointArray(-t,r);t=q.fromValues(-t,r,0);this.momentumEstimator.add(w,t,.001*g.timestamp)};l.onAnimationUpdate=function(g){this.navigation.animationManager.animateContinous(g.viewpoint,(t,r)=>{this.momentumFinished=!this.momentum||this.momentum.isFinished(this.animationTime);r*=.001;if(!this.momentumFinished){const w=this.momentum.valueDelta(this.animationTime,r);c.scale(this.tmpMomentum,this.momentum.direction,w);n.translateBy(t,t,this.tmpMomentum);
g.constraints.constrainByGeometry(t)}this.animationTime+=r})};l.stopMomentumNavigation=function(){this.momentum&&(this.momentumEstimator.reset(),this.momentum=null,this.navigation.stop())};return k}(B);F.__decorate([m.property()],E.prototype,"momentumFinished",void 0);F.__decorate([m.property()],E.prototype,"viewpoint",void 0);F.__decorate([m.property()],E.prototype,"navigation",void 0);return E=F.__decorate([e.subclass("esri.views.2d.navigation.actions.Pan")],E)})},"esri/views/navigation/PanPlanarMomentumEstimator":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/vec3 ../../chunks/vec3f64 ./FilteredFiniteDifference ./Momentum".split(" "),
function(A,F,E,C,B,x){let m=function(p){function h(b,e,c,q,n){b=p.call(this,b,e,c)||this;b.sceneVelocity=q;b.direction=n;return b}F._inheritsLoose(h,p);h.prototype.value=function(b){return p.prototype.valueFromInitialVelocity.call(this,this.sceneVelocity,b)};return h}(x.Momentum);x=function(){function p(b=300,e=12,c=.84){this.minimumInitialVelocity=b;this.stopVelocity=e;this.friction=c;this.enabled=!0;this.time=new B.FilteredFiniteDifference(.6);this.screen=[new B.FilteredFiniteDifference(.4),new B.FilteredFiniteDifference(.4)];
this.scene=[new B.FilteredFiniteDifference(.6),new B.FilteredFiniteDifference(.6),new B.FilteredFiniteDifference(.6)];this.tmpDirection=C.create()}var h=p.prototype;h.add=function(b,e,c){!this.enabled||this.time.hasLastValue&&.015>this.time.computeDelta(c)||(this.screen[0].update(b[0]),this.screen[1].update(b[1]),this.scene[0].update(e[0]),this.scene[1].update(e[1]),this.scene[2].update(e[2]),this.time.update(c))};h.reset=function(){this.screen[0].reset();this.screen[1].reset();this.scene[0].reset();
this.scene[1].reset();this.scene[2].reset();this.time.reset()};h.evaluateMomentum=function(){if(!this.enabled||!this.screen[0].hasFilteredDelta)return null;var b=this.screen[0].filteredDelta;const e=this.screen[1].filteredDelta;b=Math.sqrt(b*b+e*e)/this.time.filteredDelta;return Math.abs(b)<this.minimumInitialVelocity?null:this.createMomentum(b,this.stopVelocity,this.friction)};h.createMomentum=function(b,e,c){E.set(this.tmpDirection,this.scene[0].filteredDelta,this.scene[1].filteredDelta,this.scene[2].filteredDelta);
const q=E.length(this.tmpDirection);0<q&&E.scale(this.tmpDirection,this.tmpDirection,1/q);return new m(b,e,c,q/this.time.filteredDelta,this.tmpDirection)};return p}();A.PanPlanarMomentum=m;A.PanPlanarMomentumEstimator=x;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/navigation/FilteredFiniteDifference":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers"],function(A,F){let E=function(){function C(x){this.gain=x}var B=C.prototype;B.update=function(x){if(this.hasLastValue){const m=
this.computeDelta(x);this.updateDelta(m)}this.lastValue=x};B.reset=function(){this.filteredDelta=this.lastValue=void 0};B.computeDelta=function(x){return x-this.lastValue};B.updateDelta=function(x){this.filteredDelta=this.hasFilteredDelta?(1-this.gain)*this.filteredDelta+this.gain*x:x};F._createClass(C,[{key:"hasLastValue",get:function(){return void 0!==this.lastValue}},{key:"hasFilteredDelta",get:function(){return void 0!==this.filteredDelta}}]);return C}();A.FilteredFiniteDifference=E;Object.defineProperty(A,
"__esModule",{value:!0})})},"esri/views/navigation/Momentum":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers"],function(A,F){let E=function(){function C(x,m,p){this._initialVelocity=x;this._stopVelocity=m;this._friction=p;this._duration=Math.abs(Math.log(Math.abs(this._initialVelocity)/this._stopVelocity)/Math.log(1-this._friction))}var B=C.prototype;B.isFinished=function(x){return x>this.duration};B.value=function(x){return this.valueFromInitialVelocity(this._initialVelocity,
x)};B.valueDelta=function(x,m){const p=this.value(x);return this.value(x+m)-p};B.valueFromInitialVelocity=function(x,m){m=Math.min(m,this.duration);const p=1-this.friction;return x*(p**m-1)/Math.log(p)};F._createClass(C,[{key:"duration",get:function(){return this._duration}},{key:"friction",get:function(){return this._friction}}]);return C}();A.Momentum=E;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/navigation/actions/Pinch":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../geometry ../../../../Viewpoint ../../../../core/Accessor ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/accessorSupport/ensureType ../../../../core/Logger ../../../../core/accessorSupport/decorators/subclass ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../../viewpointUtils ../../../navigation/RotationMomentumEstimator ../../../navigation/ZoomMomentumEstimator ../../../../geometry/Point".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c,q,n,a,f){E=function(d){function k(g){var t=d.call(this,g)||this;t._animationTime=0;t._momentumFinished=!1;t._rotationMomentumEstimator=new n.RotationMomentumEstimator(.6,.15,.95);t._rotationDirection=1;t._zoomDirection=1;t._zoomMomentumEstimator=new a.ZoomMomentumEstimator;t._zoomOnly=null;t.zoomMomentum=null;t.rotateMomentum=null;t.viewpoint=new C({targetGeometry:new f,scale:0,rotation:0});t.watch("_momentumFinished",r=>{r&&t.navigation.stop()});return t}A._inheritsLoose(k,
d);var l=k.prototype;l.begin=function(g,t){this.navigation.begin();this._rotationMomentumEstimator.reset();this._zoomMomentumEstimator.reset();this._zoomOnly=null;this._previousAngle=this._startAngle=t.angle;this._previousRadius=this._startRadius=t.radius;this._previousCenter=t.center;this._updateTimestamp=null;g.constraints.rotationEnabled&&this.addToRotateEstimator(0,t.timestamp);this.addToZoomEstimator(t,1)};l.update=function(g,t){null===this._updateTimestamp&&(this._updateTimestamp=t.timestamp);
const r=t.angle,w=t.radius,v=t.center,z=Math.abs(180*(r-this._startAngle)/Math.PI),u=Math.abs(w-this._startRadius),y=this._startRadius/w;if(this._previousRadius){const D=w/this._previousRadius;let G=180*(r-this._previousAngle)/Math.PI;this._rotationDirection=0<=G?1:-1;this._zoomDirection=1<=D?1:-1;g.constraints.rotationEnabled?(null===this._zoomOnly&&200<t.timestamp-this._updateTimestamp&&(this._zoomOnly=0<u-z),null===this._zoomOnly||this._zoomOnly?G=0:this.addToRotateEstimator(r-this._startAngle,
t.timestamp)):G=0;this.addToZoomEstimator(t,y);this.navigation.setViewpoint([v.x,v.y],1/D,G,[this._previousCenter.x-v.x,v.y-this._previousCenter.y])}this._previousAngle=r;this._previousRadius=w;this._previousCenter=v};l.end=function(g){this.rotateMomentum=this._rotationMomentumEstimator.evaluateMomentum();this.zoomMomentum=this._zoomMomentumEstimator.evaluateMomentum();this._animationTime=0;if(this.rotateMomentum||this.zoomMomentum)this.onAnimationUpdate(g);this.navigation.end()};l.addToRotateEstimator=
function(g,t){this._rotationMomentumEstimator.add(g,.001*t)};l.addToZoomEstimator=function(g,t){this._zoomMomentumEstimator.add(t,.001*g.timestamp)};l.canZoomIn=function(g){const t=g.scale;g=g.constraints.effectiveMaxScale;return 0===g||t>g};l.canZoomOut=function(g){const t=g.scale;g=g.constraints.effectiveMinScale;return 0===g||t<g};l.onAnimationUpdate=function(g){this.navigation.animationManager.animateContinous(g.viewpoint,(t,r)=>{var w=!this.canZoomIn(g)&&1<this._zoomDirection||!this.canZoomOut(g)&&
1>this._zoomDirection,v=!this.rotateMomentum||this.rotateMomentum.isFinished(this._animationTime);w=w||!this.zoomMomentum||this.zoomMomentum.isFinished(this._animationTime);r*=.001;this._momentumFinished=v&&w;if(!this._momentumFinished){v=this.rotateMomentum?Math.abs(this.rotateMomentum.valueDelta(this._animationTime,r))*this._rotationDirection*180/Math.PI:0;w=this.zoomMomentum?Math.abs(this.zoomMomentum.valueDelta(this._animationTime,r)):1;const u=c.create();var z=c.create();if(this._previousCenter){e.set(u,
this._previousCenter.x,this._previousCenter.y);q.getPaddingScreenTranslation(z,g.size,g.padding);e.add(u,u,z);const {constraints:y,scale:D}=g;z=D*w;1>w&&!y.canZoomInTo(z)?(w=D/y.effectiveMaxScale,this.rotateMomentum=this.zoomMomentum=null):1<w&&!y.canZoomOutTo(z)&&(w=D/y.effectiveMinScale,this.rotateMomentum=this.zoomMomentum=null);q.scaleAndRotateBy(t,g.viewpoint,w,v,u,g.size);g.constraints.constrainByGeometry(t)}}this._animationTime+=r})};l.stopMomentumNavigation=function(){if(this.rotateMomentum||
this.zoomMomentum)this.rotateMomentum&&(this._rotationMomentumEstimator.reset(),this.rotateMomentum=null),this.zoomMomentum&&(this._zoomMomentumEstimator.reset(),this.zoomMomentum=null),this.navigation.stop()};return k}(B);F.__decorate([x.property()],E.prototype,"_momentumFinished",void 0);F.__decorate([x.property()],E.prototype,"viewpoint",void 0);F.__decorate([x.property()],E.prototype,"navigation",void 0);return E=F.__decorate([b.subclass("esri.views.2d.navigation.actions.Pinch")],E)})},"esri/views/navigation/RotationMomentumEstimator":function(){define(["exports",
"../../chunks/_rollupPluginBabelHelpers","./MomentumEstimator"],function(A,F,E){E=function(C){function B(x=3,m=.01,p=.95,h=12){return C.call(this,x,m,p,h)||this}F._inheritsLoose(B,C);B.prototype.add=function(x,m){if(this.value.hasLastValue){const p=this.value.lastValue;for(x-=p;x>Math.PI;)x-=2*Math.PI;for(;x<-Math.PI;)x+=2*Math.PI;x=p+x}C.prototype.add.call(this,x,m)};return B}(E.MomentumEstimator);A.RotationMomentumEstimator=E;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/navigation/MomentumEstimator":function(){define(["exports",
"../../core/mathUtils","./FilteredFiniteDifference","./Momentum"],function(A,F,E,C){let B=function(){function x(p=2.5,h=.01,b=.95,e=12){this.minimumInitialVelocity=p;this.stopVelocity=h;this.friction=b;this.maxVelocity=e;this.enabled=!0;this.value=new E.FilteredFiniteDifference(.8);this.time=new E.FilteredFiniteDifference(.3)}var m=x.prototype;m.add=function(p,h){if(this.enabled){if(this.time.hasLastValue){if(.01>this.time.computeDelta(h))return;if(this.value.hasFilteredDelta){const b=this.value.computeDelta(p);
0>this.value.filteredDelta*b&&this.value.reset()}}this.time.update(h);this.value.update(p)}};m.reset=function(){this.value.reset();this.time.reset()};m.evaluateMomentum=function(){if(!this.enabled||!this.value.hasFilteredDelta)return null;let p=this.value.filteredDelta/this.time.filteredDelta;p=F.clamp(p,-this.maxVelocity,this.maxVelocity);return Math.abs(p)<this.minimumInitialVelocity?null:this.createMomentum(p,this.stopVelocity,this.friction)};m.createMomentum=function(p,h,b){return new C.Momentum(p,
h,b)};return x}();A.MomentumEstimator=B;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/navigation/ZoomMomentumEstimator":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","./Momentum","./MomentumEstimator"],function(A,F,E,C){let B=function(x){function m(h,b,e){return x.call(this,h,b,e)||this}F._inheritsLoose(m,x);var p=m.prototype;p.value=function(h){h=x.prototype.value.call(this,h);return Math.exp(h)};p.valueDelta=function(h,b){const e=x.prototype.value.call(this,
h);h=x.prototype.value.call(this,h+b);return Math.exp(h-e)};return m}(E.Momentum);E=function(x){function m(h=2.5,b=.01,e=.95,c=12){return x.call(this,h,b,e,c)||this}F._inheritsLoose(m,x);var p=m.prototype;p.add=function(h,b){x.prototype.add.call(this,Math.log(h),b)};p.createMomentum=function(h,b,e){return new B(h,b,e)};return m}(C.MomentumEstimator);A.ZoomMomentum=B;A.ZoomMomentumEstimator=E;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/navigation/actions/Rotate":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../geometry ../../../../Viewpoint ../../../../core/Accessor ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/accessorSupport/ensureType ../../../../core/Logger ../../../../core/accessorSupport/decorators/subclass ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../../viewpointUtils ../../../../geometry/Point".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c,q,n){const a=c.create(),f=c.create();E=function(d){function k(g){g=d.call(this,g)||this;g._previousCenter=c.create();g.viewpoint=new C({targetGeometry:new n,scale:0,rotation:0});return g}A._inheritsLoose(k,d);var l=k.prototype;l.begin=function(g,t){this.navigation.begin();e.set(this._previousCenter,t.center.x,t.center.y)};l.update=function(g,t){const {state:{size:r,padding:w}}=g;e.set(a,t.center.x,t.center.y);q.getAnchor(f,r,w);g.viewpoint=q.rotateBy(this.viewpoint,
g.state.paddedViewState.viewpoint,q.angleBetween(f,this._previousCenter,a));e.copy(this._previousCenter,a)};l.end=function(){this.navigation.end()};return k}(B);F.__decorate([x.property()],E.prototype,"viewpoint",void 0);F.__decorate([x.property()],E.prototype,"navigation",void 0);return E=F.__decorate([b.subclass("esri.views.2d.actions.Rotate")],E)})},"esri/views/2d/magnifier/MagnifierView2D":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../request ../../../core/Handles ../../../core/mathUtils ../../../core/maybe ../../../core/promiseUtils ../../../core/urlUtils ../../../core/watchUtils ../../../chunks/mat3f32 ../../webgl/BufferObject ../../webgl/FramebufferObject ../../../core/has ../../webgl/checkWebGLError ../../webgl/enums ../../../chunks/builtins ../../webgl/renderState ../../webgl/Texture ../../webgl/VertexArrayObject ../engine/DisplayObject ../engine/webgl/enums ../engine/webgl/shaders/MagnifierPrograms ../../magnifier/resources".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c,q,n,a,f,d,k,l,g,t,r){return function(w){function v(){var u=w.call(this)||this;u._handles=new E;u._resourcePixelRatio=1;u.visible=!1;return u}A._inheritsLoose(v,w);var z=v.prototype;z.destroy=function(){this._handles.destroy();this._handles=null;this._disposeRenderResources();this._resourcesTask&&(this._resourcesTask.abort(),this._resourcesTask=null)};z._createTransforms=function(){return{dvs:h.create()}};z.doRender=function(u){const y=u.context;if(!this._resourcesTask)this._reloadResources();
else if(u.drawPhase===g.WGLDrawPhase.MAP&&this._canRender()){this._updateResources(u);var D=this._magnifier;if(!B.isNone(D.position)){var G=u.pixelRatio,H=D.size*G,J=Math.ceil(1/D.factor*H);this._readbackTexture.resize(J,J);var {size:K}=u.state;u=G*K[0];K=G*K[1];var L=.5*J,M=.5*J,N=C.clamp(G*D.position.x,L,u-L-1),P=C.clamp(K-G*D.position.y,M,K-M-1);y.setBlendingEnabled(!0);L=N-L;M=P-M;var I=this._readbackTexture;y.bindTexture(I,0);y.gl.copyTexImage2D(I.descriptor.target,0,I.descriptor.pixelFormat,
L,M,J,J,0);var O=(J=null==(O=this.background)?void 0:O.color)?[J.a*J.r/255,J.a*J.g/255,J.a*J.b/255,J.a]:[1,1,1,1];J=-1+(N+D.offset.x*G)/u*2;G=-1+(P-D.offset.y*G)/K*2;u=H/u*2;H=H/K*2;K=this._program;y.bindVAO(this._vertexArrayObject);y.bindTexture(this._overlayTexture,6);y.bindTexture(this._maskTexture,7);y.useProgram(K);K.setUniform4fv("u_background",O);K.setUniform1i("u_readbackTexture",0);K.setUniform1i("u_overlayTexture",6);K.setUniform1i("u_maskTexture",7);K.setUniform4f("u_drawPos",J,G,u,H);
K.setUniform1i("u_maskEnabled",D.maskEnabled?1:0);K.setUniform1i("u_overlayEnabled",D.overlayEnabled?1:0);y.setStencilTestEnabled(!1);y.setColorMask(!0,!0,!0,!0);y.drawArrays(5,0,4);y.bindVAO()}}};z._canRender=function(){return this.mask&&this.overlay&&null!=this._magnifier};z._reloadResources=function(){var u=this;this._resourcesTask&&this._resourcesTask.abort();const y=B.isSome(this._magnifier)?this._magnifier.maskUrl:null,D=B.isSome(this._magnifier)?this._magnifier.overlayUrl:null;this._resourcesTask=
x.createTask(function(){var G=A._asyncToGenerator(function*(H){const J=B.isNone(y)||B.isNone(D)?r.loadMagnifierResources(H):null,K=B.isSome(y)?F(y,{responseType:"image",signal:H}).then(N=>N.data):J.then(N=>N.mask);H=B.isSome(D)?F(D,{responseType:"image",signal:H}).then(N=>N.data):J.then(N=>N.overlay);const [L,M]=yield Promise.all([K,H]);u.mask=L;u.overlay=M;u._disposeRenderResources();u.requestRender()});return function(H){return G.apply(this,arguments)}}())};z._disposeRenderResources=function(){this._readbackTexture=
B.disposeMaybe(this._readbackTexture);this._overlayTexture=B.disposeMaybe(this._overlayTexture);this._maskTexture=B.disposeMaybe(this._maskTexture);this._vertexArrayObject=B.disposeMaybe(this._vertexArrayObject);this._program=B.disposeMaybe(this._program)};z._updateResources=function(u){u.pixelRatio!==this._resourcePixelRatio&&this._disposeRenderResources();if(!this._readbackTexture){var y=u.context;this._resourcePixelRatio=u.pixelRatio;var D=Math.ceil(this._magnifier.size*u.pixelRatio);this._program=
t.createMagnifierProgram(y);var G=new Uint16Array([0,1,0,0,1,1,1,0]);this._vertexArrayObject=new k(y,t.magnifierProgramTemplate.attributes,{geometry:[{name:"a_pos",count:2,type:5123,offset:0,stride:4,normalized:!1,divisor:0}]},{geometry:b.createVertex(y,35044,G)});this.overlay.width=D;this.overlay.height=D;this._overlayTexture=new d(y,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9728,flipped:!0,preMultiplyAlpha:m.isSVG(this.overlay.src)&&u.driverTestResult.svgAlwaysPremultipliesAlpha?
!1:!0},this.overlay);this.mask.width=D;this.mask.height=D;this._maskTexture=new d(y,{target:3553,pixelFormat:6406,internalFormat:6406,dataType:5121,wrapMode:33071,samplingMode:9728,flipped:!0},this.mask);u=1/this._magnifier.factor;this._readbackTexture=new d(y,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!1,width:Math.ceil(u*D),height:Math.ceil(u*D)})}};A._createClass(v,[{key:"background",get:function(){return this._background},set:function(u){this._background=
u;this.requestRender()}},{key:"magnifier",get:function(){return this._magnifier},set:function(u){this._magnifier=u;this._handles.removeAll();this._handles.add([p.init(u,"version",()=>{this.visible=u.visible&&B.isSome(u.position)&&0<u.size;this.requestRender()}),u.watch(["mask","overlay"],()=>this._reloadResources()),u.watch("size",()=>{this._disposeRenderResources();this.requestRender()})])}}]);return v}(l.DisplayObject)})},"esri/views/2d/engine/webgl/shaders/MagnifierPrograms":function(){define("exports ../../../../webgl/BufferObject ../../../../webgl/FramebufferObject ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../../../../webgl/checkWebGLError ../../../../webgl/enums ../../../../../chunks/builtins ../../../../webgl/programUtils ../../../../webgl/renderState ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ./sources/resolver".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c,q){const n={shaders:{vertexShader:q.resolveIncludes("magnifier/magnifier.vert"),fragmentShader:q.resolveIncludes("magnifier/magnifier.frag")},attributes:new Map([["a_pos",0]])};A.createMagnifierProgram=function(a){return h.createProgram(a,n)};A.magnifierProgramTemplate=n;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/magnifier/resources":function(){define(["require","exports","../../chunks/_rollupPluginBabelHelpers","../../core/promiseUtils","../../support/requestImageUtils"],
function(A,F,E,C,B){function x(){x=E._asyncToGenerator(function*(m){var p=new Promise(function(b,e){A(["./mask-svg"],function(c){b(Object.freeze({__proto__:null,default:c}))},e)}),h=new Promise(function(b,e){A(["./overlay-svg"],function(c){b(Object.freeze({__proto__:null,default:c}))},e)});p=B.requestImage((yield p).default,{signal:m});h=B.requestImage((yield h).default,{signal:m});h={mask:yield p,overlay:yield h};C.throwIfAborted(m);return h});return x.apply(this,arguments)}F.loadMagnifierResources=
function(m){return x.apply(this,arguments)};Object.defineProperty(F,"__esModule",{value:!0})})},"esri/support/requestImageUtils":function(){define(["exports","../chunks/_rollupPluginBabelHelpers","../request"],function(A,F,E){function C(){C=F._asyncToGenerator(function*(B,x){({data:B}=yield E(B,{responseType:"image",...x}));return B});return C.apply(this,arguments)}A.requestImage=function(B,x){return C.apply(this,arguments)};Object.defineProperty(A,"__esModule",{value:!0})})},"esri/core/libs/gl-matrix-2/mat4":function(){define(["exports",
"../../../chunks/mat4"],function(A,F){A.mat4=F.mat4;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/core/libs/gl-matrix-2/mat4f32":function(){define(["exports","../../../chunks/mat4f32"],function(A,F){A.mat4f32=F.mat4f32;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/core/libs/gl-matrix-2/vec3f32":function(){define(["exports","../../../chunks/vec3f32"],function(A,F){A.vec3f32=F.vec3f32;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/chunks/vec3f32":function(){define(["exports"],
function(A){function F(){return new Float32Array(3)}function E(d){const k=new Float32Array(3);k[0]=d[0];k[1]=d[1];k[2]=d[2];return k}function C(d,k,l){const g=new Float32Array(3);g[0]=d;g[1]=k;g[2]=l;return g}function B(d,k){return new Float32Array(d,k,3)}function x(){return F()}function m(){return C(1,1,1)}function p(){return C(1,0,0)}function h(){return C(0,1,0)}function b(){return C(0,0,1)}const e=F(),c=m(),q=p(),n=h(),a=b();var f=Object.freeze({__proto__:null,create:F,clone:E,fromValues:C,createView:B,
zeros:x,ones:m,unitX:p,unitY:h,unitZ:b,ZEROS:e,ONES:c,UNIT_X:q,UNIT_Y:n,UNIT_Z:a});A.ONES=c;A.UNIT_X=q;A.UNIT_Y=n;A.UNIT_Z=a;A.ZEROS=e;A.clone=E;A.create=F;A.createView=B;A.fromValues=C;A.ones=m;A.unitX=p;A.unitY=h;A.unitZ=b;A.vec3f32=f;A.zeros=x})},"esri/core/libs/gl-matrix-2/vec4f32":function(){define(["exports","../../../chunks/vec4f32"],function(A,F){A.vec4f32=F.vec4f32;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/Bitmap":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/mat3 ../../../chunks/mat3f32 ../../../chunks/vec2f32 ../../webgl/BufferObject ../../webgl/FramebufferObject ../../../core/has ../../webgl/checkWebGLError ../../webgl/enums ../../../chunks/builtins ../../webgl/renderState ../../webgl/Texture ../../webgl/VertexArrayObject ./DisplayObject ./ImageryBitmapSource".split(" "),
function(A,F,E,C,B,x,m,p,h,b,e,c,q,n,a,f,d){function k(t){return t&&"render"in t}function l(t){const r=document.createElement("canvas");r.width=t.width;r.height=t.height;t.render(r.getContext("2d"));return r}function g(t,r,w){const v={target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071};r&&w&&(v.width=r,v.height=w);return new n(t,v)}m=function(t){function r(v=null,z,u=!0){var y=t.call(this)||this;y.requestRenderOnSourceChangedEnabled=u;y._textureInvalidated=!0;y.stencilRef=
0;y.coordScale=[1,1];y._height=void 0;y.pixelRatio=1;y.resolution=0;y.rotation=0;y._source=null;y._width=void 0;y.x=0;y.y=0;y.blendFunction=z;y.source=v;y.requestRender=y.requestRender.bind(F._assertThisInitialized(y));return y}F._inheritsLoose(r,t);var w=r.prototype;w.destroy=function(){this._texture&&(this._texture.dispose(),this._texture=null)};w.beforeRender=function(v){t.prototype.beforeRender.call(this,v);this.updateTexture(v.context)};w.invalidateTexture=function(){this._textureInvalidated||
(this._textureInvalidated=!0,this.requestRenderOnSourceChangedEnabled&&this.requestRender())};w._createTransforms=function(){return{dvs:B.create()}};w.setTransform=function(v){const z=C.identity(this.transforms.dvs),[u,y]=v.toScreenNoRotation([0,0],[this.x,this.y]);var D=this.resolution/this.pixelRatio/v.resolution;const G=D*this.width;D*=this.height;const H=Math.PI*this.rotation/180;C.translate(z,z,x.fromValues(u,y));C.translate(z,z,x.fromValues(G/2,D/2));C.rotate(z,z,-H);C.translate(z,z,x.fromValues(-G/
2,-D/2));C.scaleByVec2(z,z,x.fromValues(G,D));C.multiply(this.transforms.dvs,v.displayViewMat3,z)};w.setSamplingProfile=function(v){this._texture&&(v.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(v.samplingMode))};w.bind=function(v,z){this._texture&&v.bindTexture(this._texture,z)};w.updateTexture=function(v){if(this.stage)this._textureInvalidated&&(this._textureInvalidated=!1,this._texture||(this._texture=this.source?g(v,this.sourceWidth,this.sourceHeight):
g(v)),(v=this.source)?(this._texture.resize(this.sourceWidth,this.sourceHeight),k(v)?v instanceof d?(v=v.getRenderedRasterPixels(),this._texture.setData(E.isSome(v)?v.renderedRasterPixels:null)):this._texture.setData(l(v)):!v||"render"in v||this._texture.setData(v),this.ready()):this._texture.setData(null));else{var z;null==(z=this._texture)?void 0:z.dispose();this._texture=null}};w.onAttach=function(){this.invalidateTexture()};w.onDetach=function(){this.invalidateTexture()};F._createClass(r,[{key:"isSourceScaled",
get:function(){return this.width!==this.sourceWidth||this.height!==this.sourceHeight}},{key:"height",get:function(){return void 0!==this._height?this._height:this.sourceHeight},set:function(v){this._height=v}},{key:"source",get:function(){return this._source},set:function(v){this._source=v;this.invalidateTexture()}},{key:"sourceHeight",get:function(){return this._source instanceof HTMLImageElement?this._source.naturalHeight:this._source.height}},{key:"sourceWidth",get:function(){return this._source instanceof
HTMLImageElement?this._source.naturalWidth:this._source.width}},{key:"width",get:function(){return void 0!==this._width?this._width:this.sourceWidth},set:function(v){this._width=v}}]);return r}(f.DisplayObject);A.Bitmap=m;A.isImageSource=k;A.rasterize=l;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/ImageryBitmapSource":function(){define(["../../../chunks/_rollupPluginBabelHelpers","../../../core/maybe"],function(A,F){return function(){function E(B,x,m){this.pixelBlock=
B;this.extent=x;this.originalPixelBlock=m}var C=E.prototype;C.render=function(B){var x=this.pixelBlock;if(!F.isNone(x)){var m=this.filter({pixelBlock:x});F.isNone(m.pixelBlock)||(x=m.pixelBlock.getAsRGBA(),m=B.createImageData(m.pixelBlock.width,m.pixelBlock.height),m.data.set(x),B.putImageData(m,0,0))}};C.getRenderedRasterPixels=function(){const B=this.filter({pixelBlock:this.pixelBlock});return F.isNone(B.pixelBlock)?null:{width:B.pixelBlock.width,height:B.pixelBlock.height,renderedRasterPixels:new Uint8Array(B.pixelBlock.getAsRGBA().buffer)}};
A._createClass(E,[{key:"width",get:function(){return F.isSome(this.pixelBlock)?this.pixelBlock.width:0}},{key:"height",get:function(){return F.isSome(this.pixelBlock)?this.pixelBlock.height:0}}]);return E}()})},"esri/views/2d/engine/BitmapContainer":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","./brushes","./webgl/enums","./webgl/WGLContainer"],function(A,F,E,C,B){B=function(x){function m(){return x.apply(this,arguments)||this}F._inheritsLoose(m,x);m.prototype.prepareRenderPasses=
function(p){const h=p.registerRenderPass({name:"bitmap",brushes:[E.brushes.bitmap],target:()=>this.children,drawPhase:C.WGLDrawPhase.MAP});return[...x.prototype.prepareRenderPasses.call(this,p),h]};F._createClass(m,[{key:"requiresDedicatedFBO",get:function(){return this.children.some(p=>"additive"===p.blendFunction)}}]);return m}(B);A.BitmapContainer=B;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/BitmapTile":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers",
"../../../chunks/mat3f32","./Bitmap","./webgl/TiledDisplayObject"],function(A,F,E,C,B){B=function(x){function m(h,b,e,c,q,n=null){var a=x.call(this,h,b,e,c,q)||this;a.bitmap=new C.Bitmap(n,"standard",!1);a.bitmap.coordScale=[c,q];a.bitmap.once("isReady",()=>a.ready());return a}F._inheritsLoose(m,x);var p=m.prototype;p.destroy=function(){x.prototype.destroy.call(this);this.bitmap.destroy()};p.beforeRender=function(h){x.prototype.beforeRender.call(this,h);this.bitmap.beforeRender(h)};p.afterRender=
function(h){x.prototype.afterRender.call(this,h);this.bitmap.afterRender(h)};p._createTransforms=function(){return{dvs:E.create(),tileMat3:E.create()}};p.setTransform=function(h,b){x.prototype.setTransform.call(this,h,b);this.bitmap.transforms.dvs=this.transforms.dvs};p.onAttach=function(){this.bitmap.stage=this.stage};p.onDetach=function(){this.bitmap&&(this.bitmap.stage=null)};F._createClass(m,[{key:"stencilRef",get:function(){return this.bitmap.stencilRef},set:function(h){this.bitmap.stencilRef=
h}}]);return m}(B.TiledDisplayObject);A.BitmapTile=B;Object.defineProperty(A,"__esModule",{value:!0})})},"esri/views/2d/engine/BitmapTileContainer":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../geometry/support/aaBoundingRect ./BitmapTile ./brushes ./webgl/enums ./webgl/TileContainer".split(" "),function(A,F,E,C,B,x,m){m=function(p){function h(){return p.apply(this,arguments)||this}F._inheritsLoose(h,p);var b=h.prototype;b.createTile=function(e){const c=this._tileInfoView.getTileBounds(E.create(),
e),[q,n]=this._tileInfoView.tileInfo.size;return new C.BitmapTile(e,c[0],c[3],q,n)};b.destroyTile=function(){};b.prepareRenderPasses=function(e){const c=e.registerRenderPass({name:"bitmap (tile)",brushes:[B.brushes.bitmap],target:()=>this.children.map(q=>q.bitmap),drawPhase:x.WGLDrawPhase.MAP});return[...p.prototype.prepareRenderPasses.call(this,e),c]};b.doRender=function(e){this.visible&&e.drawPhase===x.WGLDrawPhase.MAP&&p.prototype.doRender.call(this,e)};F._createClass(h,[{key:"requiresDedicatedFBO",
get:function(){return this.children.some(e=>"additive"===e.bitmap.blendFunction)}}]);return h}(m["default"]);A.BitmapTileContainer=m;Object.defineProperty(A,"__esModule",{value:!0})})},"*noref":1}});
define("exports ./engine/Stage ./LabelManager ./layers/graphics/GraphicsView2D ./layers/graphics/GraphicContainer ./navigation/MapViewNavigation ./magnifier/MagnifierView2D".split(" "),function(A,F,E,C,B,x,m){A.Stage=F.Stage;A.LabelManager=E;A.GraphicsView2D=C;A.GraphicContainer=B;A.MapViewNavigation=x;A.MagnifierView2D=m;Object.defineProperty(A,"__esModule",{value:!0})});