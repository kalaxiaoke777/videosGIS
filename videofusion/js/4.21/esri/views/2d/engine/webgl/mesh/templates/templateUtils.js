// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.21/esri/copyright.txt for details.
//>>built
define("exports ../../../../../../core/maybe ../../../../../../chunks/earcut ../../../../../../geometry/libtess ../../../../../../layers/graphics/OptimizedGeometry ../../definitions ../../TileClipper ../bufcut".split(" "),function(q,y,z,A,B,u,w,C){function v(b,a,c){let h=0;for(let e=1;e<c;e++)h+=(b[2*(a+e)]-b[2*(a+e-1)])*(b[2*(a+e)+1]+b[2*(a+e-1)+1]);return h}function x(b,a,c,h,e){let k=0;for(;c<h;c+=3){const d=2*(b.getValue(c)-e),f=2*(b.getValue(c+1)-e),g=2*(b.getValue(c+2)-e);k+=Math.abs((a[d]-
a[g])*(a[f+1]-a[d+1])-(a[d]-a[f])*(a[g+1]-a[d+1]))}return k}const r=new w.TileClipper(0,0,0,1,0),t=new w.TileClipper(0,0,0,1,0);r.setExtent(u.TILE_SIZE);t.setExtent(u.TILE_SIZE);q.area=v;q.clipLinesMarshall=function(b,a){t.setPixelMargin(a);const c=-a;a=u.TILE_SIZE+a;let h=[];var e=!1;let k=0;for(;k<b.length;){const d=[],f=b[k];if(!f)return null;t.reset(2);let [g,l]=f[0];if(e)t.moveTo(g,l);else{if(g<c||g>a||l<c||l>a){e=!0;continue}d.push({x:g,y:l})}let m=!1;const n=f.length;for(let p=1;p<n;++p)if(g+=
f[p][0],l+=f[p][1],e)t.lineTo(g,l);else{if(g<c||g>a||l<c||l>a){m=!0;break}d.push({x:g,y:l})}if(m)e=!0;else{if(e){if(e=t.resultWithStarts())for(const p of e)h.push(p)}else h.push({line:d,start:0});k++;e=!1}}h=h.filter(d=>1<d.line.length);return 0===h.length?null:h};q.clipMarshall=function(b,a){if(y.isNone(b))return null;a:{var c=u.TILE_SIZE+128;var h=0;for(var e=0;e<b.lengths.length;e++){var k=b.lengths[e];for(var d=0;d<k;d++){const f=b.coords[2*(d+h)],g=b.coords[2*(d+h)+1];if(-128>f||f>c||-128>g||
g>c){c=!0;break a}}h+=k}c=!1}if(!c)return b;r.setPixelMargin(a);r.reset(3);a=0;for(c=0;c<b.lengths.length;c++){h=b.lengths[c];e=b.coords[2*(0+a)];k=b.coords[2*(0+a)+1];r.moveTo(e,k);for(d=1;d<h;d++)e=b.coords[2*(d+a)],k=b.coords[2*(d+a)+1],r.lineTo(e,k);r.close();a+=h}c=r.result(!1);if(!c)return null;b=[];a=[];for(const f of c){c=0;for(const g of f)a.push(g.x),a.push(g.y),c++;b.push(c)}return new B(b,a)};q.triangleArea=x;q.triangulate=function(b,a){const {coords:c,lengths:h,hasIndeterminateRingOrder:e}=
a;a=b.indexWriter();b=b.vertexCount();if(e)return!1;const k=a.length;let d=0;for(var f=0;f<h.length;){let m=f,n=h[f];f=v(c,d,n);for(var g=[];++m<h.length;){var l=h[m];const p=v(c,d+n,l);if(!(0<p))break;f+=p;g.push(d+n);n+=l}l=a.length;C.bufcut(a,c,d,d+n,g,2,b);g=x(a,c,l,a.length,b);f=Math.abs(f);if(1E-5<Math.abs((g-f)/Math.max(1E-7,f)))return a.seek(k),!1;f=m;d+=n}return!0};q.triangulateEarcut=function(b,a,c){const {coords:h,lengths:e,hasIndeterminateRingOrder:k}=a;if(k)return!1;let d=0;for(var f=
0;f<e.length;){let l=f,m=e[f];for(f=[];++l<e.length;){var g=e[l];if(!(0<v(h,d+m,g)))break;f.push(d+m-d);m+=g}g=a.coords.slice(2*d,2*(d+m));f=z.earcut(g,f,2);for(const n of f)b.push(n+c+d);f=l;d+=m}return!0};q.triangulateLibtess=function(b,a){const c=b.indexWriter();b=b.vertexCount();const {coords:h,lengths:e}=a,{buffer:k,vertexCount:d}=A.triangulate(h,e);c.ensureSize(d);for(a=0;a<d;a++)c.push(a+b);return k};Object.defineProperty(q,"__esModule",{value:!0})});