// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.21/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/interactive/snapping/SnappingOptions":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ./FeatureSnappingLayerSource ./Settings".split(" "),function(f,g,a,w,z,F,J,G,K,D,t){a=function(m){function b(c){c=m.call(this,
c)||this;c.enabled=!1;c.enabledToggled=!1;c.selfEnabled=!0;c.featureEnabled=!0;c.featureSources=new w;c.distance=t.defaults.distance;c.touchSensitivityMultiplier=t.defaults.touchSensitivityMultiplier;return c}f._inheritsLoose(b,m);f._createClass(b,[{key:"effectiveEnabled",get:function(){return this.enabledToggled?!this.enabled:this.enabled}},{key:"effectiveSelfEnabled",get:function(){return this.effectiveEnabled&&this.selfEnabled}},{key:"effectiveFeatureEnabled",get:function(){return this.effectiveEnabled&&
this.featureEnabled}}]);return b}(a);g.__decorate([z.property()],a.prototype,"enabled",void 0);g.__decorate([z.property()],a.prototype,"enabledToggled",void 0);g.__decorate([z.property()],a.prototype,"selfEnabled",void 0);g.__decorate([z.property()],a.prototype,"featureEnabled",void 0);g.__decorate([z.property({type:w.ofType(D)})],a.prototype,"featureSources",void 0);g.__decorate([z.property()],a.prototype,"distance",void 0);g.__decorate([z.property()],a.prototype,"touchSensitivityMultiplier",void 0);
g.__decorate([z.property({readOnly:!0})],a.prototype,"effectiveEnabled",null);g.__decorate([z.property({readOnly:!0})],a.prototype,"effectiveSelfEnabled",null);g.__decorate([z.property({readOnly:!0})],a.prototype,"effectiveFeatureEnabled",null);return a=g.__decorate([K.subclass("esri.views.interactive.snapping.SnappingOptions")],a)})},"esri/views/interactive/snapping/FeatureSnappingLayerSource":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/accessorSupport/decorators/subclass".split(" "),
function(f,g,a,w,z,F,J,G){a=function(K){function D(t){t=K.call(this,t)||this;t.layer=null;t.enabled=!0;t.updating=!1;t.availability=1;return t}f._inheritsLoose(D,K);return D}(a);g.__decorate([w.property({constructOnly:!0})],a.prototype,"layer",void 0);g.__decorate([w.property()],a.prototype,"enabled",void 0);g.__decorate([w.property()],a.prototype,"updating",void 0);g.__decorate([w.property()],a.prototype,"availability",void 0);return a=g.__decorate([G.subclass("esri.views.interactive.snapping.SnappingLayerSource")],
a)})},"esri/views/interactive/snapping/Settings":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Color ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/subclass".split(" "),function(f,g,a,w,z,F,J){let G=function(K){function D(){var t=K.apply(this,arguments)||this;t.enabled=!0;return t}g._inheritsLoose(D,K);return D}(z.JSONSupport);a.__decorate([F.property({type:Boolean})],G.prototype,
"enabled",void 0);G=a.__decorate([J.subclass("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],G);z=function(K){function D(t){t=K.call(this,t)||this;t.lineSnapper=new G;t.parallelLineSnapper=new G;t.rightAngleSnapper=new G;t.rightAngleTriangleSnapper=new G;t.shortLineThreshold=15;t.distance=5;t.pointThreshold=1E-6;t.intersectionParallelLineThreshold=1E-6;t.parallelLineThreshold=1E-6;t.touchSensitivityMultiplier=1.5;t.pointOnLineThreshold=1E-6;t.orange=new w([255,127,0]);t.lineHintWidthReference=
3;t.lineHintWidthTarget=3;t.lineHintFadedExtensions=.3;t.parallelLineHintWidth=2;t.parallelLineHintLength=24;t.parallelLineHintOffset=1.5;t.rightAngleHintSize=24;t.rightAngleHintOutlineSize=1.5;return t}g._inheritsLoose(D,K);return D}(z.JSONSupport);a.__decorate([F.property({type:G,constructOnly:!0,nonNullable:!0,json:{write:!0}})],z.prototype,"lineSnapper",void 0);a.__decorate([F.property({type:G,constructOnly:!0,nonNullable:!0,json:{write:!0}})],z.prototype,"parallelLineSnapper",void 0);a.__decorate([F.property({type:G,
constructOnly:!0,nonNullable:!0,json:{write:!0}})],z.prototype,"rightAngleSnapper",void 0);a.__decorate([F.property({type:G,constructOnly:!0,nonNullable:!0,json:{write:!0}})],z.prototype,"rightAngleTriangleSnapper",void 0);a.__decorate([F.property({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],z.prototype,"shortLineThreshold",void 0);a.__decorate([F.property({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],z.prototype,"distance",void 0);a.__decorate([F.property({type:Number,
nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],z.prototype,"pointThreshold",void 0);a.__decorate([F.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],z.prototype,"intersectionParallelLineThreshold",void 0);a.__decorate([F.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],z.prototype,"parallelLineThreshold",void 0);a.__decorate([F.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],z.prototype,"touchSensitivityMultiplier",
void 0);a.__decorate([F.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],z.prototype,"pointOnLineThreshold",void 0);a.__decorate([F.property({type:w,nonNullable:!0})],z.prototype,"orange",void 0);a.__decorate([F.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],z.prototype,"lineHintWidthReference",void 0);a.__decorate([F.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],z.prototype,"lineHintWidthTarget",void 0);a.__decorate([F.property({type:Number,
nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],z.prototype,"lineHintFadedExtensions",void 0);a.__decorate([F.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],z.prototype,"parallelLineHintWidth",void 0);a.__decorate([F.property({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],z.prototype,"parallelLineHintLength",void 0);a.__decorate([F.property({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],z.prototype,"parallelLineHintOffset",
void 0);a.__decorate([F.property({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],z.prototype,"rightAngleHintSize",void 0);a.__decorate([F.property({type:Number,nonNullable:!0,range:{min:0,max:6},json:{write:!0}})],z.prototype,"rightAngleHintOutlineSize",void 0);z=a.__decorate([J.subclass("esri.views.interactive.snapping.Settings.Defaults")],z);a=new z;f.defaults=a;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/widgets/Sketch/SketchViewModel":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../symbols ../../core/Collection ../../core/has ../../core/Error ../../core/Evented ../../core/Handles ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/watchUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../geometry/projectionEllipsoid ../../geometry/support/coordsUtils ../../layers/GraphicsLayer ../../views/DOMContainer ../../views/3d/interactive/editingTools/isSupportedGraphicUtils ../../views/3d/interactive/editingTools/moveGraphic/isSupportedGraphic ../../views/3d/interactive/editingTools/reshapeGraphic/isSupportedGraphic ../../views/3d/interactive/editingTools/transformGraphic/isSupportedGraphic ../../views/draw/support/layerUtils ../../views/input/InputManager ../../views/interactive/keybindings ../../views/interactive/snapping/SnappingManager ../../views/interactive/snapping/SnappingOptions ../../views/support/screenUtils ./support/OperationHandle ../../symbols/SimpleMarkerSymbol ../../symbols/SimpleFillSymbol ../../symbols/SimpleLineSymbol".split(" "),
function(f,g,a,w,z,F,J,G,K,D,t,m,b,c,e,h,r,d,k,n,u,l,p,E,x,M,B,q,I,A,N,V,X,T,v){function L(ja){return Object.freeze({__proto__:null,default:ja})}function y(ja){return"polygon"===ja||"rectangle"===ja||"circle"===ja?!0:!1}function C(ja,pa){S("undo",ja.history.undo,ja.history.redo,pa)}function P(ja,pa){S("redo",ja.history.redo,ja.history.undo,pa)}function S(ja,pa,U,H){const O=pa.pop().updates,R=[];H.forEach((Q,W)=>{W=O[W];null!=W&&("geometry"in W&&t.isSome(W.geometry)&&(R.push({geometry:Q.geometry}),
Q.geometry=W.geometry),"symbol"in W&&t.isSome(W.symbol)&&(R.push({symbol:Q.symbol}),Q.symbol=W.symbol),"undo"in W&&(R.push(W),W[ja](Q)))});U.push({updates:R})}function aa(ja){return{updates:ja.map(pa=>({geometry:pa.geometry}))}}function ca(ja){return"requireError"in ja&&"aborted"===ja.requireError}const ia=D.getLogger("esri.widgets.Sketch.SketchViewModel"),la={defaultZ:0},oa={reshapeOptions:{edgeOperation:"split",shapeOperation:"move",vertexOperation:"move"},enableMoveAllGraphics:!0,enableRotation:!0,
enableScaling:!0,multipleSelectionEnabled:!0,preserveAspectRatio:!1,toggleToolOnClick:!0,enableZ:!0,tool:"transform"};F=function(ja){function pa(H){H=ja.call(this,H)||this;H._numUpdating=0;H._handles=new K;H._internalGraphicsLayer=new n({listMode:"hide",internal:!0,title:"SVM Internal"});H._operationHandle=null;H._viewHandles=new K;H.activeFillSymbol=null;H.activeLineSymbol=null;H.activeVertexSymbol=null;H.allowDeleteKey=!0;H.layer=null;H.pointSymbol=new X({style:"circle",size:6,color:[255,255,255],
outline:{color:[50,50,50],width:1}});H.polygonSymbol=new T({color:[150,150,150,.2],outline:{color:[50,50,50],width:2}});H.polylineSymbol=new v({color:[130,130,130,1],width:2});H._snappingManager=null;H.updateGraphics=new z;H.updateOnGraphicClick=!0;H.updatePointSymbol=new X({size:10,color:[0,200,255,.5],outline:{color:"black",width:1}});H.updatePolygonSymbol=new T({color:[12,207,255,.2],outline:{join:"round",color:[12,207,255],width:2}});H.updatePolylineSymbol=new v({color:[12,207,255],width:2});
H.vertexSymbol=new X({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}});H._moduleLoaderAbortController=null;H._viewReadyAbortController=null;H._originalAutoOpenEnabled=null;H.defaultCreateOptions=la;H.defaultUpdateOptions=oa;H.snappingOptions=new A;return H}g._inheritsLoose(pa,ja);var U=pa.prototype;U.initialize=function(){this._handles.add([c.watch(this,"layer",()=>{this.cancel();this._internalGraphicsLayer.elevationInfo=t.isSome(this.layer)?this.layer.elevationInfo:
null}),c.on(this,"view.map.layers","change",H=>{H.removed.includes(this.layer)&&this.cancel()}),c.on(this,"layer.graphics","change",H=>{if(t.isSome(this._operationHandle))for(const O of H.removed)this.updateGraphics.includes(O)&&(1<this.updateGraphics.length?this._operationHandle.removeFromSelection(O):this._operationHandle.cancel())}),c.init(this,"layer.elevationInfo",()=>{this.cancel();this._internalGraphicsLayer.elevationInfo=t.isSome(this.layer)?this.layer.elevationInfo:null},!0),c.init(this,
"view",H=>{t.destroyMaybe(this._snappingManager);H&&(this._snappingManager=new I.SnappingManager({view:H,options:this.snappingOptions}),"2d"===H.type?new Promise(function(O,R){f(["../../views/2d/interactive/editingTools"],O,R)}):"3d"===H.type&&(new Promise(function(O,R){f(["../../views/3d/interactive/editingTools"],O,R)}),new Promise(function(O,R){f(["../../views/3d/layers/GraphicsLayerView3D"],function(Q){O(L(Q))},R)})))},!0)])};U.destroy=function(){this.cancel();this._handles=t.destroyMaybe(this._handles);
this._viewHandles=t.destroyMaybe(this._viewHandles);this._removeDefaultLayer();this._snappingManager=t.destroyMaybe(this._snappingManager);this._set("view",null);this.emit("destroy")};U.cancel=function(){this._moduleLoaderAbortController=t.abortMaybe(this._moduleLoaderAbortController);this._viewReadyAbortController=t.abortMaybe(this._viewReadyAbortController);this._operationHandle&&this._operationHandle.cancel()};U.complete=function(){this._operationHandle&&this._operationHandle.complete()};U.delete=
function(){const {state:H,updateGraphics:O}=this;if("active"===H&&O.length){const {activeTool:R,layer:Q}=this,W=O.toArray();Q.removeMany(W);this.cancel();this._emitDeleteEvent({graphics:W,tool:R})}};U.create=function(){var H=g._asyncToGenerator(function*(O,R){yield this._waitViewReady();if("disabled"===this.state)throw this.layer||this._logError("sketch:missing-property","Property 'layer' is missing on SketchViewModel."),this.view||this._logError("sketch:missing-property","Property 'view' is missing on SketchViewModel."),
m.createAbortError();this.cancel();t.isSome(this.view.activeTool)&&(this.view.activeTool=null);if(O){M.addUniqueLayer(this.view,this._internalGraphicsLayer);var Q=yield this._setupCreateOperation(O,R);t.isNone(Q)||this.destroyed?this.view.map.remove(this._internalGraphicsLayer):(Q.on("complete",()=>{if(Q===this._operationHandle){const W=this.createGraphic,Y=this._operationHandle.cancelled;this._operationHandle.destroy();this._operationHandle=null;this._set("createGraphic",null);this.view&&this.view.map&&
this.view.map.remove(this._internalGraphicsLayer);Q.cancelled||null==W||this.layer.add(W);this.emit("create",{graphic:W,state:Y?"cancel":"complete",tool:O,toolEventInfo:null,type:"create"})}}),this._operationHandle=Q,this.view.ready&&u.isDOMContainer(this.view)&&this.view.focus())}else this._logError("sketch:missing-parameter","Missing parameter 'tool'.")});return function(O,R){return H.apply(this,arguments)}}();U.update=function(){var H=g._asyncToGenerator(function*(O,R){yield this._waitViewReady();
const {layer:Q,view:W,state:Y}=this;if("disabled"===Y)throw W||this._logError("sketch:missing-property","Property 'view' is missing on SketchViewModel."),Q||this._logError("sketch:missing-property","Property 'layer' is missing on SketchViewModel."),m.createAbortError();this.cancel();t.isSome(this.view.activeTool)&&(this.view.activeTool=null);const ba=Array.isArray(O)?O:[O];null!=O&&ba&&ba.length?ba.some(Z=>Z.layer!==Q?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics missing from the supplied GraphicsLayer."),
!0):t.isNone(Z.geometry)?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with an unsupported geometry."),!0):"2d"!==W.type||W.spatialReference.equals(Z.geometry.spatialReference)?!1:(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with a spatial reference different from the supplied MapView."),!0))||(O=yield this._setupUpdateOperation(ba,R),this.destroyed||t.isNone(O)||ca(O)||(M.addUniqueLayer(this.view,this._internalGraphicsLayer),
this._setUpdateOperationHandle(O,R),this.emit("update",{graphics:ba,state:"start",aborted:!1,tool:O.tool,toolEventInfo:null,type:"update"}))):this._logError("sketch:missing-parameter","Missing parameter 'graphics'.")});return function(O,R){return H.apply(this,arguments)}}();U.undo=function(){this.canUndo()&&this._operationHandle.undo()};U.redo=function(){this.canRedo()&&this._operationHandle.redo()};U.canUndo=function(){return!(!this._operationHandle||!this._operationHandle.canUndo())};U.canRedo=
function(){return!(!this._operationHandle||!this._operationHandle.canRedo())};U.toggleUpdateTool=function(){this._operationHandle&&this._operationHandle.toggleTool&&this._operationHandle.toggleTool()};U._getFirstHit=function(){var H=g._asyncToGenerator(function*(O){const R=[];switch(this.view.type){case "2d":var Q=yield this.view.hitTest(O);if(0<Q.results.length&&(Q=Q.results[0],Q.graphic)){var W,Y;const ba=Q.graphic;"vector-tile"!==(null==(W=ba.layer)?void 0:W.type)&&"imagery"!==(null==(Y=ba.layer)?
void 0:Y.type)&&R.push(Q)}break;case "3d":{const ba=[this.view.map.ground];this.view.map.allLayers.forEach(Z=>{"integrated-mesh"===Z.type&&ba.push(Z)});W=yield this.view.hitTest(O,{exclude:ba});0<W.results.length&&(Y=W.results[0],(!W.ground.mapPoint||1>this.view.map.ground.opacity||W.ground.distance-Y.distance>-Math.min(3*W.ground.distance,"global"===this.view.viewingMode?d.getReferenceEllipsoid(this.view.renderCoordsHelper.spatialReference).radius/this.view.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY))&&
R.push(Y))}}return{screenPoint:O,results:R}});return function(O){return H.apply(this,arguments)}}();U._generateViewHandles=function(H){var O=this;return[H.on("immediate-click",function(){var R=g._asyncToGenerator(function*(Q){var W="active"===O.state&&"create"===O._operationHandle.type;if("disabled"!==O.state&&!W&&O.updateOnGraphicClick){O._beginAsyncOperation();var Y=(yield Q.async(()=>O._getFirstHit(N.createScreenPointFromEvent(Q)))).results;W=null;if(Y.length)for(const ba of Y){if(ba.graphic){Y=
ba.graphic;if(O.updateGraphics.includes(Y)||Y.layer===O.layer){Q.stopPropagation();W=Y;break}"2d"!==H.type||O._isComponentGraphic(Y)||"active"!==O.state||O.cancel()}}else"active"===O.state&&O.cancel();t.isSome(W)&&!O.updateGraphics.includes(W)&&(yield O.update([W],{...O.defaultUpdateOptions,reshapeOptions:{...O.defaultUpdateOptions.reshapeOptions}}));O._endAsyncOperation()}});return function(Q){return R.apply(this,arguments)}}(),B.ViewEventPriorities.WIDGET)]};U._setupCreateOperation=function(){var H=
g._asyncToGenerator(function*(O,R){O=yield this._setupDrawGraphicTool(O,this.view,{hasZ:"3d"===this.view.type,...this.defaultCreateOptions,...R});if(t.isNone(O))return null;this.view.tools.add(O);this.view.activeTool=O;return this._setupCreateOperationHandle(O)});return function(O,R){return H.apply(this,arguments)}}();U._setupDrawGraphicTool=function(){var H=g._asyncToGenerator(function*(O,R,Q){if("multipoint"===O&&"3d"===R.type)return this._logError("sketch:create","Multipoint geometries are not supported in SceneView"),
null;const W="rectangle"!==O,Y="rectangle"!==O;this.snappingOptions.enabledToggled=!1;O={view:R,mode:"rectangle"===O||"circle"===O?"hybrid":"click",...Q,snapToScene:!1,geometryType:O,graphicSymbol:this._getGraphicSymbolFromTool(O),snappingManager:this._snappingManager,forceUniformSize:Y,centered:W};return"2d"===this.view.type?this._makeDrawGraphicTool2D(O):this._makeDrawGraphicTool3D(O)});return function(O,R,Q){return H.apply(this,arguments)}}();U._makeDrawGraphicTool2D=function(){var H=g._asyncToGenerator(function*(O){const R=
yield this._requireModule(new Promise(function(Q,W){f(["../../views/2d/interactive/editingTools"],Q,W)}));return ca(R)||this.destroyed?null:new R.module.DrawGraphicTool2D({...O,activeVertexSymbol:this.activeVertexSymbol,regularVerticesSymbol:this.vertexSymbol,activeLineSymbol:this.activeLineSymbol,activeFillSymbol:y(O.geometryType)?this.activeFillSymbol:null})});return function(O){return H.apply(this,arguments)}}();U._makeDrawGraphicTool3D=function(){var H=g._asyncToGenerator(function*(O){const R=
yield this._requireModule(new Promise(function(Q,W){f(["../../views/3d/interactive/editingTools"],Q,W)}));return ca(R)||this.destroyed?null:new R.module.DrawGraphicTool3D({...O,elevationInfo:this.layer.elevationInfo,snapToScene:t.isSome(this.layer.elevationInfo)?"absolute-height"===this.layer.elevationInfo.mode:!0})});return function(O){return H.apply(this,arguments)}}();U._setupCreateOperationHandle=function(H){let O=null;const R=H.forceUniformSize,Q=H.centered,W=[this.view.on("key-down",ba=>{if(ba.key===
q.SKETCH_KEYS.pan)ba.stopPropagation(),ba.repeat||(H.enabled=!1);else if(ba.key===q.SKETCH_KEYS.complete)ba.stopPropagation(),H.completeCreateOperation();else if(ba.key!==q.SKETCH_KEYS.vertexAdd||ba.repeat)ba.key===q.SKETCH_KEYS.undo?(ba.stopPropagation(),Y.undo()):ba.key===q.SKETCH_KEYS.redo?(ba.stopPropagation(),Y.redo()):ba.key!==q.SKETCH_KEYS.snappingToggle||"rectangle"===H.geometryType||"circle"===H.geometryType||ba.repeat?ba.key!==q.SKETCH_KEYS.constraint||"rectangle"!==H.geometryType&&"circle"!==
H.geometryType||ba.repeat?ba.key!==q.SKETCH_KEYS.center||ba.repeat||(H.centered=!Q,ba.stopPropagation()):(H.forceUniformSize=!R,ba.stopPropagation()):(this.snappingOptions.enabledToggled=!0,ba.stopPropagation());else{const Z=H.drawOperation.geometryType;if("polyline"===Z||"polygon"===Z||"multipoint"===Z)ba.stopPropagation(),H.drawOperation.commitStagedVertex()}},B.ViewEventPriorities.WIDGET),this.view.on("key-up",ba=>{ba.key===q.SKETCH_KEYS.pan?H.enabled=!0:ba.key===q.SKETCH_KEYS.snappingToggle&&
"rectangle"!==H.geometryType&&"circle"!==H.geometryType?(this.snappingOptions.enabledToggled=!1,ba.stopPropagation()):ba.key!==q.SKETCH_KEYS.constraint||"rectangle"!==H.geometryType&&"circle"!==H.geometryType?ba.key===q.SKETCH_KEYS.center&&(H.centered=Q,ba.stopPropagation()):(H.forceUniformSize=R,ba.stopPropagation())},B.ViewEventPriorities.WIDGET),H.on("vertex-add",ba=>{O=t.isNone(O)?"start":"active";switch(ba.operation){case "apply":this.emit("create",{graphic:t.unwrap(H.graphic),state:O,tool:this.activeTool,
toolEventInfo:ba,type:"create"});break;case "undo":this._emitUndoEvent({graphics:[t.unwrap(H.graphic)],tool:H.geometryType});break;case "redo":this._emitRedoEvent({graphics:[t.unwrap(H.graphic)],tool:H.geometryType})}}),H.on("cursor-update",ba=>{0<H.drawOperation.numCommittedVertices&&this.emit("create",{graphic:t.unwrap(H.graphic),state:"active",tool:this.activeTool,toolEventInfo:{coordinates:ba.vertices[0].coordinates,type:"cursor-update"},type:"create"})}),H.on("vertex-remove",ba=>{switch(ba.operation){case "apply":this.emit("create",
{graphic:t.unwrap(H.graphic),state:"active",tool:this.activeTool,toolEventInfo:ba,type:"create"});break;case "undo":this._emitUndoEvent({graphics:[t.unwrap(H.graphic)],tool:H.geometryType});break;case "redo":this._emitRedoEvent({graphics:[t.unwrap(H.graphic)],tool:H.geometryType})}}),H.on("complete",ba=>{this._set("createGraphic",t.unwrap(ba.graphic));O="complete";ba.aborted?Y&&Y.cancel():Y&&Y.complete()}),b.react(()=>this._getGraphicSymbolFromTool(H.geometryType),ba=>{H.graphicSymbol=ba})],Y=new V.OperationHandle({activeComponent:H,
tool:H.geometryType,type:"update",onEnd:()=>{var ba;W.forEach(Z=>Z.remove());W.length=0;null==(ba=this.view.tools)?void 0:ba.remove(H);H.destroy()},undo:()=>{H.canUndo&&H.undo()},redo:()=>{H.canRedo&&H.redo()},canUndo:()=>H.canUndo,canRedo:()=>H.canRedo});return Y};U._getGraphicSymbolFromTool=function(H){switch(H){case "point":case "multipoint":return this.pointSymbol;case "polyline":return this.polylineSymbol;case "circle":case "rectangle":case "polygon":return this.polygonSymbol;default:return null}};
U._setupUpdateOperation=function(){var H=g._asyncToGenerator(function*(O,R){const {layer:Q,view:W}=this;R={tool:this._defaultUpdateTool,...this.defaultUpdateOptions,...R,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions,...null==R?void 0:R.reshapeOptions}};var Y=R.tool;for(var ba of O)Q.remove(ba),Q.add(ba);if("3d"===W.type){if(0===O.length)return null;switch(Y){case "move":return this._setupMove3DOperation(O,R,W,Y);case "reshape":if(1<O.length)return this._logError("sketch:reshape-multiple",
"Reshape operation does not support multiple graphics."),null;Y=E.isSupportedGraphic(O[0]);if(0===Y)return this._setupReshape3DOperation(O[0],R,W);this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${l.isSupportedGraphicResultMessage(Y)}).`);return null;case "transform":return this._setupGraphicTransform3DOperation(O,R,W)}}switch(Y){case "move":return this._setupMoveOperation(O,R,W);case "reshape":if(1<O.length)return this._logError("sketch:reshape-multiple",
"Reshape operation does not support multiple graphics."),null;ba=E.isSupportedGraphic(O[0]);if(0===ba)return this._setupTransformOrReshapeOperation(O,Y,R,W);this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${l.isSupportedGraphicResultMessage(ba)}).`);return null;case "transform":return 1===O.length&&(ba=t.get(O[0].geometry,"type"),"point"===ba||"multipoint"===ba)&&(Y="reshape"),this._setupTransformOrReshapeOperation(O,Y,R,W)}});return function(O,R){return H.apply(this,
arguments)}}();U._setupMove3DOperation=function(){var H=g._asyncToGenerator(function*(O,R,Q,W,Y=!1){var ba=this;for(var Z of O){const da=p.isSupportedGraphic(Z);if(0!==da)return this._logError("sketch:move",`Move operation not supported for provided graphic(s) (${l.isSupportedGraphicResultMessage(da)}).`),null}Z=yield this._requireModule(new Promise(function(da,fa){f(["../../views/3d/interactive/editingTools"],da,fa)}));if(ca(Z))return Z;const ka=new Z.module.GraphicMoveTool({view:Q,enableZ:R.enableZ,
snappingManager:this._snappingManager});this.view.tools.add(ka);ka.graphics.addMany(O);Y||this.updateGraphics.addMany(O);const ha=[],ea=new V.UpdateOperationHandle({activeComponent:ka,tool:W,type:"update",onEnd:()=>{var da;ha.forEach(fa=>fa.remove());ha.length=0;null==(da=this.view.tools)?void 0:da.remove(ka);ka.destroyed||ka.destroy()},undo:()=>{C(ea,this.updateGraphics.toArray());this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:W})},redo:()=>{P(ea,this.updateGraphics.toArray());
this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:W})},addToSelection:da=>{this.updateGraphics.push(da);ka.graphics.push(da);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[da],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:da=>{const fa=this.updateGraphics.indexOf(da);ea.history.undo.forEach(na=>na.updates.splice(fa,1));ea.history.redo.forEach(na=>na.updates.splice(fa,1));this.updateGraphics.remove(da);
this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[da],type:"selection-change"},type:"update"});0===this.updateGraphics.length?ea.complete():ka.graphics.remove(da)},toggleTool:function(){var da=g._asyncToGenerator(function*(){if(1===ba.updateGraphics.length&&!1!==R.toggleToolOnClick&&"transform"===W){var fa=ba.updateGraphics.getItemAt(0);0===E.isSupportedGraphic(fa)&&(fa=yield ba._setupReshape3DOperation(fa,R,
Q,!0),ca(fa)||(ea.onEnd(),ea.destroy(),ba._setUpdateOperationHandle(fa,R)))}});return function(){return da.apply(this,arguments)}}()});ha.push(...this._getHandlesForComponent(ea,R),this.view.on("immediate-click",da=>this._getCommonUpdateOperationClickHandlers(ea,da,R),B.ViewEventPriorities.WIDGET),Q.on("key-down",da=>{this._getCommonUpdateOperationKeyDownHandlers(ea,da);da.key===q.SKETCH_KEYS.snappingToggle&&(this.snappingOptions.enabledToggled=!0,da.stopPropagation())},B.ViewEventPriorities.WIDGET),
Q.on("key-up",da=>{da.key===q.SKETCH_KEYS.snappingToggle&&(this.snappingOptions.enabledToggled=!1,da.stopPropagation())},B.ViewEventPriorities.WIDGET));return ea});return function(O,R,Q,W){return H.apply(this,arguments)}}();U._setupGraphicTransform3DOperation=function(H,O,R,Q=!1){if(1===H.length&&0===x.isSupportedGraphic(H[0])){const W=H[0],Y=W.geometry;if(t.isSome(Y)&&("point"===Y.type||"mesh"===Y.type))return this._setupPointTransform3DOperation(W,O,R);if(t.isSome(Y)&&("polygon"===Y.type||"polyline"===
Y.type))return this._setupPolyTransform3DOperation(W,O,R,Q)}return this._setupMove3DOperation(H,O,R,"transform",Q)};U._setupPointTransform3DOperation=function(){var H=g._asyncToGenerator(function*(O,R,Q){var W=this;const {enableRotation:Y,enableScaling:ba,enableZ:Z}=R,ka=yield this._requireModule(new Promise(function(fa,na){f(["../../views/3d/interactive/editingTools"],fa,na)}));if(ca(ka))return ka;const ha=new ka.module.GraphicTransformTool({graphic:O,view:Q,enableRotation:Y,enableScaling:ba,enableZ:Z,
snappingManager:this._snappingManager});this.view.tools.add(ha);this.updateGraphics.add(O);const ea=[],da=new V.UpdateOperationHandle({activeComponent:ha,tool:"transform",type:"update",onEnd:()=>{var fa;ea.forEach(na=>na.remove());ea.length=0;null==(fa=this.view.tools)?void 0:fa.remove(ha);ha.destroyed||ha.destroy()},undo:()=>{C(da,this.updateGraphics.toArray());this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},redo:()=>{P(da,this.updateGraphics.toArray());this._emitRedoEvent({graphics:this.updateGraphics.toArray(),
tool:"transform"})},addToSelection:function(){var fa=g._asyncToGenerator(function*(na){W.updateGraphics.add(na);W.emit("update",{graphics:W.updateGraphics.toArray(),state:"active",aborted:!1,tool:W.activeTool,toolEventInfo:{added:[na],removed:[],type:"selection-change"},type:"update"});na=yield W._setupMove3DOperation(W.updateGraphics.toArray(),R,Q,"transform",!0);ca(na)||(da.onEnd(),da.destroy(),W._setUpdateOperationHandle(na,R))});return function(na){return fa.apply(this,arguments)}}(),removeFromSelection:fa=>
{this.updateGraphics.remove(fa);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[fa],type:"selection-change"},type:"update"});da.complete()},toggleTool:()=>{}});ea.push(...this._getHandlesForComponent(da,R),this.view.on("immediate-click",fa=>this._getCommonUpdateOperationClickHandlers(da,fa,R),B.ViewEventPriorities.WIDGET),Q.on("key-down",fa=>{this._getCommonUpdateOperationKeyDownHandlers(da,fa);fa.key===q.SKETCH_KEYS.snappingToggle&&
(this.snappingOptions.enabledToggled=!0,fa.stopPropagation())},B.ViewEventPriorities.WIDGET),Q.on("key-up",fa=>{fa.key===q.SKETCH_KEYS.snappingToggle&&(this.snappingOptions.enabledToggled=!1,fa.stopPropagation())},B.ViewEventPriorities.WIDGET));return da});return function(O,R,Q){return H.apply(this,arguments)}}();U._setupPolyTransform3DOperation=function(){var H=g._asyncToGenerator(function*(O,R,Q,W=!1){var Y=this;const {enableRotation:ba,enableScaling:Z,enableZ:ka,preserveAspectRatio:ha}=R,ea=yield this._requireModule(new Promise(function(ma,
qa){f(["../../views/3d/interactive/editingTools"],ma,qa)}));if(ca(ea))return ea;const da=new ea.module.ExtentTransformTool({graphic:O,view:Q,enableRotation:ba,enableScaling:Z,enableZ:ka,preserveAspectRatio:ha});this.view.tools.add(da);W||this.updateGraphics.add(O);const fa=[],na=new V.UpdateOperationHandle({activeComponent:da,tool:"transform",type:"update",onEnd:()=>{var ma;fa.forEach(qa=>qa.remove());fa.length=0;null==(ma=this.view.tools)?void 0:ma.remove(da);da.destroyed||da.destroy()},canUndo:()=>
da.canUndo,undo:()=>{da.undo();this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},canRedo:()=>da.canRedo,redo:()=>{da.redo();this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},addToSelection:function(){var ma=g._asyncToGenerator(function*(qa){Y.updateGraphics.add(qa);Y.emit("update",{graphics:Y.updateGraphics.toArray(),state:"active",aborted:!1,tool:Y.activeTool,toolEventInfo:{added:[qa],removed:[],type:"selection-change"},type:"update"});
qa=yield Y._setupMove3DOperation(Y.updateGraphics.toArray(),R,Q,"transform",!0);ca(qa)||(na.onEnd(),na.destroy(),Y._setUpdateOperationHandle(qa,R))});return function(qa){return ma.apply(this,arguments)}}(),removeFromSelection:ma=>{this.updateGraphics.remove(ma);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[ma],type:"selection-change"},type:"update"});na.complete()},toggleTool:function(){var ma=g._asyncToGenerator(function*(){if(1===
Y.updateGraphics.length&&!1!==R.toggleToolOnClick){var qa=Y.updateGraphics.getItemAt(0);0===E.isSupportedGraphic(qa)&&(qa=yield Y._setupReshape3DOperation(qa,R,Q,!0),ca(qa)||(na.onEnd(),na.destroy(),Y._setUpdateOperationHandle(qa,R)))}});return function(){return ma.apply(this,arguments)}}()});fa.push(...this._getHandlesForComponent(na,R),this.view.on("immediate-click",ma=>this._getCommonUpdateOperationClickHandlers(na,ma,R),B.ViewEventPriorities.WIDGET),this.view.on("key-down",ma=>this._getCommonUpdateOperationKeyDownHandlers(na,
ma),B.ViewEventPriorities.WIDGET),this.view.on("key-down",ma=>{ma.key!==q.SKETCH_KEYS.constraint||ma.repeat||(da.preserveAspectRatio=!da.preserveAspectRatio,ma.stopPropagation())},B.ViewEventPriorities.WIDGET),this.view.on("key-up",ma=>{ma.key===q.SKETCH_KEYS.constraint&&(da.preserveAspectRatio=!da.preserveAspectRatio,ma.stopPropagation())},B.ViewEventPriorities.WIDGET));return na});return function(O,R,Q){return H.apply(this,arguments)}}();U._setupMoveOperation=function(){var H=g._asyncToGenerator(function*(O,
R,Q){this.updateGraphics.addMany(O);const W=yield this._getGraphicMover(O,R,Q);if(ca(W))return W;const Y=new V.UpdateOperationHandle({activeComponent:W,tool:"move",type:"update",onEnd:()=>{var ha;this._displayDefaultCursor();ka.forEach(ea=>ea.remove());Z.forEach(ea=>ea.remove());ka=[];Z=[];W.destroy();null==(ha=this._internalGraphicsLayer)?void 0:ha.removeMany([...this.updateGraphics.toArray()])},undo:()=>{const ha=this.updateGraphics.toArray();C(Y,ha);Y.refreshComponent();this._emitUndoEvent({graphics:ha,
tool:"move"})},redo:()=>{const ha=this.updateGraphics.toArray();P(Y,ha);Y.refreshComponent();this._emitRedoEvent({graphics:ha,tool:"move"})},addToSelection:ha=>{this.updateGraphics.push(ha);W.graphics=this.updateGraphics.toArray();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[ha],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:ha=>{const ea=this.updateGraphics.indexOf(ha);Y.history.undo.forEach(fa=>
fa.updates.splice(ea,1));Y.history.redo.forEach(fa=>fa.updates.splice(ea,1));this.updateGraphics.remove(ha);const da=this.updateGraphics.toArray();this.emit("update",{graphics:da,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[ha],type:"selection-change"},type:"update"});0===this.updateGraphics.length?Y.complete():W.graphics=da}});let ba=!1,Z=[Q.on("immediate-click",ha=>this._getCommonUpdateOperationClickHandlers(Y,ha,R),B.ViewEventPriorities.WIDGET),Q.on("key-down",
ha=>{this._getCommonUpdateOperationKeyDownHandlers(Y,ha);ha.key!==q.SKETCH_KEYS.constraint||ha.repeat||(ba=!0,W.enableMoveAllGraphics=!W.enableMoveAllGraphics)},B.ViewEventPriorities.WIDGET),Q.on("key-up",ha=>{ha.key===q.SKETCH_KEYS.constraint&&ba&&(ba=!1,W.enableMoveAllGraphics=!W.enableMoveAllGraphics)},B.ViewEventPriorities.WIDGET)],ka=this._getHandlesForComponent(Y,R);return Y});return function(O,R,Q){return H.apply(this,arguments)}}();U._setupReshape3DOperation=function(){var H=g._asyncToGenerator(function*(O,
R,Q,W=!1){var Y=this;const ba=yield this._requireModule(new Promise(function(ea,da){f(["../../views/3d/interactive/editingTools"],ea,da)}));if(ca(ba))return ba;this.snappingOptions.enabledToggled=!1;const Z=new ba.module.GraphicReshapeTool({view:Q,graphic:O,enableZVertex:R.enableZ&&"move"===R.reshapeOptions.vertexOperation,enableZShape:R.enableZ&&"move"===R.reshapeOptions.shapeOperation,enableMoveGraphic:"move"===R.reshapeOptions.shapeOperation||"move-xy"===R.reshapeOptions.shapeOperation,enableMidpoints:"split"===
R.reshapeOptions.edgeOperation,enableEdgeOffset:"offset"===R.reshapeOptions.edgeOperation,snappingManager:this._snappingManager});Q.tools.add(Z);W||this.updateGraphics.add(O);const ka=[],ha=new V.UpdateOperationHandle({activeComponent:Z,tool:"reshape",type:"update",onEnd:()=>{var ea;ka.forEach(da=>da.remove());ka.length=0;null==(ea=this.view.tools)?void 0:ea.remove(Z);Z.destroyed||Z.destroy()},canUndo:()=>Z.canUndo,undo:()=>{Z.undo();this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"reshape"})},
canRedo:()=>Z.canRedo,redo:()=>{Z.redo();this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:"reshape"})},addToSelection:function(){var ea=g._asyncToGenerator(function*(da){Y.updateGraphics.add(da);Y.emit("update",{graphics:Y.updateGraphics.toArray(),state:"active",aborted:!1,tool:Y.activeTool,toolEventInfo:{added:[da],removed:[],type:"selection-change"},type:"update"});da=yield Y._setupMove3DOperation(Y.updateGraphics.toArray(),R,Q,"transform",!0);ca(da)||(ha.onEnd(),ha.destroy(),Y._setUpdateOperationHandle(da,
R))});return function(da){return ea.apply(this,arguments)}}(),removeFromSelection:ea=>{this.updateGraphics.remove(ea);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[ea],type:"selection-change"},type:"update"});ha.complete()},toggleTool:function(){var ea=g._asyncToGenerator(function*(){if(!1!==R.toggleToolOnClick){var da=yield Y._setupGraphicTransform3DOperation(Y.updateGraphics.toArray(),R,Q,!0);ca(da)||(ha.onEnd(),
ha.destroy(),Y._setUpdateOperationHandle(da,R))}});return function(){return ea.apply(this,arguments)}}()});ka.push(...this._getHandlesForComponent(ha,R),Q.on("immediate-click",ea=>this._getCommonUpdateOperationClickHandlers(ha,ea,R),B.ViewEventPriorities.WIDGET),Q.on("key-down",ea=>{this._getCommonUpdateOperationKeyDownHandlers(ha,ea);ea.key===q.SKETCH_KEYS.snappingToggle&&(this.snappingOptions.enabledToggled=!0,ea.stopPropagation())},B.ViewEventPriorities.WIDGET),Q.on("key-up",ea=>{ea.key===q.SKETCH_KEYS.snappingToggle&&
(this.snappingOptions.enabledToggled=!1,ea.stopPropagation())},B.ViewEventPriorities.WIDGET));return ha});return function(O,R,Q){return H.apply(this,arguments)}}();U._setupTransformOrReshapeOperation=function(){var H=g._asyncToGenerator(function*(O,R,Q,W){var Y=this;const {multipleSelectionEnabled:ba}=Q;this.updateGraphics.addMany(O);O="transform"===R?yield this._getBox(O,Q,W):yield this._getReshape(O,Q,W);if(ca(O))return O;const Z=new V.UpdateOperationHandle({activeComponent:O,type:"update",onEnd:()=>
{ha.forEach(ea=>ea.remove());ka.forEach(ea=>ea.remove());ha=[];ka=[];Z.activeComponent&&!Z.activeComponent.destroyed&&Z.activeComponent.destroy();this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray())},undo:()=>{C(Z,this.updateGraphics.toArray());Z.refreshComponent();this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:Z.tool})},redo:()=>{P(Z,this.updateGraphics.toArray());Z.refreshComponent();this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:Z.tool})},addToSelection:function(){var ea=
g._asyncToGenerator(function*(da){var fa=Z.activeComponent;if("reshape"===fa.type){fa=[...Y.updateGraphics,da];Y.updateGraphics.removeAll();fa=yield Y._setupMoveOperation(fa,Q,W);if(ca(fa))return;Z.onEnd();Z.destroy();Y._setUpdateOperationHandle(fa,Q)}else Y.updateGraphics.add(da),fa.graphics=Y.updateGraphics.toArray(),fa.refresh(),Z.resetHistory();Y.emit("update",{graphics:Y.updateGraphics.toArray(),state:"active",aborted:!1,tool:Y.activeTool,toolEventInfo:{added:[da],removed:[],type:"selection-change"},
type:"update"})});return function(da){return ea.apply(this,arguments)}}(),removeFromSelection:function(){var ea=g._asyncToGenerator(function*(da){const fa=Y.updateGraphics.indexOf(da);Z.history.undo.forEach(ma=>ma.updates.splice(fa,1));Z.history.redo.forEach(ma=>ma.updates.splice(fa,1));Y.updateGraphics.remove(da);const na=Y.updateGraphics.toArray();if(0===na.length)Z.complete();else{const ma=na[0].geometry;1!==na.length||!t.isSome(ma)||"point"!==ma.type&&"multipoint"!==ma.type?Z.activeComponent.graphics=
na:Z.toggleTool()}Y.emit("update",{graphics:na,state:"active",aborted:!1,tool:Y.activeTool,toolEventInfo:{added:[],removed:[da],type:"selection-change"},type:"update"})});return function(da){return ea.apply(this,arguments)}}(),toggleTool:function(){var ea=g._asyncToGenerator(function*(){if(!(1<Y.updateGraphics.length)){var da=Y.updateGraphics.getItemAt(0),fa=da.geometry;t.isSome(fa)&&("reshape"===Z.tool&&("point"===fa.type||"multipoint"===fa.type)||"transform"===Z.tool&&"extent"===fa.type)||(fa=null,
"transform"===Z.tool?fa=yield Y._getReshape([da],Q,W):"reshape"===Z.tool&&(fa=yield Y._getBox([da],Q,W)),ca(fa)||(Z.activeComponent.destroy(),Z.activeComponent=fa,Z.activeComponent&&(ha.forEach(na=>na.remove()),ha=Y._getHandlesForComponent(Z,Q))))}});return function(){return ea.apply(this,arguments)}}()});let ka=[W.on("immediate-click",function(){var ea=g._asyncToGenerator(function*(da){var fa;const na=yield da.async(()=>Y._getFirstHit(N.createScreenPointFromEvent(da)));null!=(fa=na.results)&&fa.length?
na.results.some(ma=>{if(ma.graphic){var qa;ma=ma.graphic;if(null!=(qa=da.native)&&qa.shiftKey&&ba)return da.stopPropagation(),Z.addToSelection(ma),!0;if(ma.layer===Y.layer)return Z.complete(),!0}return!1}):Z.complete()});return function(da){return ea.apply(this,arguments)}}(),B.ViewEventPriorities.WIDGET),W.on("key-down",ea=>{this._getCommonUpdateOperationKeyDownHandlers(Z,ea);ea.key!==q.SKETCH_KEYS.snappingToggle||ea.repeat||(this.snappingOptions.enabledToggled=!0,ea.stopPropagation());ea.key===
q.SKETCH_KEYS.constraint&&!ea.repeat&&Z&&(ea=Z.activeComponent)&&"box"===ea.type&&(ea.preserveAspectRatio=!ea.preserveAspectRatio)},B.ViewEventPriorities.WIDGET),W.on("key-up",ea=>{var da;ea.key===q.SKETCH_KEYS.snappingToggle&&"reshape"===(null==Z?void 0:null==(da=Z.activeComponent)?void 0:da.type)&&(this.snappingOptions.enabledToggled=!1,ea.stopPropagation());ea.key===q.SKETCH_KEYS.constraint&&Z&&(ea=Z.activeComponent)&&"box"===ea.type&&(ea.preserveAspectRatio=!ea.preserveAspectRatio)},B.ViewEventPriorities.WIDGET)],
ha=this._getHandlesForComponent(Z,Q);return Z});return function(O,R,Q,W){return H.apply(this,arguments)}}();U._getGraphicMover=function(){var H=g._asyncToGenerator(function*(O,R,Q){({enableMoveAllGraphics:R}=R);const W=yield this._requireModule(new Promise(function(Y,ba){f(["../../views/draw/support/GraphicMover"],function(Z){Y(L(Z))},ba)}));return ca(W)?W:new W.module.default({enableMoveAllGraphics:R,graphics:O,view:Q,callbacks:{onGraphicMoveStart:({dx:Y,dy:ba,graphic:Z})=>{this._displayGrabbingCursor();
this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:Y,dy:ba,mover:Z,type:"move-start"},type:"update"})},onGraphicMove:({dx:Y,dy:ba,graphic:Z})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:Y,dy:ba,mover:Z,type:"move"},type:"update"}),onGraphicMoveStop:({dx:Y,dy:ba,graphic:Z})=>{this._displayPointerCursor();this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:Y,dy:ba,mover:Z,type:"move-stop"},type:"update"})},onGraphicPointerOver:()=>this._displayPointerCursor(),onGraphicPointerOut:()=>this._displayDefaultCursor()}})});return function(O,R,Q){return H.apply(this,arguments)}}();U._getBox=function(){var H=g._asyncToGenerator(function*(O,R,Q){const {enableRotation:W,enableScaling:Y,preserveAspectRatio:ba}=R;R=yield this._requireModule(new Promise(function(Z,ka){f(["../../views/draw/support/Box"],
function(ha){Z(L(ha))},ka)}));return ca(R)?R:new R.module.default({graphics:O,enableRotation:W,enableScaling:Y,preserveAspectRatio:ba,layer:this._internalGraphicsLayer,view:Q,callbacks:{onMoveStart:Z=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...Z},type:"update"}),onMove:Z=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...Z},type:"update"}),onMoveStop:Z=>
this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...Z},type:"update"}),onScaleStart:Z=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...Z},type:"update"}),onScale:Z=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...Z},type:"update"}),onScaleStop:Z=>this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...Z},type:"update"}),onRotateStart:Z=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...Z},type:"update"}),onRotate:Z=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...Z},type:"update"}),onRotateStop:Z=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,
toolEventInfo:{...Z},type:"update"})}})});return function(O,R,Q){return H.apply(this,arguments)}}();U._getReshape=function(){var H=g._asyncToGenerator(function*(O,R,Q){var W,Y;const ba="split"===(null==(W=R.reshapeOptions)?void 0:W.edgeOperation);R="move"===(null==(Y=R.reshapeOptions)?void 0:Y.shapeOperation);Y=yield this._requireModule(new Promise(function(Z,ka){f(["../../views/draw/support/Reshape"],function(ha){Z(L(ha))},ka)}));return ca(Y)?Y:new Y.module.default({enableMidpoints:ba,enableMovement:R,
graphic:O[0],layer:this._internalGraphicsLayer,snappingManager:this._snappingManager,view:Q,callbacks:{onReshapeStart:Z=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...Z},type:"update"}),onReshape:Z=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...Z},type:"update"}),onReshapeStop:({mover:Z,type:ka})=>this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:Z,type:ka},type:"update"}),onMoveStart:({dx:Z,dy:ka,mover:ha,type:ea})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:Z,dy:ka,mover:ha,type:ea},type:"update"}),onMove:({dx:Z,dy:ka,mover:ha,type:ea})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:Z,dy:ka,mover:ha,type:ea},type:"update"}),
onMoveStop:({dx:Z,dy:ka,mover:ha,type:ea})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:Z,dy:ka,mover:ha,type:ea},type:"update"}),onVertexAdd:({added:Z,type:ka,vertices:ha})=>{Z=Z.map(ea=>k.geometryToCoordinates(ea.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:Z,vertices:ha,type:ka},type:"update"})},onVertexRemove:({removed:Z,type:ka,
vertices:ha})=>{Z=Z.map(ea=>k.geometryToCoordinates(ea.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{removed:Z,vertices:ha,type:ka},type:"update"})}}})});return function(O,R,Q){return H.apply(this,arguments)}}();U._getHandlesForComponent=function(H,O){const R=H.activeComponent;switch(R.type){case "graphic-mover":return[R.on("graphic-click",({graphic:Q,viewEvent:W})=>{var Y;null!=(Y=W.native)&&Y.shiftKey&&(W.stopPropagation(),
H.removeFromSelection(Q))}),R.on("graphic-move-start",Q=>H.addToHistory(aa(Q.allGraphics)))];case "box":return[R.on("graphic-click",Q=>this._onTransformOrReshape2DGraphicClick(H,O,Q)),R.on("move-start",Q=>H.addToHistory(aa(Q.graphics))),R.on("rotate-start",Q=>H.addToHistory(aa(Q.graphics))),R.on("scale-start",Q=>H.addToHistory(aa(Q.graphics)))];case "reshape":return[R.on("graphic-click",Q=>this._onTransformOrReshape2DGraphicClick(H,O,Q)),R.on("move-start",Q=>H.addToHistory(aa([Q.mover]))),R.on("reshape-start",
Q=>H.addToHistory(aa([Q.graphic]))),R.on("vertex-add",Q=>H.addToHistory(aa([Q.oldGraphic]))),R.on("vertex-remove",Q=>H.addToHistory(aa([Q.oldGraphic])))];case "move-3d":return[R.on("graphic-move-start",Q=>{H.addToHistory(aa(Q.allGraphics));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:0<Q.allGraphics.length?Q.allGraphics[0]:null,type:"move-start"},type:"update"})}),R.on("graphic-move",Q=>{this.emit("update",
{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:Q.dx,dy:Q.dy,mover:0<Q.allGraphics.length?Q.allGraphics[0]:null,type:"move"},type:"update"})}),R.on("graphic-move-stop",Q=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:0<Q.allGraphics.length?Q.allGraphics[0]:null,type:"move-stop"},type:"update"})}),R.on("immediate-click",Q=>{Q.shiftKey?this._toggleSelection([Q.graphic],
H,O):H.toggleTool()})];case "transform-3d":return[R.on("record-undo",({record:Q})=>{H.addToHistory({updates:[Q]})}),R.on("graphic-translate-start",Q=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:Q.graphic,dx:Q.dxScreen,dy:Q.dyScreen,type:"move-start"},type:"update"})}),R.on("graphic-translate-stop",Q=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:Q.graphic,
dx:Q.dxScreen,dy:Q.dyScreen,type:"move-stop"},type:"update"})}),R.on("graphic-rotate-start",Q=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:Q.graphic,angle:Q.angle,type:"rotate-start"},type:"update"})}),R.on("graphic-rotate-stop",Q=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:Q.graphic,angle:Q.angle,type:"rotate-stop"},type:"update"})}),
R.on("graphic-scale-start",Q=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:Q.graphic,xScale:Q.xScale,yScale:Q.yScale,type:"scale-start"},type:"update"})}),R.on("graphic-scale-stop",Q=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:Q.graphic,xScale:Q.xScale,yScale:Q.yScale,type:"scale-stop"},type:"update"})}),R.on("graphic-translate",Q=>
{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:Q.graphic,dx:Q.dxScreen,dy:Q.dyScreen,type:"move"},type:"update"})}),R.on("graphic-rotate",Q=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:Q.graphic,angle:Q.angle,type:"rotate"},type:"update"})}),R.on("graphic-scale",Q=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",
aborted:!1,tool:this.activeTool,toolEventInfo:{mover:Q.graphic,xScale:Q.xScale,yScale:Q.yScale,type:"scale"},type:"update"})}),R.on("immediate-click",Q=>{Q.shiftKey?this._toggleSelection([Q.graphic],H,O):H.toggleTool()})];case "reshape-3d":return[R.on("reshape",Q=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:Q,type:"update"})}),R.on("move",Q=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,
tool:this.activeTool,toolEventInfo:Q,type:"update"})}),R.on("vertex-add",Q=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:Q,type:"update"})}),R.on("vertex-remove",Q=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:Q,type:"update"})}),R.on("immediate-click",Q=>{Q.shiftKey?this._toggleSelection([Q.graphic],H,O):H.toggleTool()})]}};U._onTransformOrReshape2DGraphicClick=
function(H,O,R){var Q;const {graphic:W,viewEvent:Y}=R;if(null!=(Q=Y.native)&&Q.shiftKey&&W.layer===this.layer)return Y.stopPropagation(),H.removeFromSelection(W);if(O.toggleToolOnClick)return Y.stopPropagation(),H.toggleTool()};U._setUpdateOperationHandle=function(H,O){this._operationHandle=H;const R=this.view.map;this._disablePopup(O);H.on("complete",()=>{if(H===this._operationHandle){const Q=this.updateGraphics.toArray(),W=this._operationHandle.tool;this._operationHandle.destroy();this._operationHandle=
null;this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray());this.updateGraphics.removeAll();R&&R.remove(this._internalGraphicsLayer);this._restorePopup(O);this.emit("update",{graphics:Q,state:"complete",aborted:H.cancelled,tool:W,toolEventInfo:null,type:"update"})}})};U._getCommonUpdateOperationClickHandlers=function(){var H=g._asyncToGenerator(function*(O,R,Q){const W=N.createScreenPointFromEvent(R),Y=(yield R.async(()=>this._getFirstHit(W))).results;Y.length?R.native.shiftKey&&this._toggleSelection(Y.map(ba=>
ba.graphic),O,Q)?R.stopPropagation():Y.some(ba=>ba.graphic&&this.updateGraphics.includes(ba.graphic))?R.stopPropagation():O.complete():O.complete()});return function(O,R,Q){return H.apply(this,arguments)}}();U._toggleSelection=function(H,O,R){const Q=!!R.multipleSelectionEnabled;return H.some(W=>null==W?!1:Q&&W.layer===this.layer?(this.updateGraphics.includes(W)?O.removeFromSelection(W):O.addToSelection(W),!0):!1)};U._getCommonUpdateOperationKeyDownHandlers=function(H,O){if(H){var R=O.key;R===q.SKETCH_KEYS.undo&&
H.canUndo()?(O.stopPropagation(),H.undo()):R===q.SKETCH_KEYS.redo&&H.canRedo()?(O.stopPropagation(),H.redo()):R===q.SKETCH_KEYS.cancel?(O.stopPropagation(),H.cancel()):this.allowDeleteKey&&q.SKETCH_KEYS.delete.includes(R)&&this._onDeleteKey(O)}};U._onDeleteKey=function(H){if(this._operationHandle&&"update"===this._operationHandle.type){var O=this.activeComponent,R=this.updateGraphics.toArray();t.isNone(O)||"reshape-3d"===O.type||"reshape"===O.type&&(1!==R.length||"point"!==t.get(R[0].geometry,"type"))||
(H.stopPropagation(),this.delete())}};U._removeDefaultLayer=function(){this._internalGraphicsLayer&&(this.view&&this.view.map&&this.view.map.remove(this._internalGraphicsLayer),this._internalGraphicsLayer=t.destroyMaybe(this._internalGraphicsLayer))};U._isComponentGraphic=function(H){const {activeComponent:O}=this;return!H||t.isNone(O)?!1:H.attributes&&H.attributes.esriSketchTool?!0:("box"===O.type||"reshape"===O.type)&&O.isUIGraphic(H)};U._displayPointerCursor=function(){this.view&&this.view.container&&
"pointer"!==this.view.cursor&&(this.view.cursor="pointer")};U._displayGrabbingCursor=function(){this.view&&this.view.container&&"grabbing"!==this.view.cursor&&(this.view.cursor="grabbing")};U._displayDefaultCursor=function(){this.view&&this.view.container&&null!==this.view.cursor&&(this.view.cursor=null)};U._logError=function(H,O,R){ia.error(new J(H,O,R))};U._requireModule=function(){var H=g._asyncToGenerator(function*(O){const R=new AbortController;this._moduleLoaderAbortController=R;O=yield O;return this._moduleLoaderAbortController!==
R||R.signal.aborted?{requireError:"aborted"}:{module:O}});return function(O){return H.apply(this,arguments)}}();U._emitUndoEvent=function(H){this.emit("undo",{...H,type:"undo"})};U._emitRedoEvent=function(H){this.emit("redo",{...H,type:"redo"})};U._emitDeleteEvent=function(H){this.emit("delete",{...H,type:"delete"})};U.test=function(){return{operationHandle:this._operationHandle,defaultUpdateOptions:oa}};U.wait=function(){return c.whenNotOnce(this,"updating")};U._beginAsyncOperation=function(){this._numUpdating+=
1;this.notifyChange("updating")};U._endAsyncOperation=function(){--this._numUpdating;this.notifyChange("updating")};U._disablePopupEnabled=function(H){var O;return"3d"!==(null==(O=this.view)?void 0:O.type)||this.updateOnGraphicClick||t.isSome(H)&&H.toggleToolOnClick};U._disablePopup=function(H){this._disablePopupEnabled(H)&&(H=this.view.popup)&&t.isNone(this._originalAutoOpenEnabled)&&(this._originalAutoOpenEnabled=H.autoOpenEnabled,H.autoOpenEnabled=!1)};U._restorePopup=function(H){this._disablePopupEnabled(H)&&
(H=this.view.popup)&&t.isSome(this._originalAutoOpenEnabled)&&(H.autoOpenEnabled=this._originalAutoOpenEnabled,this._originalAutoOpenEnabled=null)};U._waitViewReady=function(){var H=g._asyncToGenerator(function*(){this.view&&(t.abortMaybe(this._viewReadyAbortController),this._viewReadyAbortController=m.createAbortController(),yield m.whenOrAbort(c.whenOnce(this.view,"ready"),this._viewReadyAbortController.signal))});return function(){return H.apply(this,arguments)}}();g._createClass(pa,[{key:"_defaultUpdateTool",
get:function(){return"3d"===this.view.type?"move":"transform"}},{key:"updating",get:function(){return 0<this._numUpdating}},{key:"activeTool",get:function(){return this._operationHandle&&this._operationHandle.tool?this._operationHandle.tool:null}},{key:"activeComponent",get:function(){return this._operationHandle?this._operationHandle.activeComponent:null}},{key:"createGraphic",get:function(){return!t.isSome(this.activeComponent)||"draw-3d"!==this.activeComponent.type&&"draw-2d"!==this.activeComponent.type?
this._get("createGraphic"):t.unwrap(this.activeComponent.graphic)}},{key:"defaultCreateOptions",set:function(H){this._set("defaultCreateOptions",{...la,...H})}},{key:"defaultUpdateOptions",set:function(H){this._set("defaultUpdateOptions",{...oa,...H,reshapeOptions:{...oa.reshapeOptions,...null==H?void 0:H.reshapeOptions}})}},{key:"snappingOptions",set:function(H){t.isSome(this._snappingManager)&&(this._snappingManager.options=H);this._set("snappingOptions",H)}},{key:"state",get:function(){var H;const O=
!(null==(H=this.view)||!H.ready||!this.layer);H=this._operationHandle;return O&&H?"active":O?"ready":"disabled"}},{key:"view",get:function(){return this._get("view")},set:function(H){const O=this._get("view");if(O){const {container:R,map:Q}=O;R&&(O.cursor=null);Q&&Q.remove(this._internalGraphicsLayer);this._viewHandles.removeAll();this.cancel()}this._handles.remove("view-ready");H&&this._handles.add(c.when(H,"ready",R=>{this._viewHandles.removeAll();R&&this._viewHandles.add(this._generateViewHandles(H))},
!0),"view-ready");this._set("view",H)}}]);return pa}(G.EventedAccessor);a.__decorate([e.property()],F.prototype,"updating",null);a.__decorate([e.property()],F.prototype,"_operationHandle",void 0);a.__decorate([e.property({readOnly:!0})],F.prototype,"activeTool",null);a.__decorate([e.property()],F.prototype,"activeFillSymbol",void 0);a.__decorate([e.property()],F.prototype,"activeLineSymbol",void 0);a.__decorate([e.property()],F.prototype,"activeVertexSymbol",void 0);a.__decorate([e.property()],F.prototype,
"allowDeleteKey",void 0);a.__decorate([e.property({readOnly:!0})],F.prototype,"createGraphic",null);a.__decorate([e.property()],F.prototype,"defaultCreateOptions",null);a.__decorate([e.property()],F.prototype,"defaultUpdateOptions",null);a.__decorate([e.property()],F.prototype,"layer",void 0);a.__decorate([e.property({types:w.symbolTypes})],F.prototype,"pointSymbol",void 0);a.__decorate([e.property({types:w.symbolTypes})],F.prototype,"polygonSymbol",void 0);a.__decorate([e.property({types:w.symbolTypes})],
F.prototype,"polylineSymbol",void 0);a.__decorate([e.property({type:A,nonNullable:!0})],F.prototype,"snappingOptions",null);a.__decorate([e.property()],F.prototype,"_snappingManager",void 0);a.__decorate([e.property({readOnly:!0})],F.prototype,"state",null);a.__decorate([e.property({readOnly:!0})],F.prototype,"updateGraphics",void 0);a.__decorate([e.property()],F.prototype,"updateOnGraphicClick",void 0);a.__decorate([e.property({types:w.symbolTypes})],F.prototype,"updatePointSymbol",void 0);a.__decorate([e.property({types:w.symbolTypes})],
F.prototype,"updatePolygonSymbol",void 0);a.__decorate([e.property({types:w.symbolTypes})],F.prototype,"updatePolylineSymbol",void 0);a.__decorate([e.property({types:w.symbolTypes})],F.prototype,"vertexSymbol",void 0);a.__decorate([e.property({value:null})],F.prototype,"view",null);a.__decorate([e.property()],F.prototype,"cancel",null);a.__decorate([e.property()],F.prototype,"complete",null);a.__decorate([e.property()],F.prototype,"delete",null);a.__decorate([e.property()],F.prototype,"create",null);
a.__decorate([e.property()],F.prototype,"update",null);a.__decorate([e.property()],F.prototype,"undo",null);a.__decorate([e.property()],F.prototype,"redo",null);a.__decorate([e.property()],F.prototype,"canUndo",null);a.__decorate([e.property()],F.prototype,"canRedo",null);a.__decorate([e.property()],F.prototype,"toggleUpdateTool",null);return F=a.__decorate([r.subclass("esri.widgets.Sketch.SketchViewModel")],F)})},"esri/core/reactiveUtils":function(){define(["exports","./events","./handleUtils","./maybe",
"./accessorSupport/watch"],function(f,g,a,w,z){function F(K,D,t={},m){let b=null;const c=t.once?(e,h)=>{m(e)&&(w.removeMaybe(b),D(e,h))}:(e,h)=>{m(e)&&D(e,h)};b=z.watchTracked(K,c,t.sync);t.immediate&&(K=K(),c(K,K));return b}function J(K){return!0}function G(K){return!!K}f.SYNC_AND_IMMEDIATE={sync:!0,immediate:!0};f.react=function(K,D,t={}){return F(K,D,t,J)};f.reactListener=function(K,D,t,m={}){function b(){e&&h&&(h.remove(),null==m.onListenerRemove?void 0:m.onListenerRemove(e),h=e=null)}function c(k){m.once&&
m.once&&w.removeMaybe(r);t(k)}let e=null,h=null,r=null;const d=z.watchTracked(K,(k,n)=>{b();g.isEventTarget(k)&&(e=k,h=g.on(k,D,c),null==m.onListenerAdd?void 0:m.onListenerAdd(k))},m.sync);return r=a.makeHandle(()=>{d.remove();b()})};f.reactTruthy=function(K,D,t={}){return F(K,D,t,G)};Object.defineProperty(f,"__esModule",{value:!0})})},"esri/layers/GraphicsLayer":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/accessorSupport/decorators/property ../core/has ../core/accessorSupport/ensureType ../core/Logger ../core/accessorSupport/decorators/subclass ./Layer ./mixins/BlendLayer ./mixins/ScaleRangeLayer ../support/GraphicsCollection ../symbols/support/ElevationInfo".split(" "),
function(f,g,a,w,z,F,J,G,K,D,t,m){w=function(b){function c(h){h=b.call(this,h)||this;h.elevationInfo=null;h.graphics=new t["default"];h.screenSizePerspectiveEnabled=!0;h.type="graphics";h.internal=!1;return h}f._inheritsLoose(c,b);var e=c.prototype;e.destroy=function(){this.removeAll();this.graphics.destroy()};e.add=function(h){this.graphics.add(h);return this};e.addMany=function(h){this.graphics.addMany(h);return this};e.removeAll=function(){this.graphics.removeAll();return this};e.remove=function(h){this.graphics.remove(h)};
e.removeMany=function(h){this.graphics.removeMany(h)};e.on=function(h,r){return b.prototype.on.call(this,h,r)};e.graphicChanged=function(h){this.emit("graphic-update",h)};return c}(K.BlendLayer(D.ScaleRangeLayer(G)));g.__decorate([a.property({type:m})],w.prototype,"elevationInfo",void 0);g.__decorate([a.property(t.graphicsCollectionProperty())],w.prototype,"graphics",void 0);g.__decorate([a.property({type:["show","hide"]})],w.prototype,"listMode",void 0);g.__decorate([a.property()],w.prototype,"screenSizePerspectiveEnabled",
void 0);g.__decorate([a.property({readOnly:!0})],w.prototype,"type",void 0);g.__decorate([a.property({constructOnly:!0})],w.prototype,"internal",void 0);return w=g.__decorate([J.subclass("esri.layers.GraphicsLayer")],w)})},"esri/views/DOMContainer":function(){define("exports ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/domUtils ../core/scheduling ../core/watchUtils ../core/accessorSupport/decorators/property ../core/has ../core/accessorSupport/ensureType ../core/Logger ../core/accessorSupport/decorators/subclass ./overlay/ViewOverlay ../widgets/Popup".split(" "),
function(f,g,a,w,z,F,J,G,K,D,t,m,b){function c(h){h&&(w.empty(h),h.parentNode&&h.parentNode.removeChild(h))}const e=[0,0];f.DOMContainer=h=>{h=function(r){function d(...n){var u=r.call(this,...n)||this;u._freqInfo={freq:16,time:750};u._overlayRenderTaskHandle=null;u.height=0;u.position=null;u.resizing=!1;u.root=null;u.surface=null;u.suspended=!0;u.ui=null;u.userContent=null;u.width=0;u.widthBreakpoint=null;u.handles.add([u.watch("cursor",l=>{const p=u.surface;p&&p.setAttribute("data-cursor",l)}),
u.watch("interacting",l=>{const p=u.surface;p&&p.setAttribute("data-interacting",l.toString())})]);return u}g._inheritsLoose(d,r);var k=d.prototype;k.initialize=function(){this.handles.add(this.watch("ui",(n,u)=>this._handleUIChange(n,u)));this._wireUI(this.ui);this.handles.add([this.on("focus",()=>this.notifyChange("focused")),this.on("blur",()=>this.notifyChange("focused"))])};k.destroy=function(){this.destroyed||(this.ui&&(this.ui.destroy(),this.ui=null),this.popup&&!this.popup.destroyed&&this.popup.destroy(),
this.container=null)};k.blur=function(){this.surface&&this.surface.blur()};k.focus=function(){this.surface&&this.surface.focus()};k.pageToContainer=function(n,u,l){const p=this.position;n-=p[0];u-=p[1];l?(l[0]=n,l[1]=u):l=[n,u];return l};k.containerToPage=function(n,u,l){const p=this.position;n+=p[0];u+=p[1];l?(l[0]=n,l[1]=u):l=[n,u];return l};k._handleUIChange=function(n,u){u&&(this.handles.remove("ui"),u.destroy());n&&this._wireUI(n);this._set("ui",n)};k._wireUI=function(n){this.handles.remove("ui");
n&&(n.view=this,this.handles.add([F.init(this,"root",u=>{if(u){{const l=document.createElement("div");u.appendChild(l);u=l}}else u=null;n.container=u}),F.init(this,"popup",(u,l)=>{l&&n.remove(l,"popup");u&&(u.view=n.view,n.add(u,{key:"popup",position:"manual"}))})],"ui"))};k._stopMeasuring=function(){this.handles.remove("measuring");this._get("resizing")&&this._set("resizing",!1)};k._startMeasuring=function(){const n=this._freqInfo;n.freq=16;n.time=750;this.handles.add([(()=>{const u=()=>{n.freq=
16;n.time=750};window.addEventListener("resize",u);return{remove(){window.removeEventListener("resize",u)}}})(),z.addFrameTask({prepare:u=>{const l=this._measure(),p=this._freqInfo;p.time+=u.deltaTime;l&&(p.freq=16,this._get("resizing")||this._set("resizing",!0));p.time<p.freq||(p.time=0,this._position()||l?p.freq=16:p.freq=Math.min(750,2*p.freq),!l&&512<=p.freq&&this._get("resizing")&&this._set("resizing",!1))}})],"measuring");this._measure();this._position()};k._measure=function(){var n=this.container;
const u=n?n.clientWidth:0;n=n?n.clientHeight:0;if(0===u||0===n)return this.suspended||this._set("suspended",!0),!1;const l=this.width,p=this.height;if(u===l&&n===p)return this.suspended&&this._set("suspended",!1),!1;this._set("width",u);this._set("height",n);this.suspended&&this._set("suspended",!1);this.emit("resize",{oldWidth:l,oldHeight:p,width:u,height:n});return!0};k._position=function(){var n=this.container;const u=this.position;{const l=(n.ownerDocument||window.document).defaultView;n=n.getBoundingClientRect();
e[0]=n.left+l.pageXOffset;e[1]=n.top+l.pageYOffset}return u&&e[0]===u[0]&&e[1]===u[1]?!1:(this._set("position",[e[0],e[1]]),!0)};k.forceDOMReadyCycle=function(){};g._createClass(d,[{key:"container",set:function(n){var u=this._get("container");if(u!==n)if(this.handles.remove("dom-size"),this._stopMeasuring(),u&&(u.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay.destroy(),this._set("overlay",null),
c(this.root),this._set("root",null),w.reparent(this.userContent,u),c(this.userContent),this._set("userContent",null)),n){n.classList.add("esri-view");u=document.createElement("div");u.className="esri-view-user-storage";w.reparent(n,u);n.appendChild(u);this._set("userContent",u);u=document.createElement("div");u.className="esri-view-root";n.insertBefore(u,n.firstChild);this._set("root",u);const l=document.createElement("div");l.className="esri-view-surface";l.setAttribute("role","application");l.tabIndex=
0;u.appendChild(l);this._set("surface",l);const p=new m;u.appendChild(p.surface);this._set("overlay",p);p.watch("needsRender",E=>{E&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=z.addFrameTask({render:()=>{this.overlay.render()}}):this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null)});this.forceDOMReadyCycle();this.handles.add(F.init(this,"size",E=>{const [x,M]=E;x>=document.body.clientWidth||M>=document.body.clientHeight?l.classList.add("esri-view-surface--inset-outline"):
l.classList.remove("esri-view-surface--inset-outline")}),"dom-size");this._set("container",n);this._startMeasuring()}else this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),this._set("container",null)}},{key:"focused",get:function(){const n=document.activeElement===this.surface;return document.hasFocus()&&n}},{key:"popup",get:function(){return this._get("popup")||new b({view:this})},set:function(n){const u=this._get("popup");u&&
u!==n&&u.destroy();this._set("popup",n)}},{key:"size",get:function(){return[this.width,this.height]}}]);return d}(h);a.__decorate([J.property({value:null,cast:r=>w.byId(r)})],h.prototype,"container",null);a.__decorate([J.property({readOnly:!0})],h.prototype,"focused",null);a.__decorate([J.property({readOnly:!0})],h.prototype,"height",void 0);a.__decorate([J.property({type:b})],h.prototype,"popup",null);a.__decorate([J.property({type:m})],h.prototype,"overlay",void 0);a.__decorate([J.property({readOnly:!0})],
h.prototype,"position",void 0);a.__decorate([J.property({readOnly:!0})],h.prototype,"resizing",void 0);a.__decorate([J.property({readOnly:!0})],h.prototype,"root",void 0);a.__decorate([J.property({value:null,readOnly:!0})],h.prototype,"size",null);a.__decorate([J.property({readOnly:!0})],h.prototype,"surface",void 0);a.__decorate([J.property({readOnly:!0})],h.prototype,"suspended",void 0);a.__decorate([J.property()],h.prototype,"ui",void 0);a.__decorate([J.property({readOnly:!0})],h.prototype,"userContent",
void 0);a.__decorate([J.property({readOnly:!0})],h.prototype,"width",void 0);a.__decorate([J.property()],h.prototype,"widthBreakpoint",void 0);return h=a.__decorate([t.subclass("esri.views.DOMContainer")],h)};f.isDOMContainer=function(h){return h&&"focus"in h};Object.defineProperty(f,"__esModule",{value:!0})})},"esri/views/overlay/ViewOverlay":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Collection ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/accessorSupport/decorators/subclass ../../libs/maquette/projection ../../libs/maquette/projector ../support/WatchUpdatingTracking".split(" "),
function(f,g,a,w,z,F,J,G,K,D,t,m){a=function(b){function c(){var h=b.apply(this,arguments)||this;h.items=new w;h._watchUpdatingTracking=new m.WatchUpdatingTracking;h._callbacks=new Map;h._projector=t.createProjector();h._hiddenProjector=t.createProjector();return h}f._inheritsLoose(c,b);var e=c.prototype;e.initialize=function(){const h=document.createElement("div");h.className="esri-overlay-surface";this._set("surface",h);this._hiddenSurface=document.createElement("div");this._hiddenSurface.setAttribute("style",
"visibility: hidden;");h.appendChild(this._hiddenSurface);this._watchUpdatingTracking.addOnCollectionChange(this.items,r=>{r.added.map(d=>{const k=()=>d.render();this._callbacks.set(d,k);this._projector.append(this.surface,k)});r.removed.map(d=>{const k=this._projector.detach(this._callbacks.get(d));this.surface.removeChild(k.domNode);this._callbacks.delete(d)})})};e.addItem=function(h){this.items.add(h)};e.removeItem=function(h){this.items.remove(h)};e.destroy=function(){this.items.removeAll();this._callbacks.forEach(h=>
this._projector.detach(h));this._projector=this._callbacks=null;this._watchUpdatingTracking.destroy()};e.render=function(){this._projector.renderNow()};e.computeBoundingRect=function(h){const r=this._hiddenSurface,d=this._hiddenProjector;let k=null;const n=()=>k=h.render();d.append(r,n);d.renderNow();const u={left:0,top:0,right:0,bottom:0};if(k&&k.domNode){const l=k.domNode.getBoundingClientRect();u.left=l.left;u.top=l.top;u.right=l.right;u.bottom=l.bottom}for(d.detach(n);r.firstChild;)r.removeChild(r.firstChild);
return u};e.overlaps=function(h,r){h=this.computeBoundingRect(h);r=this.computeBoundingRect(r);return Math.max(h.left,r.left)<=Math.min(h.right,r.right)&&Math.max(h.top,r.top)<=Math.min(h.bottom,r.bottom)};e.renderCanvas=function(h){if(this.items.some(d=>d.visible)){var r=h.getContext("2d");r.save();r.font=`10px ${getComputedStyle(this.surface).fontFamily}`;this.items.forEach(d=>{r.save();d.renderCanvas(r);r.restore()});r.restore()}};f._createClass(c,[{key:"needsRender",get:function(){return 0<this.items.length}},
{key:"hasVisibleItems",get:function(){return this.items.some(h=>h.visible)}}]);return c}(a);g.__decorate([z.property({readOnly:!0})],a.prototype,"surface",void 0);g.__decorate([z.property({readOnly:!0})],a.prototype,"items",void 0);g.__decorate([z.property({readOnly:!0})],a.prototype,"needsRender",null);g.__decorate([z.property({readOnly:!0})],a.prototype,"_watchUpdatingTracking",void 0);g.__decorate([z.property({readOnly:!0,aliasOf:"_watchUpdatingTracking.updating"})],a.prototype,"updating",void 0);
return a=g.__decorate([K.subclass("esri.views.overlay.ViewOverlay")],a)})},"esri/widgets/Popup":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../intl ../core/Collection ../core/events ../core/Handles ../core/Logger ../core/maybe ../core/throttle ../core/watchUtils ../core/accessorSupport/decorators/aliasOf ../core/has ../core/accessorSupport/decorators/cast ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/subclass ./Feature ./Spinner ./Widget ./Feature/support/FeatureContentMixin ./Popup/PopupViewModel ./support/Heading ./support/decorators/accessibleHandler ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory ./support/widgetUtils ../intl/substitute".split(" "),
function(f,g,a,w,z,F,J,G,K,D,t,m,b,c,e,h,r,d,k,n,u,l,p,E,x,M,B){function q(V,X){return void 0===X?`${"esri-popup"}__${V}`:`${"esri-popup"}__${V}-${X}`}const I={buttonEnabled:!0,position:"auto",breakpoint:{width:544}},A=J.getLogger("esri.widgets.Popup"),N={closeButton:!0,featureNavigation:!0};a=function(V){function X(v,L){var y=V.call(this,v,L)||this;y._blurClose=!1;y._blurContainer=!1;y._containerNode=null;y._mainContainerNode=null;y._featureMenuNode=null;y._actionsMenuNode=null;y._focusClose=!1;
y._focusContainer=!1;y._focusDockButton=!1;y._focusFeatureMenuButton=!1;y._focusActionsMenuButton=!1;y._focusFirstFeature=!1;y._focusFirstAction=!1;y._handles=new F;y._pointerOffsetInPx=16;y._spinner=null;y._feature=null;y._featureMenuIntersectionObserverCallback=([C])=>{null!=C&&C.isIntersecting&&y.viewModel.featurePage++};y._featureMenuIntersectionObserver=new IntersectionObserver(y._featureMenuIntersectionObserverCallback);y._displaySpinnerThrottled=K.throttle(()=>y._displaySpinner(),0);y.actions=
null;y.alignment="auto";y.autoCloseEnabled=null;y.autoOpenEnabled=null;y.defaultPopupTemplateEnabled=null;y.content=null;y.collapsed=!1;y.collapseEnabled=!0;y.dockEnabled=!1;y.featureCount=null;y.featureMenuOpen=!1;y.features=null;y.goToOverride=null;y.headingLevel=2;y.highlightEnabled=null;y.location=null;y.label=void 0;y.maxInlineActions=3;y.messages=null;y.messagesCommon=null;y.promises=null;y.selectedFeature=null;y.selectedFeatureIndex=null;y.spinnerEnabled=!0;y.title=null;y.updateLocationEnabled=
null;y.view=null;y.viewModel=new n;y.visible=null;y.visibleElements={...N};y._addSelectedFeatureIndexHandle();y.own([D.watch(f._assertThisInitialized(y),"viewModel.screenLocation",()=>y._positionContainer()),D.watch(f._assertThisInitialized(y),["viewModel.active","dockEnabled"],()=>y._toggleScreenLocationEnabled()),D.watch(f._assertThisInitialized(y),"viewModel.screenLocation",(C,P)=>{!!C!==!!P&&y.reposition()}),D.watch(f._assertThisInitialized(y),["viewModel.view.padding","viewModel.view.size","viewModel.active",
"viewModel.location","alignment"],()=>y.reposition()),D.watch(f._assertThisInitialized(y),"spinnerEnabled",C=>y._spinnerEnabledChange(C)),D.watch(f._assertThisInitialized(y),"viewModel.view.size",(C,P)=>y._updateDockEnabledForViewSize(C,P)),D.watch(f._assertThisInitialized(y),"viewModel.view",(C,P)=>y._viewChange(C,P)),D.watch(f._assertThisInitialized(y),"viewModel.view.ready",(C,P)=>y._viewReadyChange(C,P)),D.watch(f._assertThisInitialized(y),["viewModel.waitingForResult","viewModel.location"],()=>
{y._hideSpinner();y._displaySpinnerThrottled()}),D.watch(f._assertThisInitialized(y),["selectedFeatureWidget.viewModel.title","selectedFeatureWidget.viewModel.state"],()=>y._setTitleFromFeatureWidget()),D.watch(f._assertThisInitialized(y),["selectedFeatureWidget.viewModel.content","selectedFeatureWidget.viewModel.state"],()=>y._setContentFromFeatureWidget()),D.whenFalse(f._assertThisInitialized(y),"collapsed",()=>{var C,P;"xsmall"===(null==(C=y.viewModel)?void 0:null==(P=C.view)?void 0:P.widthBreakpoint)&&
y.viewModel.active&&y.collapseEnabled&&y.viewModel.centerAtLocation()}),D.on(f._assertThisInitialized(y),"viewModel.allActions","change",()=>y._watchActions()),D.init(f._assertThisInitialized(y),"viewModel.allActions",()=>y._watchActions()),D.watch(f._assertThisInitialized(y),"viewModel.featureViewModels",()=>y._featureMenuViewportScrollTop())]);return y}f._inheritsLoose(X,V);var T=X.prototype;T.destroy=function(){var v,L;this._destroySelectedFeatureWidget();this._destroySpinner();null==(v=this._handles)?
void 0:v.destroy();this._unobserveFeatureMenuObserver();null==(L=this._featureMenuIntersectionObserver)?void 0:L.disconnect();this._handles=null};T.castVisibleElements=function(v){return{...N,...v}};T.blur=function(){const {active:v}=this.viewModel;v||A.warn("Popup can only be blurred when currently active.");this.visibleElements.closeButton?this._blurClose=!0:this._blurContainer=!0;this.scheduleRender()};T.clear=function(){this.viewModel.clear()};T.close=function(){this.visible=!1};T.fetchFeatures=
function(v,L){return this.viewModel.fetchFeatures(v,L)};T.focus=function(){const {active:v}=this.viewModel;v||A.warn("Popup can only be focused when currently active.");this.visibleElements.closeButton?this._focusClose=!0:this._focusContainer=!0;this.scheduleRender()};T.next=function(){return this.viewModel.next()};T.open=function(v){var L,y;this._handles.remove("selected-index");const C={collapsed:v?!!v.collapsed:!1,actionsMenuOpen:v?!!v.actionsMenuOpen:!1,featureMenuOpen:v?!!v.featureMenuOpen:!1};
"xsmall"===(null==(L=this.viewModel)?void 0:null==(y=L.view)?void 0:y.widthBreakpoint)&&(C.collapsed=!0);this.set(C);this.viewModel.open(v);this._addSelectedFeatureIndexHandle()};T.previous=function(){return this.viewModel.previous()};T.reposition=function(){this.renderNow();this._positionContainer();this._setCurrentAlignment()};T.triggerAction=function(v){this.viewModel.triggerAction(v)};T.render=function(){var v,L,y,C;const {actionsMenuOpen:P,dockEnabled:S,featureMenuVisible:aa,dividedActions:ca,
currentAlignment:ia,currentDockPosition:la}=this,{active:oa}=this.viewModel;var {menuActions:ja}=ca;ja=oa&&1<ja.length&&P;const pa=null==(v=this.selectedFeature)?void 0:null==(L=v.layer)?void 0:L.title;v=null==(y=this.selectedFeature)?void 0:null==(C=y.layer)?void 0:C.id;return x.tsx("div",{class:this.classes("esri-popup",{["esri-popup--aligned-top-center"]:"top-center"===ia,["esri-popup--aligned-bottom-center"]:"bottom-center"===ia,["esri-popup--aligned-top-left"]:"top-left"===ia,["esri-popup--aligned-bottom-left"]:"bottom-left"===
ia,["esri-popup--aligned-top-right"]:"top-right"===ia,["esri-popup--aligned-bottom-right"]:"bottom-right"===ia,["esri-popup--is-docked"]:oa&&S,["esri-popup--shadow"]:oa&&!S,["esri-popup--is-docked-top-left"]:"top-left"===la,["esri-popup--is-docked-top-center"]:"top-center"===la,["esri-popup--is-docked-top-right"]:"top-right"===la,["esri-popup--is-docked-bottom-left"]:"bottom-left"===la,["esri-popup--is-docked-bottom-center"]:"bottom-center"===la,["esri-popup--is-docked-bottom-right"]:"bottom-right"===
la,["esri-popup--feature-menu-open"]:aa,["esri-popup--actions-menu-open"]:ja}),role:"presentation","data-layer-title":pa,"data-layer-id":v,bind:this,afterCreate:this._positionContainer,afterUpdate:this._positionContainer},oa?[this.renderMainContainer(),this.renderPointer()]:null)};T.renderLoadingIcon=function(){return x.tsx("span",{"aria-hidden":"true",class:this.classes("esri-popup__icon","esri-icon-loading-indicator","esri-rotating")})};T.renderNavigationLoading=function(){const {messagesCommon:v}=
this;return this.viewModel.pendingPromisesCount?x.tsx("div",{key:q("loading-container"),role:"presentation",class:"esri-popup__loading-container","aria-label":v.loading,title:v.loading},this.renderLoadingIcon()):null};T.renderPreviousIcon=function(){const v=M.isRTL(this.container);return x.tsx("span",{"aria-hidden":"true",class:this.classes("esri-popup__icon",{["esri-icon-right-triangle-arrow"]:v,["esri-popup__pagination-previous-icon--rtl"]:v,["esri-icon-left-triangle-arrow"]:!v,["esri-popup__pagination-previous-icon"]:!v})})};
T.renderPreviousButton=function(){const {messages:v}=this;return x.tsx("div",{role:"button",tabIndex:0,bind:this,onclick:this._previous,onkeydown:this._previous,class:this.classes("esri-popup__button","esri-popup__pagination-previous"),"aria-label":v.previous,title:v.previous},this.renderPreviousIcon())};T.renderNextIcon=function(){const v=M.isRTL(this.container);return x.tsx("span",{"aria-hidden":"true",class:this.classes("esri-popup__icon",{["esri-icon-left-triangle-arrow"]:v,["esri-popup__pagination-next-icon--rtl"]:v,
["esri-icon-right-triangle-arrow"]:!v,["esri-popup__pagination-next-icon"]:!v})})};T.renderNextButton=function(){const {messages:v}=this;return x.tsx("div",{role:"button",tabIndex:0,bind:this,onclick:this._next,onkeydown:this._next,class:this.classes("esri-popup__button","esri-popup__pagination-next"),"aria-label":v.next,title:v.next},this.renderNextIcon())};T.renderFeatureMenuButton=function(){const {featureMenuOpen:v,featureMenuId:L,messagesCommon:y}=this,{featureCount:C,selectedFeatureIndex:P}=
this.viewModel;return x.tsx("div",{role:"button",tabIndex:0,bind:this,onclick:this._toggleFeatureMenu,onkeydown:this._toggleFeatureMenu,afterCreate:this._focusFeatureMenuButtonNode,afterUpdate:this._focusFeatureMenuButtonNode,class:this.classes("esri-popup__button","esri-popup__feature-menu-button"),"aria-haspopup":"true","aria-controls":L,"aria-expanded":v.toString(),"aria-label":y.menu,title:y.menu},this._getPageText(C,P))};T.renderNavigationButtons=function(){return this.featureNavigationVisible?
[this.renderPreviousButton(),this.renderNavigationLoading()||this.renderFeatureMenuButton(),this.renderNextButton()]:null};T.renderDockIcon=function(){const {dockEnabled:v}=this,L=this._wouldDockTo();return x.tsx("span",{"aria-hidden":"true",class:this.classes({["esri-icon-minimize"]:v,["esri-popup__icon--dock-icon"]:!v,["esri-icon-dock-right"]:!v&&("top-right"===L||"bottom-right"===L),["esri-icon-dock-left"]:!v&&("top-left"===L||"bottom-left"===L),["esri-icon-maximize"]:!v&&"top-center"===L,["esri-icon-dock-bottom"]:!v&&
"bottom-center"===L},"esri-popup__icon")})};T.renderDockButton=function(){var v,L,y;const {dockEnabled:C,messages:P}=this,S=null==(v=this.viewModel)?void 0:null==(L=v.view)?void 0:L.widthBreakpoint;v=C?P.undock:P.dock;return"xsmall"!==S&&null!=(y=this.dockOptions)&&y.buttonEnabled?x.tsx("div",{role:"button","aria-label":v,title:v,tabIndex:0,bind:this,onclick:this._toggleDockEnabled,onkeydown:this._toggleDockEnabled,afterCreate:this._focusDockButtonNode,afterUpdate:this._focusDockButtonNode,class:this.classes("esri-popup__button",
"esri-popup__button--dock")},this.renderDockIcon()):null};T.renderTitle=function(){const {title:v}=this.viewModel,{titleId:L,collapsible:y,contentCollapsed:C,messagesCommon:P}=this;var S={["esri-popup__header-container--button"]:y};const aa=x.tsx(u.Heading,{level:this.headingLevel,class:"esri-popup__header-title",innerHTML:v});S=y?x.tsx("button",{key:`${v}--collapsible`,id:L,title:C?P.expand:P.collapse,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes("esri-popup__header-container",
S),"aria-expanded":C?"false":"true",onclick:this._toggleCollapsed},aa):x.tsx("div",{key:v,id:L,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes("esri-popup__header-container",S)},aa);return v?S:null};T.renderCloseIcon=function(){return x.tsx("span",{"aria-hidden":"true",class:this.classes("esri-popup__icon","esri-icon-close")})};T.renderCloseButton=function(){const {visibleElements:v,messagesCommon:L}=this;return v.closeButton?x.tsx("div",{role:"button",tabIndex:0,
bind:this,onclick:this._close,onkeydown:this._close,class:"esri-popup__button","aria-label":L.close,title:L.close,afterCreate:this._closeButtonNodeUpdated,afterUpdate:this._closeButtonNodeUpdated},this.renderCloseIcon()):null};T.renderHeader=function(){return x.tsx("header",{class:"esri-popup__header"},this.renderTitle(),x.tsx("div",{class:"esri-popup__header-buttons"},this.renderDockButton(),this.renderCloseButton()))};T.renderContentContainer=function(){const {contentId:v,hasContent:L,contentCollapsed:y}=
this,{content:C}=this.viewModel;return L&&!y?x.tsx("article",{key:C,enterAnimation:this._createFeatureUpdatedAnimation(),id:v,class:"esri-popup__content"},this.renderContent()):null};T.renderActionsMenuButton=function(){const {actionsMenuId:v,actionsMenuButtonId:L,actionsMenuOpen:y,dividedActions:C,messagesCommon:P}=this,S=y?P.close:P.open,{menuActions:aa}=C;return aa.length?x.tsx("div",{key:q("actions-menu-button"),class:this.classes("esri-popup__button","esri-popup__actions-menu-button"),role:"button",
id:L,"aria-haspopup":"true","aria-controls":y?v:null,tabIndex:0,bind:this,onclick:this._toggleActionsMenu,onkeydown:this._toggleActionsMenu,afterCreate:this._focusActionsMenuButtonNode,afterUpdate:this._focusActionsMenuButtonNode,"aria-label":S,title:S},x.tsx("span",{"aria-hidden":"true",class:"esri-icon-handle-horizontal"})):null};T.renderMenuActions=function(){const {actionsMenuId:v,actionsMenuButtonId:L,actionsMenuOpen:y,dividedActions:C}=this,{menuActions:P,inlineActions:S}=C;return P.length&&
y?x.tsx("ul",{id:v,role:"menu","aria-labelledby":L,key:q("actions"),class:"esri-popup__actions",bind:this,onkeyup:this._handleActionMenuKeyup,afterCreate:this._actionsMenuNodeUpdated,afterUpdate:this._actionsMenuNodeUpdated},P.toArray().map((aa,ca)=>this.renderAction({action:aa,index:ca+S.length,type:"menu-item"}))):null};T.renderInlineActions=function(){const {inlineActions:v}=this.dividedActions;return!!v.length&&v.toArray().map((L,y)=>this.renderAction({action:L,index:y,type:"inline"}))};T.renderInlineActionsContainer=
function(){const {inlineActions:v,menuActions:L}=this.dividedActions,y=!!v.length,C=!!L.length;return y||C?x.tsx("div",{key:"inline-actions-container","data-inline-actions":y.toString(),"data-menu-actions":C.toString(),class:"esri-popup__inline-actions-container"},this.renderInlineActions(),this.renderActionsMenuButton(),this.renderMenuActions()):null};T.renderNavigation=function(){return this.featureNavigationVisible?x.tsx("section",{key:q("navigation"),class:this.classes("esri-popup__navigation")},
this.renderNavigationButtons()):null};T.renderFooter=function(){const {featureNavigationVisible:v,dividedActions:L}=this,{inlineActions:y,menuActions:C}=L,P=!!y.length,S={["esri-popup__footer--has-pagination"]:v,["esri-popup__footer--has-actions"]:P,["esri-popup__footer--has-actions-menu"]:!!C.length};return v||P?x.tsx("div",{key:q("feature-buttons"),class:this.classes("esri-popup__footer",S)},this.renderInlineActionsContainer(),this.renderNavigation()):null};T.renderFeatureMenuContainer=function(){var {messages:v}=
this;const {featureViewModels:L,isLoadingFeature:y}=this.viewModel;v=B.substitute(v.selectedFeatures,{total:L.length});return x.tsx("section",{key:q("menu"),class:"esri-popup__feature-menu"},x.tsx("strong",{class:"esri-popup__feature-menu-header"},v),x.tsx("nav",{bind:this,class:"esri-popup__feature-menu-viewport","data-node-ref":"_featureMenuViewportNode",afterCreate:M.storeNode},this.renderFeatureMenu(),x.tsx("div",{class:"esri-popup__feature-menu-observer",bind:this,afterCreate:this._featureMenuIntersectionObserverCreated}),
y?x.tsx("div",{class:"esri-popup__feature-menu-loader"},this.renderLoadingIcon()):null))};T.renderPointer=function(){return this.dockEnabled?null:x.tsx("div",{key:q("pointer"),class:"esri-popup__pointer",role:"presentation"},x.tsx("div",{class:this.classes("esri-popup__pointer-direction","esri-popup--shadow")}))};T.renderMainContainer=function(){const {dockEnabled:v,currentAlignment:L,currentDockPosition:y,titleId:C,contentId:P,collapsible:S,hasContent:aa,contentCollapsed:ca,visibleElements:ia}=this,
{title:la}=this.viewModel,oa="bottom-left"===L||"bottom-center"===L||"bottom-right"===L||"top-left"===y||"top-center"===y||"top-right"===y,ja="top-left"===L||"top-center"===L||"top-right"===L||"bottom-left"===y||"bottom-center"===y||"bottom-right"===y;return x.tsx("div",{class:this.classes("esri-popup__main-container","esri-widget",{["esri-popup--shadow"]:v,["esri-popup--is-collapsible"]:S,["esri-popup--is-collapsed"]:ca}),tabIndex:ia.closeButton?null:-1,role:"dialog","aria-labelledby":la?C:"","aria-describedby":aa&&
!ca?P:"",bind:this,onkeyup:this._handleMainKeyup,afterCreate:this._mainContainerNodeUpdated,afterUpdate:this._mainContainerNodeUpdated},oa?this.renderFooter():null,oa?this.renderFeatureMenuContainer():null,this.renderHeader(),this.renderContentContainer(),ja?this.renderFooter():null,ja?this.renderFeatureMenuContainer():null)};T.renderContent=function(){var v;const L=null==(v=this.viewModel)?void 0:v.content;return L?"string"===typeof L?x.tsx("div",{key:L,innerHTML:L}):this.renderNodeContent(L):null};
T.renderActionText=function(v){return x.tsx("span",{key:"text",class:"esri-popup__action-text"},v)};T.renderActionIcon=function(v){const L=this._getActionClass(v),y=this._getActionImage(v),C={["esri-icon-loading-indicator"]:v.active,["esri-rotating"]:v.active,["esri-popup__icon"]:!!L,["esri-popup__action-image"]:!v.active&&!!y};L&&(C[L]=!v.active);return x.tsx("span",{key:"icon","aria-hidden":"true",class:this.classes("esri-popup__icon",C),styles:this._getIconStyles(y)})};T.renderAction=function(v){const {action:L,
index:y,type:C}=v;v=this._getActionTitle(L);const P={["esri-popup__action"]:"toggle"!==L.type,["esri-popup__action-toggle"]:"toggle"===L.type,["esri-popup__action-toggle--on"]:"toggle"===L.type&&L.value,["esri-popup__button--disabled"]:L.disabled},S=[this.renderActionIcon(L),this.renderActionText(v)];v="menu-item"===C?x.tsx("li",{key:L.uid,role:"menuitem",tabIndex:0,title:v,"aria-label":v,class:this.classes("esri-popup__button",P),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-index":y,
onclick:this._triggerAction,onkeydown:this._triggerAction},S):x.tsx("div",{key:L.uid,role:"button",tabIndex:0,title:v,"aria-label":v,class:this.classes("esri-popup__button",P),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-index":y,onclick:this._triggerAction,onkeydown:this._triggerAction},S);return L.visible?v:null};T.renderFeatureMenuItem=function(v,L){const {messages:y,messagesCommon:C}=this,{selectedFeatureIndex:P,selectedFeatureViewModel:S}=this.viewModel;var aa=v===S;const ca=
{["esri-popup__feature-menu-item--selected"]:aa};aa=aa?x.tsx("span",{key:q(`feature-menu-selected-feature-${P}`),title:y.selectedFeature,"aria-label":y.selectedFeature,class:"esri-icon-check-mark"}):null;v=x.tsx("span",{innerHTML:v.title||C.untitled});return x.tsx("li",{role:"menuitem",tabIndex:-1,key:q(`feature-menu-feature-${P}`),class:this.classes(ca,"esri-popup__feature-menu-item"),bind:this,"data-feature-index":L,onkeyup:this._handleFeatureMenuItemKeyup,onclick:this._selectFeature,onkeydown:this._selectFeature},
x.tsx("span",{class:"esri-popup__feature-menu-title"},v,aa))};T.renderFeatureMenu=function(){const {featureMenuId:v}=this,{featureViewModels:L}=this.viewModel;return 1<L.length?x.tsx("ol",{class:"esri-popup__feature-menu-list",id:v,bind:this,afterCreate:this._featureMenuNodeUpdated,afterUpdate:this._featureMenuNodeUpdated,onkeyup:this._handleFeatureMenuKeyup,role:"menu"},L.filter(y=>!!y.graphic).map((y,C)=>this.renderFeatureMenuItem(y,C))):null};T._getActionTitle=function(v){const {messages:L,selectedFeature:y,
messagesCommon:C}=this,{id:P}=v,S=null==y?void 0:y.attributes;return(v="zoom-to-feature"===P?B.substitute(v.title,{messages:L}):"remove-selected-feature"===P?B.substitute(v.title,{messages:C}):"zoom-to-clustered-features"===P?B.substitute(v.title,{messages:L}):"browse-clustered-features"===P?B.substitute(v.title,{messages:L}):v.title)&&S?B.substitute(v,S):v};T._getActionClass=function(v){var {selectedFeature:L}=this;L=null==L?void 0:L.attributes;const {className:y,image:C}=v;return(v=C||y?y:"esri-icon-default-action")&&
L?B.substitute(v,L):v};T._getActionImage=function(v){var {selectedFeature:L}=this;L=null==L?void 0:L.attributes;({image:v}=v);return v&&L?B.substitute(v,L):v};T._createFeatureUpdatedAnimation=function(){return M.cssTransition("enter","esri-popup--feature-updated")};T._getInlineActionCount=function(){const {maxInlineActions:v,featureNavigationVisible:L}=this;if("number"!==typeof v)return null;const y=Math.round(v);return Math.max(L?y-1:y,0)};T._watchActions=function(){const {allActions:v}=this.viewModel;
this.notifyChange("dividedActions");this._handles.remove("actions");v&&v.forEach(L=>{this._handles.add(D.watch(L,"active className disabled id title image visible".split(" "),()=>this.scheduleRender()),"actions")})};T._divideActions=function(){const {allActions:v}=this.viewModel,L=this._getInlineActionCount(),y=null===L,C=0===L;return{inlineActions:y?v.slice(0):C?new w:v.slice(0,L),menuActions:y?new w:C?v.slice(0):v.slice(L)}};T._featureMenuOpenChanged=function(v){v?this._focusFirstFeature=!0:this._focusFeatureMenuButton=
!0};T._actionsMenuOpenChanged=function(v){v?this._focusFirstAction=!0:this._focusActionsMenuButton=!0};T._setTitleFromFeatureWidget=function(){const {selectedFeatureWidget:v,messagesCommon:L}=this;if(v){var y,C;this.viewModel.title="error"===(null==(y=v.viewModel)?void 0:y.state)?L.errorMessage:(null==(C=v.viewModel)?void 0:C.title)||""}};T._setContentFromFeatureWidget=function(){const {selectedFeatureWidget:v}=this;v&&(this.viewModel.content=v)};T._unobserveFeatureMenuObserver=function(){this._featureMenuIntersectionObserverNode&&
this._featureMenuIntersectionObserver.unobserve(this._featureMenuIntersectionObserverNode)};T._featureMenuIntersectionObserverCreated=function(v){this._unobserveFeatureMenuObserver();this._featureMenuIntersectionObserver.observe(v);this._featureMenuIntersectionObserverNode=v};T._handleFeatureMenuKeyup=function(v){"Escape"===z.eventKey(v)&&(v.stopPropagation(),this._focusFeatureMenuButton=!0,this.featureMenuOpen=!1,this.scheduleRender())};T._handleActionMenuKeyup=function(v){"Escape"===z.eventKey(v)&&
(v.stopPropagation(),this._focusActionsMenuButton=!0,this.actionsMenuOpen=!1,this.scheduleRender())};T._handleFeatureMenuItemKeyup=function(v){const L=z.eventKey(v);var {_featureMenuNode:y}=this;const C=v.currentTarget["data-feature-index"];if(y){y=y.querySelectorAll("li");var P=y.length;"ArrowUp"===L?(v.stopPropagation(),y[(C-1+P)%P].focus()):"ArrowDown"===L?(v.stopPropagation(),y[(C+1+P)%P].focus()):"Home"===L?(v.stopPropagation(),y[0].focus()):"End"===L&&(v.stopPropagation(),y[y.length-1].focus())}};
T._handleActionMenuItemKeyup=function(v){const L=z.eventKey(v);var {_actionsMenuNode:y}=this;const C=v.currentTarget["data-action-index"];if(y){y=y.querySelectorAll("li");var P=y.length;"ArrowUp"===L?(v.stopPropagation(),y[(C-1+P)%P].focus()):"ArrowDown"===L?(v.stopPropagation(),y[(C+1+P)%P].focus()):"Home"===L?(v.stopPropagation(),y[0].focus()):"End"===L&&(v.stopPropagation(),y[y.length-1].focus())}};T._handleMainKeyup=function(v){const L=z.eventKey(v);"ArrowLeft"===L&&(v.stopPropagation(),this.previous());
"ArrowRight"===L&&(v.stopPropagation(),this.next())};T._spinnerEnabledChange=function(v){this._destroySpinner();v&&(v=this.get("viewModel.view"),this._createSpinner(v))};T._hideSpinner=function(){const {_spinner:v}=this;v&&(v.location=null,v.hide())};T._displaySpinner=function(){const {_spinner:v}=this;if(v){var {location:L,waitingForResult:y}=this.viewModel;y?v.show({location:L}):v.hide()}};T._getIconStyles=function(v){return{"background-image":v?`url(${v})`:""}};T._addSelectedFeatureIndexHandle=
function(){const v=D.watch(this,"viewModel.selectedFeatureIndex",(L,y)=>this._selectedFeatureIndexUpdated(L,y));this._handles.add(v,"selected-index")};T._selectedFeatureIndexUpdated=function(v,L){const {featureCount:y}=this;y&&v!==L&&-1!==v&&(this.featureMenuOpen=this.actionsMenuOpen=!1)};T._destroySelectedFeatureWidget=function(){const {_feature:v}=this;v&&(v.viewModel=null,v&&!v.destroyed&&v.destroy());this._feature=null};T._isScreenLocationWithinView=function(v,L){return-1<v.x&&-1<v.y&&v.x<=L.width&&
v.y<=L.height};T._isOutsideView=function(v){const {popupHeight:L,popupWidth:y,screenLocation:C,side:P,view:S}=v;if(isNaN(y)||isNaN(L)||!S||!C)return!1;v=S.padding;return"right"===P&&C.x+y/2>S.width-v.right||"left"===P&&C.x-y/2<v.left||"top"===P&&C.y-L<v.top||"bottom"===P&&C.y+L>S.height-v.bottom?!0:!1};T._calculateAutoAlignment=function(v){if("auto"!==v)return v;const {_pointerOffsetInPx:L,_containerNode:y,_mainContainerNode:C,viewModel:P}=this,{screenLocation:S,view:aa}=P;if(G.isNone(S)||!aa||!y)return"top-center";
if(!this._isScreenLocationWithinView(S,aa))return this._get("currentAlignment")||"top-center";var ca=(v=C?window.getComputedStyle(C,null):null)?parseInt(v.getPropertyValue("max-height").replace(/[^-\d\.]/g,""),10):0,ia=v?parseInt(v.getPropertyValue("height").replace(/[^-\d\.]/g,""),10):0;const {height:la,width:oa}=y.getBoundingClientRect();v=oa+L;const ja=Math.max(la,ca,ia)+L;ca=this._isOutsideView({popupHeight:ja,popupWidth:v,screenLocation:S,side:"right",view:aa});ia=this._isOutsideView({popupHeight:ja,
popupWidth:v,screenLocation:S,side:"left",view:aa});const pa=this._isOutsideView({popupHeight:ja,popupWidth:v,screenLocation:S,side:"top",view:aa});v=this._isOutsideView({popupHeight:ja,popupWidth:v,screenLocation:S,side:"bottom",view:aa});return ia?pa?"bottom-right":"top-right":ca?pa?"bottom-left":"top-left":pa?v?"top-center":"bottom-center":"top-center"};T._callCurrentAlignment=function(v){return"function"===typeof v?v.call(this):v};T._getCurrentAlignment=function(){const {alignment:v,dockEnabled:L}=
this;return L||!this.viewModel.active?null:this._calculatePositionResult(this._calculateAutoAlignment(this._callCurrentAlignment(v)))};T._setCurrentAlignment=function(){this._set("currentAlignment",this._getCurrentAlignment())};T._setCurrentDockPosition=function(){this._set("currentDockPosition",this._getCurrentDockPosition())};T._calculatePositionResult=function(v){const L=["left","right"];M.isRTL(this.container)&&L.reverse();return v.replace(/leading/gi,L[0]).replace(/trailing/gi,L[1])};T._callDockPosition=
function(v){return"function"===typeof v?v.call(this):v};T._getDockPosition=function(){var v;return this._calculatePositionResult(this._calculateAutoDockPosition(this._callDockPosition(null==(v=this.dockOptions)?void 0:v.position)))};T._getCurrentDockPosition=function(){return this.dockEnabled&&this.viewModel.active?this._getDockPosition():null};T._wouldDockTo=function(){return this.dockEnabled?null:this._getDockPosition()};T._calculateAutoDockPosition=function(v){var L;if("auto"!==v)return v;v=null==
(L=this.viewModel)?void 0:L.view;L=M.isRTL(this.container)?"top-left":"top-right";if(!v)return L;var y=v.padding||{left:0,right:0,top:0,bottom:0};y=v.width-y.left-y.right;({breakpoints:v}=v);return v&&y<=v.xsmall?"bottom-center":L};T._positionContainer=function(v=this._containerNode){v&&(this._containerNode=v);if(v){var {screenLocation:L}=this.viewModel,{width:y}=v.getBoundingClientRect();if(L=this._calculatePositionStyle(L,y))v.style.top=L.top,v.style.left=L.left,v.style.bottom=L.bottom,v.style.right=
L.right}};T._calculateFullWidth=function(v){const {currentAlignment:L,_pointerOffsetInPx:y}=this;return"top-left"===L||"bottom-left"===L||"top-right"===L||"bottom-right"===L?v+y:v};T._calculateAlignmentPosition=function(v,L,y,C){const {currentAlignment:P,_pointerOffsetInPx:S}=this;C/=2;const aa=y.height-L;y=y.width-v;const {padding:ca}=this.view;if("bottom-center"===P)return{top:L+S-ca.top,left:v-C-ca.left};if("top-left"===P)return{bottom:aa+S-ca.bottom,right:y+S-ca.right};if("bottom-left"===P)return{top:L+
S-ca.top,right:y+S-ca.right};if("top-right"===P)return{bottom:aa+S-ca.bottom,left:v+S-ca.left};if("bottom-right"===P)return{top:L+S-ca.top,left:v+S-ca.left};if("top-center"===P)return{bottom:aa+S-ca.bottom,left:v-C-ca.left}};T._calculatePositionStyle=function(v,L){const {dockEnabled:y,view:C}=this;if(C){if(y)return{left:"",top:"",right:"",bottom:""};if(!G.isNone(v)&&L&&(L=this._calculateFullWidth(L),v=this._calculateAlignmentPosition(v.x,v.y,C,L)))return{top:void 0!==v.top?`${v.top}px`:"auto",left:void 0!==
v.left?`${v.left}px`:"auto",bottom:void 0!==v.bottom?`${v.bottom}px`:"auto",right:void 0!==v.right?`${v.right}px`:"auto"}}};T._viewChange=function(v,L){v&&L&&(this.close(),this.clear())};T._viewReadyChange=function(v,L){v?(v=this.get("viewModel.view"),this._wireUpView(v)):L&&(this.close(),this.clear())};T._wireUpView=function(v){this._destroySpinner();if(v){var {spinnerEnabled:L}=this;L&&this._createSpinner(v);this._setDockEnabledForViewSize(this.dockOptions)}};T._dockingThresholdCrossed=function(v,
L,y){const [C,P]=v,[S,aa]=L,{width:ca,height:ia}=y;return C<=ca&&S>ca||C>ca&&S<=ca||P<=ia&&aa>ia||P>ia&&aa<=ia};T._updateDockEnabledForViewSize=function(v,L){if(v&&L){var y=this.get("viewModel.view.padding")||{left:0,right:0,top:0,bottom:0},C=y.left+y.right,P=y.top+y.bottom;y=[];var S=[];y[0]=v[0]-C;y[1]=v[1]-P;S[0]=L[0]-C;S[1]=L[1]-P;({dockOptions:v}=this);this._dockingThresholdCrossed(y,S,v.breakpoint)&&this._setDockEnabledForViewSize(v);this._setCurrentDockPosition()}};T._focusDockButtonNode=function(v){this._focusDockButton&&
(this._focusDockButton=!1,v.focus())};T._closeButtonNodeUpdated=function(v){this._focusClose?(this._focusClose=!1,v.focus()):this._blurClose&&(this._blurClose=!1,v.blur())};T._mainContainerNodeUpdated=function(v){this._mainContainerNode=v;this._focusContainer?(this._focusContainer=!1,v.focus()):this._blurContainer&&(this._blurContainer=!1,v.blur())};T._featureMenuNodeUpdated=function(v){(this._featureMenuNode=v)&&this._focusFirstFeature&&(this._focusFirstFeature=!1,v=v.querySelectorAll("li"),v.length&&
v[0].focus())};T._actionsMenuNodeUpdated=function(v){(this._actionsMenuNode=v)&&this._focusFirstAction&&(this._focusFirstAction=!1,v=v.querySelectorAll("li"),v.length&&v[0].focus())};T._focusFeatureMenuButtonNode=function(v){this._focusFeatureMenuButton&&(this._focusFeatureMenuButton=!1,v.focus())};T._focusActionsMenuButtonNode=function(v){this._focusActionsMenuButton&&(this._focusActionsMenuButton=!1,v.focus())};T._featureMenuViewportScrollTop=function(){this._featureMenuViewportNode&&(this._featureMenuViewportNode.scrollTop=
0)};T._toggleScreenLocationEnabled=function(){const {dockEnabled:v,viewModel:L}=this;L&&(L.screenLocationEnabled=L.active&&!v)};T._shouldDockAtCurrentViewSize=function(v){var L,y;v=v.breakpoint;const C=null==(L=this.viewModel)?void 0:null==(y=L.view)?void 0:y.ui;if(!C)return!1;const {width:P,height:S}=C;if(isNaN(P)||isNaN(S))return!1;L=v.hasOwnProperty("width")&&P<=v.width;y=v.hasOwnProperty("height")&&S<=v.height;return L||y};T._setDockEnabledForViewSize=function(v){v.breakpoint&&(this.dockEnabled=
this._shouldDockAtCurrentViewSize(v))};T._getPageText=function(v,L){return this.featureNavigationVisible?B.substitute(this.messages.pageText,{index:L+1,total:v}):null};T._destroySpinner=function(){const {_spinner:v,view:L}=this;v&&(L&&L.ui&&L.ui.remove(this._spinner,"popup-spinner"),v.destroy(),this._spinner=null)};T._createSpinner=function(v){v&&(this._spinner=new r({view:v}),v.ui.add(this._spinner,{key:"popup-spinner",position:"manual"}))};T._toggleCollapsed=function(){this.collapsed=!this.collapsed};
T._close=function(){this.close();this.view&&this.view.focus()};T._toggleDockEnabled=function(){this.dockEnabled=!this.dockEnabled;this._focusDockButton=!0;this.scheduleRender()};T._toggleFeatureMenu=function(){const v=!this.featureMenuOpen;this._featureMenuOpenChanged(v);this.actionsMenuOpen=!1;this.featureMenuOpen=v};T._toggleActionsMenu=function(){const v=!this.actionsMenuOpen;this._actionsMenuOpenChanged(v);this.featureMenuOpen=!1;this.actionsMenuOpen=v};T._triggerAction=function(v){v=v.currentTarget["data-action-index"];
const L=this.viewModel.allActions.getItemAt(v);L&&"toggle"===L.type&&(L.value=!L.value);this.actionsMenuOpen=!1;this.viewModel.triggerAction(v)};T._selectFeature=function(v){v=v.currentTarget["data-feature-index"];isNaN(v)||(this.viewModel.selectedFeatureIndex=v);this.featureMenuOpen=!1;this._focusFeatureMenuButton=!0;this.scheduleRender()};T._next=function(){this.next()};T._previous=function(){this.previous()};f._createClass(X,[{key:"actionsMenuId",get:function(){return`${this.id}-actions-menu`}},
{key:"actionsMenuButtonId",get:function(){return`${this.id}-actions-menu-button`}},{key:"featureMenuId",get:function(){return`${this.id}-feature-menu`}},{key:"titleId",get:function(){return`${this.id}-popup-title`}},{key:"contentId",get:function(){return`${this.id}-popup-content`}},{key:"hasContent",get:function(){var v,L,y,C,P,S,aa;return!!(this.selectedFeatureWidget?(null==(v=this.selectedFeatureWidget)?0:null==(L=v.viewModel)?0:L.waitingForContent)||"error"===(null==(y=this.selectedFeatureWidget)?
void 0:null==(C=y.viewModel)?void 0:C.state)||(null==(P=this.selectedFeatureWidget)?0:null==(S=P.viewModel)?0:S.content):null==(aa=this.viewModel)?0:aa.content)}},{key:"featureNavigationVisible",get:function(){return this.viewModel.active&&1<this.viewModel.featureCount&&this.visibleElements.featureNavigation}},{key:"collapsible",get:function(){return!!(this.collapseEnabled&&this.viewModel.title&&this.hasContent)}},{key:"featureMenuVisible",get:function(){return this.featureNavigationVisible&&this.featureMenuOpen}},
{key:"contentCollapsed",get:function(){return this.collapsible&&!this.featureMenuVisible&&this.collapsed}},{key:"dividedActions",get:function(){return this._divideActions()}},{key:"actionsMenuOpen",get:function(){return this.viewModel.active?this._get("actionsMenuOpen"):!1},set:function(v){this._set("actionsMenuOpen",!!v)}},{key:"currentAlignment",get:function(){return this._getCurrentAlignment()}},{key:"currentDockPosition",get:function(){return this._getCurrentDockPosition()}},{key:"dockOptions",
get:function(){return this._get("dockOptions")||I},set:function(v){var L={...I};const y=this.get("viewModel.view.breakpoints");var C={};y&&(C.width=y.xsmall,C.height=y.xsmall);v={...L,...v};L={...L.breakpoint,...C};({breakpoint:C}=v);!0===C?v.breakpoint=L:"object"===typeof C&&(v.breakpoint={...L,...C});this._set("dockOptions",v);this._setCurrentDockPosition();this.reposition()}},{key:"selectedFeatureWidget",get:function(){const {_feature:v,visibleElements:L,headingLevel:y}=this,{selectedFeatureViewModel:C}=
this.viewModel,P={...L,title:!1};if(!C)return null;v?(v.viewModel=C,v.visibleElements=P):this._feature=new h({headingLevel:y+1,viewModel:C,visibleElements:P});return this._feature}}]);return X}(k.FeatureContentMixin(d));g.__decorate([c.property({readOnly:!0})],a.prototype,"actionsMenuId",null);g.__decorate([c.property({readOnly:!0})],a.prototype,"actionsMenuButtonId",null);g.__decorate([c.property({readOnly:!0})],a.prototype,"featureMenuId",null);g.__decorate([c.property({readOnly:!0})],a.prototype,
"titleId",null);g.__decorate([c.property({readOnly:!0})],a.prototype,"contentId",null);g.__decorate([c.property({readOnly:!0})],a.prototype,"hasContent",null);g.__decorate([c.property({readOnly:!0})],a.prototype,"featureNavigationVisible",null);g.__decorate([c.property({readOnly:!0})],a.prototype,"collapsible",null);g.__decorate([c.property({readOnly:!0})],a.prototype,"featureMenuVisible",null);g.__decorate([c.property({readOnly:!0})],a.prototype,"contentCollapsed",null);g.__decorate([c.property({readOnly:!0})],
a.prototype,"dividedActions",null);g.__decorate([t.aliasOf("viewModel.actions")],a.prototype,"actions",void 0);g.__decorate([c.property()],a.prototype,"actionsMenuOpen",null);g.__decorate([c.property()],a.prototype,"alignment",void 0);g.__decorate([t.aliasOf("viewModel.autoCloseEnabled")],a.prototype,"autoCloseEnabled",void 0);g.__decorate([t.aliasOf("viewModel.autoOpenEnabled")],a.prototype,"autoOpenEnabled",void 0);g.__decorate([t.aliasOf("viewModel.defaultPopupTemplateEnabled")],a.prototype,"defaultPopupTemplateEnabled",
void 0);g.__decorate([t.aliasOf("viewModel.content")],a.prototype,"content",void 0);g.__decorate([c.property()],a.prototype,"collapsed",void 0);g.__decorate([c.property()],a.prototype,"collapseEnabled",void 0);g.__decorate([c.property({readOnly:!0})],a.prototype,"currentAlignment",null);g.__decorate([c.property({readOnly:!0})],a.prototype,"currentDockPosition",null);g.__decorate([c.property()],a.prototype,"dockOptions",null);g.__decorate([c.property()],a.prototype,"dockEnabled",void 0);g.__decorate([t.aliasOf("viewModel.featureCount")],
a.prototype,"featureCount",void 0);g.__decorate([c.property()],a.prototype,"featureMenuOpen",void 0);g.__decorate([t.aliasOf("viewModel.features")],a.prototype,"features",void 0);g.__decorate([t.aliasOf("viewModel.goToOverride")],a.prototype,"goToOverride",void 0);g.__decorate([c.property()],a.prototype,"headingLevel",void 0);g.__decorate([t.aliasOf("viewModel.highlightEnabled")],a.prototype,"highlightEnabled",void 0);g.__decorate([t.aliasOf("viewModel.location")],a.prototype,"location",void 0);g.__decorate([c.property({aliasOf:{source:"messages.widgetLabel",
overridable:!0}})],a.prototype,"label",void 0);g.__decorate([c.property()],a.prototype,"maxInlineActions",void 0);g.__decorate([c.property(),p.messageBundle("esri/widgets/Popup/t9n/Popup")],a.prototype,"messages",void 0);g.__decorate([c.property(),p.messageBundle("esri/t9n/common")],a.prototype,"messagesCommon",void 0);g.__decorate([t.aliasOf("viewModel.promises")],a.prototype,"promises",void 0);g.__decorate([t.aliasOf("viewModel.selectedFeature")],a.prototype,"selectedFeature",void 0);g.__decorate([t.aliasOf("viewModel.selectedFeatureIndex")],
a.prototype,"selectedFeatureIndex",void 0);g.__decorate([c.property({readOnly:!0})],a.prototype,"selectedFeatureWidget",null);g.__decorate([c.property()],a.prototype,"spinnerEnabled",void 0);g.__decorate([t.aliasOf("viewModel.title")],a.prototype,"title",void 0);g.__decorate([t.aliasOf("viewModel.updateLocationEnabled")],a.prototype,"updateLocationEnabled",void 0);g.__decorate([t.aliasOf("viewModel.view")],a.prototype,"view",void 0);g.__decorate([c.property({type:n}),E.vmEvent(["triggerAction","trigger-action"])],
a.prototype,"viewModel",void 0);g.__decorate([t.aliasOf("viewModel.visible")],a.prototype,"visible",void 0);g.__decorate([c.property()],a.prototype,"visibleElements",void 0);g.__decorate([b.cast("visibleElements")],a.prototype,"castVisibleElements",null);g.__decorate([l.accessibleHandler()],a.prototype,"_close",null);g.__decorate([l.accessibleHandler()],a.prototype,"_toggleDockEnabled",null);g.__decorate([l.accessibleHandler()],a.prototype,"_toggleFeatureMenu",null);g.__decorate([l.accessibleHandler()],
a.prototype,"_toggleActionsMenu",null);g.__decorate([l.accessibleHandler()],a.prototype,"_triggerAction",null);g.__decorate([l.accessibleHandler()],a.prototype,"_selectFeature",null);g.__decorate([l.accessibleHandler()],a.prototype,"_next",null);g.__decorate([l.accessibleHandler()],a.prototype,"_previous",null);return a=g.__decorate([e.subclass("esri.widgets.Popup")],a)})},"esri/core/throttle":function(){define(["exports"],function(f){function g(a,w,z,F){let J=null,G=1E3;"number"===typeof w?(G=w,
F=z):(J=null!=w?w:null,G=z);let K=0,D;const t=()=>{K=0;a.apply(F,D)};w=(...m)=>{J&&J.apply(F,m);D=m;G?K||(K=setTimeout(t,G)):t()};w.remove=()=>{K&&(clearTimeout(K),K=0)};w.forceUpdate=()=>{K&&(clearTimeout(K),t())};w.hasPendingUpdates=()=>!!K;return w}f["default"]=g;f.throttle=g;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/widgets/Feature":function(){define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../intl ../core/watchUtils ../core/accessorSupport/decorators/aliasOf ../core/has ../core/accessorSupport/decorators/cast ../core/Logger ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/subclass ./Widget ./Feature/FeatureAttachments ./Feature/FeatureContent ./Feature/FeatureFields ./Feature/FeatureMedia ./Feature/FeatureViewModel ./Feature/support/FeatureContentMixin ./support/Heading ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory ../intl/substitute".split(" "),
function(f,g,a,w,z,F,J,G,K,D,t,m,b,c,e,h,r,d,k,n,u,l,p){const E={title:!0,content:!0,lastEditedInfo:!0};w=function(x){function M(q,I){q=x.call(this,q,I)||this;q._contentWidgets=[];q.graphic=null;q.defaultPopupTemplateEnabled=!1;q.headingLevel=2;q.label=void 0;q.messages=null;q.messagesCommon=null;q.messagesURIUtils=null;q.spatialReference=null;q.title=null;q.visibleElements={...E};q.map=null;q.view=null;q.viewModel=new r;return q}g._inheritsLoose(M,x);var B=M.prototype;B.initialize=function(){this.own(z.init(this,
"viewModel.contentViewModels",()=>this._setupContentWidgets()))};B.loadDependencies=function(){return new Promise(function(q,I){f(["../chunks/notice"],q,I)})};B.destroy=function(){this._destroyContentWidgets()};B.castVisibleElements=function(q){return{...E,...q}};B.render=function(){var {state:q}=this.viewModel;q=l.tsx("div",{class:"esri-feature__size-container",key:"container"},this.renderTitle(),"error"===q?this.renderError():"loading"===q?this.renderLoading():this.renderContentContainer());return l.tsx("div",
{class:this.classes("esri-feature","esri-widget")},q)};B.setActiveMedia=function(q,I){this.viewModel.setActiveMedia(q,I)};B.nextMedia=function(q){this.viewModel.nextMedia(q)};B.previousMedia=function(q){this.viewModel.previousMedia(q)};B.renderError=function(){const {messagesCommon:q,messages:I,visibleElements:A}=this;return l.tsx("calcite-notice",{active:!0,color:"red",icon:"exclamation-mark-circle",scale:"s"},A.title?l.tsx("div",{key:"error-title",slot:"title"},q.errorMessage):null,l.tsx("div",
{key:"error-message",slot:"message"},I.loadingError))};B.renderLoading=function(){return l.tsx("div",{key:"loading-container",class:"esri-feature__loading-container"},l.tsx("span",{class:this.classes("esri-icon-loading-indicator esri-rotating","esri-feature__loading-spinner")}))};B.renderContentContainer=function(){const {visibleElements:q}=this;return q.content?l.tsx("div",{class:"esri-feature__main-container"},[this.renderContent(),this.renderLastEditInfo()]):null};B.renderTitle=function(){const {visibleElements:q,
title:I}=this;return q.title?l.tsx(k.Heading,{level:this.headingLevel,class:"esri-feature__title",innerHTML:I}):null};B.renderContent=function(){var q=this.viewModel.content;return q?Array.isArray(q)?q.length?l.tsx("div",{key:"content-content-elements"},q.map(this.renderContentElement,this)):null:"string"===typeof q?(q=this._contentWidgets[0],!q||q.destroyed?null:l.tsx("div",{key:"content-content"},q.render())):this.renderNodeContent(q):null};B.renderContentElement=function(q,I){const {visibleElements:A}=
this;if("boolean"!==typeof A.content&&!A.content[q.type])return null;switch(q.type){case "attachments":return this.renderAttachments(I);case "custom":return this.renderCustom(q,I);case "fields":return this.renderFields(I);case "media":return this.renderMedia(I);case "text":return this.renderText(q,I);default:return null}};B.renderAttachments=function(q){const I=this._contentWidgets[q];if(!I||I.destroyed)return null;const {state:A,attachmentInfos:N}=I.viewModel;return"loading"===A||0<N.length?l.tsx("div",
{key:this._buildKey("attachments-element",q),class:this.classes("esri-feature__content-element")},I.render()):null};B.renderCustom=function(q,I){({creator:q}=q);const A=this._contentWidgets[I];return!A||A.destroyed?null:q?l.tsx("div",{key:this._buildKey("custom-element",I),class:"esri-feature__content-element"},A.render()):null};B.renderFields=function(q){const I=this._contentWidgets[q];return!I||I.destroyed?null:l.tsx("div",{key:this._buildKey("fields-element",q),class:"esri-feature__content-element"},
I.render())};B.renderMedia=function(q){const I=this._contentWidgets[q];return!I||I.destroyed?null:l.tsx("div",{key:this._buildKey("media-element",q),class:"esri-feature__content-element"},I.render())};B.renderLastEditInfo=function(){const {visibleElements:q,messages:I}=this;var {lastEditInfo:A}=this.viewModel;if(!A||!q.lastEditedInfo)return null;const {date:N,user:V}=A;A=p.substitute("edit"===A.type?V?I.lastEditedByUser:I.lastEdited:V?I.lastCreatedByUser:I.lastCreated,{date:N,user:V});return l.tsx("div",
{key:"edit-info-element",class:this.classes("esri-feature__last-edited-info","esri-feature__content-element")},A)};B.renderText=function(q,I){const A=this._contentWidgets[I];return!A||A.destroyed?null:q.text?l.tsx("div",{key:this._buildKey("text-element",I),class:this.classes("esri-feature__content-element","esri-feature__text")},A.render()):null};B._buildKey=function(q,...I){const A=this.get("viewModel.graphic.uid")||"0";I=I.join("-");return`${q}__${A}-${I}`};B._destroyContentWidgets=function(){this._contentWidgets.forEach(q=>
{q.viewModel=null;q&&!q.destroyed&&q.destroy()});this._contentWidgets=[]};B._setupContentWidgets=function(){this._destroyContentWidgets();const {headingLevel:q,visibleElements:I}=this;var A=this.get("viewModel.content");const {contentViewModels:N}=this.viewModel;Array.isArray(A)?A.forEach((V,X)=>{"attachments"===V.type&&(this._contentWidgets[X]=new b({displayType:V.displayType,headingLevel:I.title?q+1:q,viewModel:N[X]}));"fields"===V.type&&(this._contentWidgets[X]=new e({viewModel:N[X]}));"media"===
V.type&&(this._contentWidgets[X]=new h({viewModel:N[X]}));"text"===V.type&&(this._contentWidgets[X]=new c({viewModel:N[X]}));"custom"===V.type&&(this._contentWidgets[X]=new c({viewModel:N[X]}))},this):(A=N[0])&&!A.destroyed&&(this._contentWidgets[0]=new c({viewModel:A}));this.scheduleRender()};return M}(d.FeatureContentMixin(m));a.__decorate([F.aliasOf("viewModel.graphic")],w.prototype,"graphic",void 0);a.__decorate([F.aliasOf("viewModel.defaultPopupTemplateEnabled")],w.prototype,"defaultPopupTemplateEnabled",
void 0);a.__decorate([D.property()],w.prototype,"headingLevel",void 0);a.__decorate([D.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],w.prototype,"label",void 0);a.__decorate([D.property(),u.messageBundle("esri/widgets/Feature/t9n/Feature")],w.prototype,"messages",void 0);a.__decorate([D.property(),u.messageBundle("esri/t9n/common")],w.prototype,"messagesCommon",void 0);a.__decorate([D.property(),u.messageBundle("esri/widgets/support/t9n/uriUtils")],w.prototype,"messagesURIUtils",
void 0);a.__decorate([F.aliasOf("viewModel.spatialReference")],w.prototype,"spatialReference",void 0);a.__decorate([F.aliasOf("viewModel.title")],w.prototype,"title",void 0);a.__decorate([D.property()],w.prototype,"visibleElements",void 0);a.__decorate([G.cast("visibleElements")],w.prototype,"castVisibleElements",null);a.__decorate([F.aliasOf("viewModel.map")],w.prototype,"map",void 0);a.__decorate([F.aliasOf("viewModel.view")],w.prototype,"view",void 0);a.__decorate([D.property({type:r})],w.prototype,
"viewModel",void 0);return w=a.__decorate([t.subclass("esri.widgets.Feature")],w)})},"esri/widgets/Feature/FeatureAttachments":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/watchUtils ../../core/accessorSupport/decorators/aliasOf ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/subclass ../Attachments ../Widget ./FeatureAttachments/FeatureAttachmentsViewModel ./support/FeatureElementInfo ../support/widgetUtils ../support/jsxFactory".split(" "),
function(f,g,a,w,z,F,J,G,K,D,t,m,b,c,e){z=function(h){function r(k,n){k=h.call(this,k,n)||this;k._featureElementInfo=null;k.attachmentsWidget=new D;k.description=null;k.displayType=null;k.graphic=null;k.headingLevel=2;k.title=null;k.viewModel=new m;return k}f._inheritsLoose(r,h);var d=r.prototype;d.initialize=function(){this._featureElementInfo=new b;a.init(this,["viewModel.description","viewModel.title","headingLevel"],()=>this._setupFeatureElementInfo());a.init(this,"viewModel.graphic",k=>this.attachmentsWidget.graphic=
k)};d.destroy=function(){this.attachmentsWidget.destroy();this._featureElementInfo.destroy()};d.render=function(){var k;const {attachmentsWidget:n}=this;return e.tsx("div",{class:"esri-feature-attachments"},null==(k=this._featureElementInfo)?void 0:k.render(),null==n?void 0:n.render())};d._setupFeatureElementInfo=function(){const {description:k,title:n,headingLevel:u}=this;this._featureElementInfo.set({description:k,title:n,headingLevel:u})};return r}(t);g.__decorate([G.property({readOnly:!0})],z.prototype,
"attachmentsWidget",void 0);g.__decorate([w.aliasOf("viewModel.description")],z.prototype,"description",void 0);g.__decorate([w.aliasOf("attachmentsWidget.displayType")],z.prototype,"displayType",void 0);g.__decorate([w.aliasOf("viewModel.graphic")],z.prototype,"graphic",void 0);g.__decorate([G.property()],z.prototype,"headingLevel",void 0);g.__decorate([w.aliasOf("viewModel.title")],z.prototype,"title",void 0);g.__decorate([G.property({type:m})],z.prototype,"viewModel",void 0);return z=g.__decorate([K.subclass("esri.widgets.Feature.FeatureAttachments")],
z)})},"esri/widgets/Attachments":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Error ../core/unitFormatUtils ../core/watchUtils ../core/accessorSupport/decorators/aliasOf ../core/has ../core/accessorSupport/decorators/cast ../core/Logger ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/subclass ./Widget ./Attachments/AttachmentsViewModel ./Attachments/support/attachmentUtils ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory".split(" "),
function(f,g,a,w,z,F,J,G,K,D,t,m,b,c,e,h,r){const d={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},k=window.CSS;J=function(n){function u(p,E){p=n.call(this,p,E)||this;p.abilities=null;p.displayType="list";p.graphic=null;p.label=void 0;p.messages=null;p.messagesUnits=null;p.selectedFile=null;p.submitting=!1;p.viewModel=new b;p.visibleElements={...d};p._supportsImageOrientation=k&&k.supports&&k.supports("image-orientation",
"from-image");p._addAttachmentForm=null;p._updateAttachmentForm=null;return p}f._inheritsLoose(u,n);var l=u.prototype;l.initialize=function(){this.own(z.on(this,"viewModel.attachmentInfos","change",()=>this.scheduleRender()),z.init(this,"viewModel.mode",()=>this._modeChanged()))};l.castVisibleElements=function(p){return{...d,...p}};l.addAttachment=function(){const {_addAttachmentForm:p,viewModel:E}=this;this._set("submitting",!0);this._set("error",null);return E.addAttachment(p).then(x=>{this._set("submitting",
!1);this._set("error",null);E.mode="view";return x}).catch(x=>{this._set("submitting",!1);this._set("error",new a("attachments:add-attachment",this.messages.addErrorMessage,x));throw x;})};l.deleteAttachment=function(p){const {viewModel:E}=this;this._set("submitting",!0);this._set("error",null);return E.deleteAttachment(p).then(x=>{this._set("submitting",!1);this._set("error",null);E.mode="view";return x}).catch(x=>{this._set("submitting",!1);this._set("error",new a("attachments:delete-attachment",
this.messages.deleteErrorMessage,x));throw x;})};l.updateAttachment=function(){const {viewModel:p}=this,{_updateAttachmentForm:E}=this;this._set("submitting",!0);this._set("error",null);return p.updateAttachment(E).then(x=>{this._set("submitting",!1);this._set("error",null);p.mode="view";return x}).catch(x=>{this._set("submitting",!1);this._set("error",new a("attachments:update-attachment",this.messages.updateErrorMessage,x));throw x;})};l.render=function(){const {submitting:p,viewModel:E}=this,{state:x}=
E;return r.tsx("div",{class:this.classes("esri-attachments","esri-widget")},p?this.renderProgressBar():null,"loading"===x?this.renderLoading():this.renderAttachments(),this.renderErrorMessage())};l.renderErrorMessage=function(){const {error:p,visibleElements:E}=this;return p&&E.errorMessage?r.tsx("div",{key:"error-message",class:"esri-attachments__error-message"},p.message):null};l.renderAttachments=function(){const {mode:p,activeAttachmentInfo:E}=this.viewModel;return"add"===p?this.renderAddForm():
"edit"===p?this.renderDetailsForm(E):this.renderAttachmentContainer()};l.renderLoading=function(){return r.tsx("div",{class:"esri-attachments__loader-container",key:"loader"},r.tsx("div",{class:"esri-attachments__loader"}))};l.renderProgressBar=function(){return this.visibleElements.progressBar?r.tsx("div",{class:"esri-attachments__progress-bar",key:"progress-bar"}):null};l.renderAddForm=function(){const {submitting:p,selectedFile:E}=this;var x=p||!E,M=this.visibleElements.cancelAddButton?r.tsx("button",
{type:"button",bind:this,disabled:p,onclick:this._cancelForm,class:this.classes("esri-button","esri-button--tertiary","esri-button--small","esri-button--half",p&&"esri-button--disabled")},this.messages.cancel):null;x=this.visibleElements.addSubmitButton?r.tsx("button",{type:"submit",disabled:x,class:this.classes("esri-button","esri-button--secondary","esri-button--small","esri-button--half",{["esri-button--disabled"]:x})},this.messages.add):null;const B=E?r.tsx("span",{key:"file-name",class:"esri-attachments__file-name"},
E.name):null;M=r.tsx("form",{bind:this,afterCreate:e.storeNode,afterRemoved:e.discardNode,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},r.tsx("fieldset",{class:"esri-attachments__file-fieldset"},B,r.tsx("label",{class:this.classes("esri-attachments__file-label","esri-button","esri-button--secondary")},E?this.messages.changeFile:this.messages.selectFile,r.tsx("input",{class:"esri-attachments__file-input",type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))),
x,M);return r.tsx("div",{key:"add-form-container",class:"esri-attachments__form-node"},M)};l.renderDetailsForm=function(p){const {visibleElements:E,viewModel:x,selectedFile:M,submitting:B}=this,{contentType:q,size:I,url:A}=p;var {abilities:N}=x,V=B||!M,X=N.editing&&N.operations.delete&&E.deleteButton?r.tsx("button",{key:"delete-button",type:"button",disabled:B,bind:this,onclick:y=>this._submitDeleteAttachment(y,p),class:this.classes("esri-button","esri-button--small","esri-button--tertiary","esri-attachments__delete-button",
{["esri-button--disabled"]:B})},this.messages.delete):null;V=N.editing&&N.operations.update&&E.updateButton?r.tsx("button",{disabled:V,key:"update-button",type:"submit",class:this.classes("esri-button","esri-button--small","esri-button--third",{["esri-button--disabled"]:V})},this.messages.update):null;const T=this.visibleElements.cancelUpdateButton?r.tsx("button",{disabled:B,key:"cancel-button",type:"button",bind:this,onclick:this._cancelForm,class:this.classes("esri-button","esri-button--small",
"esri-button--tertiary","esri-button--third",{["esri-button--disabled"]:B})},this.messages.cancel):null;var v=M?r.tsx("span",{key:"file-name",class:"esri-attachments__file-name"},M.name):null;N=N.editing&&N.operations.update?r.tsx("fieldset",{key:"file",class:"esri-attachments__file-fieldset"},v,r.tsx("label",{class:this.classes("esri-attachments__file-label","esri-button","esri-button--secondary")},this.messages.changeFile,r.tsx("input",{class:"esri-attachments__file-input",type:"file",name:"attachment",
bind:this,onchange:this._handleFileInputChange}))):null;v=r.tsx("fieldset",{key:"size",class:"esri-attachments__metadata-fieldset"},r.tsx("label",null,w.formatFileSize(this.messagesUnits,I)));const L=r.tsx("fieldset",{key:"content-type",class:"esri-attachments__metadata-fieldset"},r.tsx("label",null,q));X=r.tsx("form",{bind:this,afterCreate:e.storeNode,afterRemoved:e.discardNode,"data-node-ref":"_updateAttachmentForm",onsubmit:this._submitUpdateAttachment},r.tsx("div",{class:"esri-attachments__metadata"},
v,L),N,r.tsx("div",{class:"esri-attachments__actions"},X,T,V));return r.tsx("div",{key:"edit-form-container",class:"esri-attachments__form-node"},r.tsx("a",{class:"esri-attachments__item-link",href:A,rel:"noreferrer",target:"_blank"},this.renderImageMask({attachmentInfo:p,size:400}),r.tsx("div",{class:"esri-attachments__item-link-overlay"},r.tsx("span",{class:"esri-attachments__item-link-overlay-icon"},r.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32"},r.tsx("path",
{d:"M28 13h1v16H3V3h16v1H4v24h24zm-5-9h4.293L15.646 15.638l.707.707L28 4.707V9h1V3h-6z"}),r.tsx("path",{fill:"none",d:"M0 0h32v32H0z"}))))),X)};l.renderImageMask=function({attachmentInfo:p,size:E}){var {supportsResizeAttachments:x}=this.viewModel;const {contentType:M,name:B,url:q}=p,I=x&&c.isSupportedImage(M);p=(p=this._getCSSTransform(p,I))?{transform:p,"image-orientation":"none"}:{};const A=-1===q.indexOf("?")?"?":"\x26";E=I?`${q}${A}w=${E}`:c.getIconPath(M);x={["esri-attachments__image--resizable"]:x};
return r.tsx("div",{class:this.classes({["esri-attachments__item-mask--icon"]:!I},"esri-attachments__item-mask")},r.tsx("img",{styles:p,alt:B,src:E,class:this.classes(x,"esri-attachments__image")}))};l.renderAttachmentInfo=function({attachmentInfo:p,displayType:E}){var {viewModel:x}=this;({abilities:x}=x);const {name:M,url:B}=p;E=this.renderImageMask({attachmentInfo:p,size:"list"===E?48:400});var q=x.editing?r.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-chevron-icon",
e.isRTL(this.container)?"esri-icon-left":"esri-icon-right")}):null;q=r.tsx("label",{class:"esri-attachments__label"},r.tsx("span",{class:"esri-attachments__filename"},M||this.messages.noTitle),q);E=[E,q];x=x.editing?r.tsx("button",{key:"details-button",bind:this,class:"esri-attachments__item-button",title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,"data-attachment-info-id":p.id,onclick:()=>this._startEditAttachment(p),type:"button"},E):r.tsx("a",{key:"details-link",
class:"esri-attachments__item-button",href:B,target:"_blank"},E);return r.tsx("li",{class:"esri-attachments__item",key:p},x)};l.renderAttachmentContainer=function(){const {displayType:p,viewModel:E,visibleElements:x}=this,{attachmentInfos:M,abilities:B}=E;var q=M&&M.length;const I={["esri-attachments__container--list"]:"preview"!==p,["esri-attachments__container--preview"]:"preview"===p},A=B.editing&&B.operations.add&&x.addButton?r.tsx("button",{bind:this,onclick:()=>this._startAddAttachment(),class:this.classes("esri-button",
"esri-button--tertiary","esri-attachments__add-attachment-button"),type:"button"},r.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-add-icon","esri-icon-plus")}),this.messages.add):null;q=q?r.tsx("ul",{class:"esri-attachments__items"},M.toArray().map(N=>this.renderAttachmentInfo({attachmentInfo:N,displayType:p}))):r.tsx("div",{class:"esri-widget__content--empty"},this.messages.noAttachments);return r.tsx("div",{key:"attachments-container",class:this.classes("esri-attachments__container",
I)},q,A)};l._modeChanged=function(){this._set("error",null);this._set("selectedFile",null)};l._handleFileInputChange=function(p){p=(p=p.target)&&p.files&&p.files.item(0);this._set("selectedFile",p)};l._submitDeleteAttachment=function(p,E){p.preventDefault();this.deleteAttachment(E)};l._submitAddAttachment=function(p){p.preventDefault();this.addAttachment()};l._submitUpdateAttachment=function(p){p.preventDefault();this.updateAttachment()};l._startEditAttachment=function(p){const {viewModel:E}=this;
E.activeAttachmentInfo=p;E.mode="edit"};l._startAddAttachment=function(){this.viewModel.mode="add"};l._cancelForm=function(p){p.preventDefault();this.viewModel.mode="view"};l._getCSSTransform=function(p,E){({orientationInfo:p}=p);return!this._supportsImageOrientation&&E&&p?[p.rotation?`rotate(${p.rotation}deg)`:"",p.mirrored?"scaleX(-1)":""].join(" "):""};return u}(m);g.__decorate([F.aliasOf("viewModel.abilities")],J.prototype,"abilities",void 0);g.__decorate([D.property()],J.prototype,"displayType",
void 0);g.__decorate([F.aliasOf("viewModel.graphic")],J.prototype,"graphic",void 0);g.__decorate([D.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],J.prototype,"label",void 0);g.__decorate([D.property(),h.messageBundle("esri/widgets/Attachments/t9n/Attachments")],J.prototype,"messages",void 0);g.__decorate([D.property(),h.messageBundle("esri/core/t9n/Units")],J.prototype,"messagesUnits",void 0);g.__decorate([D.property({readOnly:!0})],J.prototype,"selectedFile",void 0);g.__decorate([D.property({readOnly:!0})],
J.prototype,"submitting",void 0);g.__decorate([D.property({readOnly:!0})],J.prototype,"error",void 0);g.__decorate([D.property({type:b})],J.prototype,"viewModel",void 0);g.__decorate([D.property()],J.prototype,"visibleElements",void 0);g.__decorate([G.cast("visibleElements")],J.prototype,"castVisibleElements",null);return J=g.__decorate([t.subclass("esri.widgets.Attachments")],J)})},"esri/core/unitFormatUtils":function(){define(["exports","./mathUtils","./string","./unitUtils","../intl/number"],function(f,
g,a,w,z){function F(K,D,t){return K.units[D][t]}function J(K,D,t,m=2,b="abbr"){return`${z.formatNumber(D,{minimumFractionDigits:m,maximumFractionDigits:m})} ${F(K,t,b)}`}const G=["B","kB","MB","GB","TB"];f.formatAngleDegrees=function(K,D,t=2){K=w.convertUnit(K,D,"degrees");return z.formatNumber(K,{style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:t,minimumFractionDigits:t})};f.formatDMS=function(K,D,t=2){K=w.convertUnit(K,D,"degrees");D=K-Math.floor(K);K-=D;D*=60;let m=D-Math.floor(D);
D-=m;m*=60;return`${K.toFixed()}\u00b0 ${D.toFixed()}' ${m.toFixed(t)}"`};f.formatDecimal=J;f.formatFileSize=function(K,D){let t=0===D?0:Math.floor(Math.log(D)/Math.log(1024));t=g.clamp(t,0,G.length-1);D=z.formatNumber(D/1024**t,{maximumFractionDigits:2});return a.replace(K.units.bytes[G[t]],{fileSize:D})};f.formatImperialArea=function(K,D,t,m=2,b="abbr"){const c=w.preferredImperialAreaUnit(D,t);return J(K,w.convertUnit(D,t,c),c,m,b)};f.formatImperialLength=function(K,D,t,m=2,b="abbr"){const c=w.preferredImperialLengthUnit(D,
t);return J(K,w.convertUnit(D,t,c),c,m,b)};f.formatImperialVerticalLength=function(K,D,t,m=2,b="abbr"){const c=w.preferredImperialVerticalLengthUnit(D,t);return J(K,w.convertUnit(D,t,c),c,m,b)};f.formatMetricArea=function(K,D,t,m=2,b="abbr"){const c=w.preferredMetricAreaUnit(D,t);return J(K,w.convertUnit(D,t,c),c,m,b)};f.formatMetricLength=function(K,D,t,m=2,b="abbr"){const c=w.preferredMetricLengthUnit(D,t);return J(K,w.convertUnit(D,t,c),c,m,b)};f.formatMetricVerticalLength=function(K,D,t,m=2,b=
"abbr"){const c=w.preferredMetricVerticalLengthUnit(D,t);return J(K,w.convertUnit(D,t,c),c,m,b)};f.unitName=F;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/widgets/Attachments/AttachmentsViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Graphic ../../core/Collection ../../core/Error ../../core/HandleOwner ../../core/maybe ../../core/watchUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/decorators/cast ../../core/Logger ../../core/accessorSupport/decorators/subclass ../../rest/query/support/AttachmentInfo ../../rest/support/AttachmentQuery ../Feature/support/featureUtils".split(" "),
function(f,g,a,w,z,F,J,G,K,D,t,m,b,c,e,h){const r={editing:!1,operations:{add:!0,update:!0,delete:!0}},d=w.ofType(c);w=function(k){function n(l){var p=k.call(this,l)||this;p._getAttachmentsPromise=null;p._attachmentLayer=null;p.abilities={...r};p.activeAttachmentInfo=null;p.attachmentInfos=new d;p.graphic=null;p.mode="view";p.handles.add([G.init(f._assertThisInitialized(p),"graphic",()=>p._graphicChanged())]);return p}f._inheritsLoose(n,k);var u=n.prototype;u.destroy=function(){this.graphic=this._attachmentLayer=
null};u.castAbilities=function(l){return{...r,...l}};u.getAttachments=function(){var l=f._asyncToGenerator(function*(){const {_attachmentLayer:p,attachmentInfos:E}=this;if(!p||"function"!==typeof p.queryAttachments)throw new z("invalid-layer","getAttachments(): A valid layer is required.");const x=this._getFeatureId();var M=new e({objectIds:[x],returnMetadata:!0});const B=[];this._getAttachmentsPromise=M=p.queryAttachments(M).then(q=>q[x]||B).catch(()=>B);this.notifyChange("state");M=yield M;E.removeAll();
M.length&&E.addMany(M);this._getAttachmentsPromise=null;this.notifyChange("state");return M});return function(){return l.apply(this,arguments)}}();u.addAttachment=function(){var l=f._asyncToGenerator(function*(p){const {_attachmentLayer:E,attachmentInfos:x,graphic:M,abilities:B}=this;if(!p)throw new z("invalid-attachment","addAttachment(): An attachment is required.",{attachment:p});if(!B.operations.add)throw new z("invalid-abilities","addAttachment(): add abilities are required.");if(!E||"function"!==
typeof E.addAttachment)throw new z("invalid-layer","addAttachment(): A valid layer is required.");p=yield E.addAttachment(M,p).then(q=>this._queryAttachment(q.objectId));x.add(p);return p});return function(p){return l.apply(this,arguments)}}();u.deleteAttachment=function(){var l=f._asyncToGenerator(function*(p){const {_attachmentLayer:E,attachmentInfos:x,graphic:M,abilities:B}=this;if(!p)throw new z("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:p});
if(!B.operations.delete)throw new z("invalid-abilities","deleteAttachment(): delete abilities are required.");if(!E||"function"!==typeof E.deleteAttachments)throw new z("invalid-layer","deleteAttachment(): A valid layer is required.");const q=yield E.deleteAttachments(M,[p.id]).then(()=>p);x.remove(q);return q});return function(p){return l.apply(this,arguments)}}();u.updateAttachment=function(){var l=f._asyncToGenerator(function*(p,E=this.activeAttachmentInfo){const {_attachmentLayer:x,attachmentInfos:M,
graphic:B,abilities:q}=this;if(!p)throw new z("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:p});if(!E)throw new z("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:E});if(!q.operations.update)throw new z("invalid-abilities","updateAttachment(): Update abilities are required.");const I=M.findIndex(A=>A===E);if(!x||"function"!==typeof x.updateAttachment)throw new z("invalid-layer","updateAttachment(): A valid layer is required.");
p=yield x.updateAttachment(B,E.id,p).then(A=>this._queryAttachment(A.objectId));M.splice(I,1,p);return p});return function(p){return l.apply(this,arguments)}}();u._queryAttachment=function(){var l=f._asyncToGenerator(function*(p){if(!p)throw new z("invalid-attachment-id","Could not query attachment.");const {_attachmentLayer:E}=this,x=this._getFeatureId();p=new e({objectIds:[x],attachmentsWhere:`AttachmentId=${p}`,returnMetadata:!0});return E.queryAttachments(p).then(M=>M[x][0])});return function(p){return l.apply(this,
arguments)}}();u._getFeatureId=function(){const {_attachmentLayer:l,graphic:p}=this;if(!l||!p)return null;const {objectIdField:E}=l,{attributes:x}=p;return x&&x[E]};u._graphicChanged=function(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch(()=>{}))};u._setAttachmentLayer=function(){var {graphic:l}=this;this._attachmentLayer=(l=h.getSourceLayer(l))?"scene"===l.type&&J.isSome(l.associatedLayer)?l.associatedLayer:l:null};f._createClass(n,[{key:"state",get:function(){return this._getAttachmentsPromise?
"loading":this.graphic?"ready":"disabled"}},{key:"supportsResizeAttachments",get:function(){return this.get("graphic.layer.capabilities.operations.supportsResizeAttachments")||!1}}]);return n}(F.HandleOwner);g.__decorate([K.property()],w.prototype,"abilities",void 0);g.__decorate([t.cast("abilities")],w.prototype,"castAbilities",null);g.__decorate([K.property()],w.prototype,"activeAttachmentInfo",void 0);g.__decorate([K.property({readOnly:!0,type:d})],w.prototype,"attachmentInfos",void 0);g.__decorate([K.property({type:a})],
w.prototype,"graphic",void 0);g.__decorate([K.property()],w.prototype,"mode",void 0);g.__decorate([K.property({readOnly:!0})],w.prototype,"state",null);g.__decorate([K.property({readOnly:!0})],w.prototype,"supportsResizeAttachments",null);return w=g.__decorate([b.subclass("esri.widgets.Attachments.AttachmentsViewModel")],w)})},"esri/widgets/Feature/support/featureUtils":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../intl ../../../core/Logger ../../../core/maybe ../../../core/string ../../../intl/date ../../../intl/number ../../../layers/support/fieldUtils ../../../popup/support/FieldInfoFormat ../../../support/arcadeOnDemand".split(" "),
function(f,g,a,w,z,F,J,G,K,D,t){function m(){m=g._asyncToGenerator(function*(U,H){return"function"===typeof U?U.call(null,H):U});return m.apply(this,arguments)}function b(U){return S.test(U)}function c(U,H){if(!b(H)||!U)return null;const O=H.replace(S,"").toLowerCase();let R;U.some(Q=>Q.name.toLowerCase()===O?(R=Q,!0):!1);return R}function e(U,H){return(H=h(H,U))?H.name:U}function h(U,H){return U&&"function"===typeof U.getField?U.getField(H):null}function r({formattedAttributes:U,template:H,fieldInfoMap:O}){return`${F.replace(F.replace(H,
R=>{{const Q=O.get(R.toLowerCase());R=`{${Q&&Q.fieldName||R}}`}return R}),U).replace(y,"")}`.trim()}function d(U,H,O=!1){const R=H[U];"string"===typeof R&&(O=(O?encodeURIComponent(R):R).replace(P,"%27"),H[U]=O)}function k(U,H=!1){const O={...U};Object.keys(O).forEach(R=>d(R,O,H));return O}function n(U,H){return U.replace(C,(O,R,Q)=>(O=h(H,Q))?`{${O.name}}`:R)}function u(U,H,O){return(U=n(U,O))?U.replace(ia,(R,Q,W)=>{Q=`${Q||W}`.trim();return F.replace(R,k(H,Q&&"{"!==Q[0]))}):U}function l(U,H){var O=
H.fieldName,R=p(H.fieldInfos,O),Q=null==R?void 0:R.clone();R=H.preventPlacesFormatting;H=H.layer;O=h(H,O);if(Q&&"date"===(null==O?void 0:O.type)){O=Q.format||new D;O.dateFormat=O.dateFormat||"short-date-short-time";var W;if(!(W="feature"===(null==H?void 0:H.type)&&H.datesInUnknownTimezone)){if(W=!(null==H||!H.layer))W=H.layer,W="map-image"===(null==W?void 0:W.type);W=W&&H.layer.datesInUnknownTimezone}O.dateTimeFormatOptions=W?{timeZone:"UTC"}:null;Q.format=O}Q=Q&&Q.format;"string"!==typeof U||!Q||
null!=Q.dateFormat||null==Q.places&&null==Q.digitSeparator||(H=Number(U),isNaN(H)||(U=H));return"string"===typeof U||null==U||null==Q?U:R?G.formatNumber(U,{...G.convertNumberFormatToIntlOptions(Q),minimumFractionDigits:0,maximumFractionDigits:20}):Q.format(U)}function p(U,H){if(U&&U.length&&H){var O=H.toLowerCase(),R=void 0;U.some(Q=>Q.fieldName&&Q.fieldName.toLowerCase()===O?(R=Q,!0):!1);return R}}function E({fieldName:U,graphic:H,layer:O}){if(X(U)||!O||"function"!==typeof O.getFeatureType)return null;
const {typeIdField:R}=O;return R&&U===R?(U=O.getFeatureType(H))?U.name:null:null}function x({fieldName:U,value:H,graphic:O,layer:R}){return X(U)||!R||"function"!==typeof R.getFieldDomain?null:(U=R.getFieldDomain(U,{feature:O}))&&"coded-value"===U.type?U.getName(H):null}function M(U){return"string"===typeof U?U.replace(aa,'\x3cbr class\x3d"esri-text-new-line" /\x3e'):U}function B(U){const {value:H,fieldName:O,fieldInfos:R,fieldInfoMap:Q,layer:W,graphic:Y}=U;return null==H?"":(U=x({fieldName:O,value:H,
graphic:Y,layer:W}))||(U=E({fieldName:O,graphic:Y,layer:W}))?U:Q.get(O.toLowerCase())?l(H,{fieldInfos:R,fieldName:O,layer:W}):(U=W&&W.fieldsIndex)&&U.isDateField(O)?J.formatDate(H,oa):M(H)}function q(U,H){return I.apply(this,arguments)}function I(){I=g._asyncToGenerator(function*(U,H){var O,R;const {layer:Q,graphic:W,outFields:Y,objectIds:ba,returnGeometry:Z,spatialReference:ka}=U;U=ba[0];if("number"!==typeof U&&"string"!==typeof U)return L.warn("Could not query required fields for the specified feature. The feature's ID is invalid.",
{layer:Q,graphic:W,objectId:U,requiredFields:Y}),null;if(null==(O=Q.capabilities)||null==(R=O.operations)||!R.supportsQuery)return L.warn("The specified layer cannot be queried. The following fields will not be available.",{layer:Q,graphic:W,requiredFields:Y,returnGeometry:Z}),null;O=Q.createQuery();O.objectIds=ba;O.outFields=null!=Y&&Y.length?Y:[Q.objectIdField];O.returnGeometry=!!Z;O.returnZ=!!Z;O.returnM=!!Z;O.outSpatialReference=ka;return(yield Q.queryFeatures(O,H)).features[0]});return I.apply(this,
arguments)}function A(U){return N.apply(this,arguments)}function N(){N=g._asyncToGenerator(function*(U){var H;if(null==(H=U.expressionInfos)||!H.length)return!1;H=yield t.loadArcade();({arcadeUtils:{hasGeometryFunctions:H}}=H);return H(U)});return N.apply(this,arguments)}function V(){V=g._asyncToGenerator(function*({graphic:U,popupTemplate:H,layer:O,spatialReference:R},Q){if(O&&H&&("function"===typeof O.load&&(yield O.load(Q)),U.attributes)){var W=U.attributes[O.objectIdField];if(null!=W){W=[W];var Y=
yield H.getRequiredFields(O.fieldsIndex),ba=K.featureHasFields(Y,U);Y=ba?[]:Y;H=H.returnGeometry||(yield A(H));if(!ba||H)if(O=yield q({layer:O,graphic:U,outFields:Y,objectIds:W,returnGeometry:H,spatialReference:R},Q))O.geometry&&(U.geometry=O.geometry),O.attributes&&(U.attributes={...U.attributes,...O.attributes})}}});return V.apply(this,arguments)}function X(U=""){return U?-1!==U.indexOf("relationships/"):!1}function T({attributes:U,graphic:H,relatedInfo:O}){U&&H&&O&&Object.keys(H.attributes).forEach(R=>
{var Q={layerId:O.relation.id.toString(),fieldName:R};U[Q?`${"relationships/"}${Q.layerId}/${Q.fieldName}`:""]=H.attributes[R]})}function v(U,H){U&&H&&(H.relatedFeatures&&H.relatedFeatures&&H.relatedFeatures.forEach(O=>T({attributes:U,graphic:O,relatedInfo:H})),H.relatedStatsFeatures&&H.relatedStatsFeatures&&H.relatedStatsFeatures.forEach(O=>T({attributes:U,graphic:O,relatedInfo:H})))}const L=w.getLogger("esri.widgets.Feature.support.featureUtils"),y=/href=(""|'')/gi,C=/(\{([^\{\r\n]+)\})/g,P=/'/g,
S=/^\s*expression\//i,aa=/(\n)/gi,ca=/[\u00A0-\u9999<>&]/gim,ia=/href\s*=\s*(?:"([^"]+)"|'([^']+)')/gi,la=/^(?:mailto:|tel:)/,oa=J.convertDateFormatToIntlOptions("short-date-short-time"),ja=U=>{if(!U)return!1;U=U.toUpperCase();return-1<U.indexOf("CURRENT_TIMESTAMP")||-1<U.indexOf("CURRENT_DATE")||-1<U.indexOf("CURRENT_TIME")},pa=({layer:U,method:H,query:O,definitionExpression:R})=>{var Q,W;null!=(Q=U.capabilities)&&null!=(W=Q.query)&&W.supportsCacheHint&&"attachments"!==H&&(U=z.isSome(O.where)&&O.where,
H=z.isSome(O.geometry)&&O.geometry,ja(R)||ja(U)||"extent"===(null==H?void 0:H.type)||"tile"===O.resultType||(O.cacheHint=!0))};f.applyTextFormattingHTML=M;f.createfieldInfoMap=function(U,H){const O=new Map;U&&U.forEach(R=>{const Q=e(R.fieldName,H);R.fieldName=Q;O.set(Q.toLowerCase(),R)});return O};f.fixTokens=n;f.formatAttributes=function({fieldInfos:U,attributes:H,layer:O,graphic:R,fieldInfoMap:Q,relatedInfos:W}){const Y={...H};null==W?void 0:W.forEach(ba=>v(Y,ba));Object.keys(Y).forEach(ba=>{Y[ba]=
B({fieldName:ba,fieldInfos:U,fieldInfoMap:Q,layer:O,value:Y[ba],graphic:R})});return Y};f.formatEditInfo=function(U,H){const {creatorField:O,creationDateField:R,editorField:Q,editDateField:W}=U;if(H){U=H[W];if("number"===typeof U)return H=H[Q],{type:"edit",date:J.formatDate(U,oa),user:H};U=H[R];return"number"===typeof U?(H=H[O],{type:"create",date:J.formatDate(U,oa),user:H}):null}};f.formatValueToFieldInfo=l;f.getAllFieldInfos=function(U){const H=[];if(!U)return H;const {fieldInfos:O,content:R}=U;
O&&H.push(...O);if(!R||!Array.isArray(R))return H;R.forEach(Q=>{"fields"===Q.type&&(Q=Q&&Q.fieldInfos)&&H.push(...Q)});return H};f.getFieldInfo=p;f.getFieldInfoLabel=function(U,H){return(H=c(H,null==U?void 0:U.fieldName))?H.title||null:U?U.label||U.fieldName:null};f.getFixedFieldName=e;f.getFixedFieldNames=function(U,H){return U&&U.map(O=>e(O,H))};f.getSourceLayer=function(U){if(!z.isNone(U))return U.get("sourceLayer")||U.get("layer")};f.graphicCallback=function(U,H){return m.apply(this,arguments)};
f.htmlEntities=function(U){return U.replace(ca,H=>`&#${H.charCodeAt(0)};`)};f.isExpressionField=b;f.isRelatedField=X;f.preLayerQueryCallback=({query:U,layer:H,method:O})=>{pa({layer:H,method:O,query:U,definitionExpression:`${H.definitionExpression} ${H.serviceDefinitionExpression}`})};f.preRequestCallback=({queryPayload:U,layer:H,method:O})=>{pa({layer:H,method:O,query:U,definitionExpression:`${H.definitionExpression} ${H.serviceDefinitionExpression}`})};f.queryUpdatedFeature=function(U,H){return V.apply(this,
arguments)};f.shouldOpenInNewTab=function(U=""){if(U)return!la.test(U.trim().toLowerCase())};f.substituteAttributes=r;f.substituteFieldsInLinksAndAttributes=function({attributes:U,globalAttributes:H,layer:O,text:R,expressionAttributes:Q,fieldInfoMap:W}){return R?r({formattedAttributes:H,template:u(R,{...H,...Q,...U},O),fieldInfoMap:W}):""};Object.defineProperty(f,"__esModule",{value:!0})})},"esri/widgets/Attachments/support/attachmentUtils":function(){define(["exports","../../../assets"],function(f,
g){f.getIconPath=function(a){const w=g.getAssetUrl("esri/themes/base/images/files/");return a?"text/plain"===a?`${w}text-32.svg`:"application/pdf"===a?`${w}pdf-32.svg`:"text/csv"===a?`${w}csv-32.svg`:"application/gpx+xml"===a?`${w}gpx-32.svg`:"application/x-dwf"===a?`${w}cad-32.svg`:"application/postscript"===a||"application/json"===a||"text/xml"===a||"model/vrml"===a?`${w}code-32.svg`:"application/x-zip-compressed"===a||"application/x-7z-compressed"===a||"application/x-gzip"===a||"application/x-tar"===
a||"application/x-gtar"===a||"application/x-bzip2"===a||"application/gzip"===a||"application/x-compress"===a||"application/x-apple-diskimage"===a||"application/x-rar-compressed"===a||"application/zip"===a?`${w}zip-32.svg`:-1!==a.indexOf("image/")?`${w}image-32.svg`:-1!==a.indexOf("audio/")?`${w}sound-32.svg`:-1!==a.indexOf("video/")?`${w}video-32.svg`:-1!==a.indexOf("msexcel")||-1!==a.indexOf("ms-excel")||-1!==a.indexOf("spreadsheetml")?`${w}excel-32.svg`:-1!==a.indexOf("msword")||-1!==a.indexOf("ms-word")||
-1!==a.indexOf("wordprocessingml")?`${w}word-32.svg`:-1!==a.indexOf("powerpoint")||-1!==a.indexOf("presentationml")?`${w}report-32.svg`:`${w}generic-32.svg`:`${w}generic-32.svg`};f.isSupportedImage=function(a){a=a.toLowerCase();return"image/bmp"===a||"image/emf"===a||"image/exif"===a||"image/gif"===a||"image/x-icon"===a||"image/jpeg"===a||"image/png"===a||"image/tiff"===a||"image/x-wmf"===a};Object.defineProperty(f,"__esModule",{value:!0})})},"esri/widgets/Feature/FeatureAttachments/FeatureAttachmentsViewModel":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../../Attachments/AttachmentsViewModel".split(" "),
function(f,g,a,w,z,F,J,G){w=function(K){function D(t){t=K.call(this,t)||this;t.description=null;t.title=null;return t}f._inheritsLoose(D,K);return D}(G);g.__decorate([a.property()],w.prototype,"description",void 0);g.__decorate([a.property()],w.prototype,"title",void 0);return w=g.__decorate([J.subclass("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")],w)})},"esri/widgets/Feature/support/FeatureElementInfo":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../../Widget ../../support/Heading ../../support/widgetUtils ../../support/jsxFactory".split(" "),
function(f,g,a,w,z,F,J,G,K,D,t){w=function(m){function b(e,h){e=m.call(this,e,h)||this;e.description=null;e.headingLevel=2;e.title=null;return e}f._inheritsLoose(b,m);var c=b.prototype;c.render=function(){return t.tsx("div",{class:"esri-feature-element-info"},this.renderTitle(),this.renderDescription())};c.renderTitle=function(){const {title:e}=this;return e?t.tsx(K.Heading,{level:this.headingLevel,class:"esri-feature-element-info__title"},e):null};c.renderDescription=function(){const {description:e}=
this;return e?t.tsx("div",{key:"description",class:"esri-feature-element-info__description"},e):null};return b}(G);g.__decorate([a.property()],w.prototype,"description",void 0);g.__decorate([a.property()],w.prototype,"headingLevel",void 0);g.__decorate([a.property()],w.prototype,"title",void 0);return w=g.__decorate([J.subclass("esri.widgets.Feature.support.FeatureElementInfo")],w)})},"esri/widgets/support/Heading":function(){define("exports ../../core/mathUtils ./widgetUtils ../../core/has ../../core/Logger ./jsxFactory".split(" "),
function(f,g,a,w,z,F){const J={heading:"esri-widget__heading"};f.CSS=J;f.Heading=function(G,K){const D=`h${g.clamp(Math.ceil(G.level),1,6)}`;delete G.level;return F.tsx(D,{...G,class:a.classes(J.heading,G.class)},K)};Object.defineProperty(f,"__esModule",{value:!0})})},"esri/widgets/Feature/FeatureContent":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/accessorSupport/decorators/aliasOf ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureContent/FeatureContentViewModel ./support/featureUtils ../support/widget ../support/jsxFactory".split(" "),
function(f,g,a,w,z,F,J,G,K,D,t,m,b){w=function(c){function e(r,d){r=c.call(this,r,d)||this;r.creator=null;r.graphic=null;r.viewModel=null;r._addTargetToAnchors=k=>{Array.from(k.querySelectorAll("a")).forEach(n=>{t.shouldOpenInNewTab(n.href)&&!n.hasAttribute("target")&&n.setAttribute("target","_blank")})};return r}f._inheritsLoose(e,c);var h=e.prototype;h.renderLoading=function(){return b.tsx("div",{class:"esri-feature-content__loader-container",key:"loader"},b.tsx("div",{class:"esri-feature-content__loader"}))};
h.renderCreated=function(){var r;const d=null==(r=this.viewModel)?void 0:r.created;return d?d instanceof HTMLElement?b.tsx("div",{key:d,bind:d,afterCreate:this._attachToNode}):m.isWidget(d)?b.tsx("div",{key:d},!d.destroyed&&d.render()):b.tsx("div",{key:d,innerHTML:d,afterCreate:this._addTargetToAnchors}):null};h.render=function(){var r;const d=null==(r=this.viewModel)?void 0:r.state;return b.tsx("div",{class:"esri-feature-content"},"loading"===d?this.renderLoading():this.renderCreated())};h._attachToNode=
function(r){r.appendChild(this)};return e}(K);g.__decorate([a.aliasOf("viewModel.creator")],w.prototype,"creator",void 0);g.__decorate([a.aliasOf("viewModel.graphic")],w.prototype,"graphic",void 0);g.__decorate([J.property({type:D})],w.prototype,"viewModel",void 0);return w=g.__decorate([G.subclass("esri.widgets.Feature.FeatureContent")],w)})},"esri/widgets/Feature/FeatureContent/FeatureContentViewModel":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Graphic ../../../core/Accessor ../../../core/HandleOwner ../../../core/watchUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../support/featureUtils".split(" "),
function(f,g,a,w,z,F,J,G,K,D,t,m){w=function(b){function c(h){var r=b.call(this,h)||this;r._loadingPromise=null;r.created=null;r.creator=null;r.destroyer=null;r.graphic=null;r.handles.add(F.init(f._assertThisInitialized(r),"creator",d=>{r._destroyContent();r._createContent(d)}));return r}f._inheritsLoose(c,b);var e=c.prototype;e.destroy=function(){this._destroyContent()};e._destroyContent=function(){const {created:h,graphic:r,destroyer:d}=this;h&&(m.graphicCallback(d,{graphic:r}).catch(()=>null),
this._set("created",null))};e._createContent=function(){var h=f._asyncToGenerator(function*(r){var {graphic:d}=this;this._loadingPromise=r=m.graphicCallback(r,{graphic:d}).catch(()=>null);this.notifyChange("state");d=yield r;r===this._loadingPromise&&(this._loadingPromise=null,this.notifyChange("state"),this._set("created",d))});return function(r){return h.apply(this,arguments)}}();f._createClass(c,[{key:"state",get:function(){return this._loadingPromise?"loading":"ready"}}]);return c}(z.HandleOwnerMixin(w));
g.__decorate([J.property({readOnly:!0})],w.prototype,"created",void 0);g.__decorate([J.property()],w.prototype,"creator",void 0);g.__decorate([J.property()],w.prototype,"destroyer",void 0);g.__decorate([J.property({type:a})],w.prototype,"graphic",void 0);g.__decorate([J.property({readOnly:!0})],w.prototype,"state",null);return w=g.__decorate([t.subclass("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],w)})},"esri/widgets/Feature/FeatureFields":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/watchUtils ../../core/accessorSupport/decorators/aliasOf ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureFields/FeatureFieldsViewModel ./support/FeatureElementInfo ../support/uriUtils ../support/widgetUtils ../support/decorators/messageBundle ../support/jsxFactory".split(" "),
function(f,g,a,w,z,F,J,G,K,D,t,m,b,c,e,h){z=function(r){function d(n,u){n=r.call(this,n,u)||this;n._featureElementInfo=null;n.attributes=null;n.description=null;n.expressionInfos=null;n.fieldInfos=null;n.title=null;n.viewModel=new t;n.messages=null;n.messagesURIUtils=null;return n}f._inheritsLoose(d,r);var k=d.prototype;k.initialize=function(){this._featureElementInfo=new m;a.init(this,["viewModel.description","viewModel.title"],()=>this._setupFeatureElementInfo())};k.destroy=function(){this._featureElementInfo.destroy()};
k.renderFieldInfo=function(n,u){var {attributes:l}=this.viewModel;const p=n.fieldName,E=n.label||p;l=l?null==l[p]?"":l[p]:"";n=!(!n.format||!n.format.dateFormat);l="number"!==typeof l||n?b.autoLink(this.messagesURIUtils,l):this._forceLTR(l);n={["esri-feature-fields__field-data--date"]:n};return h.tsx("tr",{key:`fields-element-info-row-${p}-${u}`},h.tsx("th",{key:`fields-element-info-row-header-${p}-${u}`,class:"esri-feature-fields__field-header",innerHTML:E}),h.tsx("td",{key:`fields-element-info-row-data-${p}-${u}`,
class:this.classes("esri-feature-fields__field-data",n),innerHTML:l}))};k.renderFields=function(){const {formattedFieldInfos:n}=this.viewModel;return null!=n&&n.length?h.tsx("table",{class:"esri-widget__table",summary:this.messages.fieldsSummary},h.tsx("tbody",null,n.map((u,l)=>this.renderFieldInfo(u,l)))):null};k.render=function(){var n;return h.tsx("div",{class:"esri-feature-fields"},null==(n=this._featureElementInfo)?void 0:n.render(),this.renderFields())};k._setupFeatureElementInfo=function(){const {description:n,
title:u}=this;this._featureElementInfo.set({description:n,title:u})};k._forceLTR=function(n){return`&lrm;${n}`};return d}(D);g.__decorate([w.aliasOf("viewModel.attributes")],z.prototype,"attributes",void 0);g.__decorate([w.aliasOf("viewModel.description")],z.prototype,"description",void 0);g.__decorate([w.aliasOf("viewModel.expressionInfos")],z.prototype,"expressionInfos",void 0);g.__decorate([w.aliasOf("viewModel.fieldInfos")],z.prototype,"fieldInfos",void 0);g.__decorate([w.aliasOf("viewModel.title")],
z.prototype,"title",void 0);g.__decorate([G.property({type:t})],z.prototype,"viewModel",void 0);g.__decorate([G.property(),e.messageBundle("esri/widgets/Feature/t9n/Feature")],z.prototype,"messages",void 0);g.__decorate([G.property(),e.messageBundle("esri/widgets/support/t9n/uriUtils")],z.prototype,"messagesURIUtils",void 0);return z=g.__decorate([K.subclass("esri.widgets.Feature.FeatureFields")],z)})},"esri/widgets/Feature/FeatureFields/FeatureFieldsViewModel":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../../../popup/ExpressionInfo ../../../popup/FieldInfo ../support/featureUtils".split(" "),
function(f,g,a,w,z,F,J,G,K,D,t){a=function(m){function b(c){c=m.call(this,c)||this;c.attributes=null;c.expressionInfos=null;c.description=null;c.fieldInfos=null;c.title=null;return c}f._inheritsLoose(b,m);f._createClass(b,[{key:"formattedFieldInfos",get:function(){const {expressionInfos:c,fieldInfos:e}=this,h=[];null==e?void 0:e.forEach(r=>{if(!r.hasOwnProperty("visible")||r.visible)r=r.clone(),r.label=t.getFieldInfoLabel(r,c),h.push(r)});return h}}]);return b}(a);g.__decorate([w.property()],a.prototype,
"attributes",void 0);g.__decorate([w.property({type:[K]})],a.prototype,"expressionInfos",void 0);g.__decorate([w.property()],a.prototype,"description",void 0);g.__decorate([w.property({type:[D]})],a.prototype,"fieldInfos",void 0);g.__decorate([w.property({readOnly:!0})],a.prototype,"formattedFieldInfos",null);g.__decorate([w.property()],a.prototype,"title",void 0);return a=g.__decorate([G.subclass("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")],a)})},"esri/widgets/support/uriUtils":function(){define(["exports",
"../../core/string"],function(f,g){function a(z){let F=null;w.some(J=>{J.pattern.test(z)&&(F=J);return!!F});return F}const w=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",
appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",
appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];f.autoLink=function(z,F){if("string"!==typeof F||!F)return F;const J=a(F);if(!J)return F;const G=F.match(J.pattern);
z=g.replace(g.replace(J.label,{messages:z,hierPart:G&&G[2]}),{appName:J.appName});return F.replace(J.pattern,`<a${J.target?` target="${J.target}"`:""} href="$1"${"_blank"===J.target?' rel\x3d"noreferrer"':""}>${z}</a>`)};Object.defineProperty(f,"__esModule",{value:!0})})},"esri/widgets/Feature/FeatureMedia":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/events ../../core/watchUtils ../../core/accessorSupport/decorators/aliasOf ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureMedia/FeatureMediaViewModel ./support/FeatureElementInfo ./support/featureUtils ../support/chartUtils ../support/widgetUtils ../support/decorators/messageBundle ../support/jsxFactory".split(" "),
function(f,g,a,w,z,F,J,G,K,D,t,m,b,c,e,h,r,d){F=function(k){function n(l,p){l=k.call(this,l,p)||this;l._refreshTimer=null;l._refreshIntervalInfo=null;l._featureElementInfo=null;l.attributes=null;l.activeMediaInfoIndex=null;l.description=null;l.fieldInfoMap=null;l.layer=null;l.mediaInfos=null;l.popupTemplate=null;l.relatedInfos=null;l.title=null;l.viewModel=new m;l.messages=null;return l}f._inheritsLoose(n,k);var u=n.prototype;u.initialize=function(){this._featureElementInfo=new b;this.own(w.init(this,
["viewModel.activeMediaInfo","viewModel.activeMediaInfoIndex"],()=>this._setupMediaRefreshTimer()),w.init(this,["viewModel.description","viewModel.title"],()=>this._setupFeatureElementInfo()))};u.destroy=function(){this._clearMediaRefreshTimer();this._featureElementInfo.destroy()};u.render=function(){var l;return d.tsx("div",{bind:this,class:"esri-feature-media",onkeyup:this._handleMediaKeyup},null==(l=this._featureElementInfo)?void 0:l.render(),this.renderMedia())};u.renderMedia=function(){const {formattedMediaInfoCount:l}=
this.viewModel;return l?d.tsx("div",{key:"media-element-container",class:"esri-feature-media__container"},this.renderMediaPageButton("previous"),this.renderMediaInfo(),this.renderMediaPageButton("next")):null};u.renderImageMediaInfo=function(l){var {_refreshIntervalInfo:p}=this;const {activeMediaInfoIndex:E,formattedMediaInfoCount:x}=this.viewModel,{value:M,refreshInterval:B,altText:q,title:I,type:A}=l,{sourceURL:N,linkURL:V}=M;l=c.shouldOpenInNewTab(V)?"_blank":"_self";const X="_blank"===l?"noreferrer":
"";p=B?p:null;p=d.tsx("img",{alt:q||I,key:`media-${A}-${E}-${x}-${p?p.timestamp:0}`,src:p?p.sourceURL:N});return(l=V?d.tsx("a",{title:I,href:V,rel:X,target:l},p):null)?l:p};u.renderChartMediaInfo=function(l){const {activeMediaInfoIndex:p,formattedMediaInfoCount:E}=this.viewModel;return d.tsx("div",{key:`media-${l.type}-${p}-${E}`,bind:this,class:"esri-feature-media__chart",afterCreate:this._getChartDependencies})};u.renderMediaInfoType=function(){const {activeMediaInfo:l}=this.viewModel;return l?
"image"===l.type?this.renderImageMediaInfo(l):-1!==l.type.indexOf("chart")?this.renderChartMediaInfo(l):null:null};u.renderMediaInfo=function(){var {activeMediaInfo:l}=this.viewModel;if(!l)return null;const p=l.title?d.tsx("div",{key:"media-title",class:"esri-feature-media__item-title",innerHTML:l.title}):null;l=l.caption?d.tsx("div",{key:"media-caption",class:"esri-feature-media__item-caption",innerHTML:l.caption}):null;return d.tsx("div",{key:"media-container",class:"esri-feature-media__item-container"},
d.tsx("div",{key:"media-item-container",class:"esri-feature-media__item"},this.renderMediaInfoType()),p,l)};u.renderMediaPageButton=function(l){if(2>this.viewModel.formattedMediaInfoCount)return null;const p=(l="previous"===l)?this.messages.previous:this.messages.next,E=l?this.classes("esri-feature-media__button","esri-feature-media__previous"):this.classes("esri-feature-media__button","esri-feature-media__next"),x=l?this.classes("esri-feature-media__icon","esri-feature-media__previous-icon","esri-icon-left-triangle-arrow"):
this.classes("esri-feature-media__icon","esri-feature-media__next-icon","esri-icon-right-triangle-arrow"),M=l?this.classes("esri-feature-media__icon","esri-feature-media__previous-icon--rtl","esri-icon-right-triangle-arrow"):this.classes("esri-feature-media__icon","esri-feature-media__next-icon--rtl","esri-icon-left-triangle-arrow");return d.tsx("button",{type:"button",key:l?"media-previous":"media-next",title:p,"aria-label":p,tabIndex:0,class:E,bind:this,onclick:l?this._previous:this._next},d.tsx("span",
{"aria-hidden":"true",class:x}),d.tsx("span",{"aria-hidden":"true",class:M}))};u._setupFeatureElementInfo=function(){const {description:l,title:p}=this;this._featureElementInfo.set({description:l,title:p})};u._next=function(){this.viewModel.next()};u._previous=function(){this.viewModel.previous()};u._getChartDependencies=function(){var l=f._asyncToGenerator(function*(p){const E=yield e.loadChartsModule(),{activeMediaInfo:x}=this.viewModel;this._renderChart({chartDiv:p,mediaInfo:x,chartsModule:E})});
return function(p){return l.apply(this,arguments)}}();u._handleMediaKeyup=function(l){const p=a.eventKey(l);"ArrowLeft"===p&&(l.stopPropagation(),this.viewModel.previous());"ArrowRight"===p&&(l.stopPropagation(),this.viewModel.next())};u._renderChart=function(l){const {chartsModule:p,chartDiv:E,mediaInfo:x}=l,{value:M,type:B}=x,{am4core:q}=p,I=e.getColorSet(q);h.isDarkTheme()&&q.useTheme(p.am4themes_dark);q.useTheme(p.am4themes_animated);q.useTheme(function(A){A instanceof q.ColorSet&&I&&(A.list=
I)});l="pie-chart"===B?this._createPieChart(l):this._createXYChart(l);E.setAttribute("aria-label",x.altText||x.title);l.data=M.series.map(A=>({tooltip:A.tooltip,value:A.value})).filter(A=>"pie-chart"===B?0<A.value:!0)};u._customizeChartTooltip=function(l,p){l.label.wrap=!0;l.label.maxWidth=200;l.autoTextColor=!1;l.getFillFromObject=!1;l.label.fill=p.color("#ffffff");l.background.fill=p.color({r:0,g:0,b:0,a:.7})};u._createPieChart=function(l){const {chartDiv:p,chartsModule:E}=l,{am4core:x,am4charts:M}=
E;l=x.create(p,M.PieChart);l.rtl=h.isRTL(this.container);const B=l.series.push(new M.PieSeries);B.labels.template.disabled=!0;B.ticks.template.disabled=!0;B.dataFields.value="value";B.dataFields.category="tooltip";this._customizeChartTooltip(B.tooltip,x);return l};u._getMinSeriesValue=function(l){let p=0;l.forEach(E=>p=Math.min(E.value,p));return p};u._createColumnChart=function(l,p){const {chartsModule:E,mediaInfo:x}=p;({value:p}=x);const {am4core:M,am4charts:B}=E,q=l.xAxes.push(new B.CategoryAxis);
q.dataFields.category="tooltip";q.renderer.labels.template.disabled=!0;this._customizeChartTooltip(q.tooltip,M);q.tooltip.events.on("sizechanged",()=>{q.tooltip.dy=-q.tooltip.contentHeight});var I=l.yAxes.push(new B.ValueAxis);const A=I.renderer.labels.template;I.renderer.minLabelPosition=.05;I.renderer.maxLabelPosition=.95;I.min=this._getMinSeriesValue(p.series);this._customizeChartTooltip(I.tooltip,M);A.wrap=!0;I=l.series.push(new B.ColumnSeries);I.dataFields.valueY="value";I.dataFields.categoryX=
"tooltip";l.cursor=new B.XYCursor;15<p.series.length&&(l.scrollbarX=new M.Scrollbar)};u._createBarChart=function(l,p){const {chartsModule:E,mediaInfo:x}=p;({value:p}=x);const {am4core:M,am4charts:B}=E,q=l.yAxes.push(new B.CategoryAxis);q.dataFields.category="tooltip";q.renderer.inversed=!0;q.renderer.labels.template.disabled=!0;this._customizeChartTooltip(q.tooltip,M);q.tooltip.events.on("sizechanged",()=>{q.tooltip.dx=q.tooltip.contentWidth});var I=l.xAxes.push(new B.ValueAxis);const A=I.renderer.labels.template;
I.renderer.minLabelPosition=.05;I.renderer.maxLabelPosition=.95;I.min=this._getMinSeriesValue(p.series);this._customizeChartTooltip(I.tooltip,M);A.wrap=!0;I=l.series.push(new B.ColumnSeries);I.dataFields.valueX="value";I.dataFields.categoryY="tooltip";l.cursor=new B.XYCursor;15<p.series.length&&(l.scrollbarY=new M.Scrollbar)};u._createLineChart=function(l,p){const {chartsModule:E,mediaInfo:x}=p;({value:p}=x);const {am4core:M,am4charts:B}=E,q=l.xAxes.push(new B.CategoryAxis);q.dataFields.category=
"tooltip";q.renderer.labels.template.disabled=!0;this._customizeChartTooltip(q.tooltip,M);q.tooltip.events.on("sizechanged",()=>{q.tooltip.dy=-q.tooltip.contentHeight});var I=l.yAxes.push(new B.ValueAxis);const A=I.renderer.labels.template;I.renderer.minLabelPosition=.05;I.renderer.maxLabelPosition=.95;I.min=this._getMinSeriesValue(p.series);this._customizeChartTooltip(I.tooltip,M);A.wrap=!0;I=l.series.push(new B.LineSeries);I.dataFields.categoryX="tooltip";I.dataFields.valueY="value";l.cursor=new B.XYCursor;
15<p.series.length&&(l.scrollbarX=new M.Scrollbar)};u._createXYChart=function(l){const {chartDiv:p,chartsModule:E,mediaInfo:x}=l,{type:M}=x,{am4core:B,am4charts:q}=E,I=B.create(p,q.XYChart);I.rtl=h.isRTL(this.container);"column-chart"===M&&this._createColumnChart(I,l);"bar-chart"===M&&this._createBarChart(I,l);"line-chart"===M&&this._createLineChart(I,l);return I};u._clearMediaRefreshTimer=function(){const {_refreshTimer:l}=this;l&&(clearTimeout(l),this._refreshTimer=null)};u._updateMediaInfoTimestamp=
function(l){const p=Date.now();this._refreshIntervalInfo={timestamp:p,sourceURL:this._getImageSource(l,p)};this.scheduleRender()};u._setupMediaRefreshTimer=function(){this._clearMediaRefreshTimer();const {activeMediaInfo:l}=this.viewModel;l&&"image"===l.type&&l.refreshInterval&&this._setRefreshTimeout(l)};u._setRefreshTimeout=function(l){const {refreshInterval:p,value:E}=l;p&&(l=6E4*p,this._updateMediaInfoTimestamp(E.sourceURL),this._refreshTimer=setInterval(()=>{this._updateMediaInfoTimestamp(E.sourceURL)},
l))};u._getImageSource=function(l,p){const E=-1!==l.indexOf("?")?"\x26":"?",[x,M=""]=l.split("#");return`${x}${E}timestamp=${p}${M?"#":""}${M}`};return n}(t);g.__decorate([z.aliasOf("viewModel.attributes")],F.prototype,"attributes",void 0);g.__decorate([z.aliasOf("viewModel.activeMediaInfoIndex")],F.prototype,"activeMediaInfoIndex",void 0);g.__decorate([z.aliasOf("viewModel.description")],F.prototype,"description",void 0);g.__decorate([z.aliasOf("viewModel.fieldInfoMap")],F.prototype,"fieldInfoMap",
void 0);g.__decorate([z.aliasOf("viewModel.layer")],F.prototype,"layer",void 0);g.__decorate([z.aliasOf("viewModel.mediaInfos")],F.prototype,"mediaInfos",void 0);g.__decorate([z.aliasOf("viewModel.popupTemplate")],F.prototype,"popupTemplate",void 0);g.__decorate([z.aliasOf("viewModel.relatedInfos")],F.prototype,"relatedInfos",void 0);g.__decorate([z.aliasOf("viewModel.title")],F.prototype,"title",void 0);g.__decorate([K.property({type:m})],F.prototype,"viewModel",void 0);g.__decorate([K.property(),
r.messageBundle("esri/widgets/Feature/t9n/Feature")],F.prototype,"messages",void 0);return F=g.__decorate([D.subclass("esri.widgets.Feature.FeatureMedia")],F)})},"esri/widgets/Feature/FeatureMedia/FeatureMediaViewModel":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../../../popup/FieldInfo ../../../popup/content/support/ChartMediaInfoValueSeries ../support/featureUtils ../support/relatedFeatureUtils".split(" "),
function(f,g,a,w,z,F,J,G,K,D,t,m){a=function(b){function c(h){h=b.call(this,h)||this;h.activeMediaInfoIndex=0;h.attributes=null;h.description=null;h.fieldInfoMap=null;h.formattedAttributes=null;h.expressionAttributes=null;h.layer=null;h.mediaInfos=null;h.popupTemplate=null;h.relatedInfos=null;h.title=null;return h}f._inheritsLoose(c,b);var e=c.prototype;e.setActiveMedia=function(h){this._setContentElementMedia(h)};e.next=function(){this._pageContentElementMedia(1)};e.previous=function(){this._pageContentElementMedia(-1)};
e._setContentElementMedia=function(h){const {formattedMediaInfoCount:r}=this;this.activeMediaInfoIndex=(h+r)%r};e._pageContentElementMedia=function(h){const {activeMediaInfoIndex:r}=this;this._setContentElementMedia(r+h)};e._formatMediaInfos=function(){const {attributes:h,mediaInfos:r,formattedAttributes:d,expressionAttributes:k,fieldInfoMap:n,layer:u}=this;return null==r?void 0:r.map(l=>{if(!l)return null;l.title=t.substituteFieldsInLinksAndAttributes({attributes:h,fieldInfoMap:n,globalAttributes:d,
expressionAttributes:k,layer:u,text:l.title});l.caption=t.substituteFieldsInLinksAndAttributes({attributes:h,fieldInfoMap:n,globalAttributes:d,expressionAttributes:k,layer:u,text:l.caption});l.altText=t.substituteFieldsInLinksAndAttributes({attributes:h,fieldInfoMap:n,globalAttributes:d,expressionAttributes:k,layer:u,text:l.altText});if("image"===l.type){var {value:p}=l;this._setImageValue({value:p,formattedAttributes:d,layer:u});return l.value.sourceURL?l:void 0}return"pie-chart"===l.type||"line-chart"===
l.type||"column-chart"===l.type||"bar-chart"===l.type?({value:p}=l,this._setChartValue({value:p,chartType:l.type,attributes:h,formattedAttributes:d,layer:u}),l):null}).filter(Boolean)};e._setImageValue=function(h){const {fieldInfoMap:r}=this,{value:d,formattedAttributes:k,layer:n}=h,{linkURL:u,sourceURL:l}=d;l&&(h=t.fixTokens(l,n),d.sourceURL=t.substituteAttributes({formattedAttributes:k,template:h,fieldInfoMap:r}));u&&(h=t.fixTokens(u,n),d.linkURL=t.substituteAttributes({formattedAttributes:k,template:h,
fieldInfoMap:r}))};e._setChartValue=function(h){const {value:r,attributes:d,formattedAttributes:k,chartType:n,layer:u}=h,{popupTemplate:l,relatedInfos:p}=this,{fields:E,normalizeField:x}=r;r.fields=t.getFixedFieldNames(E,u);x&&(r.normalizeField=t.getFixedFieldName(x,u));if(E.some(B=>!!(null!=k[B]||t.isRelatedField(B)&&p.size))){var M=null==l?void 0:l.fieldInfos;E.forEach(B=>{t.isRelatedField(B)?r.series=[...r.series,...this._getRelatedChartInfos({fieldInfos:M,fieldName:B,formattedAttributes:k,chartType:n,
value:r})]:(B=this._getChartOption({value:r,attributes:d,chartType:n,formattedAttributes:k,fieldName:B,fieldInfos:M}),r.series.push(B))})}};e._getRelatedChartInfos=function(h){var r;const {fieldInfos:d,fieldName:k,formattedAttributes:n,chartType:u,value:l}=h,p=[];h=m.getRelatedFieldInfo(k);const {layerId:E,fieldName:x}=h;h=null==(r=this.relatedInfos)?void 0:r.get(E.toString());if(!h)return p;const {relatedFeatures:M,relation:B}=h;if(!B||!M)return p;({cardinality:r}=B);M.forEach(q=>{const {attributes:I}=
q;I&&Object.keys(I).forEach(A=>{A===x&&p.push(this._getChartOption({value:l,attributes:I,formattedAttributes:n,fieldName:k,chartType:u,relatedFieldName:A,fieldInfos:d}))})});return"one-to-many"===r||"many-to-many"===r?p:[p[0]]};e._getTooltip=function({label:h,value:r,chartType:d}){return"pie-chart"===d?h:`${h}: ${r}`};e._getChartOption=function(h){const {value:r,attributes:d,formattedAttributes:k,fieldName:n,relatedFieldName:u,fieldInfos:l,chartType:p}=h;var {layer:E}=this;const {normalizeField:x,
tooltipField:M}=r;var B=x?t.isRelatedField(x)?d[m.getRelatedFieldInfo(x).fieldName]:d[x]:null;h=u&&void 0!==d[u]?d[u]:void 0!==d[n]?d[n]:k[n];const q=void 0===h?null:h&&B?h/B:h;h=new D({value:q});if(t.isRelatedField(n)){var I=m.getRelatedFieldInfo(n);var A=m.getRelatedFieldInfo(M);A=A?A.fieldName:null;E=t.formatValueToFieldInfo(q,{fieldInfos:l,fieldName:u,layer:E,preventPlacesFormatting:!!B});I=I?I.label||I.fieldName:u;h.tooltip=this._getTooltip({label:A&&void 0!==d[A]?d[A]:I,value:E,chartType:p});
return h}B=t.getFieldInfo(l,n);E=t.getFixedFieldName(n,E);B=M&&void 0!==k[M]?k[M]:t.getFieldInfoLabel(B||new K({fieldName:E}),null==(I=this.popupTemplate)?void 0:I.expressionInfos);h.tooltip=this._getTooltip({label:B,value:k[E],chartType:p});return h};f._createClass(c,[{key:"activeMediaInfo",get:function(){return this.formattedMediaInfos[this.activeMediaInfoIndex]||null}},{key:"formattedMediaInfos",get:function(){return this._formatMediaInfos()||[]}},{key:"formattedMediaInfoCount",get:function(){return this.formattedMediaInfos.length}}]);
return c}(a);g.__decorate([w.property()],a.prototype,"activeMediaInfoIndex",void 0);g.__decorate([w.property({readOnly:!0})],a.prototype,"activeMediaInfo",null);g.__decorate([w.property()],a.prototype,"attributes",void 0);g.__decorate([w.property()],a.prototype,"description",void 0);g.__decorate([w.property()],a.prototype,"fieldInfoMap",void 0);g.__decorate([w.property()],a.prototype,"formattedAttributes",void 0);g.__decorate([w.property()],a.prototype,"expressionAttributes",void 0);g.__decorate([w.property({readOnly:!0})],
a.prototype,"formattedMediaInfos",null);g.__decorate([w.property()],a.prototype,"layer",void 0);g.__decorate([w.property({readOnly:!0})],a.prototype,"formattedMediaInfoCount",null);g.__decorate([w.property()],a.prototype,"mediaInfos",void 0);g.__decorate([w.property()],a.prototype,"popupTemplate",void 0);g.__decorate([w.property()],a.prototype,"relatedInfos",void 0);g.__decorate([w.property()],a.prototype,"title",void 0);return a=g.__decorate([G.subclass("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")],
a)})},"esri/widgets/Feature/support/relatedFeatureUtils":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../request ../../../core/Error ../../../core/Logger ../../../core/promiseUtils ../../../layers/support/fieldUtils ../../../rest/support/Query ../../../rest/support/RelationshipQuery ../../../rest/support/StatisticDefinition ../../../tasks/QueryTask ./featureUtils".split(" "),function(f,g,a,w,z,F,J,G,K,D,t,m){function b(p,E){if(!E.relationships)return null;let x=null;
({relationships:E}=E);E.some(M=>M.id===parseInt(p,10)?(x=M,!0):!1);return x}function c({originRelationship:p,relationships:E,layerId:x}){let M;E&&E.some(B=>{`${B.relatedTableId}`===x&&B.id===p.id&&(M=B);return!!M});return M}function e(p,E){E=E.toLowerCase();for(const x in p)if(x.toLowerCase()===E)return p[x];return null}function h(p,E,x,M){const B=new K;B.outFields=["*"];B.relationshipId="number"===typeof E.id?E.id:parseInt(E.id,10);B.objectIds=[p.attributes[x.objectIdField]];return x.queryRelatedFeatures(B,
M)}function r(p,E,x){let M=0;const B=[];for(;M<E.length;)B.push(`${p} IN (${E.slice(M,x+M)})`),M+=x;return B.join(" OR ")}function d(p,E,x,M){return k.apply(this,arguments)}function k(){k=g._asyncToGenerator(function*(p,E,x,M){var B=x.layerId.toString();const {layerInfo:q,queryTask:I,relation:A,relatedFields:N,outStatistics:V}=E;B=c({originRelationship:A,relationships:q.relationships,layerId:B});if(B.relationshipTableId&&B.keyFieldInRelationshipTable){x=(yield h(p,B,x,M))[p.attributes[x.objectIdField]];
if(!x)return null;const X=x.features.map(T=>T.attributes[q.objectIdField]);if(0<(null==V?void 0:V.length)&&q.supportsStatistics)return E=new G,E.where=r(q.objectIdField,X,1E3),E.outFields=N,E.outStatistics=V,E={features:Promise.resolve(x),statsFeatures:I.execute(E)},F.eachAlways(E)}return(B=null==B?void 0:B.keyField)?(x=J.isNumericField(n(q.fields,B)),p=e(p.attributes,A.keyField),B=x?`${B}=${p}`:`${B}='${p}'`,p=I.execute(new G({where:B,outFields:E.relatedFields}),M),E=E.outStatistics&&0<E.outStatistics.length&&
q.supportsStatistics?I.execute(new G({where:B,outFields:E.relatedFields,outStatistics:E.outStatistics}),M):null,M={features:p},E&&(M.statsFeatures=E),F.eachAlways(M)):null});return k.apply(this,arguments)}function n(p,E){if(null!=p){E=E.toLowerCase();for(const x of p)if(x&&x.name.toLowerCase()===E)return x}return null}const u=z.getLogger("esri.widgets.Feature.support.relatedFeatureUtils"),l=new Map;f.createRelatedInfo=function(p,E){if(p=b(p,E)){var x=`${E.url}/${p.relatedTableId}`;E=new t({url:x,
sourceSpatialReference:E.spatialReference});return{url:x,queryTask:E,relation:p,relatedFields:[],outStatistics:[]}}};f.getDestinationRelation=c;f.getRelatedFieldInfo=function(p){if(!m.isRelatedField(p))return null;const [E,x]=p.split("/").slice(1);return{layerId:E,fieldName:x}};f.queryLayerInfos=function({relatedInfos:p,layer:E},x){const M={};p.forEach((B,q)=>{({relation:B}=B);if(!B)throw q=new w("relation-required","A relation is required on a layer to retrieve related records."),u.error(q),q;({relatedTableId:B}=
B);if("number"!==typeof B)throw q=new w("A related table ID is required on a layer to retrieve related records."),u.error(q),q;B=`${E.url}/${B}`;const I=l.get(B),A=I?I:a(B,{query:{f:"json"},signal:x&&x.signal});I||l.set(B,A);M[q]=A});return F.eachAlways(M)};f.queryRelatedFeatures=function({graphic:p,relatedInfos:E,layer:x},M){const B={};E.forEach((q,I)=>{q.layerInfo&&(B[I]=d(p,q,x,M))});return F.eachAlways(B)};f.setRelatedFeatures=function(p,E){if(E&&p){var {features:x,statsFeatures:M}=p;p=x&&x.value;
E.relatedFeatures=p?p.features:[];p=M&&M.value;E.relatedStatsFeatures=p?p.features:[]}};f.updateRelatedInfo=function({relatedInfo:p,fieldName:E,fieldInfo:x}){p.relatedFields.push(E);x.statisticType&&(E=new D({statisticType:x.statisticType,onStatisticField:E,outStatisticFieldName:E}),p.outStatistics.push(E))};Object.defineProperty(f,"__esModule",{value:!0})})},"esri/widgets/support/chartUtils":function(){define("require exports ../../chunks/_rollupPluginBabelHelpers ../../intl ../../core/has ../../intl/locale".split(" "),
function(f,g,a,w,z,F){function J(b){if(!b)return"en-us";if(D.has(b.toLowerCase()))return b.toLowerCase();{b=b.split("-")[0].toLowerCase();let e=null;for(c of D.keys())if(c.startsWith(b)){e=c;break}var c=e}return c||"en-us"}function G(){G=a._asyncToGenerator(function*(b=F.getLocale()){b=J(b);if(t&&b===m)return t;t=(new Promise(function(c,e){f(["../../chunks/index"],c,e)})).then(function(c){return c.index});m=b;try{const [c,e]=yield Promise.all([t,D.get(m)()]);m===b&&(c.am4core.options.defaultLocale=
e.default);c.am4core.options.suppressWarnings=!0;c.am4core.options.autoDispose=!0}catch{return m=t=null}return t});return G.apply(this,arguments)}w="#ffffff #858585 #ffbebe #ffebbe #ffebaf #ffffbe #e9ffbe #d3ffbe #beffe8 #bee8ff #bed2ff #e8beff #ffbee8 #ebebeb #707070 #ff7f7f #ffa77f #ffd37f #ffff73 #d1ff73 #a3ff73 #73ffdf #73dfff #73b2ff #df73ff #ff73df #d6d6d6 #5c5c5c #ff0000 #ff5500 #ffaa00 #ffff00 #aaff00 #55ff00 #00ffc5 #00c5ff #0070ff #c500ff #ff00c5 #c2c2c2 #474747 #e60000 #e64c00 #e69800 #e6e600 #98e600 #4ce600 #00e6a9 #00a9e6 #005ce6 #a900e6 #e600a9 #adadad #242424 #a80000 #a83800 #a87000 #a8a800 #70a800 #38a800 #00a884 #0084a8 #004da8 #8400a8 #a80084 #999999 #1a1a1a #730000 #732600 #734c00 #737300 #4c7300 #267300 #00734c #004c73 #002673 #4c0073 #73004".split(" ");
var K=[{name:"default",colors:[].concat(w.slice(30,39),w.slice(28,30).reverse())},{name:"cat-dark",colors:"#ed5151 #149ece #a7c636 #9e559c #fc921f #ffde3e #f789d8 #b7814a #3caf99 #6b6bd6 #b54779 #7f7f7f".split(" ")},{name:"tropical-bliss",colors:"#fce138 #ff9399 #fcd27e #f1983c #a553b7 #b1a9d0 #6ecffc #4c81cd #fc6f84 #fc3e5a #6af689 #48885c".split(" ")},{name:"desert-blooms",colors:"#102432 #144d59 #ffc730 #ed9310 #a64f1b #661510 #d9351a #b31515 #4a0932 #8c213f #18382e #2c6954".split(" ")},{name:"under-the-sea",
colors:"#bf9727 #607100 #00734c #704489 #01acca #024e76 #f09100 #ea311f #c6004b #7570b3 #666666 #333333".split(" ")},{name:"vibrant-rainbow",colors:"#fffb00 #f5cb11 #9fd40c #46e39c #32b8a6 #7ff2fa #ac08cc #dd33ff #eb7200 #e8a784 #bf2e2e #6c7000".split(" ")},{name:"ocean-bay",colors:"#191921 #11495c #78b1c2 #454f4b #8f8f82 #9be0c0 #87b051 #f7ec88 #ebdcc1 #dbb658 #c43541 #75351e".split(" ")},{name:"prairie-summer",colors:"#332424 #751555 #d47013 #d68989 #211173 #82aad6 #7bfaeb #6ec9a8 #6b6408 #eada40 #ccc54a #1fc235".split(" ")},
{name:"pastel-chalk",colors:"#fffd99 #f5e6a4 #c1d48c #b8e3d0 #a0b8b5 #cbf7fa #d791f2 #dfc1eb #f2b983 #e8c4b2 #bf8e8e #94995c".split(" ")},{name:"seq-yellow-orange-red-bright",colors:"#910000 #b1260b #c0370f #e05919 #ef6a1d #ff7b22 #ffa143 #ffb454 #ffda74 #ffed85".split(" ")},{name:"seq-reds-bright",colors:"#57453b #7b4238 #9f4036 #c23d33 #d7483c #ec5244 #f3696c #f9816c #ffc4ae #fff0dc".split(" ")},{name:"seq-purples-bright",colors:"#4e465c #5a4a78 #695291 #775baa #8663c3 #946bdc #aa89e8 #c1a6f3 #d7c4ff #e6e1ff".split(" ")},
{name:"seq-blues-bright",colors:"#404d54 #435c6c #48799d #4b88b6 #4d96ce #50a5e7 #74bbed #98d0f3 #bce6f9 #e6faff".split(" ")},{name:"seq-greens-bright",colors:"#39544c #386757 #368165 #359b73 #33b581 #4bc392 #64d2a2 #7ce0b3 #cbf6d9 #f4ffea".split(" ")},{name:"seq-browns-bright",colors:"#524834 #715b38 #8f6e3c #ae8140 #cc9444 #eba748 #eeb664 #f0c47f #f9e0b7 #fff8eb".split(" ")}];const D=new Map([["ar",()=>(new Promise(function(b,c){f(["../../chunks/ar2"],b,c)})).then(function(b){return b.ar})],["bs-ba",
()=>(new Promise(function(b,c){f(["../../chunks/bs_BA"],b,c)})).then(function(b){return b.bs_BA})],["ca-es",()=>(new Promise(function(b,c){f(["../../chunks/ca_ES"],b,c)})).then(function(b){return b.ca_ES})],["cs-cz",()=>(new Promise(function(b,c){f(["../../chunks/cs_CZ"],b,c)})).then(function(b){return b.cs_CZ})],["da-dk",()=>(new Promise(function(b,c){f(["../../chunks/da_DK"],b,c)})).then(function(b){return b.da_DK})],["de-de",()=>(new Promise(function(b,c){f(["../../chunks/de_DE"],b,c)})).then(function(b){return b.de_DE})],
["de-ch",()=>(new Promise(function(b,c){f(["../../chunks/de_CH"],b,c)})).then(function(b){return b.de_CH})],["el-gr",()=>(new Promise(function(b,c){f(["../../chunks/el_GR"],b,c)})).then(function(b){return b.el_GR})],["en-us",()=>(new Promise(function(b,c){f(["../../chunks/en_US"],b,c)})).then(function(b){return b.en_US})],["en-ca",()=>(new Promise(function(b,c){f(["../../chunks/en_CA"],b,c)})).then(function(b){return b.en_CA})],["es-es",()=>(new Promise(function(b,c){f(["../../chunks/es_ES"],b,c)})).then(function(b){return b.es_ES})],
["et-ee",()=>(new Promise(function(b,c){f(["../../chunks/et_EE"],b,c)})).then(function(b){return b.et_EE})],["fi-fi",()=>(new Promise(function(b,c){f(["../../chunks/fi_FI"],b,c)})).then(function(b){return b.fi_FI})],["fr-fr",()=>(new Promise(function(b,c){f(["../../chunks/fr_FR"],b,c)})).then(function(b){return b.fr_FR})],["he-il",()=>(new Promise(function(b,c){f(["../../chunks/he_IL"],b,c)})).then(function(b){return b.he_IL})],["hr-hr",()=>(new Promise(function(b,c){f(["../../chunks/hr_HR"],b,c)})).then(function(b){return b.hr_HR})],
["hu-hu",()=>(new Promise(function(b,c){f(["../../chunks/hu_HU"],b,c)})).then(function(b){return b.hu_HU})],["id-id",()=>(new Promise(function(b,c){f(["../../chunks/id_ID"],b,c)})).then(function(b){return b.id_ID})],["it-it",()=>(new Promise(function(b,c){f(["../../chunks/it_IT"],b,c)})).then(function(b){return b.it_IT})],["ja-jp",()=>(new Promise(function(b,c){f(["../../chunks/ja_JP"],b,c)})).then(function(b){return b.ja_JP})],["ko-kr",()=>(new Promise(function(b,c){f(["../../chunks/ko_KR"],b,c)})).then(function(b){return b.ko_KR})],
["lt-lt",()=>(new Promise(function(b,c){f(["../../chunks/lt_LT"],b,c)})).then(function(b){return b.lt_LT})],["lv-lv",()=>(new Promise(function(b,c){f(["../../chunks/lv_LV"],b,c)})).then(function(b){return b.lv_LV})],["nb-no",()=>(new Promise(function(b,c){f(["../../chunks/nb_NO"],b,c)})).then(function(b){return b.nb_NO})],["nl-nl",()=>(new Promise(function(b,c){f(["../../chunks/nl_NL"],b,c)})).then(function(b){return b.nl_NL})],["pl-pl",()=>(new Promise(function(b,c){f(["../../chunks/pl_PL"],b,c)})).then(function(b){return b.pl_PL})],
["pt-br",()=>(new Promise(function(b,c){f(["../../chunks/pt_BR"],b,c)})).then(function(b){return b.pt_BR})],["pt-pt",()=>(new Promise(function(b,c){f(["../../chunks/pt_PT"],b,c)})).then(function(b){return b.pt_PT})],["ro-ro",()=>(new Promise(function(b,c){f(["../../chunks/ro_RO"],b,c)})).then(function(b){return b.ro_RO})],["ru-ru",()=>(new Promise(function(b,c){f(["../../chunks/ru_RU"],b,c)})).then(function(b){return b.ru_RU})],["sk-sk",()=>(new Promise(function(b,c){f(["../../chunks/sk_SK"],b,c)})).then(function(b){return b.sk_SK})],
["sl-sl",()=>(new Promise(function(b,c){f(["../../chunks/sl_SL"],b,c)})).then(function(b){return b.sl_SL})],["sr-rs",()=>(new Promise(function(b,c){f(["../../chunks/sr_RS"],b,c)})).then(function(b){return b.sr_RS})],["sv-se",()=>(new Promise(function(b,c){f(["../../chunks/sv_SE"],b,c)})).then(function(b){return b.sv_SE})],["th-th",()=>(new Promise(function(b,c){f(["../../chunks/th_TH"],b,c)})).then(function(b){return b.th_TH})],["tr-tr",()=>(new Promise(function(b,c){f(["../../chunks/tr_TR"],b,c)})).then(function(b){return b.tr_TR})],
["uk-ua",()=>(new Promise(function(b,c){f(["../../chunks/uk_UA"],b,c)})).then(function(b){return b.uk_UA})],["vi-vn",()=>(new Promise(function(b,c){f(["../../chunks/vi_VN"],b,c)})).then(function(b){return b.vi_VN})],["zh-cn",()=>(new Promise(function(b,c){f(["../../chunks/zh_Hans"],b,c)})).then(function(b){return b.zh_Hans})],["zh-hk",()=>(new Promise(function(b,c){f(["../../chunks/zh_Hant"],b,c)})).then(function(b){return b.zh_Hant})],["zh-tw",()=>(new Promise(function(b,c){f(["../../chunks/zh_Hant"],
b,c)})).then(function(b){return b.zh_Hant})]]);let t,m;g.getChartLocale=J;g.getColorSet=function(b,c="default"){const e=K.find(h=>h.name===c);return e?e.colors.map(h=>b.color(h)):null};g.loadChartsModule=function(){return G.apply(this,arguments)};Object.defineProperty(g,"__esModule",{value:!0})})},"esri/widgets/Feature/FeatureViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Graphic ../../arcade/featureset/support/FeatureSetQueryInterceptor ../../core/Accessor ../../core/Handles ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/throttle ../../core/watchUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/subclass ../../popup/content/TextContent ./FeatureAttachments/FeatureAttachmentsViewModel ./FeatureContent/FeatureContentViewModel ./FeatureFields/FeatureFieldsViewModel ./FeatureMedia/FeatureMediaViewModel ./support/arcadeFeatureUtils ./support/featureUtils ./support/relatedFeatureUtils".split(" "),
function(f,g,a,w,z,F,J,G,K,D,t,m,b,c,e,h,r,d,k,n,u,l,p){var E;const x=J.getLogger("esri.widgets.FeatureViewModel"),M={attachmentsContent:!0,customContent:!0,fieldsContent:!0,mediaContent:!0,textContent:!0};z=E=function(B){function q(A){var N=B.call(this,A)||this;N._handles=new F;N._error=null;N._featureAbortController=null;N.graphicChangedThrottled=D.throttle(N.graphicChanged,1,f._assertThisInitialized(N));N._expressionAttributes=null;N.abilities={...M};N.content=null;N.contentViewModels=[];N.defaultPopupTemplateEnabled=
!1;N.formattedAttributes=null;N.lastEditInfo=null;N.relatedInfos=new Map;N.title="";N.view=null;N._isAllowedContentType=V=>{const {abilities:X}=f._assertThisInitialized(N);return"attachments"===V.type&&X.attachmentsContent||"custom"===V.type&&X.customContent||"fields"===V.type&&X.fieldsContent||"media"===V.type&&X.mediaContent||"text"===V.type&&X.textContent};N._handles.add(t.init(f._assertThisInitialized(N),["graphic","_effectivePopupTemplate","abilities"],()=>N.graphicChangedThrottled()));return N}
f._inheritsLoose(q,B);var I=q.prototype;I.destroy=function(){this._clear();this._cancelFeatureQuery();this._error=null;this._handles.destroy();this.graphic=this._handles=null;this._destroyContentViewModels();this.relatedInfos.clear()};I.castAbilities=function(A){return{...M,...A}};I.setActiveMedia=function(A,N){A=this.contentViewModels[A];A instanceof n&&A.setActiveMedia(N)};I.nextMedia=function(A){A=this.contentViewModels[A];A instanceof n&&A.next()};I.previousMedia=function(A){A=this.contentViewModels[A];
A instanceof n&&A.previous()};I._clear=function(){this._set("title","");this._set("content",null);this._set("formattedAttributes",null)};I.graphicChanged=function(){var A=f._asyncToGenerator(function*(){this._cancelFeatureQuery();this._error=null;this._clear();const {graphic:N}=this;if(N){var V=K.createAbortController();this._featureAbortController=V;try{yield this._queryFeature({signal:V.signal})}catch(X){K.isAbortError(X)||(this._error=X,x.error("error","The popupTemplate could not be displayed for this feature.",
{error:X,graphic:N,popupTemplate:this._effectivePopupTemplate}))}this._featureAbortController===V&&(this._featureAbortController=null)}});return function(){return A.apply(this,arguments)}}();I._cancelFeatureQuery=function(){const {_featureAbortController:A}=this;A&&A.abort();this._featureAbortController=null};I._compileContent=function(A){this._destroyContentViewModels();if(this.graphic)return Array.isArray(A)?A.filter(this._isAllowedContentType).map((N,V)=>{if("attachments"===N.type)return this._compileAttachments(N,
V);if("custom"===N.type)return this._compileCustom(N,V);if("fields"===N.type)return this._compileFields(N,V);if("media"===N.type)return this._compileMedia(N,V);if("text"===N.type)return this._compileText(N,V)}):"string"===typeof A?this._compileText(new h({text:A}),0).text:A};I._destroyContentViewModels=function(){this.contentViewModels.forEach(A=>A&&!A.destroyed&&A.destroy());this._set("contentViewModels",[])};I._compileAttachments=function(A,N){const {graphic:V}=this,{description:X,title:T}=A;this.contentViewModels[N]=
new r({graphic:V,...this._compileTitleAndDesc({title:T,description:X})});return A};I._compileCustom=function(A,N){const {graphic:V}=this,{creator:X,destroyer:T}=A;this.contentViewModels[N]=new d({graphic:V,creator:X,destroyer:T});return A};I._compileTitleAndDesc=function({title:A,description:N}){const {_fieldInfoMap:V,_sourceLayer:X,graphic:T,formattedAttributes:v,_expressionAttributes:L}=this,{attributes:y}=T,C=v.global;return{title:l.substituteFieldsInLinksAndAttributes({attributes:y,fieldInfoMap:V,
globalAttributes:C,expressionAttributes:L,layer:X,text:A}),description:l.substituteFieldsInLinksAndAttributes({attributes:y,fieldInfoMap:V,globalAttributes:C,expressionAttributes:L,layer:X,text:N})}};I._compileFields=function(A,N){const {_effectivePopupTemplate:V,formattedAttributes:X}=this,T=A.clone();A=(null==A?void 0:A.fieldInfos)||(null==V?void 0:V.fieldInfos);const v=null==V?void 0:V.expressionInfos,L={...X.global,...X.content[N]},{description:y,title:C}=T;A=new k({attributes:L,expressionInfos:v,
fieldInfos:A,...this._compileTitleAndDesc({title:C,description:y})});this.contentViewModels[N]=A;T.fieldInfos=A.formattedFieldInfos.slice(0);return T};I._compileMedia=function(A,N){const {graphic:V,_fieldInfoMap:X,_effectivePopupTemplate:T,relatedInfos:v,_sourceLayer:L,_expressionAttributes:y}=this;var {attributes:C}=V;const P=this.formattedAttributes.global;A=A.clone();const {description:S,mediaInfos:aa,title:ca}=A;C=new n({activeMediaInfoIndex:A.activeMediaInfoIndex||0,attributes:C,layer:L,fieldInfoMap:X,
formattedAttributes:P,expressionAttributes:y,mediaInfos:aa,popupTemplate:T,relatedInfos:v,...this._compileTitleAndDesc({title:ca,description:S})});A.mediaInfos=C.formattedMediaInfos.slice(0);this.contentViewModels[N]=C;return A};I._compileText=function(A,N){A=A.clone();const {graphic:V,_fieldInfoMap:X,_sourceLayer:T,_expressionAttributes:v}=this;if(A&&A.text){const {attributes:L}=V;A.text=l.substituteFieldsInLinksAndAttributes({attributes:L,fieldInfoMap:X,globalAttributes:this.formattedAttributes.global,
expressionAttributes:v,layer:T,text:A.text})}this.contentViewModels[N]=new d({graphic:V,creator:A.text});return A};I._compileLastEditInfo=function(){const {_effectivePopupTemplate:A,_sourceLayer:N,graphic:V}=this;if(A){var {lastEditInfoEnabled:X}=A,T=null==N?void 0:N.editFieldsInfo;if(X&&T)return l.formatEditInfo(T,V.attributes)}};I._compileTitle=function(A){const {_fieldInfoMap:N,_sourceLayer:V,graphic:X,_expressionAttributes:T}=this,{attributes:v}=X;return l.substituteFieldsInLinksAndAttributes({attributes:v,
fieldInfoMap:N,globalAttributes:this.formattedAttributes.global,expressionAttributes:T,layer:V,text:A})};I._getTitle=function(){var A=f._asyncToGenerator(function*(){const {_effectivePopupTemplate:N,graphic:V}=this;return l.graphicCallback(null==N?void 0:N.title,{graphic:V})});return function(){return A.apply(this,arguments)}}();I._getContent=function(){var A=f._asyncToGenerator(function*(){const {_effectivePopupTemplate:N,graphic:V}=this;return l.graphicCallback(null==N?void 0:N.content,{graphic:V})});
return function(){return A.apply(this,arguments)}}();I._queryFeature=function(){var A=f._asyncToGenerator(function*(N){const {_featureAbortController:V,_sourceLayer:X,graphic:T,_effectivePopupTemplate:v,spatialReference:L,map:y,view:C}=this,{content:{value:P},title:{value:S}}=yield K.eachAlways({content:this._getContent(),title:this._getTitle()});V===this._featureAbortController&&T&&(yield l.queryUpdatedFeature({graphic:T,popupTemplate:v,layer:X,spatialReference:L},N),{expressionAttributes:{value:N}}=
yield K.eachAlways({checkForRelatedFeatures:this._checkForRelatedFeatures(N),expressionAttributes:u.createCompiledExpressions({popupTemplate:this._effectivePopupTemplate,spatialReference:L,graphic:T,map:y,interceptor:E.interceptor,view:C})}),V===this._featureAbortController&&T&&(this._expressionAttributes=N,this._set("formattedAttributes",this._createFormattedAttributes(P,N)),this._set("title",this._compileTitle(S)),this._set("lastEditInfo",this._compileLastEditInfo()||null),this._set("content",this._compileContent(P)||
null)))});return function(N){return A.apply(this,arguments)}}();I._createFormattedAttributes=function(A,N){const {_effectivePopupTemplate:V,graphic:X,relatedInfos:T,_sourceLayer:v,_fieldInfoMap:L}=this,y={...X.attributes,...N},C={global:l.formatAttributes({fieldInfos:null==V?void 0:V.fieldInfos,graphic:X,attributes:y,layer:v,fieldInfoMap:L,relatedInfos:T}),content:[]};Array.isArray(A)&&A.forEach((P,S)=>{"fields"===P.type&&P.fieldInfos&&(C.content[S]=l.formatAttributes({fieldInfos:P.fieldInfos,graphic:X,
attributes:y,layer:v,fieldInfoMap:L,relatedInfos:T}))});return C};I._checkForRelatedFeatures=function(A){const {graphic:N,_effectivePopupTemplate:V}=this;return this._queryRelatedInfos(N,l.getAllFieldInfos(V),A)};I._queryRelatedInfos=function(){var A=f._asyncToGenerator(function*(N,V,X){const {relatedInfos:T,_sourceLayer:v}=this;T.clear();const L=G.isSome(v.associatedLayer)?yield v.associatedLayer.load(X):v;if(L){var y=V.filter(S=>S&&l.isRelatedField(S.fieldName));if(y&&y.length){V.forEach(S=>this._configureRelatedInfo(S,
L));var C=yield p.queryLayerInfos({relatedInfos:T,layer:L},X);Object.keys(C).forEach(S=>{var aa;const ca=T.get(S.toString());S=null==(aa=C[S])?void 0:aa.value;ca&&S&&(ca.layerInfo=S.data)});var P=yield p.queryRelatedFeatures({graphic:N,relatedInfos:T,layer:L},X);Object.keys(P).forEach(S=>{var aa;p.setRelatedFeatures(null==(aa=P[S])?void 0:aa.value,T.get(S.toString()))})}}});return function(N,V,X){return A.apply(this,arguments)}}();I._configureRelatedInfo=function(A,N){const {relatedInfos:V}=this,
X=p.getRelatedFieldInfo(A.fieldName);if(X){var {layerId:T,fieldName:v}=X;T&&(N=V.get(T.toString())||p.createRelatedInfo(T,N))&&(p.updateRelatedInfo({relatedInfo:N,fieldName:v,fieldInfo:A}),this.relatedInfos.set(T,N))}};f._createClass(q,[{key:"_effectivePopupTemplate",get:function(){return G.isSome(this.graphic)?this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled):null}},{key:"_fieldInfoMap",get:function(){return l.createfieldInfoMap(l.getAllFieldInfos(this._effectivePopupTemplate),
this._sourceLayer)}},{key:"_sourceLayer",get:function(){return l.getSourceLayer(this.graphic)}},{key:"state",get:function(){return this.graphic?this._error?"error":this.waitingForContent?"loading":"ready":"disabled"}},{key:"graphic",set:function(A){this._set("graphic",A?A.clone():null)}},{key:"spatialReference",get:function(){return this.get("view.spatialReference")||null},set:function(A){void 0===A?this._clearOverride("spatialReference"):this._override("spatialReference",A)}},{key:"map",get:function(){return this.get("view.map")||
null},set:function(A){void 0===A?this._clearOverride("map"):this._override("map",A)}},{key:"waitingForContent",get:function(){return!!this._featureAbortController}}]);return q}(z);z.interceptor=new w.FeatureSetQueryInterceptor(l.preLayerQueryCallback,l.preRequestCallback);g.__decorate([m.property()],z.prototype,"_error",void 0);g.__decorate([m.property()],z.prototype,"_featureAbortController",void 0);g.__decorate([m.property({readOnly:!0})],z.prototype,"_effectivePopupTemplate",null);g.__decorate([m.property({readOnly:!0})],
z.prototype,"_fieldInfoMap",null);g.__decorate([m.property({readOnly:!0})],z.prototype,"_sourceLayer",null);g.__decorate([m.property()],z.prototype,"abilities",void 0);g.__decorate([c.cast("abilities")],z.prototype,"castAbilities",null);g.__decorate([m.property({readOnly:!0})],z.prototype,"content",void 0);g.__decorate([m.property({readOnly:!0})],z.prototype,"contentViewModels",void 0);g.__decorate([m.property({type:Boolean})],z.prototype,"defaultPopupTemplateEnabled",void 0);g.__decorate([m.property({readOnly:!0})],
z.prototype,"state",null);g.__decorate([m.property({readOnly:!0})],z.prototype,"formattedAttributes",void 0);g.__decorate([m.property({type:a,value:null})],z.prototype,"graphic",null);g.__decorate([m.property({readOnly:!0})],z.prototype,"lastEditInfo",void 0);g.__decorate([m.property()],z.prototype,"relatedInfos",void 0);g.__decorate([m.property()],z.prototype,"spatialReference",null);g.__decorate([m.property({readOnly:!0})],z.prototype,"title",void 0);g.__decorate([m.property()],z.prototype,"map",
null);g.__decorate([m.property({readOnly:!0})],z.prototype,"waitingForContent",null);g.__decorate([m.property()],z.prototype,"view",void 0);return z=E=g.__decorate([e.subclass("esri.widgets.FeatureViewModel")],z)})},"esri/arcade/featureset/support/FeatureSetQueryInterceptor":function(){define(["exports"],function(f){f.FeatureSetQueryInterceptor=function(g,a){this.preLayerQueryCallback=g;this.preRequestCallback=a;this.preLayerQueryCallback||(this.preLayerQueryCallback=w=>{});this.preRequestCallback||
(this.preLayerQueryCallback=w=>{})};Object.defineProperty(f,"__esModule",{value:!0})})},"esri/widgets/Feature/support/arcadeFeatureUtils":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/Logger ../../../core/promiseUtils ../../../layers/FeatureLayer ./featureUtils".split(" "),function(f,g,a,w,z,F,J){function G(k){return`<ul class="esri-widget__list">${k.map(n=>`<li>${"string"===typeof n?J.applyTextFormattingHTML(J.htmlEntities(n)):n}</li>`).join("")}</ul>`}
function K(k){return`<table class="esri-widget__table">${k.keys().map(n=>{var u=k.field(n);u="string"===typeof u?J.applyTextFormattingHTML(J.htmlEntities(u)):u;return`<tr><th>${n}</th><td>${u}</td></tr>`}).join("")}</table>`}function D({aggregatedFeatures:k,arcadeUtils:n,featureSetVars:u,context:l,viewInfo:p,map:E,graphic:x,interceptor:M}){u.forEach(B=>{B=B.toLowerCase();var q={map:E,spatialReference:p.sr,interceptor:M};"$map"===B&&(l.vars[B]=n.convertMapToFeatureSetCollection(q));"$layer"===B&&(l.vars[B]=
n.convertFeatureLayerToFeatureSet({layer:x.sourceLayer,spatialReference:p.sr,interceptor:M}));"$datastore"===B&&(l.vars[B]=n.convertServiceUrlToWorkspace({url:x.sourceLayer.url,spatialReference:p.sr,interceptor:M}));if("$aggregatedfeatures"===B){q=x.layer;const {fields:I,objectIdField:A,geometryType:N,spatialReference:V,displayField:X}=q;q=new F({fields:I,objectIdField:A,geometryType:N,spatialReference:V,displayField:X,..."feature"===q.type?{templates:q.templates,typeIdField:q.typeIdField,types:q.types}:
null,source:k});l.vars[B]=n.convertFeatureLayerToFeatureSet({layer:q,spatialReference:p.sr,interceptor:M})}})}function t(){return new Promise(function(k,n){f(["../../../support/arcadeUtils"],k,n)})}function m(k){return b.apply(this,arguments)}function b(){b=a._asyncToGenerator(function*({graphic:k,view:n}){const {isAggregate:u,layer:l}=k;if(!u||!l||"2d"!==(null==n?void 0:n.type))return[];n=yield n.whenLayerView(l);if(!n.createQuery||!n.queryFeatures)return[];const p=n.createQuery();p.aggregateIds=
[k.getObjectId()];({features:k}=yield n.queryFeatures(p));return k});return b.apply(this,arguments)}function c(k){return e.apply(this,arguments)}function e(){e=a._asyncToGenerator(function*({expressionAttributes:k,info:n,arcadeUtils:u,interceptor:l,spatialReference:p,map:E,graphic:x,view:M}){const B=`expression/${n.name}`,q=u.createSyntaxTree(n.expression),I=r.filter(N=>u.hasVariable(q,N));yield u.loadScriptDependencies(q,!0,I);const A=u.getViewInfo({spatialReference:p});p=u.createExecContext(x,A);
p.interceptor=l;p.useAsync=!0;M=yield m({graphic:x,view:M});D({aggregatedFeatures:M,arcadeUtils:u,featureSetVars:I,context:p,viewInfo:A,map:E,graphic:x,interceptor:l});l=u.createFunction(q,p);l=yield u.executeAsyncFunction(l,p).catch(N=>d.error("arcade-execution-error",{error:N,graphic:x,expressionInfo:n}));k[B]="string"===typeof l?J.applyTextFormattingHTML(J.htmlEntities(l)):Array.isArray(l)?G(l):l&&"esri.arcade.Dictionary"===l.declaredClass?K(l):l});return e.apply(this,arguments)}function h(){h=
a._asyncToGenerator(function*({popupTemplate:k,spatialReference:n,graphic:u,interceptor:l,map:p,view:E}){k=k.expressionInfos;const x=[],M={};if(!k||!k.length)return M;const B=yield t();for(const q of k)x.push(c({expressionAttributes:M,info:q,arcadeUtils:B,interceptor:l,spatialReference:n,map:p,graphic:u,view:E}));yield z.eachAlways(x);return M});return h.apply(this,arguments)}const r=["$datastore","$map","$layer","$aggregatedfeatures"],d=w.getLogger("esri.widgets.Feature.support.arcadeFeatureUtils");
g.createCompiledExpressions=function(k){return h.apply(this,arguments)};Object.defineProperty(g,"__esModule",{value:!0})})},"esri/widgets/Feature/support/FeatureContentMixin":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../../support/widget ../../support/jsxFactory".split(" "),
function(f,g,a,w,z,F,J,G,K,D){f.FeatureContentMixin=t=>{t=function(m){function b(){var c=m.apply(this,arguments)||this;c.renderNodeContent=e=>K.isWidget(e)&&!e.destroyed?D.tsx("div",{key:e},e.render()):e instanceof HTMLElement?D.tsx("div",{key:e,bind:e,afterCreate:c._attachToNode}):K.hasDomNode(e)?D.tsx("div",{key:e,bind:e.domNode,afterCreate:c._attachToNode}):null;return c}g._inheritsLoose(b,m);b.prototype._attachToNode=function(c){c.appendChild(this)};return b}(t);return t=a.__decorate([G.subclass("esri.widgets.Feature.ContentMixin")],
t)};Object.defineProperty(f,"__esModule",{value:!0})})},"esri/widgets/Spinner":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/maybe ../core/promiseUtils ../core/watchUtils ../core/accessorSupport/decorators/aliasOf ../core/has ../core/accessorSupport/ensureType ../core/Logger ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/subclass ./Widget ./Spinner/SpinnerViewModel ./support/widgetUtils ./support/jsxFactory".split(" "),function(f,
g,a,w,z,F,J,G,K,D,t,m,b,c,e){J=function(h){function r(k,n){k=h.call(this,k,n)||this;k._animationDelay=500;k._animationPromise=null;k.location=null;k.view=null;k.viewModel=new b;k.visible=!1;return k}f._inheritsLoose(r,h);var d=r.prototype;d.initialize=function(){this.own([z.watch(this,"visible",k=>this._visibleChange(k))])};d.destroy=function(){this._animationPromise=null};d.show=function(k){const {location:n,promise:u}=k;n&&(this.viewModel.location=n);this.visible=!0;k=()=>this.hide();u&&u.catch(()=>
{}).then(k)};d.hide=function(){this.visible=!1};d.render=function(){var {visible:k}=this,{screenLocation:n}=this.viewModel;n=!!n;k={["esri-spinner--start"]:k&&n,["esri-spinner--finish"]:!k&&n};n=this._getPositionStyles();return e.tsx("div",{class:this.classes("esri-spinner",k),styles:n})};d._visibleChange=function(k){if(k)this.viewModel.screenLocationEnabled=!0;else{var n=w.after(this._animationDelay);this._animationPromise=n;n.catch(()=>{}).then(()=>{this._animationPromise===n&&(this.viewModel.screenLocationEnabled=
!1,this._animationPromise=null)})}};d._getPositionStyles=function(){const {screenLocation:k,view:n}=this.viewModel;if(!n||a.isNone(k))return{};const {padding:u}=n;return{left:`${k.x-u.left}px`,top:`${k.y-u.top}px`}};return r}(m);g.__decorate([F.aliasOf("viewModel.location")],J.prototype,"location",void 0);g.__decorate([F.aliasOf("viewModel.view")],J.prototype,"view",void 0);g.__decorate([D.property({type:b})],J.prototype,"viewModel",void 0);g.__decorate([F.aliasOf("viewModel.visible")],J.prototype,
"visible",void 0);return J=g.__decorate([t.subclass("esri.widgets.Spinner")],J)})},"esri/widgets/Spinner/SpinnerViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/accessorSupport/decorators/subclass ../support/AnchorElementViewModel".split(" "),function(f,g,a,w,z,F,J,G){w=function(K){function D(t){t=K.call(this,t)||this;t.visible=
!1;return t}f._inheritsLoose(D,K);return D}(G);g.__decorate([a.property()],w.prototype,"visible",void 0);return w=g.__decorate([J.subclass("esri.widgets.CompassViewModel")],w)})},"esri/widgets/support/AnchorElementViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Evented ../../core/Handles ../../core/maybe ../../core/watchUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/accessorSupport/decorators/subclass".split(" "),
function(f,g,a,w,z,F,J,G,K,D,t){a=function(m){function b(e){var h=m.call(this,e)||this;h._anchorHandles=new w;h.location=null;h.screenLocation=null;h.screenLocationEnabled=!1;h.view=null;h._anchorHandles.add([F.watch(f._assertThisInitialized(h),["screenLocationEnabled","location","view.size","view.stationary"],()=>h._updateScreenPointAndHandle()),F.watch(f._assertThisInitialized(h),["view","view.ready"],()=>h._wireUpView())]);return h}f._inheritsLoose(b,m);var c=b.prototype;c.destroy=function(){this.view=
null;this._anchorHandles&&this._anchorHandles.destroy();this._viewpointHandle=this._anchorHandles=null};c._wireUpView=function(){this._anchorHandles.remove("view");this._viewpointHandle=null;if(this.get("view.ready")){this._setScreenLocation();var {view:e}=this;e=F.pausable(e,"3d"===e.type?"camera":"viewpoint",()=>this._viewpointChange());this._anchorHandles.add(e,"view");this._viewpointHandle=e;this._toggleWatchingViewpoint()}};c._viewpointChange=function(){this._setScreenLocation();this.emit("view-change")};
c._updateScreenPointAndHandle=function(){this._setScreenLocation();this._toggleWatchingViewpoint()};c._toggleWatchingViewpoint=function(){const {_viewpointHandle:e,location:h,screenLocationEnabled:r}=this;e&&(h&&r?e.resume():e.pause())};c._setScreenLocation=function(){const {location:e,view:h,screenLocationEnabled:r}=this;var d=this.get("view.ready");d=r&&d&&z.isSome(e)?h.toScreen(e):null;this._set("screenLocation",d)};return b}(a.EventedAccessor);g.__decorate([J.property()],a.prototype,"location",
void 0);g.__decorate([J.property({readOnly:!0})],a.prototype,"screenLocation",void 0);g.__decorate([J.property()],a.prototype,"screenLocationEnabled",void 0);g.__decorate([J.property()],a.prototype,"view",void 0);return a=g.__decorate([t.subclass("esri.widgets.support.AnchorElementViewModel")],a)})},"esri/widgets/Popup/PopupViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../Graphic ../../symbols ../../core/Collection ../../core/Error ../../core/Handles ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/watchUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../geometry/support/webMercatorUtils ../../layers/Layer ../../support/actions/ActionBase ../../support/actions/ActionButton ../../support/actions/ActionToggle ../../symbols/support/symbolUtils ../../views/input/InputManager ../../views/support/layerViewUtils ../Feature/FeatureViewModel ./actions ./actionUtils ../support/AnchorElementViewModel ../support/GoTo ../../geometry/Point ../../symbols/SimpleFillSymbol".split(" "),
function(f,g,a,w,z,F,J,G,K,D,t,m,b,c,e,h,r,d,k,n,u,l,p,E,x,M,B,q,I,A,N){const V=F.ofType({key:"type",defaultKeyValue:"button",base:k,typeMap:{button:n,toggle:u}}),X=K.getLogger("esri.widgets.Popup.PopupViewModel");a=function(T){function v(y){y=T.call(this,y)||this;y._handles=new G;y._pendingPromises=new Set;y._fetchFeaturesController=null;y._selectedClusterFeature=null;y.featurePage=null;y.actions=new V;y.defaultPopupTemplateEnabled=!1;y.autoCloseEnabled=!1;y.autoOpenEnabled=!0;y.browseClusterEnabled=
!1;y.content=null;y.featuresPerPage=20;y.featureViewModelAbilities=null;y.featureViewModels=[];y.highlightEnabled=!0;y.includeDefaultActions=!0;y.selectedClusterBoundaryFeature=new w({symbol:new N({outline:{width:1.5,color:"cyan"},style:"none"})});y.title=null;y.updateLocationEnabled=!1;y.view=null;y.visible=!1;y.zoomFactor=4;y.zoomToLocation=null;return y}f._inheritsLoose(v,T);var L=v.prototype;L.initialize=function(){this._handles.add([m.init(this,["autoOpenEnabled","view"],()=>this._autoOpenEnabledChange()),
this.on("view-change",()=>this._autoClose()),m.watch(this,["highlightEnabled","selectedFeature","visible","view"],()=>this._highlightFeature()),m.watch(this,"view.animation.state",y=>this._animationStateChange(y)),m.watch(this,"location",y=>this._locationChange(y)),m.watch(this,"selectedFeature",y=>this._selectedFeatureChange(y)),m.watch(this,["selectedFeatureIndex","featureCount","featuresPerPage"],()=>this._selectedFeatureIndexChange()),m.watch(this,["featurePage","selectedFeatureIndex","featureCount",
"featuresPerPage, featureViewModels"],()=>this._setGraphicOnFeatureViewModels()),m.watch(this,"featureViewModels",()=>this._featureViewModelsChange()),this.on("trigger-action",y=>B.triggerAction({event:y,view:this.view})),m.whenFalse(this,"waitingForResult",()=>this._waitingForResultChange(),!0),m.watch(this,["features","view","view.map","view.spatialReference"],()=>this._updateFeatureVMs()),m.watch(this,["view.scale"],this._viewScaleChange),m.whenFalse(this,"visible",()=>this.browseClusterEnabled=
!1),m.watch(this,"browseClusterEnabled",y=>y?this.enableClusterBrowsing():this.disableClusterBrowsing())])};L.destroy=function(){this._cancelFetchingFeatures();this._handles.destroy();this._handles=null;this._pendingPromises.clear();this.browseClusterEnabled=!1;this.view=null};L.centerAtLocation=function(){var {view:y}=this;const C=B.getSelectedTarget(this);return C?this.callGoTo({target:{target:C,scale:y.scale}}):(y=new J("center-at-location:invalid-target-or-view","Cannot center at a location without a target and view.",
{target:C,view:y}),X.error(y),Promise.reject(y))};L.clear=function(){this.set({promises:[],features:[],content:null,title:null,location:null})};L.fetchFeatures=function(y,C){const {view:P}=this;return P&&y?P.fetchPopupFeatures(y,{event:C&&C.event,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,signal:C&&C.signal}):(y=new J("fetch-features:invalid-screenpoint-or-view","Cannot fetch features without a screenPoint and view.",{screenPoint:y,view:P}),X.error(y),Promise.reject(y))};L.open=
function(y){y={updateLocationEnabled:!1,promises:[],fetchFeatures:!1,...y,visible:!0};const {fetchFeatures:C}=y;delete y.fetchFeatures;C&&this._setFetchFeaturesPromises(y.location);this.set(y)};L.triggerAction=function(y){(y=this.allActions.getItemAt(y))&&!y.disabled&&this.emit("trigger-action",{action:y})};L.next=function(){this.selectedFeatureIndex+=1;return this};L.previous=function(){--this.selectedFeatureIndex;return this};L.disableClusterBrowsing=function(){B.removeClusteredFeaturesForBrowsing(this);
this._clearBrowsedClusterGraphics()};L.enableClusterBrowsing=function(){var y=f._asyncToGenerator(function*(){yield B.displayClusterExtent(this);yield B.browseAggregateFeatures(this)});return function(){return y.apply(this,arguments)}}();L._animationStateChange=function(y){this.zoomToLocation||(M.zoomToFeature.disabled="waiting-for-target"===y)};L._clearBrowsedClusterGraphics=function(){var y;const C=null==(y=this.view)?void 0:y.graphics;C&&(C.remove(this.selectedClusterBoundaryFeature),C.remove(this._selectedClusterFeature));
this._selectedClusterFeature=null;this.selectedClusterBoundaryFeature.geometry=null};L._viewScaleChange=function(){var y;if(null!=(y=this.selectedFeature)&&y.isAggregate||this.browseClusterEnabled)this.visible=this.browseClusterEnabled=!1};L._locationChange=function(y){const {selectedFeature:C,updateLocationEnabled:P}=this;P&&y&&(!C||C.geometry)&&this.centerAtLocation()};L._selectedFeatureIndexChange=function(){this.featurePage=1<this.featureCount?Math.floor(this.selectedFeatureIndex/this.featuresPerPage)+
1:null};L._featureViewModelsChange=function(){this.featurePage=1<this.featureCount?1:null};L._setGraphicOnFeatureViewModels=function(){const {features:y,featureCount:C,featurePage:P,featuresPerPage:S,featureViewModels:aa}=this;if(null!==P){var ca=((P-1)*S+C)%C;aa.slice(ca,ca+S).forEach((ia,la)=>{ia&&!ia.graphic&&(ia.graphic=y[ca+la])})}};L._selectedFeatureChange=function(){var y=f._asyncToGenerator(function*(C){if(C){var {location:P,updateLocationEnabled:S,view:aa}=this;this.browseClusterEnabled?
(this._selectedClusterFeature&&(aa.graphics.remove(this._selectedClusterFeature),this._selectedClusterFeature=null),C.isAggregate||(C.symbol=yield l.getDisplayedSymbol(C),this._selectedClusterFeature=C,aa.graphics.add(this._selectedClusterFeature))):!S&&P||!C.geometry?S&&!C.geometry&&this.centerAtLocation().then(()=>{this.location=aa.center.clone()}):this.location=D.unwrap(this._getPointFromGeometry(C.geometry))}});return function(C){return y.apply(this,arguments)}}();L._waitingForResultChange=function(){!this.featureCount&&
this.promises&&(this.visible=!1)};L._setFetchFeaturesPromises=function(y){return this._fetchFeaturesWithController(this._getScreenPoint(y||this.location)).then(C=>{const {clientOnlyGraphics:P,promisesPerLayerView:S}=C;C=Promise.resolve(P);const aa=S.map(ca=>ca.promise);this.promises=[C,...aa]})};L._destroyFeatureVMs=function(){this.featureViewModels.forEach(y=>y&&!y.destroyed&&y.destroy());this._set("featureViewModels",[])};L._updateFeatureVMs=function(){const {selectedFeature:y,features:C,featureViewModels:P}=
this;null!=y&&y.isAggregate||(this.browseClusterEnabled=!1);this._destroyFeatureVMs();if(C&&C.length){var S=P.slice(0),aa=[];C.forEach((ca,ia)=>{if(ca){var la=null;S.some((pa,U)=>{pa&&pa.graphic===ca&&(la=pa,S.splice(U,1));return!!la});if(la)aa[ia]=la;else{var oa,ja;const pa=new x({abilities:this.featureViewModelAbilities,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,spatialReference:null==(oa=this.view)?void 0:oa.spatialReference,graphic:ca===y?ca:null,map:null==(ja=this.view)?void 0:
ja.map,view:this.view});aa[ia]=pa}}});S.forEach(ca=>ca&&!ca.destroyed&&ca.destroy());this._set("featureViewModels",aa)}};L._getScreenPoint=function(y){const {view:C}=this;return C&&y&&"function"===typeof C.toScreen?C.toScreen(y):null};L._autoOpenEnabledChange=function(){const {_handles:y,autoOpenEnabled:C}=this;y.remove("auto-fetch-features");if(C&&this.view){const P=this.view.on("click",S=>{"mouse"===S.pointerType&&0!==S.button||this._fetchFeaturesAndOpen(S)},p.ViewEventPriorities.WIDGET);y.add(P,
"auto-fetch-features")}};L._cancelFetchingFeatures=function(){const y=this._fetchFeaturesController;y&&y.abort();this._fetchFeaturesController=null;this.notifyChange("waitingForResult")};L._fetchFeaturesWithController=function(y,C){this._cancelFetchingFeatures();const P=t.createAbortController(),{signal:S}=P;this._fetchFeaturesController=P;this.notifyChange("waitingForResult");y=this.fetchFeatures(y,{signal:S,event:C});y.catch(()=>{}).then(()=>{this._fetchFeaturesController=null;this.notifyChange("waitingForResult")});
return y};L._fetchFeaturesAndOpen=function(y){const {screenPoint:C,mapPoint:P}=y,{view:S}=this;this._fetchFeaturesWithController(C,y).then(aa=>{const {clientOnlyGraphics:ca,promisesPerLayerView:ia,location:la}=aa,oa=[Promise.resolve(ca),...ia.map(ja=>ja.promise)];S.popup.open({location:la||P,promises:oa});return aa})};L._updatePendingPromises=function(y){y&&this._pendingPromises.has(y)&&(this._pendingPromises.delete(y),this.notifyChange("pendingPromisesCount"))};L._autoClose=function(){this.autoCloseEnabled&&
(this.visible=!1)};L._getPointFromGeometry=function(y){return D.isNone(y)?null:"point"===y.type?y:"extent"===y.type?y.center:"polygon"===y.type?y.centroid:"multipoint"===y.type||"polyline"===y.type?y.extent.center:null};L._getLayerView=function(){var y=f._asyncToGenerator(function*(C,P){yield C.when();return C.whenLayerView(P)});return function(C,P){return y.apply(this,arguments)}}();L._highlightFeature=function(){var y=f._asyncToGenerator(function*(){this._handles.remove("highlight");const {selectedFeature:C,
highlightEnabled:P,view:S,visible:aa}=this;if(C&&S&&P&&aa){var {layer:ca,sourceLayer:ia}=C;if("map-notes"===(null==ia?void 0:ia.type)||"subtype-group"===(null==ia?void 0:ia.type))ca=ia;if(ca&&ca instanceof d){var la=this._getLayerView(S,ca);this._highlightPromise=la;var oa=yield la;if(oa&&E.highlightsSupported(oa)&&this._highlightPromise===la&&this.selectedFeature&&this.highlightEnabled&&this.visible){la="objectIdField"in ca&&ca.objectIdField;var ja=C.attributes;oa=oa.highlight(ja&&la&&ja[la]||C);
this._handles.add(oa,"highlight")}}}});return function(){return y.apply(this,arguments)}}();L._updateFeatures=function(y){const {features:C}=this;y&&y.length&&(C.length?(y=y.filter(P=>-1===C.indexOf(P)),this.features=C.concat(y)):this.features=y)};f._createClass(v,[{key:"isLoadingFeature",get:function(){return this.featureViewModels.some(y=>y.waitingForContent)}},{key:"active",get:function(){return!(!this.visible||this.waitingForResult)}},{key:"allActions",get:function(){const y=this._get("allActions")||
new V;y.removeAll();const {actions:C,defaultActions:P,defaultPopupTemplateEnabled:S,includeDefaultActions:aa,selectedFeature:ca}=this;var ia=aa?P.concat(C):C;const la=ca&&("function"===typeof ca.getEffectivePopupTemplate&&ca.getEffectivePopupTemplate(S)||ca.popupTemplate),oa=la&&la.actions;(ia=la&&la.overwriteActions?oa:oa?oa.concat(ia):ia)&&ia.filter(Boolean).forEach(ja=>y.add(ja));return y}},{key:"defaultActions",get:function(){var y;const C=this._get("defaultActions")||new V;C.removeAll();C.addMany(null!=
(y=this.selectedFeature)&&y.isAggregate?[M.zoomToClusteredFeatures.clone(),M.browseClusteredFeatures.clone()]:[M.zoomToFeature.clone()]);return C}},{key:"featureCount",get:function(){return this.features.length}},{key:"features",get:function(){return this._get("features")||[]},set:function(y){y=y||[];this._set("features",y);const {pendingPromisesCount:C,promiseCount:P,selectedFeatureIndex:S}=this,aa=P&&y.length;aa&&C&&-1===S?this.selectedFeatureIndex=0:aa&&-1!==S||(this.selectedFeatureIndex=y.length?
0:-1)}},{key:"location",get:function(){return this._get("location")||null},set:function(y){const C=this.get("view.spatialReference.isWebMercator");y&&y.get("spatialReference.isWGS84")&&C&&(y=r.geographicToWebMercator(y));this._set("location",y)}},{key:"pendingPromisesCount",get:function(){return this._pendingPromises.size}},{key:"waitingForResult",get:function(){return!(!(this._fetchFeaturesController||0<this.pendingPromisesCount)||0!==this.featureCount)}},{key:"promiseCount",get:function(){return this.promises.length}},
{key:"promises",get:function(){return this._get("promises")||[]},set:function(y){this._pendingPromises.clear();this.features=[];Array.isArray(y)&&y.length?(this._set("promises",y),y=y.slice(0),y.forEach(C=>{this._pendingPromises.add(C);C.then(P=>{this._pendingPromises.has(C)&&this._updateFeatures(P);this._updatePendingPromises(C)},()=>this._updatePendingPromises(C))})):this._set("promises",[]);this.notifyChange("pendingPromisesCount")}},{key:"selectedFeature",get:function(){const {features:y,selectedFeatureIndex:C}=
this;return-1===C?null:y[C]||null}},{key:"selectedFeatureIndex",get:function(){const y=this._get("selectedFeatureIndex");return"number"===typeof y?y:-1},set:function(y){const {featureCount:C}=this;y=isNaN(y)||-1>y||!C?-1:(y+C)%C;this._set("selectedFeatureIndex",y)}},{key:"selectedFeatureViewModel",get:function(){return this.featureViewModels[this.selectedFeatureIndex]||null}},{key:"state",get:function(){return this.get("view.ready")?"ready":"disabled"}}]);return v}(I.GoToMixin(q));g.__decorate([b.property()],
a.prototype,"featurePage",void 0);g.__decorate([b.property()],a.prototype,"isLoadingFeature",null);g.__decorate([b.property({type:V})],a.prototype,"actions",void 0);g.__decorate([b.property({readOnly:!0})],a.prototype,"active",null);g.__decorate([b.property({readOnly:!0})],a.prototype,"allActions",null);g.__decorate([b.property({type:Boolean})],a.prototype,"defaultPopupTemplateEnabled",void 0);g.__decorate([b.property()],a.prototype,"autoCloseEnabled",void 0);g.__decorate([b.property()],a.prototype,
"autoOpenEnabled",void 0);g.__decorate([b.property()],a.prototype,"browseClusterEnabled",void 0);g.__decorate([b.property()],a.prototype,"content",void 0);g.__decorate([b.property({type:V,readOnly:!0})],a.prototype,"defaultActions",null);g.__decorate([b.property({readOnly:!0})],a.prototype,"featureCount",null);g.__decorate([b.property()],a.prototype,"features",null);g.__decorate([b.property()],a.prototype,"featuresPerPage",void 0);g.__decorate([b.property()],a.prototype,"featureViewModelAbilities",
void 0);g.__decorate([b.property({readOnly:!0})],a.prototype,"featureViewModels",void 0);g.__decorate([b.property()],a.prototype,"highlightEnabled",void 0);g.__decorate([b.property()],a.prototype,"includeDefaultActions",void 0);g.__decorate([b.property({type:A})],a.prototype,"location",null);g.__decorate([b.property({readOnly:!0})],a.prototype,"pendingPromisesCount",null);g.__decorate([b.property({readOnly:!0})],a.prototype,"selectedClusterBoundaryFeature",void 0);g.__decorate([b.property({readOnly:!0})],
a.prototype,"waitingForResult",null);g.__decorate([b.property({readOnly:!0})],a.prototype,"promiseCount",null);g.__decorate([b.property()],a.prototype,"promises",null);g.__decorate([b.property({value:null,readOnly:!0})],a.prototype,"selectedFeature",null);g.__decorate([b.property({value:-1})],a.prototype,"selectedFeatureIndex",null);g.__decorate([b.property({readOnly:!0})],a.prototype,"selectedFeatureViewModel",null);g.__decorate([b.property({readOnly:!0})],a.prototype,"state",null);g.__decorate([b.property()],
a.prototype,"title",void 0);g.__decorate([b.property()],a.prototype,"updateLocationEnabled",void 0);g.__decorate([b.property()],a.prototype,"view",void 0);g.__decorate([b.property()],a.prototype,"visible",void 0);g.__decorate([b.property()],a.prototype,"zoomFactor",void 0);g.__decorate([b.property()],a.prototype,"zoomToLocation",void 0);g.__decorate([b.property()],a.prototype,"centerAtLocation",null);return a=g.__decorate([h.subclass("esri.widgets.Popup.PopupViewModel")],a)})},"esri/symbols/support/symbolUtils":function(){define("require exports ../../chunks/_rollupPluginBabelHelpers ../../core/has ../../core/maybe ../../support/arcadeOnDemand ./utils".split(" "),
function(f,g,a,w,z,F,J){function G(c,e){return K.apply(this,arguments)}function K(){K=a._asyncToGenerator(function*(c,e){switch(c.type){case "web-style":var {previewWebStyleSymbol:h}=yield new Promise(function(r,d){f(["./previewWebStyleSymbol"],r,d)});return h(c,G,e);case "label-3d":case "line-3d":case "mesh-3d":case "point-3d":case "polygon-3d":return{previewSymbol3D:h}=yield new Promise(function(r,d){f(["./previewSymbol3D"],r,d)}),h(c,e);case "simple-marker":case "simple-line":case "simple-fill":case "picture-marker":case "picture-fill":case "text":return{previewSymbol2D:h}=
yield new Promise(function(r,d){f(["./previewSymbol2D"],r,d)}),h(c,e);case "cim":return{previewCIMSymbol:h}=yield new Promise(function(r,d){f(["./previewCIMSymbol"],r,d)}),h(c,e)}});return K.apply(this,arguments)}function D(c){return c&&"opacity"in c?c.opacity*D(c.parent):1}function t(){t=a._asyncToGenerator(function*(c,e){var h,r;if(c){var d=c.sourceLayer;d=null!=(h=z.isSome(e)&&null!=(r=e.useSourceLayer)&&r?d:c.layer)?h:d;h=D(d);if(z.isSome(c.symbol)&&(!z.isSome(e)||!0!==e.ignoreGraphicSymbol))return c=
"web-style"===c.symbol.type?yield c.symbol.fetchSymbol(z.isSome(e)?e.abortOptions:null):c.symbol.clone(),J.applyColorToSymbol(c,null,h),c;var k=z.isSome(e)&&e.renderer||d&&"renderer"in d&&d.renderer;if(r=k&&"getSymbolAsync"in k?yield k.getSymbolAsync(c,e):null){r="web-style"===r.type?yield r.fetchSymbol(z.isSome(e)?e.abortOptions:null):r.clone();if(!("visualVariables"in k&&k.visualVariables&&k.visualVariables.length))return J.applyColorToSymbol(r,null,h),r;"arcadeRequiredForVisualVariables"in k&&
k.arcadeRequiredForVisualVariables&&(z.isNone(e)||z.isNone(e.arcade))&&(e={...z.unwrap(e)},e.arcade=yield F.loadArcade());d=yield new Promise(function(x,M){f(["../../renderers/visualVariables/support/visualVariableUtils"],x,M)});var n=[],u=[],l=[],p=[];for(var E of k.visualVariables)switch(E.type){case "color":n.push(E);break;case "opacity":u.push(E);break;case "rotation":p.push(E);break;case "size":E.target||l.push(E)}E=(E=!!n.length&&n[n.length-1])?d.getColor(E,c,e):null;u=(u=!!u.length&&u[u.length-
1])?d.getOpacity(u,c,e):null;null!=h&&(u=null!=u?u*h:h);J.applyColorToSymbol(r,E,u);l.length&&(h=d.getAllSizes(l,c,e),yield J.applySizesToSymbol(r,h));for(const x of p)J.applyRotationToSymbol(r,d.getRotationAngle(x,c,e),x.axis);return r}}});return t.apply(this,arguments)}function m(){m=a._asyncToGenerator(function*(c,e){var h;if(c){var r=D(c.layer||c.sourceLayer);if(z.isSome(c.symbol)&&(!z.isSome(e)||!0!==e.ignoreGraphicSymbol))return c="web-style"===c.symbol.type?yield c.symbol.fetchSymbol(z.isSome(e)?
e.abortOptions:null):c.symbol.clone(),J.getColorFromSymbol(c,r);var d=z.isSome(e)&&e.renderer||c.get("layer.renderer")||c.get("sourceLayer.renderer"),k=yield d.getSymbolAsync(c,e);if(k){k="web-style"===k.type?yield k.fetchSymbol(z.isSome(e)?e.abortOptions:null):k.clone();k=J.getColorFromSymbol(k,r);if(!("visualVariables"in d)||"visualVariables"in d&&!d.visualVariables||"visualVariables"in d&&(null==(h=d.visualVariables)||!h.length))return k;d.arcadeRequiredForVisualVariables&&(z.isNone(e)||z.isNone(e.arcade))&&
(e={...z.unwrap(e)},e.arcade=yield F.loadArcade());h=yield new Promise(function(l,p){f(["../../renderers/visualVariables/support/visualVariableUtils"],l,p)});var n=[],u=[];for(const l of d.visualVariables)switch(l.type){case "color":n.push(l);break;case "opacity":u.push(l)}d=(d=0<n.length?n[n.length-1]:null)?h.getColor(d,c,e):k;c=(k=0<u.length?u[u.length-1]:null)?h.getOpacity(k,c,e):null;null!=r&&(c=null!=c?c*r:r);return d?J.applyOpacityToColor(d,c):null}}});return m.apply(this,arguments)}let b=null;
g.getDisplayedColor=function(c,e){return m.apply(this,arguments)};g.getDisplayedSymbol=function(c,e){return t.apply(this,arguments)};g.renderColorRampPreviewHTML=function(c,e={}){var h="horizontal"===e.align;const {width:r=h?75:24,height:d=h?24:75,gradient:k=!0}=e;e=window.devicePixelRatio;var n=r*e,u=d*e;e=document.createElement("canvas");e.width=n;e.height=u;e.style.width=`${r}px`;e.style.height=`${d}px`;const l=e.getContext("2d");var p=h?n:0,E=h?0:u;if(k){const x=l.createLinearGradient(0,0,p,E);
h=c.length;const M=1===h?0:1/(h-1);c.forEach((B,q)=>x.addColorStop(q*M,B.toString()));l.fillStyle=x;l.fillRect(0,0,n,u)}else{n=h?n/c.length:n;u=h?u:u/c.length;E=p=0;for(const x of c)l.fillStyle=x.toString(),l.fillRect(p,E,n,u),p=h?p+n:0,E=h?0:E+u}c=document.createElement("div");c.style.width=`${r}px`;c.style.height=`${d}px`;c.appendChild(e);return c};g.renderDotDensityPreviewHTML=function(c,e,h){const {backgroundColor:r,outline:d,dotSize:k}=c;h=h&&h.swatchSize||22;const n=Math.round(h*h/k**2*.8),
u=window.devicePixelRatio;c=document.createElement("canvas");const l=h*u;c.width=l;c.height=l;c.style.width=`${c.width/u}px`;c.style.height=`${c.height/u}px`;const p=c.getContext("2d");r&&(p.fillStyle=r.toCss(!0),p.fillRect(0,0,l,l),p.fill());p.fillStyle=e.toCss(!0);if(b&&b.length/2===n)for(e=0;e<2*n;e+=2)p.fillRect(b[e],b[e+1],k*u,k*u),p.fill();else for(b=[],e=0;e<2*n;e+=2){const E=Math.floor(Math.random()*(l-0+1)),x=Math.floor(Math.random()*(l-0+1));b.push(E,x);p.fillRect(E,x,k*u,k*u);p.fill()}d&&
(d.color&&(p.strokeStyle=d.color.toCss(!0)),p.lineWidth=d.width,p.strokeRect(0,0,l,l));h=new Image(h,h);h.src=c.toDataURL();return h};g.renderPreviewHTML=G;Object.defineProperty(g,"__esModule",{value:!0})})},"esri/symbols/support/utils":function(){define("require exports ../../chunks/_rollupPluginBabelHelpers ../../Color ../../symbols ../../core/asyncUtils ../../core/has ../../core/maybe ../../core/screenUtils ../../chunks/vec3f64 ./gfxUtils ./Symbol3DMaterial".split(" "),function(f,g,a,w,z,F,J,G,
K,D,t,m){function b(A){A=A.symbolLayers;if(!A)return null;let N=null;A.forEach(V=>{if("object"!==V.type||null==V.resource.href)N="water"===V.type?G.unwrap(V.color):G.isSome(V.material)?G.unwrap(V.material.color):null});return N?new w(N):null}function c(A,N){if(null==N)return A;A=A.toRgba();A[3]*=N;return new w(A)}function e(A,N,V){if(A=A.symbolLayers){var X=T=>{T=G.isSome(T)?T:null;N=N||T||null!=V&&I;return c(N,V)};A.forEach(T=>{if("object"!==T.type||null==T.resource.href||N)if("water"===T.type)T.color=
X(T.color);else{var v=G.isSome(T.material)?T.material.color:null;v=X(v);G.isNone(T.material)?T.material=new m["default"]({color:v}):T.material.color=v;null!=V&&"outline"in T&&G.isSome(T.outline)&&G.isSome(T.outline.color)&&(T.outline.color=c(T.outline.color,V))}})}}function h(A,N){return r.apply(this,arguments)}function r(){r=a._asyncToGenerator(function*(A,N){(A=A.symbolLayers)&&(yield F.forEach(A,function(){var V=a._asyncToGenerator(function*(X){return d(X,N)});return function(X){return V.apply(this,
arguments)}}()))});return r.apply(this,arguments)}function d(A,N){return k.apply(this,arguments)}function k(){k=a._asyncToGenerator(function*(A,N){switch(A.type){case "extrude":A.size="number"===typeof N[2]?N[2]:0;break;case "icon":case "line":case "text":N=n(N);G.isSome(N)&&(A.size=N);break;case "path":{const V=p(N,D.ONES,[A.width,void 0,A.height]);A.width=M(N[0],A.width,1,V);A.height=M(N[2],A.height,1,V)}break;case "object":yield u(A,N)}});return k.apply(this,arguments)}function n(A){for(const N of A)if("number"===
typeof N)return N;return null}function u(A,N){return l.apply(this,arguments)}function l(){l=a._asyncToGenerator(function*(A,N){const {resourceSize:V,symbolSize:X}=yield E(A),T=p(N,V,X);A.width=M(N[0],X[0],V[0],T);A.depth=M(N[1],X[1],V[1],T);A.height=M(N[2],X[2],V[2],T)});return l.apply(this,arguments)}function p(A,N,V){for(let X=0;3>X;X++){const T=A[X];switch(T){case "symbol-value":return null!=V[X]?V[X]/N[X]:1;case "proportional":break;default:if(T&&N[X])return T/N[X]}}return 1}function E(A){return x.apply(this,
arguments)}function x(){x=a._asyncToGenerator(function*(A){const N=yield(yield new Promise(function(y,C){f(["./symbolLayerUtils"],y,C)})).computeObjectLayerResourceSize(A,10),{width:V,height:X,depth:T}=A;A=[V,T,X];let v=1;for(var L=0;3>L;L++)if(null!=A[L]){v=A[L]/N[L];break}for(L=0;3>L;L++)null==A[L]&&(A[L]=N[L]*v);return{resourceSize:N,symbolSize:A}});return x.apply(this,arguments)}function M(A,N,V,X){switch(A){case "proportional":return V*X;case "symbol-value":return null!=N?N:V;default:return A}}
function B(){B=a._asyncToGenerator(function*(A,N){if(A&&N){if(z.isSymbol3D(A))return h(A,N);if(z.isSymbol2D(A)&&(N=n(N),!G.isNone(N)))switch(A.type){case "simple-marker":A.size=N;break;case "picture-marker":{const V=A.width/A.height;1<V?(A.width=N,A.height=N*V):(A.width=N*V,A.height=N);break}case "simple-line":A.width=N;break;case "text":A.font.size=N}}});return B.apply(this,arguments)}const q=/\/resource\/(.*?)\.svg$/,I=new w("white");g.applyColorToSymbol=function(A,N,V){if(A&&(N||null!=V))if(N&&
(N=new w(N)),z.isSymbol3D(A))e(A,N,V);else if(z.isSymbol2D(A)){if(N=N||A.color)A.color=c(N,V);null!=V&&"outline"in A&&A.outline&&A.outline.color&&(A.outline.color=c(A.outline.color,V))}};g.applyOpacityToColor=c;g.applyRotationToSymbol=function(A,N,V){A&&null!=N&&(z.isSymbol3D(A)?(A=A.symbolLayers)&&A.forEach(X=>{if(X&&"object"===X.type)switch(V){case "tilt":X.tilt=N;break;case "roll":X.roll=N;break;default:X.heading=N}}):!z.isSymbol2D(A)||"simple-marker"!==A.type&&"picture-marker"!==A.type&&"text"!==
A.type||(A.angle=N))};g.applySizesToSymbol=function(A,N){return B.apply(this,arguments)};g.getColorFromSymbol=function(A,N){if(!A)return null;let V=null;z.isSymbol3D(A)?V=b(A):z.isSymbol2D(A)&&(V=A.color?new w(A.color):null);return V?c(V,N):null};g.getIconHref=function(A,N){N=N.resource.href;return!J("esri-canvas-svg-support")&&A.styleOrigin&&q.test(N)?N.replace(q,"/resource/png/$1.png"):N};g.getSymbolOutlineSize=function(A){if(!A)return 0;if(z.isSymbol3D(A)){{const N=A.symbolLayers&&A.symbolLayers.length;
N?(A=A.symbolLayers.getItemAt(N-1),A="outline"in A?G.get(A,"outline","size"):void 0):A=void 0}return G.isSome(A)?A:0}return(A=t.getStroke(A))&&K.px2pt(A.width)||0};g.isVolumetricSymbol=function(A){if(G.isNone(A)||!("symbolLayers"in A)||G.isNone(A.symbolLayers))return!1;switch(A.type){case "point-3d":return A.symbolLayers.some(N=>"object"===N.type);case "line-3d":return A.symbolLayers.some(N=>"path"===N.type);case "polygon-3d":return A.symbolLayers.some(N=>"object"===N.type||"extrude"===N.type);default:return!1}};
Object.defineProperty(g,"__esModule",{value:!0})})},"esri/symbols/support/gfxUtils":function(){define("exports ../../assets ../../Color ../../request ../../core/ItemCache ../../core/screenUtils ./cimSymbolUtils".split(" "),function(f,g,a,w,z,F,J){function G(b){if(!b)return null;let c;switch(b.type){case "simple-fill":case "picture-fill":case "simple-marker":c=G(b.outline);break;case "simple-line":{const e=F.pt2px(b.width);"none"!==b.style&&0!==e&&(c={color:b.color,style:m(b.style),width:e,cap:b.cap,
join:"miter"===b.join?F.pt2px(b.miterLimit):b.join});break}default:c=null}return c}const K={left:"start",center:"middle",right:"end",justify:"start"},D={top:"text-before-edge",middle:"central",baseline:"alphabetic",bottom:"text-after-edge"},t=new z(1E3),m=function(){const b={};return function(c){if(b[c])return b[c];const e=c.replace(/-/g,"");return b[c]=e}}();a=new a([128,128,128]);f.defaultThematicColor=a;f.dekebabifyLineStyle=m;f.getFill=function(b){const c=b.style;let e=null;if(b)switch(b.type){case "simple-marker":"cross"!==
c&&"x"!==c&&(e=b.color);break;case "simple-fill":"solid"===c?e=b.color:"none"!==c&&(e={type:"pattern",x:0,y:0,src:g.getAssetUrl(`esri/symbols/patterns/${c}.png`),width:5,height:5});break;case "picture-fill":e={type:"pattern",src:b.url,width:F.pt2px(b.width)*b.xscale,height:F.pt2px(b.height)*b.yscale,x:F.pt2px(b.xoffset),y:F.pt2px(b.yoffset)};break;case "text":e=b.color;break;case "cim":e=J.getCIMSymbolColor(b)}return e};f.getPatternUrlWithColor=function(b,c){const e=b+"-"+c;return void 0!==t.get(e)?
Promise.resolve(t.get(e)):w(b,{responseType:"image"}).then(h=>{h=h.data;const r=h.naturalWidth,d=h.naturalHeight,k=document.createElement("canvas");k.width=r;k.height=d;const n=k.getContext("2d");n.fillStyle=c;n.fillRect(0,0,r,d);n.globalCompositeOperation="destination-in";n.drawImage(h,0,0);h=k.toDataURL();t.put(e,h);return h})};f.getSVGAlign=function(b){return b=(b=b.horizontalAlignment)&&K[b.toLowerCase()]||"middle"};f.getSVGBaseline=function(b){return(b=b.verticalAlignment)&&D[b.toLowerCase()]||
"alphabetic"};f.getSVGBaselineShift=function(b){return"bottom"===b.verticalAlignment?"super":null};f.getStroke=G;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/core/ItemCache":function(){define(["./MemCache"],function(f){return function(){function g(w,z){this._storage=new f.MemCacheStorage;this._storage.maxSize=w;z&&this._storage.registerRemoveFunc("",z)}var a=g.prototype;a.put=function(w,z){this._storage.put(w,z,1,1)};a.pop=function(w){return this._storage.pop(w)};a.get=function(w){return this._storage.get(w)};
a.clear=function(){this._storage.clearAll()};a.destroy=function(){this._storage.destroy()};return g}()})},"esri/symbols/support/cimSymbolUtils":function(){define(["exports","../../Color","../cim/utils"],function(f,g,a){function w(m){m=a.toCIMSymbolJSON(m);if("CIMTextSymbol"===m.type)return m.height;let b=0;if(m.symbolLayers)for(const c of m.symbolLayers)a.isCIMMarker(c)&&c.size>b?b=c.size:a.isCIMStroke(c)&&c.width>b?b=c.width:a.isCIMFill(c);return b}function z(m,b,c,e){if("CIMTextSymbol"===m.type)m.height*=
b;else{if(c&&m.effects)for(const h of m.effects)G(h,b);if(m.symbolLayers)for(const h of m.symbolLayers)switch(h.type){case "CIMPictureMarker":case "CIMVectorMarker":F(h,b,e);break;case "CIMPictureStroke":case "CIMSolidStroke":null!=e&&e.preserveOutlineWidth||(h.width*=b);break;case "CIMPictureFill":h.height*=b;h.offsetX*=b;h.offsetY*=b;break;case "CIMHatchFill":z(h.lineSymbol,b,!0,{...e,preserveOutlineWidth:!1}),h.offsetX*=b,h.offsetY*=b,h.separation*=b}}}function F(m,b,c){m.markerPlacement&&J(m.markerPlacement,
b);m.offsetX*=b;m.offsetY*=b;m.anchorPoint&&"Absolute"===m.anchorPointUnits&&(m.anchorPoint={x:m.anchorPoint.x*b,y:m.anchorPoint.y*b});m.size*=b;if("CIMVectorMarker"===m.type&&m.markerGraphics)for(const e of m.markerGraphics)m.scaleSymbolsProportionally||z(e.symbol,b,!0,c)}function J(m,b){a.isCIMMarkerStrokePlacement(m)&&(m.offset*=b);switch(m.type){case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineSameSize":m.customEndingOffset*=b;m.offsetAlongLine*=b;if(m.placementTemplate&&
m.placementTemplate.length){var c=m.placementTemplate.map(e=>e*b);m.placementTemplate=c}break;case "CIMMarkerPlacementAlongLineVariableSize":m.maxRandomOffset*=b;m.placementTemplate&&m.placementTemplate.length&&(c=m.placementTemplate.map(e=>e*b),m.placementTemplate=c);break;case "CIMMarkerPlacementOnLine":m.startPointOffset*=b;break;case "CIMMarkerPlacementAtExtremities":m.offsetAlongLine*=b;break;case "CIMMarkerPlacementAtRatioPositions":m.beginPosition*=b;m.endPosition*=b;break;case "CIMMarkerPlacementPolygonCenter":m.offsetX*=
b;m.offsetY*=b;break;case "CIMMarkerPlacementInsidePolygon":m.offsetX*=b,m.offsetY*=b,m.stepX*=b,m.stepY*=b}}function G(m,b){switch(m.type){case "CIMGeometricEffectArrow":case "CIMGeometricEffectDonut":m.width*=b;break;case "CIMGeometricEffectBuffer":m.size*=b;break;case "CIMGeometricEffectCut":m.beginCut*=b;m.endCut*=b;m.middleCut*=b;break;case "CIMGeometricEffectDashes":m.customEndingOffset*=b;m.offsetAlongLine*=b;if(m.dashTemplate&&m.dashTemplate.length){const c=m.dashTemplate.map(e=>e*b);m.dashTemplate=
c}break;case "CIMGeometricEffectExtension":case "CIMGeometricEffectJog":case "CIMGeometricEffectRadial":m.length*=b;break;case "CIMGeometricEffectMove":m.offsetX*=b;m.offsetY*=b;break;case "CIMGeometricEffectOffset":case "CIMGeometricEffectOffsetTangent":m.offset*=b;break;case "CIMGeometricEffectRegularPolygon":m.radius*=b;break;case "CIMGeometricEffectTaperedPolygon":m.fromWidth*=b;m.length*=b;m.toWidth*=b;break;case "CIMGeometricEffectWave":m.amplitude*=b,m.period*=b}}function K(m,b){let c;c="CIMTextSymbol"===
m.type?m.symbol:m;m="CIMPolygonSymbol"===m.type;if(c.symbolLayers)for(const e of c.symbolLayers)if(!(e.colorLocked||m&&(a.isCIMStroke(e)||a.isCIMMarker(e)&&e.markerPlacement&&a.isCIMMarkerStrokePlacement(e.markerPlacement))))switch(e.type){case "CIMVectorMarker":e.markerGraphics.forEach(h=>{K(h.symbol,b)});break;case "CIMSolidStroke":case "CIMSolidFill":D(b,e.color);break;case "CIMHatchFill":K(e.lineSymbol,b)}}function D(m,b){for(const c of m)if(c.join(".")===b.join("."))return;m.push(b)}function t(m,
b){var c="CIMTextSymbol"===m.type?m.symbol:m;m="CIMPolygonSymbol"===m.type?!0:!1;if(c.symbolLayers)for(const e of c.symbolLayers)if(!(e.colorLocked||m&&(a.isCIMStroke(e)||a.isCIMMarker(e)&&e.markerPlacement&&a.isCIMMarkerStrokePlacement(e.markerPlacement))))switch(c=b.toArray(0),e.type){case "CIMVectorMarker":e.markerGraphics.forEach(h=>{t(h.symbol,b)});break;case "CIMSolidStroke":case "CIMSolidFill":e.color=c;break;case "CIMHatchFill":t(e.lineSymbol,b)}}f.applyCIMSymbolColor=function(m,b){b instanceof
g||(b=new g(b));m=a.toCIMSymbolJSON(m);t(m,b)};f.applyCIMSymbolRotation=function(m,b,c=!1){m=a.toCIMSymbolJSON(m);c&&0!==b&&(b=360-b);if("CIMTextSymbol"===m.type)m.angle=b;else if("CIMPointSymbol"===m.type&&m.symbolLayers){c=b-(m.angle||0);for(const e of m.symbolLayers)if(a.isCIMMarker(e)){let h=e.rotation||0;h=e.rotateClockwise?h-c:h+c;e.rotation=h}m.angle=b}};f.getCIMSymbolColor=function(m){m=a.toCIMSymbolJSON(m);const b=[];K(m,b);return b.length?new g(a.fromCIMColor(b[0])):null};f.getCIMSymbolRotation=
function(m,b=!1){m=a.toCIMSymbolJSON(m);return"CIMTextSymbol"===m.type||"CIMPointSymbol"===m.type?b&&0!==m.angle?360-m.angle:m.angle||0:0};f.getCIMSymbolSize=w;f.scaleCIMMarker=F;f.scaleCIMSymbolTo=function(m,b,c){const e=a.toCIMSymbolJSON(m);m=w(m);if(0===m)if("CIMTextSymbol"===e.type)e.height=b;else{if(e.symbolLayers)for(const h of e.symbolLayers)switch(h.type){case "CIMPictureMarker":case "CIMVectorMarker":h.size=b;break;case "CIMPictureStroke":case "CIMSolidStroke":h.width=b}}else z(e,b/m,!1,
c)};Object.defineProperty(f,"__esModule",{value:!0})})},"esri/symbols/cim/utils":function(){define(["exports"],function(f){function g(a,w){"string"!==typeof a&&(a=String(a));switch(w){case "LowerCase":return a.toLowerCase();case "Allcaps":return a.toUpperCase();default:return a}}f._adjustTextCase=g;f.colorToArray=function(a){return[a.r,a.g,a.b,a.a]};f.createLabelOverrideFunction=function(a,w,z){const F=D=>{let t=D.length;for(;t--;)if(-1===" /-,\n".indexOf(D.charAt(t)))return!1;return!0},J=[];var G=
0;let K=-1;do K=w.indexOf("[",G),K>=G&&(K>G&&(G=w.substr(G,K-G),J.push([G,null,F(G)])),G=K+1,K=w.indexOf("]",G),K>=G&&(K>G&&(G=w.substr(G,K-G),(G=a[G])&&J.push([null,G,!1])),G=K+1));while(-1!==K);G<w.length-1&&(a=w.substr(G),J.push([a,null,F(a)]));return D=>{let t="",m=null;for(const b of J){const [c,e,h]=b;if(c)h?m=c:(m&&(t+=m,m=null),t+=c);else{const r=D.attributes[e];r&&(m&&(t+=m,m=null),t+=r)}}return g(t,z)}};f.evaluateValueOrFunction=function(a,w,z,F){return"function"===typeof a?a(w,z,F):a};
f.fromCIMColor=function(a){return a?{r:a[0],g:a[1],b:a[2],a:a[3]/255}:{r:0,g:0,b:0,a:0}};f.isCIMFill=function(a){return"CIMGradientFill"===a.type||"CIMHatchFill"===a.type||"CIMPictureFill"===a.type||"CIMSolidFill"===a.type||"CIMWaterFill"===a.type};f.isCIMMarker=function(a){return"CIMVectorMarker"===a.type||"CIMPictureMarker"===a.type||"CIMBarChartMarker"===a.type||"CIMCharacterMarker"===a.type||"CIMPieChartMarker"===a.type||"CIMStackedBarChartMarker"===a.type};f.isCIMMarkerStrokePlacement=function(a){return"CIMMarkerPlacementAlongLineRandomSize"===
a.type||"CIMMarkerPlacementAlongLineSameSize"===a.type||"CIMMarkerPlacementAlongLineVariableSize"===a.type||"CIMMarkerPlacementAtExtremities"===a.type||"CIMMarkerPlacementAtMeasuredUnits"===a.type||"CIMMarkerPlacementAtRatioPositions"===a.type||"CIMMarkerPlacementOnLine"===a.type||"CIMMarkerPlacementOnVertices"===a.type};f.isCIMStroke=function(a){return"CIMGradientStroke"===a.type||"CIMPictureStroke"===a.type||"CIMSolidStroke"===a.type};f.resampleHermite=function(a,w,z,F,J,G,K=!0){const D=w/J;z/=
G;const t=Math.ceil(D/2),m=Math.ceil(z/2);for(let e=0;e<G;e++)for(let h=0;h<J;h++){const r=4*(h+(K?G-e-1:e)*J);var b=0;let d=0,k=0,n=0,u=0,l=0,p=0;const E=(e+.5)*z;for(let x=Math.floor(e*z);x<(e+1)*z;x++){var c=Math.abs(E-(x+.5))/m;const M=(h+.5)*D;c*=c;for(let B=Math.floor(h*D);B<(h+1)*D;B++){let q=Math.abs(M-(B+.5))/t;b=Math.sqrt(c+q*q);-1<=b&&1>=b&&(b=2*b*b*b-3*b*b+1,0<b&&(q=4*(B+x*w),p+=b*a[q+3],k+=b,255>a[q+3]&&(b=b*a[q+3]/250),n+=b*a[q],u+=b*a[q+1],l+=b*a[q+2],d+=b))}}F[r]=n/d;F[r+1]=u/d;F[r+
2]=l/d;F[r+3]=p/k}};f.toCIMSymbolJSON=function(a){var w;return null==(w=a.data)?void 0:w.symbol};Object.defineProperty(f,"__esModule",{value:!0})})},"esri/views/support/layerViewUtils":function(){define(["exports","../../core/maybe"],function(f,g){f.extractSafeScaleBounds=function(a){let {minScale:w,maxScale:z}=a;return{minScale:w||0,maxScale:z||0}};f.highlightsSupported=function(a){return a&&"function"===typeof a.highlight};f.occludeesSupported=function(a){return a&&"function"===typeof a.maskOccludee};
f.scaleBoundsPredicate=function(a,w,z){return g.isNone(a)||a>z&&(0===w||a<w)};Object.defineProperty(f,"__esModule",{value:!0})})},"esri/widgets/Popup/actions":function(){define(["exports","../../support/actions/ActionButton"],function(f,g){const a=new g({id:"zoom-to-feature",title:"{messages.zoom}",className:"esri-icon-zoom-in-magnifying-glass"}),w=new g({id:"remove-selected-feature",title:"{messages.remove}",className:"esri-icon-trash"}),z=new g({id:"zoom-to-clustered-features",title:"{messages.zoom}",
className:"esri-icon-zoom-in-magnifying-glass"});g=new g({id:"browse-clustered-features",title:"{messages.browseClusteredFeatures}",className:"esri-icon-table"});f.all=[a,w,g,z];f.browseClusteredFeatures=g;f.removeSelectedFeature=w;f.zoomToClusteredFeatures=z;f.zoomToFeature=a;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/widgets/Popup/actionUtils":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../core/Error","../../core/Logger","./actions"],function(f,g,a,w,
z){function F(e){const {selectedFeature:h,location:r,view:d}=e;return d?"3d"===d.type?h||r:e.get("selectedFeature.geometry")||r:null}function J(e,h){if("3d"!==(null==h?void 0:h.type)||!e||"esri.Graphic"!==e.declaredClass)return!0;if((h=h.getViewForGraphic(e))&&"whenGraphicBounds"in h){let r=!1;h.whenGraphicBounds(e,{useViewElevation:!0}).then(d=>{r=!d||!d.boundingBox||d.boundingBox[0]===d.boundingBox[3]&&d.boundingBox[1]===d.boundingBox[4]&&d.boundingBox[2]===d.boundingBox[5]}).catch(()=>{const d=
new a("zoom-to:invalid-graphic","Could not zoom to the location of the graphic.",{graphic:e});c.error(d)});return r}return!0}function G(e){return K.apply(this,arguments)}function K(){K=g._asyncToGenerator(function*(e){const {location:h,selectedFeature:r,view:d,zoomFactor:k}=e,n=F(e);if(!n)return e=new a("zoom-to:invalid-target-or-view","Cannot zoom to location without a target and view.",{target:n,view:d}),c.error(e),Promise.reject(e);const u=d.scale/k,l=e.get("selectedFeature.geometry")||h,p=l&&
"point"===l.type&&J(r,d);z.zoomToFeature.active=!0;z.zoomToFeature.disabled=!0;yield e.view.goTo({target:n,scale:p?u:void 0});z.zoomToFeature.active=!1;z.zoomToFeature.disabled=!1;e.zoomToLocation=null;p&&(e.location=l)});return K.apply(this,arguments)}function D(e){return t.apply(this,arguments)}function t(){t=g._asyncToGenerator(function*(e){const {selectedFeature:h,view:r}=e;if("2d"!==(null==r?void 0:r.type))throw e=new a("zoomToCluster:invalid-view","View must be 2d MapView.",{view:r}),c.error(e),
e;if(!h.isAggregate)throw e=new a("zoomToCluster:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:h}),c.error(e),e;e=yield r.whenLayerView(h.sourceLayer);const d=e.createQuery();d.aggregateIds=[h.getObjectId()];z.zoomToClusteredFeatures.active=!0;z.zoomToClusteredFeatures.disabled=!0;({extent:e}=yield e.queryExtent(d));yield r.goTo({target:e});z.zoomToClusteredFeatures.active=!1;z.zoomToClusteredFeatures.disabled=!1});return t.apply(this,arguments)}
function m(){m=g._asyncToGenerator(function*(e){const {selectedFeature:h,view:r}=e;if("2d"!==(null==r?void 0:r.type))throw e=new a("displayClusterExtent:invalid-view","View must be 2d MapView.",{view:r}),c.error(e),e;if(!h.isAggregate)throw e=new a("zoomToCluster:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:h}),c.error(e),e;var d=yield r.whenLayerView(h.sourceLayer);const k=d.createQuery();k.aggregateIds=[h.getObjectId()];({extent:d}=yield d.queryExtent(k));
e.selectedClusterBoundaryFeature.geometry=d;r.graphics.add(e.selectedClusterBoundaryFeature)});return m.apply(this,arguments)}function b(){b=g._asyncToGenerator(function*(e){const {selectedFeature:h,view:r}=e;if("2d"!==(null==r?void 0:r.type))throw e=new a("browseAggregateFeatures:invalid-view","View must be 2d MapView.",{view:r}),c.error(e),e;if(!h.isAggregate)throw e=new a("browseAggregateFeatures:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:h}),
c.error(e),e;e=yield r.whenLayerView(h.sourceLayer);const d=e.createQuery();d.aggregateIds=[h.getObjectId()];z.browseClusteredFeatures.active=!0;z.browseClusteredFeatures.disabled=!0;({features:e}=yield e.queryFeatures(d));z.browseClusteredFeatures.active=!1;z.browseClusteredFeatures.disabled=!1;r.popup.open({features:[h].concat(e),featureMenuOpen:!0})});return b.apply(this,arguments)}const c=w.getLogger("esri.widgets.Popup.PopupViewModel");f.browseAggregateFeatures=function(e){return b.apply(this,
arguments)};f.displayClusterExtent=function(e){return m.apply(this,arguments)};f.getSelectedTarget=F;f.isZoomScreenSize=J;f.removeClusteredFeaturesForBrowsing=function(e){e.features=e.features.filter(h=>h.isAggregate)};f.triggerAction=function(e){const {event:h,view:r}=e;({action:e}=h);var d=r&&r.popup;if(!e)return Promise.reject(new a("trigger-action:missing-arguments","Event has no action"));if(!d)return Promise.reject(new a("trigger-action:missing-arguments","view.popup is missing"));const {disabled:k,
id:n}=e;if(!n)return Promise.reject(new a("trigger-action:invalid-action","action.id is missing"));if(k)return Promise.reject(new a("trigger-action:invalid-action","Action is disabled"));if(n===z.zoomToFeature.id)return G(d.viewModel);if(n===z.zoomToClusteredFeatures.id)return D(d.viewModel);if(n===z.browseClusteredFeatures.id)return d.featureMenuOpen=!d.featureMenuOpen,d.viewModel.browseClusterEnabled=!d.viewModel.browseClusterEnabled,Promise.resolve();d.viewModel.browseClusterEnabled=!1;if(n===
z.removeSelectedFeature.id){d.close();({selectedFeature:e}=d);if(!e)return Promise.reject(new a(`trigger-action:${z.removeSelectedFeature.id}`,"selectedFeature is required",{selectedFeature:e}));({sourceLayer:d}=e);d?d.remove(e):r.graphics.remove(e)}return Promise.resolve()};f.zoomToClusterExtent=D;f.zoomToLocation=G;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/widgets/support/GoTo":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/accessorSupport/decorators/subclass".split(" "),
function(f,g,a,w,z,F,J,G){f.GoToMixin=K=>{K=function(D){function t(...m){m=D.call(this,...m)||this;m.goToOverride=null;m.view=null;return m}g._inheritsLoose(t,D);t.prototype.callGoTo=function(m){const {view:b}=this;return this.goToOverride?this.goToOverride(b,m):b.goTo(m.target,m.options)};return t}(K);a.__decorate([w.property()],K.prototype,"goToOverride",void 0);a.__decorate([w.property()],K.prototype,"view",void 0);return K=a.__decorate([G.subclass("esri.widgets.support.GoTo")],K)};Object.defineProperty(f,
"__esModule",{value:!0})})},"esri/views/3d/interactive/editingTools/isSupportedGraphicUtils":function(){define(["exports","../../../../core/has"],function(f,g){f.isSupportedGraphicResultMessage=function(a){switch(a){case 1:return"not owned by a graphics layer";case 2:return"no geometry";case 3:return"the geometry type is not supported";case 4:return"the elevation mode is not supported";case 5:return"the symbol type is not supported"}return""};Object.defineProperty(f,"__esModule",{value:!0})})},"esri/views/3d/interactive/editingTools/moveGraphic/isSupportedGraphic":function(){define(["exports",
"../../../../../core/has","../../../../../core/maybe","../../../../../support/elevationInfoUtils"],function(f,g,a,w){f.isSupportedGraphic=function(z){var F;if("graphics"!==(null==(F=z.layer)?void 0:F.type))return 1;if(a.isNone(z.geometry))return 2;switch(z.geometry.type){case "polygon":case "point":case "polyline":case "mesh":break;case "multipoint":case "extent":return 3;default:return 3}return"on-the-ground"!==w.getGraphicEffectiveElevationMode(z)&&w.hasGraphicFeatureExpressionInfo(z)?4:0};Object.defineProperty(f,
"__esModule",{value:!0})})},"esri/support/elevationInfoUtils":function(){define(["exports","../core/maybe","../symbols/support/unitConversionUtils"],function(f,g,a){function w(D,t){return g.isNone(t)||!t.mode?D?"absolute-height":"on-the-ground":t.mode}function z(D,t){return w(g.isSome(D)?D.hasZ:!1,t)}function F(D){const t=J(D);return z(D.geometry,t)}function J(D){return D.layer&&"elevationInfo"in D.layer?D.layer.elevationInfo:null}function G(D,t,m,b,c,e,h=null){if(!g.isNone(e)){var r=g.isSome(h)?
h.mode:"absolute-height";if("on-the-ground"===r)return 0;a:{e=K(t,m,b,c,D,e);h=g.isSome(h)&&g.isSome(h.offset)?h.offset:0;switch(r){case "absolute-height":D=e-h;break a;case "relative-to-ground":D=e-(g.unwrapOr(D.elevationProvider.getElevation(t,m,b,c,"ground"),0)+h);break a;case "relative-to-scene":D=e-(g.unwrapOr(D.elevationProvider.getElevation(t,m,b,c,"scene"),0)+h);break a}D=void 0}return D}}function K(D,t,m,b,c,e){const h=g.isSome(e.offset)?e.offset:0;switch(e.mode){case "absolute-height":return m+
h;case "on-the-ground":return g.unwrapOr(c.elevationProvider.getElevation(D,t,0,b,"ground"),0);case "relative-to-ground":return m+g.unwrapOr(c.elevationProvider.getElevation(D,t,m,b,"ground"),0)+h;case "relative-to-scene":return m+g.unwrapOr(c.elevationProvider.getElevation(D,t,m,b,"scene"),0)+h}}f.getConvertedElevation=function(D,t,m,b=null){return G(D,t.x,t.y,t.hasZ?t.z:0,t.spatialReference,m,b)};f.getConvertedElevationFromVector=function(D,t,m,b,c=null){return G(D,t[0],t[1],2<t.length?t[2]:0,m,
b,c)};f.getEffectiveElevationMode=w;f.getGeometryEffectiveElevationMode=z;f.getGraphicEffectiveElevationInfo=function(D){var t=J(D);D=z(D.geometry,t);t=g.isSome(t)&&"on-the-ground"!==D?g.unwrapOr(t.offset,0)*a.getMetersPerUnit(g.unwrapOr(t.unit,"meters")):0;return{mode:D,offset:t}};f.getGraphicEffectiveElevationMode=F;f.getZForElevationMode=function(D,t,m){if(!g.isNone(m)&&m.mode){var b=D.hasZ?D.z:0,c=g.isSome(m.offset)?m.offset:0;switch(m.mode){case "absolute-height":return b-c;case "on-the-ground":return 0;
case "relative-to-ground":return D=g.unwrapOr(t.elevationProvider.getElevation(D.x,D.y,D.z,D.spatialReference,"ground"),0)+c,b-D;case "relative-to-scene":return D=g.unwrapOr(t.elevationProvider.getElevation(D.x,D.y,D.z,D.spatialReference,"scene"),0)+c,b-D}}};f.hasGraphicFeatureExpressionInfo=function(D){if("on-the-ground"===F(D))return!1;D=J(D);D=g.isSome(D)&&D.featureExpressionInfo?D.featureExpressionInfo.expression:null;return!(!D||"0"===D)};f.zValueInAbsoluteHeightMode=K;Object.defineProperty(f,
"__esModule",{value:!0})})},"esri/views/3d/interactive/editingTools/reshapeGraphic/isSupportedGraphic":function(){define(["exports","../../../../../core/maybe","../../../../../geometry/Circle","../../../../../support/elevationInfoUtils"],function(f,g,a,w){function z(F){var J;return"graphics"!==(null==(J=F.layer)?void 0:J.type)?{result:1,geometry:null}:g.isNone(F.geometry)?{result:2,geometry:null}:"on-the-ground"!==w.getGraphicEffectiveElevationMode(F)&&w.hasGraphicFeatureExpressionInfo(F)?{result:4,
geometry:null}:"point"!==F.geometry.type&&"polyline"!==F.geometry.type&&("polygon"!==F.geometry.type||F.geometry instanceof a)?{result:3,geometry:null}:{result:0,geometry:F.geometry}}f.geometryOfSupportedGraphic=function(F){return z(F).geometry};f.isSupportedGraphic=function(F){return z(F).result};Object.defineProperty(f,"__esModule",{value:!0})})},"esri/geometry/Circle":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/unitUtils ../core/accessorSupport/decorators/property ../core/has ../core/accessorSupport/ensureType ../core/Logger ../core/accessorSupport/decorators/subclass ./Point ./Polygon ./projectionEllipsoid ./support/geodesicUtils ./support/webMercatorUtils ./support/WKIDUnitConversion".split(" "),
function(f,g,a,w,z,F,J,G,K,D,t,m,b,c){var e;z=e=function(h){function r(...k){k=h.call(this,...k)||this;k.center=null;k.geodesic=!1;k.numberOfPoints=60;k.radius=1E3;k.radiusUnit="meters";return k}f._inheritsLoose(r,h);var d=r.prototype;d.normalizeCtorArgs=function(k,n){if(!k||!k.center){if(k&&k.rings)return h.prototype.normalizeCtorArgs.call(this,k,n);k={center:k}}return{...h.prototype.normalizeCtorArgs.call(this),...k,...n}};d.initialize=function(){var k=this.center;const n=this.numberOfPoints;this.hasZ=
k&&k.hasZ;if(0===this.rings.length&&k){var u=a.convertUnit(this.radius,this.radiusUnit,"meters"),l=k.spatialReference,p="geographic";if(l.isWebMercator)p="webMercator";else if(null!=c[l.wkid]||l.wkt&&0===l.wkt.indexOf("PROJCS"))p="projected";if(this.geodesic){let E;switch(p){case "webMercator":E=b.webMercatorToGeographic(k);break;case "projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");break;case "geographic":E=
k}k=this._createGeodesicCircle(E,u,n);"webMercator"===p&&(k=b.geographicToWebMercator(k))}else{let E;"webMercator"===p||"projected"===p?E=u/this._convert2Meters(1,k.spatialReference):"geographic"===p&&(E=a.lengthToDegrees(u,"meters",t.getReferenceEllipsoid(k.spatialReference).radius));k=this._createPlanarCircle(k,E,n)}this.spatialReference=k.spatialReference;this.addRing(k.rings[0])}};d.clone=function(){const {center:k,numberOfPoints:n,radius:u,radiusUnit:l,geodesic:p}=this;return new e({center:k.clone(),
numberOfPoints:n,radius:u,radiusUnit:l,geodesic:p})};d._createGeodesicCircle=function(k,n,u){let l=0;const p=[];for(;360>l;){const E=[0,0];m.directGeodeticSolver(E,[k.x,k.y],l,n);this.hasZ&&E.push(k.z);p.push(E);l+=360/u}p.push(p[0]);return new D(p)};d._createPlanarCircle=function(k,n,u){const l=[],p=2*Math.PI/u;for(let x=0;x<u;++x){var E=p*x;E=[k.x+Math.cos(-E)*n,k.y+Math.sin(-E)*n];this.hasZ&&E.push(k.z);l.push(E)}l.push(l[0]);return new D({spatialReference:k.spatialReference,rings:[l]})};d._convert2Meters=
function(k,n){if(null!=c[n.wkid])n=c.values[c[n.wkid]];else{n=n.wkt;const u=n.lastIndexOf(",")+1,l=n.lastIndexOf("]]");n=parseFloat(n.substring(u,l))}return k*n};return r}(D);g.__decorate([w.property({type:K})],z.prototype,"center",void 0);g.__decorate([w.property()],z.prototype,"geodesic",void 0);g.__decorate([w.property()],z.prototype,"numberOfPoints",void 0);g.__decorate([w.property()],z.prototype,"radius",void 0);g.__decorate([w.property()],z.prototype,"radiusUnit",void 0);return z=e=g.__decorate([G.subclass("esri.geometry.Circle")],
z)})},"esri/geometry/support/geodesicUtils":function(){define("exports ../../geometry ../../core/Error ../../core/unitUtils ./geodesicConstants ../Polyline ../Polygon ../Point ../SpatialReference".split(" "),function(f,g,a,w,z,F,J,G,K){function D(d){if(!d)return null;if(d.isGeographic&&d.wkid){var k=z.spheroids[d.wkid];if(k)return k}return d.wkt&&((d=z.WKT_SPHEROID_REGEX.exec(d.wkt))&&2===d.length?(k=d[1].split(","),!k||3>k.length?d=null:(d=parseFloat(k[1]),k=parseFloat(k[2]),d=isNaN(d)||isNaN(k)?
null:{a:d,f:0===k?0:1/k})):d=null,d)?d:null}function t(d){d=D(d||K.WGS84);if("b"in d&&"eSq"in d&&"radius"in d)return d;const k=d.a*(1-d.f);return Object.assign(d,{b:k,eSq:1-(k/d.a)**2,radius:(2*d.a+k)/3,densificationRatio:1E4/((2*d.a+k)/3)})}function m(d){return 0>d?d+360:d}function b(d,k,n){const {a:u,eSq:l}=t(n);n=Math.sqrt(l);const p=Math.sin(k[1]*z.toRadians);k=u*k[0]*z.toRadians;n=0<l?u*(1-l)*(p/(1-l*p*p)-1/(2*n)*Math.log((1-n*p)/(1+n*p)))*.5:u*p;d[0]=k;d[1]=n;return d}function c(d){return null!==
D(d)}function e(d,k){if("polyline"!==d.type&&"polygon"!==d.type)throw new a("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");const {spatialReference:n}=d;if(!c(n))throw new a("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");var u="polyline"===d.type?d.paths:d.rings;const l=[],p=[0,0],E={distance:null};for(const B of u){u=[];l.push(u);u.push([B[0][0],B[0][1]]);var x=B[0][0],M=B[0][1];let q,I;for(let A=0;A<
B.length-1;A++){q=B[A+1][0];I=B[A+1][1];if(x===q&&M===I)continue;const N=[x,M];r(E,[x,M],[q,I],n);const {azimuth:V,distance:X}=E;x=X/k;if(1<x){for(M=1;M<=x-1;M++)h(p,N,V,M*k,n),u.push(p.slice(0));h(p,N,V,(X+Math.floor(x-1)*k)/2,n);u.push(p.slice(0))}h(p,N,V,X,n);u.push(p.slice(0));x=p[0];M=p[1]}}return"polyline"===d.type?new F({paths:l,spatialReference:n}):new J({rings:l,spatialReference:n})}function h(d,k,n,u,l){const p=k[0]*z.toRadians;k=k[1]*z.toRadians;n*=z.toRadians;const {a:E,b:x,f:M}=t(l);
l=Math.sin(n);n=Math.cos(n);var B=(1-M)*Math.tan(k);k=1/Math.sqrt(1+B*B);const q=B*k,I=Math.atan2(B,n);B=k*l;const A=B*B;var N=1-A,V=N*(E*E-x*x)/(x*x);const X=1+V/16384*(4096+V*(-768+V*(320-175*V))),T=V/1024*(256+V*(-128+V*(74-47*V)));V=u/(x*X);let v=2*Math.PI,L,y,C,P;for(;1E-12<Math.abs(V-v);)C=Math.cos(2*I+V),L=Math.sin(V),y=Math.cos(V),P=T*L*(C+T/4*(y*(-1+2*C*C)-T/6*C*(-3+4*L*L)*(-3+4*C*C))),v=V,V=u/(x*X)+P;u=q*L-k*y*n;N=M/16*N*(4+M*(4-3*N));u=Math.atan2(q*y+k*L*n,(1-M)*Math.sqrt(A+u*u))/z.toRadians;
d[0]=(p+(Math.atan2(L*l,k*y-q*L*n)-(1-N)*M*B*(V+N*L*(C+N*y*(-1+2*C*C)))))/z.toRadians;d[1]=u;return d}function r(d,k,n,u){var l=k[0]*z.toRadians;k=k[1]*z.toRadians;var p=n[0]*z.toRadians;n=n[1]*z.toRadians;const {a:E,b:x,f:M,radius:B}=t(u),q=p-l;var I=Math.atan((1-M)*Math.tan(k)),A=Math.atan((1-M)*Math.tan(n));u=Math.sin(I);I=Math.cos(I);const N=Math.sin(A);A=Math.cos(A);let V=1E3,X=q,T,v,L;let y,C,P;do{var S=Math.sin(X);var aa=Math.cos(X);L=Math.sqrt(A*S*A*S+(I*N-u*A*aa)*(I*N-u*A*aa));if(0===L)return d.distance=
0,d.azimuth=void 0,d.reverseAzimuth=void 0,d;aa=u*N+I*A*aa;y=Math.atan2(L,aa);C=I*A*S/L;v=1-C*C;S=aa-2*u*N/v;isNaN(S)&&(S=0);P=M/16*v*(4+M*(4-3*v));T=X;X=q+(1-P)*M*C*(y+P*L*(S+P*aa*(-1+2*S*S)))}while(1E-12<Math.abs(X-T)&&0<--V);if(0===V)return u=Math.acos(Math.sin(k)*Math.sin(n)+Math.cos(k)*Math.cos(n)*Math.cos(p-l))*B,l=p-l,d.azimuth=Math.atan2(Math.sin(l)*Math.cos(n),Math.cos(k)*Math.sin(n)-Math.sin(k)*Math.cos(n)*Math.cos(l))/z.toRadians,d.distance=u,d.reverseAzimuth=void 0,d;l=v*(E*E-x*x)/(x*
x);k=l/1024*(256+l*(-128+l*(74-47*l)));p=Math.atan2(I*Math.sin(X),I*N*Math.cos(X)-u*A);d.azimuth=Math.atan2(A*Math.sin(X),I*N-u*A*Math.cos(X))/z.toRadians;d.distance=x*(1+l/16384*(4096+l*(-768+l*(320-175*l))))*(y-k*L*(S+k/4*(aa*(-1+2*S*S)-k/6*S*(-3+4*L*L)*(-3+4*S*S))));d.reverseAzimuth=p/z.toRadians;return d}f.directGeodeticSolver=h;f.geodesicAreas=function(d,k="square-meters"){if(d.some(p=>!c(p.spatialReference)))throw new a("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");
const n=[];for(var u=0;u<d.length;u++){var l=d[u];const {radius:p,densificationRatio:E}=t(l.spatialReference);n.push(e(l,p*E))}d=[];u=[0,0];l=[0,0];for(let p=0;p<n.length;p++){const {rings:E,spatialReference:x}=n[p];let M=0;for(let B=0;B<E.length;B++){const q=E[B];b(u,q[0],x);b(l,q[q.length-1],x);let I=l[0]*u[1]-u[0]*l[1];for(let A=0;A<q.length-1;A++)b(u,q[A+1],x),b(l,q[A],x),I+=l[0]*u[1]-u[0]*l[1];M+=I}M=w.convertUnit(M,"square-meters",k);d.push(M/-2)}return d};f.geodesicDensify=e;f.geodesicDistance=
function(d,k,n="meters"){if(!d||!k)throw new a("geodesic-distance:missing-parameters","one or both input parameters are missing");if(!d.spatialReference||!k.spatialReference)throw new a("geodesic-distance:invalid-parameters","one or both input points do not have a spatial reference");if(!d.spatialReference.equals(k.spatialReference))throw new a("geodesic-distance:invalid-parameters","spatial references of input parameters do not match");const {spatialReference:u}=d;if(!c(u))throw new a("geodesic-distance:not-supported",
"input geometry spatial reference is not supported");if(d.equals(k))return{distance:0,azimuth:0,reverseAzimuth:0};const l={distance:null};r(l,[d.x,d.y],[k.x,k.y],u);l.distance=w.convertUnit(l.distance,"meters",n);l.azimuth=m(l.azimuth);l.reverseAzimuth=m(l.reverseAzimuth);return l};f.geodesicLengths=function(d,k="meters"){if(!d)throw new a("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(d.some(l=>!c(l.spatialReference)))throw new a("geodesic-lengths:invalid-spatial-reference",
"the input geometries spatial reference is not supported");const n=[];for(let l=0;l<d.length;l++){var u=d[l];const {spatialReference:p}=u;u="polyline"===u.type?u.paths:u.rings;let E=0;for(let x=0;x<u.length;x++){const M=u[x];let B=0;for(let q=1;q<M.length;q++){const I=M[q-1][0],A=M[q][0],N=M[q-1][1],V=M[q][1];if(N!==V||I!==A){const X={distance:null};r(X,[I,N],[A,V],p);B+=X.distance}}E+=B}E=w.convertUnit(E,"meters",k);n.push(E)}return n};f.inverseGeodeticSolver=r;f.isSupported=c;f.pointFromDistance=
function(d,k,n){if(!d||null==k||null==n)throw new a("point-from-distance:missing-parameters","one or more input parameters are missing or undefined");if(0>n||360<n)throw new a("point-from-distance:-of-bounds","azimuth is restricted to angles between, and including, 0\u00b0 to 360\u00b0 degrees");if(!d.spatialReference)throw new a("point-from-distance:missing-spatial-reference","the input point must have a spatial reference");const {spatialReference:u}=d;if(!c(u))throw new a("geodesic-distance:not-supported",
"input geometry spatial reference is not supported");const l=[0,0];h(l,[d.x,d.y],n,k,u);return new G({x:l[0],y:l[1],spatialReference:u})};Object.defineProperty(f,"__esModule",{value:!0})})},"esri/geometry/support/geodesicConstants":function(){define(["exports","./Ellipsoid"],function(f,g){const a=Math.PI/180;var w=g.earth.radius;const z=g.earth.eccentricitySquared;w={a1:w*z,a2:w*z*w*z,a3:w*z*z/2,a4:w*z*w*z*2.5,a5:w*z+w*z*z/2,a6:1-z};g={4267:{a:6378206.4,f:1/294.9786982},4269:{a:6378137,f:1/298.257222101},
4326:{a:g.earth.radius,f:g.earth.flattening},104900:{a:2439700,f:0},104901:{a:6051E3,f:0},104902:{a:6051800,f:0},104903:{a:g.moon.radius,f:g.moon.flattening},104904:{a:3393400,f:.005207166853303471},104905:{a:g.mars.radius,f:g.mars.flattening},104906:{a:6200,f:0},104907:{a:11100,f:0},104908:{a:71492E3,f:.06487439154031222},104909:{a:8200,f:0},104910:{a:83500,f:0},104911:{a:1E4,f:0},104912:{a:2409300,f:0},104913:{a:15E3,f:0},104914:{a:4E4,f:0},104915:{a:1562090,f:0},104916:{a:2632345,f:0},104917:{a:85E3,
f:0},104918:{a:1821460,f:0},104919:{a:5E3,f:0},104920:{a:12E3,f:0},104921:{a:3E4,f:3},104922:{a:18E3,f:0},104923:{a:14E3,f:0},104924:{a:49300,f:0},104925:{a:60268E3,f:.09796243445941462},104926:{a:16E3,f:0},104927:{a:9500,f:0},104928:{a:56E4,f:0},104929:{a:249400,f:0},104930:{a:59500,f:0},104931:{a:16E3,f:0},104932:{a:133E3,f:0},104933:{a:718E3,f:0},104934:{a:888E3,f:0},104935:{a:1986300,f:0},104936:{a:1E4,f:0},104937:{a:41900,f:0},104938:{a:11E4,f:0},104939:{a:50100,f:0},104940:{a:764E3,f:0},104941:{a:11E3,
f:0},104942:{a:529800,f:0},104943:{a:2575E3,f:0},104944:{a:25559E3,f:.022927344575296365},104945:{a:578900,f:0},104946:{a:33E3,f:0},104947:{a:21E3,f:0},104948:{a:13E3,f:0},104949:{a:31E3,f:0},104950:{a:27E3,f:0},104951:{a:42E3,f:0},104952:{a:235800,f:0},104953:{a:761400,f:0},104954:{a:15E3,f:0},104955:{a:54E3,f:0},104956:{a:77E3,f:0},104957:{a:27E3,f:0},104958:{a:788900,f:0},104959:{a:584700,f:0},104960:{a:24764E3,f:.01708124697141011},104961:{a:74E3,f:0},104962:{a:79E3,f:0},104963:{a:104E3,f:.14423076923076922},
104964:{a:29E3,f:0},104965:{a:17E4,f:0},104966:{a:208E3,f:0},104967:{a:4E4,f:0},104968:{a:1352600,f:0},104969:{a:1195E3,f:0},104970:{a:593E3,f:0},104971:{a:g.mars.radius,f:0},104972:{a:47E4,f:0},104973:{a:255E3,f:0},104974:{a:2439400,f:0}};f.WKT_SPHEROID_REGEX=/SPHEROID\[([^\]]+)]/i;f.earthEllipsoidConstants=w;f.spheroids=g;f.toRadians=a;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/views/3d/interactive/editingTools/transformGraphic/isSupportedGraphic":function(){define(["exports","../../../../../core/has",
"../../../../../core/maybe","../../../../../support/elevationInfoUtils"],function(f,g,a,w){f.isSupportedGraphic=function(z){var F;if("graphics"!==(null==(F=z.layer)?void 0:F.type))return 1;if(a.isNone(z.geometry))return 2;switch(z.geometry.type){case "point":break;case "polygon":case "polyline":case "multipoint":case "extent":case "mesh":return 0;default:return 3}return(F=a.isSome(z.symbol)&&"point-3d"===z.symbol.type&&z.symbol.symbolLayers)&&0<F.length&&F.some(J=>"object"===J.type)?"on-the-ground"!==
w.getGraphicEffectiveElevationMode(z)&&w.hasGraphicFeatureExpressionInfo(z)?4:0:5};Object.defineProperty(f,"__esModule",{value:!0})})},"esri/views/draw/support/layerUtils":function(){define(["exports"],function(f){f.addUniqueLayer=function(g,a,w){if(a&&g&&g.map){({map:g}=g);var z=g.layers.find(F=>F===a);z||g.add(a,w);void 0!==w&&null!==w&&g.layers.reorder(z,w)}};Object.defineProperty(f,"__esModule",{value:!0})})},"esri/views/interactive/keybindings":function(){define(["exports"],function(f){f.SKETCH_KEYS=
{redo:"r",undo:"z",center:"Alt",constraint:"Shift",snappingToggle:"Control",cancel:"Escape",delete:["Backspace","Delete"],complete:"Enter",vertexAdd:"f",pan:" "};Object.defineProperty(f,"__esModule",{value:!0})})},"esri/views/interactive/snapping/SnappingManager":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Evented ../../../core/HandleOwner ../../../core/maybe ../../../core/promiseUtils ../../../core/watchUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/trackingUtils ../../../chunks/vec2 ../../../geometry/SpatialReference ./FeatureSnappingEngine ./SelfSnappingEngine ./SnappingOptions ./snappingUtils ./candidates/IntersectionSnappingCandidate".split(" "),
function(f,g,a,w,z,F,J,G,K,D,t,m,b,c,e,h,r,d,k,n,u){f.SnappingManager=function(l){function p(x){x=l.call(this,x)||this;x.options=new k;x.engines=[];x._currentMainCandidate=null;x._currentOtherActiveCandidates=[];return x}g._inheritsLoose(p,l);var E=p.prototype;E.initialize=function(){this.handles.add([c.reaction(()=>{const {effectiveFeatureEnabled:x,effectiveSelfEnabled:M,touchSensitivityMultiplier:B,distance:q}=this.options;return{effectiveFeatureEnabled:x,effectiveSelfEnabled:M,touchSensitivityMultiplier:B,
distance:q}},()=>{this.doneSnapping();this.emit("changed")}),this.watch("options",x=>{for(const M of this.engines)M.options=x},!0),G.init(this.view,"ready",x=>this.onViewReady(x),!0)])};E.destroy=function(){this.destroyEngines()};E.onViewReady=function(x){this.destroyEngines();if(x){var M,B;this.engines=[new d.SelfSnappingEngine({view:this.view,options:this.options}),new r.FeatureSnappingEngine({view:this.view,spatialReference:null!=(M=null==(B=this.view)?void 0:B.spatialReference)?M:h.WGS84,options:this.options})]}};
E.destroyEngines=function(){for(const x of this.engines)x.destroy();this.engines.length=0};E.snap=function(){var x=g._asyncToGenerator(function*(M,B,q){const I=B.coordinateHelper.pointToVector(M),A=yield this.fetchCandidates(I,B,q);return{get valid(){return!J.isAborted(q)},apply:()=>{const {snappedPoint:N,hints:V}=this.processCandidates(I,A,B);this.removeVisualization();F.isSome(B.visualizer)&&this.handles.add(B.visualizer.draw(V,{coordinateHelper:B.coordinateHelper,elevationInfo:B.elevationInfo,
view:this.view}),"visualization-handle");return N}}});return function(M,B,q){return x.apply(this,arguments)}}();E.update=function(x,M){this.removeVisualization();let B=x;const q=[];if(F.isSome(this._currentMainCandidate)){const I=M.coordinateHelper;x=I.pointToVector(x);const A=this._currentMainCandidate.constraint.closestTo(x);if(n.squareDistance(n.anyMapPointToScreenPoint(x,I,M.elevationInfo,this.view),n.anyMapPointToScreenPoint(A,I,M.elevationInfo,this.view))<this.squaredPointProximityThreshold(M.pointer)){B=
I.vectorToDehydratedPoint(A);this._currentMainCandidate.targetPoint=A;q.push(...this._currentMainCandidate.hints);for(const N of this._currentOtherActiveCandidates)N.targetPoint=A,q.push(...N.hints)}else this._currentMainCandidate=null,this._currentOtherActiveCandidates=[]}F.isSome(M.visualizer)&&this.handles.add(M.visualizer.draw(q,{coordinateHelper:M.coordinateHelper,elevationInfo:M.elevationInfo,view:this.view}),"visualization-handle");return B};E.doneSnapping=function(){this.removeVisualization();
this._currentMainCandidate=null;this._currentOtherActiveCandidates=[]};E.removeVisualization=function(){this.handles.remove("visualization-handle")};E.fetchCandidates=function(){var x=g._asyncToGenerator(function*(M,B,q){return(yield Promise.all(this.engines.map(I=>I.fetchCandidates(M,B,q)))).flat()});return function(M,B,q){return x.apply(this,arguments)}}();E.processCandidates=function(x,M,B){if(1>M.length)return this.doneSnapping(),{snappedPoint:B.coordinateHelper.vectorToDehydratedPoint(x),hints:[]};
n.sortCandidatesInPlace(x,M);const q=this._currentMainCandidate;if(F.isSome(q)){const I=this.findOldConstraintInNewCandidates(q,M);if(0<=I)if(M[I]instanceof u.IntersectionSnappingCandidate){if(e.squaredDistance(x,q.targetPoint)<this.squaredPointProximityThreshold(B.pointer))return this.updateSnappingCandidate(q,M,B)}else return this.intersectWithOtherCandidates(I,M,x,B)}return this.intersectWithOtherCandidates(0,M,x,B)};E.findOldConstraintInNewCandidates=function(x,M){return x instanceof u.IntersectionSnappingCandidate?
0<=this.findOldCandidateIndex(M,x.first)&&0<=this.findOldCandidateIndex(M,x.second)?0:-1:this.findOldCandidateIndex(M,x)};E.intersectWithOtherCandidates=function(x,M,B,q){const I=M[x],A=[],N=q.coordinateHelper;for(let V=0;V<M.length;++V){if(V===x)continue;const X=M[V];for(const T of I.constraint.intersect(X.constraint)){const v=N.fromXYZ(T.intersection,I.targetPoint[2]);A.push([new u.IntersectionSnappingCandidate(N,v,I,X),n.squareDistance(n.anyMapPointToScreenPoint(B,q.coordinateHelper,q.elevationInfo,
this.view),n.anyMapPointToScreenPoint(v,q.coordinateHelper,q.elevationInfo,this.view))])}}return 0<A.length&&(A.sort((V,X)=>V[1]-X[1]),A[0][1]<this.squaredPointProximityThreshold(q.pointer))?this.updateSnappingCandidate(A[0][0],M,q):this.updateSnappingCandidate(I,M,q)};E.updateSnappingCandidate=function(x,M,B){this.doneSnapping();this._currentMainCandidate=x;const q=this._currentMainCandidate.targetPoint,I=[];I.push(...x.hints);for(const A of M){if(x instanceof u.IntersectionSnappingCandidate){if(A.constraint.objectEqual(x.first.constraint)||
A.constraint.objectEqual(x.second.constraint))continue}else if(A.constraint.objectEqual(x.constraint))continue;A.constraint.check(q)&&(A.targetPoint=q,this._currentOtherActiveCandidates.push(A),I.push(...A.hints))}return{snappedPoint:B.coordinateHelper.vectorToDehydratedPoint(q),hints:I}};E.squaredPointProximityThreshold=function(x){return"touch"===x?this.squaredTouchProximityThreshold:this.squaredMouseProximityTreshold};E.findOldCandidateIndex=function(x,M){let B=-1;for(let q=0;q<x.length;++q)if(M.constraint.objectEqual(x[q].constraint)){B=
q;break}return B};g._createClass(p,[{key:"updating",get:function(){return this.engines.some(x=>x.updating)}},{key:"squaredMouseProximityTreshold",get:function(){return this.options.distance*this.options.distance}},{key:"squaredTouchProximityThreshold",get:function(){const {distance:x,touchSensitivityMultiplier:M}=this.options,B=x*M;return B*B}},{key:"test",get:function(){return{visualizationsActive:this.handles.has("visualization-handle"),engines:this.engines}}}]);return p}(w.EventedMixin(z.HandleOwner));
a.__decorate([K.property({constructOnly:!0})],f.SnappingManager.prototype,"view",void 0);a.__decorate([K.property()],f.SnappingManager.prototype,"options",void 0);a.__decorate([K.property({readOnly:!0})],f.SnappingManager.prototype,"updating",null);a.__decorate([K.property()],f.SnappingManager.prototype,"engines",void 0);a.__decorate([K.property()],f.SnappingManager.prototype,"squaredMouseProximityTreshold",null);a.__decorate([K.property()],f.SnappingManager.prototype,"squaredTouchProximityThreshold",
null);f.SnappingManager=a.__decorate([b.subclass("esri.views.interactive.snapping.SnappingManager")],f.SnappingManager);Object.defineProperty(f,"__esModule",{value:!0})})},"esri/chunks/vec2":function(){define(["exports","./common"],function(f,g){function a(C,P){C[0]=P[0];C[1]=P[1];return C}function w(C,P,S){C[0]=P;C[1]=S;return C}function z(C,P,S){C[0]=P[0]+S[0];C[1]=P[1]+S[1];return C}function F(C,P,S){C[0]=P[0]-S[0];C[1]=P[1]-S[1];return C}function J(C,P,S){C[0]=P[0]*S[0];C[1]=P[1]*S[1];return C}
function G(C,P,S){C[0]=P[0]/S[0];C[1]=P[1]/S[1];return C}function K(C,P){C[0]=Math.ceil(P[0]);C[1]=Math.ceil(P[1]);return C}function D(C,P){C[0]=Math.floor(P[0]);C[1]=Math.floor(P[1]);return C}function t(C,P,S){C[0]=Math.min(P[0],S[0]);C[1]=Math.min(P[1],S[1]);return C}function m(C,P,S){C[0]=Math.max(P[0],S[0]);C[1]=Math.max(P[1],S[1]);return C}function b(C,P){C[0]=Math.round(P[0]);C[1]=Math.round(P[1]);return C}function c(C,P,S){C[0]=P[0]*S;C[1]=P[1]*S;return C}function e(C,P,S,aa){C[0]=P[0]+S[0]*
aa;C[1]=P[1]+S[1]*aa;return C}function h(C,P){const S=P[0]-C[0];C=P[1]-C[1];return Math.sqrt(S*S+C*C)}function r(C,P){const S=P[0]-C[0];C=P[1]-C[1];return S*S+C*C}function d(C){const P=C[0];C=C[1];return Math.sqrt(P*P+C*C)}function k(C){const P=C[0];C=C[1];return P*P+C*C}function n(C,P){C[0]=-P[0];C[1]=-P[1];return C}function u(C,P){C[0]=1/P[0];C[1]=1/P[1];return C}function l(C,P){var S=P[0];const aa=P[1];S=S*S+aa*aa;0<S&&(S=1/Math.sqrt(S),C[0]=P[0]*S,C[1]=P[1]*S);return C}function p(C,P){return C[0]*
P[0]+C[1]*P[1]}function E(C,P,S){P=P[0]*S[1]-P[1]*S[0];C[0]=C[1]=0;C[2]=P;return C}function x(C,P,S,aa){const ca=P[0];P=P[1];C[0]=ca+aa*(S[0]-ca);C[1]=P+aa*(S[1]-P);return C}function M(C,P){P=P||1;const S=2*g.RANDOM()*Math.PI;C[0]=Math.cos(S)*P;C[1]=Math.sin(S)*P;return C}function B(C,P,S){const aa=P[0];P=P[1];C[0]=S[0]*aa+S[2]*P;C[1]=S[1]*aa+S[3]*P;return C}function q(C,P,S){const aa=P[0];P=P[1];C[0]=S[0]*aa+S[2]*P+S[4];C[1]=S[1]*aa+S[3]*P+S[5];return C}function I(C,P,S){const aa=P[0];P=P[1];C[0]=
S[0]*aa+S[3]*P+S[6];C[1]=S[1]*aa+S[4]*P+S[7];return C}function A(C,P,S){const aa=P[0];P=P[1];C[0]=S[0]*aa+S[4]*P+S[12];C[1]=S[1]*aa+S[5]*P+S[13];return C}function N(C,P,S,aa){const ca=P[0]-S[0];P=P[1]-S[1];const ia=Math.sin(aa);aa=Math.cos(aa);C[0]=ca*aa-P*ia+S[0];C[1]=ca*ia+P*aa+S[1];return C}function V(C,P){var S=C[0];C=C[1];const aa=P[0];P=P[1];let ca=S*S+C*C;0<ca&&(ca=1/Math.sqrt(ca));let ia=aa*aa+P*P;0<ia&&(ia=1/Math.sqrt(ia));S=(S*aa+C*P)*ca*ia;return 1<S?0:-1>S?Math.PI:Math.acos(S)}function X(C){return"vec2("+
C[0]+", "+C[1]+")"}function T(C,P){return C[0]===P[0]&&C[1]===P[1]}function v(C,P){const S=C[0];C=C[1];const aa=P[0];P=P[1];return Math.abs(S-aa)<=g.EPSILON*Math.max(1,Math.abs(S),Math.abs(aa))&&Math.abs(C-P)<=g.EPSILON*Math.max(1,Math.abs(C),Math.abs(P))}function L(C,P,S,aa,ca){let ia=P[0]-S[0];S=P[1]-S[1];ca=(aa[0]*ia+aa[1]*S)*(ca-1);ia=aa[0]*ca;S=aa[1]*ca;C[0]=P[0]+ia;C[1]=P[1]+S;return C}var y=Object.freeze({__proto__:null,copy:a,set:w,add:z,subtract:F,multiply:J,divide:G,ceil:K,floor:D,min:t,
max:m,round:b,scale:c,scaleAndAdd:e,distance:h,squaredDistance:r,length:d,squaredLength:k,negate:n,inverse:u,normalize:l,dot:p,cross:E,lerp:x,random:M,transformMat2:B,transformMat2d:q,transformMat3:I,transformMat4:A,rotate:N,angle:V,str:X,exactEquals:T,equals:v,projectAndScale:L,len:d,sub:F,mul:J,div:G,dist:h,sqrDist:r,sqrLen:k});f.add=z;f.angle=V;f.ceil=K;f.copy=a;f.cross=E;f.dist=h;f.distance=h;f.div=G;f.divide=G;f.dot=p;f.equals=v;f.exactEquals=T;f.floor=D;f.inverse=u;f.len=d;f.length=d;f.lerp=
x;f.max=m;f.min=t;f.mul=J;f.multiply=J;f.negate=n;f.normalize=l;f.projectAndScale=L;f.random=M;f.rotate=N;f.round=b;f.scale=c;f.scaleAndAdd=e;f.set=w;f.sqrDist=r;f.sqrLen=k;f.squaredDistance=r;f.squaredLength=k;f.str=X;f.sub=F;f.subtract=F;f.transformMat2=B;f.transformMat2d=q;f.transformMat3=I;f.transformMat4=A;f.vec2=y})},"esri/views/interactive/snapping/FeatureSnappingEngine":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/HandleOwner ../../../core/Handles ../../../core/MapUtils ../../../core/maybe ../../../core/promiseUtils ../../../core/watchUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../../../chunks/vec3f64 ./SnappingConstraint ./snappingUtils ./candidates/EdgeSnappingCandidate ./candidates/FeatureSnappingCandidate ./candidates/RightAngleSnappingCandidate".split(" "),
function(f,g,a,w,z,F,J,G,K,D,t,m,b,c,e,h,r,d,k,n,u){g.FeatureSnappingEngine=function(E){function x(B){B=E.call(this,B)||this;B.sourceModules={featureService:{module:null,loader:null},featureCollection:{module:null,loader:null},graphics:{module:null,loader:null}};return B}a._inheritsLoose(x,E);var M=x.prototype;M.initialize=function(){this.updatingHandles.add(this,"snappingSources",()=>{this.notifyChange("updating")},1);G.isSome(this.view)&&this.handles.add([this.view.on("layerview-create",B=>this.updateLayerView(B.layer,
B.layerView)),this.view.on("layerview-destroy",B=>this.updateLayerView(B.layer,null))])};M.updateLayerView=function(B,q){for(const [,I]of this.snappingSources)I.snappingSource.layerSource.layer===B&&(I.layerView=q)};M.destroy=function(){this._set("options",null);for(const [,B]of this.snappingSources)B.destroy()};M.fetchCandidates=function(){var B=a._asyncToGenerator(function*(q,I,A){if(!this.options.effectiveFeatureEnabled)return[];var N=[];const V=this.computeScreeenSizeDistanceParameters(q,I),X=
{distance:V,point:q,coordinateHelper:I.coordinateHelper,types:this.types,filter:null};for(const [,{snappingSource:T,layerView:v}]of this.snappingSources)!T.layerSource.enabled||G.isSome(v)&&v.suspended||N.push(T.fetchCandidates(X,A).then(L=>L.filter(y=>!this.candidateIsExcluded(T,y,I.excludeFeature))));N=(yield K.eachAlwaysValues(N)).flat();this.addRightAngleCandidates(N,q,V,I);K.throwIfAborted(A);d.sortCandidatesInPlace(q,N);return N});return function(q,I,A){return B.apply(this,arguments)}}();M.addRightAngleCandidates=
function(B,q,I,A){var N,V,X,T,v,L,y,C;const P=G.isSome(A.vertexHandle)?null==(N=A.vertexHandle.rightEdge)?void 0:null==(V=N.rightVertex)?void 0:V.pos:G.isSome(A.editGeometryOperations)&&"polygon"===A.editGeometryOperations.data.type?null==(X=G.unwrap(null==(T=A.editGeometryOperations.data.components[0])?void 0:T.getFirstVertex()))?void 0:X.pos:null;N=G.isSome(A.vertexHandle)?null==(v=A.vertexHandle.leftEdge)?void 0:null==(L=v.leftVertex)?void 0:L.pos:G.isSome(A.editGeometryOperations)?null==(y=G.unwrap(null==
(C=A.editGeometryOperations.data.components[0])?void 0:C.getLastVertex()))?void 0:y.pos:null;v=B.length;for(L=0;L<v;L++)this.addRightAngleCandidate(B[L],N,q,I,A,B),this.addRightAngleCandidate(B[L],P,q,I,A,B)};M.addRightAngleCandidate=function(B,q,I,A,N,V){if(!G.isNone(q)&&B instanceof k.EdgeSnappingCandidate){var X=B.constraint.closestTo(q),T=(X[0]-I[0])/A.x;I=(X[1]-I[1])/A.y;1>=T*T+I*I&&(N=N.coordinateHelper,V.push(new u.RightAngleSnappingCandidate({coordinateHelper:N,targetPoint:X,otherVertex:q,
otherVertexType:0,previousVertex:B.constraint.start,constraint:new r.RayConstraint(N,q,X),objectId:B.objectId})))}};M.computeScreeenSizeDistanceParameters=function(B,q){const I=this.options.distance*("touch"===q.pointer?this.options.touchSensitivityMultiplier:1);return G.isNone(this.view)?{x:I,y:I}:"2d"===this.view.type?{x:I*this.view.resolution,y:I*this.view.resolution}:this.computeScreeenSizeDistanceParameters3D(B,I,this.view,q)};M.computeScreeenSizeDistanceParameters3D=function(B,q,I,A){const {coordinateHelper:N,
elevationInfo:V}=A,X=I.state.camera.computeScreenPixelSizeAt(d.anyMapPointToRender(B,N,V,I,p))*I.renderCoordsHelper.unitInMeters/I.mapCoordsHelper.unitInMeters;q*=X;const T=this.computeScreenMagnitudeOfMapOffset(B,X,0,I,A);B=this.computeScreenMagnitudeOfMapOffset(B,0,X,I,A);return{x:q/T,y:q/B}};M.computeScreenMagnitudeOfMapOffset=function(B,q,I,A,{coordinateHelper:N,elevationInfo:V}){const X=N.clone(B);X[0]+=q;X[1]+=I;B=d.anyMapPointToScreenPoint(B,N,V,A);N=d.anyMapPointToScreenPoint(X,N,V,A);A=N.x-
B.x;N=N.y-B.y;return Math.sqrt(A*A+N*N)};M.candidateIsExcluded=function(B,q,I){if(G.isNone(I))return!1;q=this.getCandidateObjectId(q);if(G.isNone(q))return!1;B=B.layerSource.layer;return"graphics"===B.type?I.uid===q:I.sourceLayer===B&&I.attributes&&"objectIdField"in B?I.attributes[B.objectIdField]===q:!1};M.getCandidateObjectId=function(B){return B instanceof n.FeatureSnappingCandidate?B.objectId:null};M.createSourceInfo=function(B){const q=this.createFeatureSnappingSourceType(B);if(G.isNone(q))return null;
if("loading"in q)return this.updatingHandles.addPromise(q.loading.then(()=>{this.destroyed||this.notifyChange("snappingSources")})),null;const I=G.isSome(this.view)?this.view.allLayerViews.find(A=>A.layer===B.layer):null;return new l(q.source,I)};M.createFeatureSnappingSourceType=function(B){switch(B.layer.type){case "feature":case "geojson":case "csv":case "subtype-group":case "wfs":return this.createFeatureSnappingSourceFeatureLayer(B);case "graphics":return this.createFeatureSnappingSourceGraphicsLayer(B)}return null};
M.createFeatureSnappingSourceFeatureLayer=function(B){switch(B.layer.source.type){case "feature-layer":var q=this.getSourceModule("featureService");return G.isSome(q.module)?{source:new q.module.FeatureServiceSnappingSource({spatialReference:this.spatialReference,view:this.view,layerSource:B})}:{loading:q.loader};case "memory":case "csv":case "geojson":case "wfs":if("mesh"!==B.layer.geometryType)return q=this.getSourceModule("featureCollection"),G.isSome(q.module)?{source:new q.module.FeatureCollectionSnappingSource({layerSource:B})}:
{loading:q.loader}}return null};M.createFeatureSnappingSourceGraphicsLayer=function(B){const q=this.getSourceModule("graphics");return G.isSome(q.module)?{source:new q.module.GraphicsSnappingSource({spatialReference:this.spatialReference,view:this.view,layerSource:B})}:{loading:q.loader}};M.getSourceModule=function(B){const q=this.sourceModules[B];return G.isNone(q.loader)?(B=this.loadSourceModule(B).then(I=>{q.module=I}),q.loader=B,{module:q.module,loader:B}):{module:q.module,loader:q.loader}};M.loadSourceModule=
function(B){switch(B){case "featureService":return this.updatingHandles.addPromise(new Promise(function(q,I){f(["./featureSources/FeatureServiceSnappingSource"],q,I)}));case "featureCollection":return this.updatingHandles.addPromise(new Promise(function(q,I){f(["./featureSources/FeatureCollectionSnappingSource"],q,I)}));case "graphics":return this.updatingHandles.addPromise(new Promise(function(q,I){f(["./featureSources/GraphicsSnappingSource"],q,I)}))}return null};a._createClass(x,[{key:"updating",
get:function(){return J.someMap(this.snappingSources,({snappingSource:B})=>B.updating)||this.updatingHandles.updating}},{key:"snappingSources",get:function(){var B;const q=this._get("snappingSources")||new Map,I=new Map;if(null!=(B=this.options)&&B.featureSources)for(const N of this.options.featureSources.items){B=N.layer.uid;var A=q.get(B);A?(q.delete(B),I.set(B,A)):N.layer.loaded?(A=this.createSourceInfo(N),G.isSome(A)&&I.set(B,A)):this.updatingHandles.addPromise(N.layer.load())}for(const [,N]of q)N.destroy();
return I}},{key:"types",get:function(){return 3}}]);return x}(z.HandleOwner);w.__decorate([t.property({constructOnly:!0})],g.FeatureSnappingEngine.prototype,"spatialReference",void 0);w.__decorate([t.property({constructOnly:!0})],g.FeatureSnappingEngine.prototype,"view",void 0);w.__decorate([t.property()],g.FeatureSnappingEngine.prototype,"options",void 0);w.__decorate([t.property({readOnly:!0})],g.FeatureSnappingEngine.prototype,"updating",null);w.__decorate([t.property({readOnly:!0})],g.FeatureSnappingEngine.prototype,
"snappingSources",null);g.FeatureSnappingEngine=w.__decorate([e.subclass("esri.views.interactive.snapping.FeatureSnappingEngine")],g.FeatureSnappingEngine);let l=function(){function E(x,M){this.snappingSource=x;this.layerView=M;this.handles=new F;M=this.snappingSource.layerSource.layer;"refresh"in M&&this.handles.add(M.on("refresh",()=>x.refresh()));this.handles.add([D.init(x,"updating",B=>x.layerSource.updating=B,!0),D.init(x,"availability",B=>x.layerSource.availability=B,!0)])}E.prototype.destroy=
function(){this.snappingSource.destroy();this.handles.destroy()};return E}();const p=h.create();Object.defineProperty(g,"__esModule",{value:!0})})},"esri/views/interactive/snapping/SnappingConstraint":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/vec2 ../../../chunks/vec2f64 ./Settings ./snappingUtils ../../support/geometry2dUtils".split(" "),function(f,g,a,w,z,F,J){let G=function(e){this.coordinateHelper=e},K=function(e){function h(d,k){d=e.call(this,d)||this;
d.point=k;return d}g._inheritsLoose(h,e);var r=h.prototype;r.objectEqual=function(d){return d instanceof h?F.objectEqual(this.point,d.point):!1};r.check=function(d){return a.squaredDistance(d,this.point)<z.defaults.pointThreshold};r.closestTo=function(){return this.coordinateHelper.clone(this.point)};r.intersect=function(d){const k=[];d instanceof D?k.push(...J.intersectLineAndPoint({start:d.start,end:d.end,type:d instanceof m?1:0},this.point)):d instanceof c&&k.push(...J.intersectCircleAndPoint(d.center,
d.radius,this.point));return k.map(n=>new b(this.coordinateHelper,n,this,d))};return h}(G),D=function(e){function h(d,k,n){d=e.call(this,d)||this;d.start=k;d.end=n;return d}g._inheritsLoose(h,e);var r=h.prototype;r.objectEqual=function(d){return d instanceof h?F.objectEqual(this.start,d.start)&&F.objectEqual(this.end,d.end):!1};r.intersect=function(d){const k=[];d instanceof K?k.push(...J.intersectLineAndPoint({start:this.start,end:this.end,type:this instanceof m?1:0},d.point)):d instanceof h?k.push(...J.intersectLineAndRay({start:this.start,
end:this.end,type:this instanceof m?1:0},{start:d.start,end:d.end,type:d instanceof m?1:0})):d instanceof c&&k.push(...J.intersectLineLikeAndCircle({start:this.start,end:this.end,type:this instanceof m?1:0},d.center,d.radius));return k.map(n=>new b(this.coordinateHelper,n,this,d))};return h}(G),t=function(e){function h(d,k,n){d=e.call(this,d,k,n)||this;d.dir=w.create();d.p=w.create();return d}g._inheritsLoose(h,e);var r=h.prototype;r.objectEqual=function(d){return d instanceof h?e.prototype.objectEqual.call(this,
d):!1};r.check=function(d){a.subtract(this.dir,this.end,this.start);a.subtract(this.p,d,this.start);return 0<=a.dot(this.dir,this.p)?J.pointToLineDistance(d,this.start,this.end)<z.defaults.pointOnLineThreshold:!1};r.closestTo=function(d){const k=this.coordinateHelper.clone(d);J.projectPointToRay(k,d,this.start,this.end);return k};return h}(D),m=function(e){function h(d,k,n){return e.call(this,d,k,n)||this}g._inheritsLoose(h,e);var r=h.prototype;r.objectEqual=function(d){return d instanceof h?e.prototype.objectEqual.call(this,
d):!1};r.check=function(d){return J.pointToLineDistance(d,this.start,this.end)<z.defaults.pointOnLineThreshold};r.closestTo=function(d){const k=this.coordinateHelper.clone(d);J.projectPointToLine(k,d,this.start,this.end);return k};return h}(D),b=function(e){function h(d,k,n,u){d=e.call(this,d)||this;d.intersection=k;d.first=n;d.second=u;return d}g._inheritsLoose(h,e);var r=h.prototype;r.objectEqual=function(d){return d instanceof h?this.first.objectEqual(d.first)&&this.second.objectEqual(d.second):
!1};r.check=function(){return!1};r.closestTo=function(d){d=this.coordinateHelper.clone(d);a.copy(d,this.intersection);return d};r.intersect=function(){return[]};return h}(G),c=function(e){function h(d,k,n){d=e.call(this,d)||this;d.center=k;d.radius=n;return d}g._inheritsLoose(h,e);var r=h.prototype;r.objectEqual=function(d){return d instanceof h?this.center[0]===d.center[0]&&this.center[1]===d.center[1]&&this.radius===d.radius:!1};r.check=function(){return!1};r.closestTo=function(d){const k=this.coordinateHelper.clone(d);
J.projectPointToCircle(k,d,this.center,this.radius);return k};r.intersect=function(d){const k=[];d instanceof D?k.push(...J.intersectLineLikeAndCircle({start:d.start,end:d.end,type:d instanceof m?1:0},this.center,this.radius)):d instanceof K&&k.push(...J.intersectCircleAndPoint(this.center,this.radius,d.point));return k.map(n=>new b(this.coordinateHelper,n,this,d))};return h}(G);f.IntersectionConstraint=b;f.LineConstraint=m;f.LineLikeConstraint=D;f.PlanarCircleConstraint=c;f.PointConstraint=K;f.RayConstraint=
t;f.SnappingConstraint=G;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/chunks/vec2f64":function(){define(["exports"],function(f){function g(){return[0,0]}function a(h){return[h[0],h[1]]}function w(h,r){return[h,r]}function z(h){const r=[0,0],d=Math.min(2,h.length);for(let k=0;k<d;++k)r[k]=h[k];return r}function F(h,r){return new Float64Array(h,r,2)}function J(){return[0,0]}function G(){return[1,1]}function K(){return[1,0]}function D(){return[0,1]}const t=[0,0],m=[1,1],b=[1,0],c=[0,1];
var e=Object.freeze({__proto__:null,create:g,clone:a,fromValues:w,fromArray:z,createView:F,zeros:J,ones:G,unitX:K,unitY:D,ZEROS:t,ONES:m,UNIT_X:b,UNIT_Y:c});f.ONES=m;f.UNIT_X=b;f.UNIT_Y=c;f.ZEROS=t;f.clone=a;f.create=g;f.createView=F;f.fromArray=z;f.fromValues=w;f.ones=G;f.unitX=K;f.unitY=D;f.vec2f64=e;f.zeros=J})},"esri/views/interactive/snapping/snappingUtils":function(){define("exports ../../../core/screenUtils ../../../chunks/vec2 ../../../chunks/vec3f64 ../../../geometry/Point ../../../support/elevationInfoUtils".split(" "),
function(f,g,a,w,z,F){function J(t,m,b,c,e=w.create()){t=m.toXYZ(t);t[2]=F.getConvertedElevationFromVector(c,t,m.spatialReference,b)||0;c.renderCoordsHelper.toRenderCoords(t,m.spatialReference,e);return e}const G=w.create(),K=g.createScreenPointArray(),D=new z;f.anyMapPointToRender=J;f.anyMapPointToScreenPoint=function(t,m,b,c){if("2d"===c.type)return c.toScreen(m.vectorToPoint(t,D));J(t,m,b,c,G);c.state.camera.projectToScreen(G,K);return g.createScreenPoint(K[0],K[1])};f.anyMapPointsToRenderWithEqualZ=
function(t,m,b,c,e,h,r){t=b.toXYZ(t);m=b.toXYZ(m);const d=F.getConvertedElevationFromVector(e,t,b.spatialReference,c);c=F.getConvertedElevationFromVector(e,m,b.spatialReference,c);c=(null==d?c:null==c?d:Math.min(d,c))||0;t[2]=c;m[2]=c;e.renderCoordsHelper.toRenderCoords(t,b.spatialReference,h);e.renderCoordsHelper.toRenderCoords(m,b.spatialReference,r)};f.objectEqual=function(t,m){const b=t.length===m.length&&t[0]===m[0]&&t[1]===m[1];switch(t.length){case 2:return b;case 3:return b&&t[2]===m[2];case 4:return b&&
t[3]===m[3]}return!1};f.sortCandidatesInPlace=function(t,m){m.sort((b,c)=>{b=a.squaredDistance(b.targetPoint,t);c=a.squaredDistance(c.targetPoint,t);return b-c})};f.squareDistance=function(t,m){const b=t.x-m.x;t=t.y-m.y;return b*b+t*t};Object.defineProperty(f,"__esModule",{value:!0})})},"esri/views/support/geometry2dUtils":function(){define(["exports","../../core/mathUtils","../../chunks/vec2","../../chunks/vec2f64"],function(f,g,a,w){function z(b,c){return b[0]*c[1]-b[1]*c[0]}function F(b,c,e){c=
a.dot(e,c)/a.squaredLength(e);return a.scale(b,e,c)}function J(b,c,e,h,r=e){a.subtract(K,h,e);a.subtract(t,c,r);F(m,t,K);return a.add(b,r,m)}function G(b,c,e,h){a.subtract(K,c,e);c=h/a.length(K);return a.scaleAndAdd(b,e,K,c)}const K=w.create(),D=w.create(),t=w.create(),m=w.create();f.cross=z;f.intersectCircleAndPoint=function(b,c,e){G(t,e,b,c);return g.floatEqualAbsolute(t[0],e[0])&&g.floatEqualAbsolute(t[1],e[1])?[w.clone(e)]:[]};f.intersectLineAndPoint=function(b,c){J(t,c,b.start,b.end);return g.floatEqualAbsolute(t[0],
c[0])&&g.floatEqualAbsolute(t[1],c[1])?[w.clone(c)]:[]};f.intersectLineAndRay=function(b,c){const e=b.start;var h=c.start,r=c.end;const d=a.subtract(K,b.end,e);var k=a.subtract(D,r,h);r=z(d,k);if(1E-6>=Math.abs(r))return[];h=a.subtract(t,e,h);k=z(k,h)/r;r=z(d,h)/r;if(0<=k){if(0<=r||1===c.type)return[a.scaleAndAdd(m,e,d,k)]}else if(1===b.type&&(0<=r||1===c.type))return[a.scaleAndAdd(m,e,d,k)];return[]};f.intersectLineLikeAndCircle=function(b,c,e){const h=[],r=a.subtract(K,b.end,b.start);var d=a.subtract(D,
b.start,c);c=a.squaredLength(r);const k=2*a.dot(r,d);e=a.squaredLength(d)-e*e;e=k*k-4*c*e;0===e?(c=-k/(2*c),(1===b.type||0<=c)&&h.push(a.scaleAndAdd(m,b.start,r,c))):0<e&&(e=Math.sqrt(e),d=(-k+e)/(2*c),(1===b.type||0<=d)&&h.push(a.scaleAndAdd(m,b.start,r,d)),c=(-k-e)/(2*c),(1===b.type||0<=c)&&h.push(a.scaleAndAdd(t,b.start,r,c)));return h};f.pointToLineDistance=function(b,c,e){return Math.abs((c[0]-b[0])*(e[1]-b[1])-(c[1]-b[1])*(e[0]-b[0]))/a.distance(c,e)};f.projectPoint=F;f.projectPointToCircle=
G;f.projectPointToLine=J;f.projectPointToRay=function(b,c,e,h){a.subtract(K,h,e);a.subtract(t,c,e);c=a.dot(K,t)/a.squaredLength(K);return 0<c?a.scaleAndAdd(b,e,K,c):a.copy(b,e)};Object.defineProperty(f,"__esModule",{value:!0})})},"esri/views/interactive/snapping/candidates/EdgeSnappingCandidate":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../SnappingConstraint","./FeatureSnappingCandidate","../hints/LineSnappingHint"],function(f,g,a,w,z){w=function(F){function J(G){return F.call(this,
{...G,constraint:new a.LineConstraint(G.coordinateHelper,G.edgeStart,G.edgeEnd)})||this}g._inheritsLoose(J,F);g._createClass(J,[{key:"hints",get:function(){return[new z.LineSnappingHint(1,this.constraint.start,this.constraint.end)]}}]);return J}(w.FeatureSnappingCandidate);f.EdgeSnappingCandidate=w;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/views/interactive/snapping/candidates/FeatureSnappingCandidate":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","./SnappingCandidate"],
function(f,g,a){a=function(w){function z({coordinateHelper:F,targetPoint:J,objectId:G,constraint:K}){F=w.call(this,F,J,K)||this;F.objectId=G;return F}g._inheritsLoose(z,w);return z}(a.SnappingCandidate);f.FeatureSnappingCandidate=a;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/views/interactive/snapping/candidates/SnappingCandidate":function(){define(["exports"],function(f){f.SnappingCandidate=function(g,a,w){this.coordinateHelper=g;this.targetPoint=a;this.constraint=w};Object.defineProperty(f,
"__esModule",{value:!0})})},"esri/views/interactive/snapping/hints/LineSnappingHint":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/Logger ../snappingUtils ./SnappingHint".split(" "),function(f,g,a,w,z,F){w.getLogger("esri.views.interactive.snapping.hints.LineSnappingHint");a=function(J){function G(K,D,t,m=!0,b=!0){var c=J.call(this)||this;c.type=K;c.lineStart=D;c.lineEnd=t;c.fadeLeft=m;c.fadeRight=b;return c}g._inheritsLoose(G,J);G.prototype.equals=
function(K){return K instanceof G?this.type===K.type&&z.objectEqual(this.lineStart,K.lineStart)&&z.objectEqual(this.lineEnd,K.lineEnd)&&this.fadeLeft===K.fadeLeft&&this.fadeRight===K.fadeRight:!1};return G}(F.SnappingHint);f.LineSnappingHint=a;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/views/interactive/snapping/hints/SnappingHint":function(){define(["exports"],function(f){f.SnappingHint=function(){};Object.defineProperty(f,"__esModule",{value:!0})})},"esri/views/interactive/snapping/candidates/RightAngleSnappingCandidate":function(){define(["exports",
"../../../../chunks/_rollupPluginBabelHelpers","./SnappingCandidate","../hints/LineSnappingHint","../hints/RightAngleSnappingHint"],function(f,g,a,w,z){a=function(F){function J({coordinateHelper:G,targetPoint:K,constraint:D,previousVertex:t,otherVertex:m,otherVertexType:b,objectId:c}){G=F.call(this,G,K,D)||this;G.previousVertex=t;G.otherVertex=m;G.otherVertexType=b;G.objectId=c;return G}g._inheritsLoose(J,F);g._createClass(J,[{key:"hints",get:function(){const G=this.previousVertex,K=1===this.otherVertexType?
this.otherVertex:this.targetPoint,D=1===this.otherVertexType?this.targetPoint:this.otherVertex;return[new w.LineSnappingHint(0,K,D),new w.LineSnappingHint(1,G,K),new z.RightAngleSnappingHint(this.previousVertex,K,D)]}}]);return J}(a.SnappingCandidate);f.RightAngleSnappingCandidate=a;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/views/interactive/snapping/hints/RightAngleSnappingHint":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/Logger ../snappingUtils ./SnappingHint".split(" "),
function(f,g,a,w,z,F){w.getLogger("esri.views.interactive.snapping.hints.RightAngleSnappingHint");a=function(J){function G(K,D,t){var m=J.call(this)||this;m.previousVertex=K;m.centerVertex=D;m.nextVertex=t;return m}g._inheritsLoose(G,J);G.prototype.equals=function(K){return K instanceof G?z.objectEqual(this.previousVertex,K.previousVertex)&&z.objectEqual(this.centerVertex,K.centerVertex)&&z.objectEqual(this.nextVertex,K.nextVertex):!1};return G}(F.SnappingHint);f.RightAngleSnappingHint=a;Object.defineProperty(f,
"__esModule",{value:!0})})},"esri/views/interactive/snapping/SelfSnappingEngine":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ./LineSnapper ./ParallelLineSnapper ./RightAngleSnapper ./RightAngleTriangleSnapper ./snappingUtils".split(" "),
function(f,g,a,w,z,F,J,G,K,D,t,m,b,c,e){f.SelfSnappingEngine=function(h){function r(k){k=h.call(this,k)||this;k.updating=!1;k._snappers=new z;return k}g._inheritsLoose(r,h);var d=r.prototype;d.initialize=function(){this._snappers.push(new m.ParallelLineSnapper(this.view,this.options),new t.LineSnapper(this.view,this.options),new b.RightAngleSnapper(this.view,this.options),new c.RightAngleTriangleSnapper(this.view,this.options))};d.fetchCandidates=function(){var k=g._asyncToGenerator(function*(n,u){if(!this.options.effectiveSelfEnabled)return[];
const l=[];for(const p of this._snappers.items)l.push(...p.snap(n,u));e.sortCandidatesInPlace(n,l);return l});return function(n,u){return k.apply(this,arguments)}}();g._createClass(r,[{key:"options",set:function(k){this._set("options",k);for(const n of this._snappers)n.options=k}}]);return r}(w);a.__decorate([F.property({readOnly:!0})],f.SelfSnappingEngine.prototype,"updating",void 0);a.__decorate([F.property({constructOnly:!0})],f.SelfSnappingEngine.prototype,"view",void 0);a.__decorate([F.property()],
f.SelfSnappingEngine.prototype,"options",null);f.SelfSnappingEngine=a.__decorate([D.subclass("esri.views.interactive.snapping.SelfSnappingEngine")],f.SelfSnappingEngine);Object.defineProperty(f,"__esModule",{value:!0})})},"esri/views/interactive/snapping/LineSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/vec2f64 ./SnappingAlgorithm ./snappingUtils ./candidates/LineSnappingCandidate ../../support/geometry2dUtils".split(" "),function(f,
g,a,w,z,F,J,G){z=function(K){function D(){return K.apply(this,arguments)||this}g._inheritsLoose(D,K);var t=D.prototype;t.snapNewVertex=function(m,b){var c=b.editGeometryOperations.data.components[0],e=c.edges.length;const h=[];if(1>e)return h;const r=F.anyMapPointToScreenPoint(m,b.coordinateHelper,b.elevationInfo,this.view);e=c=c.edges[e-1];do this.edgeExceedsShortLineThreshold(e,b)&&this._processCandidateProposal(e.leftVertex.pos,e.rightVertex.pos,m,r,b,h),e=e.leftVertex.leftEdge;while(e&&e!==c);
return h};t.snapExistingVertex=function(m,b){const c=[],e=a.unwrap(b.vertexHandle);var h=e.component;if(2>h.edges.length)return c;const r=F.anyMapPointToScreenPoint(m,b.coordinateHelper,b.elevationInfo,this.view);var d=e.leftEdge;const k=e.rightEdge;d&&k&&this.edgeExceedsShortLineThreshold(d,b)&&this.edgeExceedsShortLineThreshold(k,b)&&this._processCandidateProposal(d.leftVertex.pos,k.rightVertex.pos,m,r,b,c);d=h=h.edges[0];do d!==e.leftEdge&&d!==e.rightEdge&&this.edgeExceedsShortLineThreshold(d,
b)&&this._processCandidateProposal(d.leftVertex.pos,d.rightVertex.pos,m,r,b,c),d=d.rightVertex.rightEdge;while(d&&d!==h);return c};t._processCandidateProposal=function(m,b,c,e,h,r){const d=G.projectPointToLine(w.create(),c,m,b),k=h.coordinateHelper;c=k.fromXYZ(d,k.getZ(c,0));F.squareDistance(e,F.anyMapPointToScreenPoint(c,k,h.elevationInfo,this.view))<this.squaredProximityTreshold(h.pointer)&&r.push(new J.LineSnappingCandidate({coordinateHelper:h.coordinateHelper,lineStart:m,lineEnd:b,targetPoint:c}))};
return D}(z.SnappingAlgorithm);f.LineSnapper=z;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/views/interactive/snapping/SnappingAlgorithm":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../core/maybe","./Settings","./snappingUtils"],function(f,g,a,w,z){let F=function(){function J(K,D){this.view=K;this.options=D;this.squaredShortLineThreshold=w.defaults.shortLineThreshold*w.defaults.shortLineThreshold}var G=J.prototype;G.snap=function(K,D){return a.isSome(D.vertexHandle)?
"vertex"!==D.vertexHandle.type?[]:this.snapExistingVertex(K,D):this.snapNewVertex(K,D)};G.edgeExceedsShortLineThreshold=function(K,D){return this.exceedsShortLineThreshold(K.leftVertex.pos,K.rightVertex.pos,D)};G.exceedsShortLineThreshold=function(K,D,{elevationInfo:t,editGeometryOperations:m}){m=m.data.coordinateHelper;return 0===this.squaredShortLineThreshold||z.squareDistance(z.anyMapPointToScreenPoint(D,m,t,this.view),z.anyMapPointToScreenPoint(K,m,t,this.view))>this.squaredShortLineThreshold};
G.squaredProximityTreshold=function(K){return"touch"===K?this.squaredTouchProximityThreshold:this.squaredMouseProximityTreshold};g._createClass(J,[{key:"squaredMouseProximityTreshold",get:function(){return this.options.distance*this.options.distance}},{key:"squaredTouchProximityThreshold",get:function(){const {distance:K,touchSensitivityMultiplier:D}=this.options,t=K*D;return t*t}}]);return J}();f.SnappingAlgorithm=F;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/views/interactive/snapping/candidates/LineSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/mathUtils ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../SnappingConstraint ./SnappingCandidate ../hints/LineSnappingHint".split(" "),
function(f,g,a,w,z,F,J,G){J=function(t){function m({coordinateHelper:b,lineStart:c,lineEnd:e,targetPoint:h}){b=t.call(this,b,h,new F.LineConstraint(b,c,e))||this;b.referenceLineHint=new G.LineSnappingHint(2,c,e);return b}g._inheritsLoose(m,t);m.prototype.lineEndClosestToTarget=function(){const b=this.constraint.start,c=this.constraint.end;return 0<a.sign(w.dot(w.subtract(D,c,b),w.subtract(K,this.targetPoint,b)))?c:b};g._createClass(m,[{key:"hints",get:function(){return[this.referenceLineHint,new G.LineSnappingHint(0,
this.lineEndClosestToTarget(),this.targetPoint)]}}]);return m}(J.SnappingCandidate);const K=z.create(),D=z.create();f.LineSnappingCandidate=J;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/views/interactive/snapping/ParallelLineSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/vec2 ../../../chunks/vec2f64 ./Settings ./SnappingAlgorithm ./snappingUtils ./candidates/ParallelLineSnappingCandidate ../../support/geometry2dUtils".split(" "),
function(f,g,a,w,z,F,J,G,K,D){J=function(t){function m(){var c=t.apply(this,arguments)||this;c._tmpProjection=z.create();return c}g._inheritsLoose(m,t);var b=m.prototype;b.snapNewVertex=function(c,e){var h=e.editGeometryOperations.data.components[0],r=h.edges.length,d=h.vertices.length;const k=[];if(2>r)return k;const n=G.anyMapPointToScreenPoint(c,e.coordinateHelper,e.elevationInfo,this.view);d=h.vertices[d-1];const u=h.vertices[0];r=h=h.edges[r-1];do this.edgeExceedsShortLineThreshold(r,e)&&(this._checkEdgeForParalleLines(r,
d.pos,c,n,e,k),this._checkEdgeForParalleLines(r,u.pos,c,n,e,k)),r=r.leftVertex.leftEdge;while(r&&r!==h);return k};b.snapExistingVertex=function(c,e){const h=[],r=a.unwrap(e.vertexHandle);var d=r.component;if(3>d.edges.length)return h;const k=G.anyMapPointToScreenPoint(c,e.coordinateHelper,e.elevationInfo,this.view),n=r.leftEdge,u=r.rightEdge,l=d.vertices[0],p=d.vertices[d.vertices.length-1];let E=d=d.edges[0];do E!==n&&E!==u&&this.edgeExceedsShortLineThreshold(E,e)&&(n&&this._checkEdgeForParalleLines(E,
n.leftVertex.pos,c,k,e,h),u&&this._checkEdgeForParalleLines(E,u.rightVertex.pos,c,k,e,h),r===l?this._checkEdgeForParalleLines(E,p.pos,c,k,e,h):r===p&&this._checkEdgeForParalleLines(E,l.pos,c,k,e,h)),E=E.rightVertex.rightEdge;while(E&&E!==d);return h};b._checkEdgeForParalleLines=function(c,e,h,r,d,k){var n=c.leftVertex.pos;const u=c.rightVertex.pos;D.projectPointToLine(this._tmpProjection,e,n,u);w.squaredDistance(this._tmpProjection,e)<F.defaults.parallelLineThreshold||(D.projectPointToLine(this._tmpProjection,
h,n,u,e),n=d.coordinateHelper,h=n.fromXYZ(this._tmpProjection,n.getZ(h,0)),G.squareDistance(r,G.anyMapPointToScreenPoint(h,n,d.elevationInfo,this.view))<this.squaredProximityTreshold(d.pointer)&&!this.parallelToPreviousCandidate(c,k)&&k.push(new K.ParallelLineSnappingCandidate({coordinateHelper:n,referenceLine:c,lineStart:e,targetPoint:h})))};b.parallelToPreviousCandidate=function(c,e){const h=c.leftVertex.pos,r=c.rightVertex.pos;for(const d of e)if(D.projectPointToLine(this._tmpProjection,r,d.constraint.start,
d.constraint.end,h),w.squaredDistance(this._tmpProjection,r)<F.defaults.parallelLineThreshold)return d.addReferenceLine(c),!0;return!1};return m}(J.SnappingAlgorithm);f.ParallelLineSnapper=J;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/views/interactive/snapping/candidates/ParallelLineSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/vec2 ../SnappingConstraint ./SnappingCandidate ../hints/LineSnappingHint ../hints/ParallelSnappingHint".split(" "),
function(f,g,a,w,z,F,J){z=function(G){function K({coordinateHelper:D,referenceLine:t,lineStart:m,targetPoint:b}){const c=D.clone(m);a.subtract(c,a.add(c,c,t.rightVertex.pos),t.leftVertex.pos);D=G.call(this,D,b,new w.LineConstraint(D,m,c))||this;D._referenceLines=[{edge:t,fadeLeft:!0,fadeRight:!0}];return D}g._inheritsLoose(K,G);K.prototype.addReferenceLine=function(D){const t={edge:D,fadeLeft:!0,fadeRight:!0};this._referenceLines.forEach(m=>{D.rightVertex.rightEdge===m.edge&&(m.fadeLeft=!1,t.fadeRight=
!1);D.leftVertex.leftEdge===m.edge&&(m.fadeRight=!1,t.fadeLeft=!1)});this._referenceLines.push(t)};g._createClass(K,[{key:"hints",get:function(){return[new F.LineSnappingHint(0,this.constraint.start,this.targetPoint),new J.ParallelSnappingHint(this.constraint.start,this.targetPoint),...this._referenceLines.map(D=>new F.LineSnappingHint(1,D.edge.leftVertex.pos,D.edge.rightVertex.pos,D.fadeLeft,D.fadeRight))]}}]);return K}(z.SnappingCandidate);f.ParallelLineSnappingCandidate=z;Object.defineProperty(f,
"__esModule",{value:!0})})},"esri/views/interactive/snapping/hints/ParallelSnappingHint":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/Logger ../snappingUtils ./SnappingHint".split(" "),function(f,g,a,w,z,F){w.getLogger("esri.views.interactive.snapping.hints.ParallelSnappingHint");a=function(J){function G(K,D){var t=J.call(this)||this;t.lineStart=K;t.lineEnd=D;return t}g._inheritsLoose(G,J);G.prototype.equals=function(K){return K instanceof
G?z.objectEqual(this.lineStart,K.lineStart)&&z.objectEqual(this.lineEnd,K.lineEnd):!1};return G}(F.SnappingHint);f.ParallelSnappingHint=a;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/views/interactive/snapping/RightAngleSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/mathUtils ../../../core/maybe ../../../chunks/vec2 ../../../chunks/vec2f64 ./SnappingAlgorithm ./SnappingConstraint ./snappingUtils ./candidates/RightAngleSnappingCandidate".split(" "),
function(f,g,a,w,z,F,J,G,K,D){J=function(t){function m(){var c=t.apply(this,arguments)||this;c._tmp=F.create();return c}g._inheritsLoose(m,t);var b=m.prototype;b.snapNewVertex=function(c,e){var h=e.editGeometryOperations.data.components[0],r=h.vertices.length;const d=[];if(2>r)return d;const k=K.anyMapPointToScreenPoint(c,e.coordinateHelper,e.elevationInfo,this.view);r=h.vertices[r-1];this._checkForSnappingCandidate(d,r.leftEdge,r.pos,c,r.leftEdge.leftVertex.pos,r.pos,e,c,k);h=h.vertices[0];this._checkForSnappingCandidate(d,
h.rightEdge,h.pos,c,h.rightEdge.rightVertex.pos,h.pos,e,c,k);return d};b.snapExistingVertex=function(c,e){const h=[];var r=w.unwrap(e.vertexHandle),d=r.component;const k=d.vertices.length;if(3>k)return h;const n=K.anyMapPointToScreenPoint(c,e.coordinateHelper,e.elevationInfo,this.view);var u=r.leftEdge;r=r.rightEdge;const l=d.vertices[0];d=d.vertices[k-1];if(!u)return this._checkForSnappingCandidate(h,l.rightEdge.rightVertex.rightEdge,l.rightEdge.rightVertex.pos,c,l.rightEdge.rightVertex.rightEdge.rightVertex.pos,
l.rightEdge.rightVertex.pos,e,c,n),h;if(!r)return this._checkForSnappingCandidate(h,d.leftEdge.leftVertex.leftEdge,d.leftEdge.leftVertex.pos,c,d.leftEdge.leftVertex.leftEdge.leftVertex.pos,d.leftEdge.leftVertex.pos,e,c,n),h;u&&u.leftVertex.leftEdge&&(d=u.leftVertex.leftEdge,this._checkForSnappingCandidate(h,d,u.leftVertex.pos,c,d.leftVertex.pos,u.leftVertex.pos,e,c,n));r&&r.rightVertex.rightEdge&&(u=r.rightVertex.rightEdge,this._checkForSnappingCandidate(h,u,r.rightVertex.pos,c,u.rightVertex.pos,
r.rightVertex.pos,e,c,n));return h};b._checkForSnappingCandidate=function(c,e,h,r,d,k,n,u,l){this.edgeExceedsShortLineThreshold(e,n)&&(z.subtract(this._tmp,e.rightVertex.pos,e.leftVertex.pos),e=F.fromValues(this._tmp[1],-this._tmp[0]),h=z.dot(e,z.subtract(this._tmp,r,h))/z.squaredLength(e),r=n.coordinateHelper,u=r.fromXYZ(z.scaleAndAdd(F.create(),k,e,h),r.getZ(u,0)),K.squareDistance(l,K.anyMapPointToScreenPoint(u,r,n.elevationInfo,this.view))<this.squaredProximityTreshold(n.pointer)&&c.push(new D.RightAngleSnappingCandidate({coordinateHelper:r,
targetPoint:u,constraint:new G.RayConstraint(r,k,z.scaleAndAdd(r.createVector(),k,e,a.sign(h))),previousVertex:d,otherVertex:k,otherVertexType:1})))};return m}(J.SnappingAlgorithm);f.RightAngleSnapper=J;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/views/interactive/snapping/RightAngleTriangleSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/vec2 ../../../chunks/vec2f64 ./SnappingAlgorithm ./snappingUtils ./candidates/RightAngleTriangleSnappingCandidate ../../support/geometry2dUtils".split(" "),
function(f,g,a,w,z,F,J,G,K){F=function(D){function t(){return D.apply(this,arguments)||this}g._inheritsLoose(t,D);var m=t.prototype;m.snapNewVertex=function(b,c){const e=c.editGeometryOperations.data.components[0],h=[],r=e.vertices.length;if("polygon"!==c.editGeometryOperations.data.type||2>r)return h;this._processCandidateProposal(e.vertices[0].pos,e.vertices[r-1].pos,b,c,h);return h};m.snapExistingVertex=function(b,c){const e=[],h=a.unwrap(c.vertexHandle),r=h.component;if(2>r.edges.length||"polyline"===
c.editGeometryOperations.data.type&&(0===h.index||h.index===r.vertices.length-1))return e;this._processCandidateProposal(h.leftEdge.leftVertex.pos,h.rightEdge.rightVertex.pos,b,c,e);return e};m._processCandidateProposal=function(b,c,e,h,r){if(this.exceedsShortLineThreshold(b,c,h)){var d=w.lerp(z.create(),b,c,.5),k=.5*w.distance(b,c);k=K.projectPointToCircle(z.create(),e,d,k);d=h.coordinateHelper;k=d.fromXYZ(k,d.getZ(e,0));e=J.anyMapPointToScreenPoint(e,d,h.elevationInfo,this.view);J.squareDistance(e,
J.anyMapPointToScreenPoint(k,d,h.elevationInfo,this.view))<this.squaredProximityTreshold(h.pointer)&&r.push(new G.RightAngleTriangleSnappingCandidate({coordinateHelper:d,targetPoint:k,point1:b,point2:c}))}};return t}(F.SnappingAlgorithm);f.RightAngleTriangleSnapper=F;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/views/interactive/snapping/candidates/RightAngleTriangleSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../SnappingConstraint ./SnappingCandidate ../hints/LineSnappingHint ../hints/RightAngleSnappingHint".split(" "),
function(f,g,a,w,z,F,J,G){F=function(D){function t({coordinateHelper:m,targetPoint:b,point1:c,point2:e}){m=D.call(this,m,b,new z.PlanarCircleConstraint(m,a.lerp(K,c,e,.5),.5*a.distance(c,e)))||this;m.p1=c;m.p2=e;return m}g._inheritsLoose(t,D);g._createClass(t,[{key:"hints",get:function(){return[new J.LineSnappingHint(1,this.targetPoint,this.p1),new J.LineSnappingHint(1,this.targetPoint,this.p2),new G.RightAngleSnappingHint(this.p1,this.targetPoint,this.p2)]}}]);return t}(F.SnappingCandidate);const K=
w.create();f.RightAngleTriangleSnappingCandidate=F;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/views/interactive/snapping/candidates/IntersectionSnappingCandidate":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../SnappingConstraint","./SnappingCandidate","../hints/IntersectionSnappingHint"],function(f,g,a,w,z){w=function(F){function J(G,K,D,t){G=F.call(this,G,K,new a.IntersectionConstraint(G,K,D.constraint,t.constraint))||this;G.first=D;G.second=t;return G}
g._inheritsLoose(J,F);g._createClass(J,[{key:"hints",get:function(){this.first.targetPoint=this.targetPoint;this.second.targetPoint=this.targetPoint;return[...this.first.hints,...this.second.hints,new z.IntersectionSnappingHint(this.targetPoint)]}}]);return J}(w.SnappingCandidate);f.IntersectionSnappingCandidate=w;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/views/interactive/snapping/hints/IntersectionSnappingHint":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers",
"../snappingUtils","./SnappingHint"],function(f,g,a,w){w=function(z){function F(J){var G=z.call(this)||this;G.intersectionPoint=J;return G}g._inheritsLoose(F,z);F.prototype.equals=function(J){return J instanceof F?a.objectEqual(this.intersectionPoint,J.intersectionPoint):!1};return F}(w.SnappingHint);f.IntersectionSnappingHint=w;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/widgets/Sketch/support/OperationHandle":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/compilerUtils ../../../core/Evented ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/accessorSupport/decorators/subclass".split(" "),
function(f,g,a,w,z,F,J,G,K,D){f.OperationHandle=function(t){function m(c){c=t.call(this,c)||this;c.cancelled=!1;c.history={undo:[],redo:[]};c.type=null;return c}g._inheritsLoose(m,t);var b=m.prototype;b.addToHistory=function(c){this.history.redo=[];this.history.undo.push(c)};b.resetHistory=function(){this.history.redo=[];this.history.undo=[]};b.canUndo=function(){return 0<this.history.undo.length};b.canRedo=function(){return 0<this.history.redo.length};b.complete=function(){this.reset();this.onEnd();
this.emit("complete")};b.cancel=function(){this.cancelled=!0;this.complete()};b.reset=function(){this.activeComponent.reset()};b.refreshComponent=function(){const c=this.activeComponent;c&&("box"!==c.type&&"reshape"!==c.type&&"graphic-mover"!==c.type||c.refresh())};g._createClass(m,[{key:"tool",get:function(){if(!this.activeComponent)return null;switch(this.activeComponent.type){case "graphic-mover":case "move-3d":return"move";case "box":case "transform-3d":return"transform";case "reshape":case "reshape-3d":return"reshape";
case "draw-2d":case "draw-3d":return this.activeComponent.geometryType;default:w.neverReached(this.activeComponent)}return null}},{key:"undo",set:function(c){this._set("undo",()=>{this.canUndo()&&c()})}},{key:"redo",set:function(c){this._set("redo",()=>{this.canRedo()&&c()})}}]);return m}(z.EventedAccessor);a.__decorate([F.property()],f.OperationHandle.prototype,"activeComponent",void 0);a.__decorate([F.property()],f.OperationHandle.prototype,"cancelled",void 0);a.__decorate([F.property()],f.OperationHandle.prototype,
"history",void 0);a.__decorate([F.property()],f.OperationHandle.prototype,"tool",null);a.__decorate([F.property()],f.OperationHandle.prototype,"type",void 0);a.__decorate([F.property()],f.OperationHandle.prototype,"canUndo",null);a.__decorate([F.property()],f.OperationHandle.prototype,"canRedo",null);a.__decorate([F.property()],f.OperationHandle.prototype,"onEnd",void 0);a.__decorate([F.property()],f.OperationHandle.prototype,"undo",null);a.__decorate([F.property()],f.OperationHandle.prototype,"redo",
null);a.__decorate([F.property()],f.OperationHandle.prototype,"toggleTool",void 0);a.__decorate([F.property()],f.OperationHandle.prototype,"addToSelection",void 0);a.__decorate([F.property()],f.OperationHandle.prototype,"removeFromSelection",void 0);f.OperationHandle=a.__decorate([D.subclass("esri.widgets.Sketch.support.OperationHandle")],f.OperationHandle);f.CreateOperationHandle=function(t){function m(){return t.apply(this,arguments)||this}g._inheritsLoose(m,t);return m}(f.OperationHandle);a.__decorate([F.property()],
f.CreateOperationHandle.prototype,"activeComponent",void 0);f.CreateOperationHandle=a.__decorate([D.subclass("esri.widgets.Sketch.support.CreateOperationHandle")],f.CreateOperationHandle);f.UpdateOperationHandle=function(t){function m(b){return t.call(this,b)||this}g._inheritsLoose(m,t);return m}(f.OperationHandle);a.__decorate([F.property()],f.UpdateOperationHandle.prototype,"activeComponent",void 0);f.UpdateOperationHandle=a.__decorate([D.subclass("esri.widgets.Sketch.support.UpdateOperationHandle")],
f.UpdateOperationHandle);Object.defineProperty(f,"__esModule",{value:!0})})},"esri/widgets/support/SelectionToolbar":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/handleUtils ../../core/maybe ../../core/accessorSupport/decorators/aliasOf ../../core/has ../../core/accessorSupport/decorators/cast ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/subclass ../Widget ./widgetUtils ./decorators/messageBundle ./jsxFactory ./SelectionToolbar/SelectionToolbarViewModel".split(" "),
function(f,g,a,w,z,F,J,G,K,D,t,m,b,c,e,h){const r={lassoTool:!0,rectangleTool:!0},d={createTool:"polygon",createOptions:{mode:"freehand"}},k={createTool:"rectangle"};J=function(n){function u(p,E){var x=n.call(this,p,E)||this;x._viewModelHandlesGroup=null;x.activeToolInfo=null;x.label=void 0;x.layers=[];x.messages=null;x.toolConfigs=[];x.view=null;x.viewModel=new h;x.visibleElements={...r};x._viewModelHandlesGroup=w.handlesGroup([x.viewModel.on("selection-change",M=>x.emit("selection-change",M)),x.viewModel.on("complete",
M=>{x._set("activeToolInfo",null);x.emit("complete",M)})]);return x}g._inheritsLoose(u,n);var l=u.prototype;l.destroy=function(){this._viewModelHandlesGroup=z.removeMaybe(this._viewModelHandlesGroup)};l.loadDependencies=function(){return new Promise(function(p,E){f(["../../chunks/action"],p,E)})};l.castVisibleElements=function(p){return{...r,...p}};l.activate=function(p){this.cancel();switch(p){case "lasso":this._activateTool("lasso");case "rectangle":this._activateTool("rectangle");default:this._activateTool(p)}};
l.cancel=function(){this.viewModel.cancel();this._set("activeToolInfo",null)};l.render=function(){return e.tsx("div",{"aria-label":this.label,class:this.classes("esri-selection-toolbar","esri-widget")},e.tsx("div",{class:"esri-selection-toolbar__container"},this.renderDefaultTools(),this.renderCustomTools()))};l.renderDefaultTools=function(){var p;if("2d"===(null==(p=this.view)?void 0:p.type))return[this.renderRectangleTool(),this.renderLassoTool()]};l.renderCustomTools=function(){if(this.toolConfigs&&
this.toolConfigs.length)return this.toolConfigs.map(p=>{var E;return e.tsx("calcite-action",{active:(null==(E=this.activeToolInfo)?void 0:E.toolName)===p.toolName,bind:this,class:"esri-selection-toolbar__tool-button",icon:p.icon||"selection",label:p.toolName,onclick:()=>this._onCustomToolClick(p.toolName),scale:"s",text:p.toolName,title:p.toolName})})};l.renderLassoTool=function(){const {activeToolInfo:p,messages:E,visibleElements:x}=this;if(x.lassoTool)return e.tsx("calcite-action",{active:"lasso"===
(null==p?void 0:p.toolName),bind:this,icon:"lasso",label:E.selectByLasso,onclick:this._onLassoToolClick,scale:"s",text:E.selectByLasso,title:E.selectByLasso})};l.renderRectangleTool=function(){const {activeToolInfo:p,messages:E,visibleElements:x}=this;if(x.rectangleTool)return e.tsx("calcite-action",{active:"rectangle"===(null==p?void 0:p.toolName),bind:this,icon:"cursor-marquee",label:E.selectByRectangle,onclick:this._onRectangleToolClick,scale:"s",text:E.selectByRectangle,title:E.selectByRectangle})};
l._onCustomToolClick=function(p){this._toggleTool(p)};l._onLassoToolClick=function(){this._toggleTool("lasso")};l._onRectangleToolClick=function(){this._toggleTool("rectangle")};l._activateTool=function(p){var E=this._getToolOptions(p);E&&(E=this.viewModel.activate(E),this._set("activeToolInfo",{toolName:p,operation:E}))};l._toggleTool=function(p){if(this.activeToolInfo){const E=this.activeToolInfo.toolName;this.cancel();if(E===p)return}this._activateTool(p)};l._getToolOptions=function(p){if("lasso"===
p)return d;if("rectangle"===p)return k;const E=this.toolConfigs.find(q=>q.toolName===p);if(E){var {createTool:x,createOptions:M,selectionOptions:B}=E;return{createTool:x,createOptions:M,selectionOptions:B}}};return u}(m);a.__decorate([D.property({readOnly:!0})],J.prototype,"activeToolInfo",void 0);a.__decorate([D.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],J.prototype,"label",void 0);a.__decorate([F.aliasOf("viewModel.layers")],J.prototype,"layers",void 0);a.__decorate([D.property(),
c.messageBundle("esri/widgets/support/SelectionToolbar/t9n/SelectionToolbar")],J.prototype,"messages",void 0);a.__decorate([D.property()],J.prototype,"toolConfigs",void 0);a.__decorate([F.aliasOf("viewModel.view")],J.prototype,"view",void 0);a.__decorate([D.property()],J.prototype,"viewModel",void 0);a.__decorate([D.property()],J.prototype,"visibleElements",void 0);a.__decorate([G.cast("visibleElements")],J.prototype,"castVisibleElements",null);return J=a.__decorate([t.subclass("esri.widgets.support.SelectionToolbar")],
J)})},"esri/widgets/support/SelectionToolbar/SelectionToolbarViewModel":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Evented ../../../core/handleUtils ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../Selector2D".split(" "),function(f,g,a,w,z,F,J,G,K,D,t){a=function(m){function b(e){e=m.call(this,
e)||this;e._operationHandlesGroup=null;e.activeOperation=null;e.layers=null;e.selector=new t;return e}f._inheritsLoose(b,m);var c=b.prototype;c.destroy=function(){this._operationHandlesGroup=z.removeMaybe(this._operationHandlesGroup);this.selector.destroy()};c.cancel=function(){"active"===this.state&&(this.activeOperation.cancel(),this.activeOperation=null);this.selector.candidates=null};c.activate=function(e){const {state:h}=this;if("disabled"!==h)return"active"===h&&this.cancel(),this.selector.candidates=
this._getCandidates(),e=this.selector.draw(e),this._operationHandlesGroup=w.handlesGroup([e.once("complete",r=>this._onOperationComplete(r)),e.on("selection-change",r=>this._onOperationSelectionChange(r))]),this.activeOperation=e};c._getCandidates=function(){let e=[];this.layers.forEach(h=>{e=e.concat(...h.graphics.toArray())});return e};c._onOperationSelectionChange=function(e){this.emit("selection-change",e)};c._onOperationComplete=function(e){this._operationHandlesGroup=z.removeMaybe(this._operationHandlesGroup);
this.activeOperation=null;this.emit("complete",e)};f._createClass(b,[{key:"state",get:function(){var e,h;return this.activeOperation?"active":null!=(e=this.view)&&e.ready&&null!=(h=this.layers)&&h.length?"ready":"disabled"}},{key:"view",set:function(e){this.selector.view=e;this._set("view",e)}}]);return b}(a.EventedAccessor);g.__decorate([F.property()],a.prototype,"activeOperation",void 0);g.__decorate([F.property()],a.prototype,"layers",void 0);g.__decorate([F.property({readOnly:!0})],a.prototype,
"selector",void 0);g.__decorate([F.property({readOnly:!0})],a.prototype,"state",null);g.__decorate([F.property()],a.prototype,"view",null);return a=g.__decorate([D.subclass("esri.widgets.support.SelectionToolbar.SelectionToolbarViewModel")],a)})},"esri/widgets/support/Selector2D":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Collection ../../core/HandleOwner ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/accessorSupport/decorators/subclass ./Selector2D/SelectionOperation2D ./Selector2D/selectorUtils".split(" "),
function(f,g,a,w,z,F,J,G,K,D,t,m){a=function(b){function c(h){h=b.call(this,h)||this;h._defaultSelectionOptions={intersects:!0,overlaps:!0,contains:!0};h.candidates=null;h.options=null;h.view=null;return h}f._inheritsLoose(c,b);var e=c.prototype;e.draw=function(h){const {_defaultSelectionOptions:r,candidates:d,options:k,view:n}=this;return new t({candidates:d,options:{...h,selectionOptions:{...r,...k,...null==h?void 0:h.selectionOptions}},view:n})};e.selectionFrom=function(){var h=f._asyncToGenerator(function*(r,
d){const {_defaultSelectionOptions:k,candidates:n,options:u,view:l}=this,p=new w;yield m.updateSelection({selector:r,candidates:n,currentSelection:p,options:{...k,...u,...d},view:l});return p.toArray()});return function(r,d){return h.apply(this,arguments)}}();return c}(z.HandleOwnerMixin(a));g.__decorate([F.property()],a.prototype,"candidates",void 0);g.__decorate([F.property()],a.prototype,"options",void 0);g.__decorate([F.property({value:null})],a.prototype,"view",void 0);return a=g.__decorate([D.subclass("esri.widgets.support.Selector2D")],
a)})},"esri/widgets/support/Selector2D/SelectionOperation2D":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../symbols ../../../core/Collection ../../../core/Evented ../../../core/Handles ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../../../layers/GraphicsLayer ../../Sketch/SketchViewModel ./selectorUtils ../../../symbols/SimpleFillSymbol ../../../symbols/SimpleLineSymbol ../../../symbols/SimpleMarkerSymbol".split(" "),
function(f,g,a,w,z,F,J,G,K,D,t,m,b,c,e,h,r){a=function(d){function k({candidates:u,options:l,view:p}){var E=d.call(this)||this;E._activeOptions=null;E._dashedFillSymbol=new e({color:[0,0,0,0],outline:{style:"dash",color:[12,207,255],width:2}});E._dashedLineSymbol=new h({style:"dash",color:[12,207,255],width:2});E._defaultOptions={createTool:"rectangle",createOptions:null,selectionOptions:{overlaps:!0,intersects:!0,contains:!1}};E._completed=!1;E._handles=new F;E._sketchViewModel=new b;E._sketchGraphicsLayer=
new m({listMode:"hide",internal:!0});E._transparentPointSymbol=new r({color:[0,0,0,0],outline:{style:"none",width:0}});E.candidates=null;E.geometry=null;E.options=null;E.selection=new w;E.view=null;E.candidates=u;E.options=l;E.view=p;const {_dashedFillSymbol:x,_dashedLineSymbol:M,_sketchViewModel:B,_sketchGraphicsLayer:q,_transparentPointSymbol:I}=f._assertThisInitialized(E);B.set({layer:q,view:E.view,activePointSymbol:I,activeLineSymbol:M,activeVertexSymbol:I,activeFillSymbol:x,pointSymbol:I,polygonSymbol:x,
polylineSymbol:M,vertexSymbol:I});E._handles.add([B.on("create",A=>E._onSketchEvent(A)),B.on(["undo","redo"],A=>E._onSketchEvent(A))]);return E}f._inheritsLoose(k,d);var n=k.prototype;n.initialize=function(){this._load()};n.destroy=function(){this._handles.destroy();this._handles=null};n.cancel=function(){this._sketchViewModel.cancel()};n._load=function(){var u=f._asyncToGenerator(function*(){yield this.view.whenReady();const {options:l}=this,{createTool:p,createOptions:E}=this._activeOptions={...this._defaultOptions,
...l};this._sketchViewModel.create(p,E)});return function(){return u.apply(this,arguments)}}();n._onSketchEvent=function(u){const l="create"===u.type?u.graphic:u.graphics[0];this._processSelectionGeometry((null==l?void 0:l.geometry)||null,"create"===u.type&&"complete"===u.state,"create"===u.type&&"cancel"===u.state)};n._processSelectionGeometry=function(u,l,p){this._set("geometry",u);if(l||p)this._completed=!0;if(p)this._onComplete([],!0);else{var {_activeOptions:E,candidates:x,selection:M,view:B}=
this;c.updateSelection({selector:u,candidates:x,currentSelection:M,options:E.selectionOptions,view:B}).then(({added:q,removed:I})=>{l?this._onComplete(this.selection.toArray(),!1):(q.length||I.length)&&this.emit("selection-change",{added:q,removed:I,type:"selection-change"})})}};n._onComplete=function(u,l){this._handles.removeAll();this.notifyChange("state");this.emit("complete",{aborted:l,selection:u,type:"complete"})};f._createClass(k,[{key:"state",get:function(){const {_completed:u,_sketchViewModel:{state:l}}=
this;return u?"complete":"active"===l?"active":"disabled"}}]);return k}(z.EventedAccessor);g.__decorate([J.property()],a.prototype,"_completed",void 0);g.__decorate([J.property()],a.prototype,"candidates",void 0);g.__decorate([J.property({readOnly:!0})],a.prototype,"geometry",void 0);g.__decorate([J.property()],a.prototype,"options",void 0);g.__decorate([J.property({readOnly:!0})],a.prototype,"selection",void 0);g.__decorate([J.property({readOnly:!0})],a.prototype,"state",null);g.__decorate([J.property({value:null})],
a.prototype,"view",void 0);return a=g.__decorate([t.subclass("esri.widgets.support.Selector2D.SelectionOperation2D")],a)})},"esri/widgets/support/Selector2D/selectorUtils":function(){define(["require","exports","../../../chunks/_rollupPluginBabelHelpers"],function(f,g,a){function w(){return z.apply(this,arguments)}function z(){z=a._asyncToGenerator(function*(){return new Promise(function(K,D){f(["../../../geometry/geometryEngineJSON"],K,D)})});return z.apply(this,arguments)}function F(){return J.apply(this,
arguments)}function J(){J=a._asyncToGenerator(function*(){return w().then(({contains:K,intersects:D,overlaps:t,simplify:m})=>({contains:K,intersects:D,overlaps:t,simplify:m}))});return J.apply(this,arguments)}function G(){G=a._asyncToGenerator(function*(K){const {selector:D,candidates:t,currentSelection:m,options:b,view:c}=K;if(!(t&&t.length&&m&&c))return{added:[],removed:[]};const {overlaps:e,intersects:h,contains:r}=b,{spatialReference:d}=c;if(!D)return{added:[],removed:m.removeAll()};const k=yield F(),
n=[],u=[];t.forEach(l=>{var p=l.geometry;const E=e&&!!k.overlaps(d,D,p),x=h&&!!k.intersects(d,D,p);p=r&&!!k.contains(d,D,p);const M=m.includes(l);E||x||p?!M&&n.push(l):M&&u.push(l)});m.removeMany(u);m.addMany(n);return{added:n,removed:u}});return G.apply(this,arguments)}g.getGeometryEngineOperations=F;g.importGeometryEngine=w;g.updateSelection=function(K){return G.apply(this,arguments)};Object.defineProperty(g,"__esModule",{value:!0})})},"esri/widgets/support/SnappingControls":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/maybe ../../core/accessorSupport/decorators/aliasOf ../../core/has ../../core/accessorSupport/decorators/cast ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/subclass ../Widget ./widgetUtils ./decorators/messageBundle ./jsxFactory ./SnappingControls/SnappingControlsViewModel".split(" "),
function(f,g,a,w,z,F,J,G,K,D,t,m,b,c,e){const h={header:!0,enabledToggle:!0,selfEnabledToggle:!0,featureEnabledToggle:!0,layerList:!0};F=function(r){function d(n,u){u=r.call(this,(()=>{const {view:l,viewModel:p,snappingOptions:E,...x}=n;return x})(),u)||this;u.label=void 0;u.messages=null;u.messagesCommon=null;u.snappingOptions=null;u.view=null;u.visibleElements={...h};u._defaultViewModel=null;null!=n&&n.viewModel?u.viewModel=n.viewModel:(u._defaultViewModel=new e({snappingOptions:n.snappingOptions,
view:n.view}),u.viewModel=u._defaultViewModel);return u}g._inheritsLoose(d,r);var k=d.prototype;k.destroy=function(){this._defaultViewModel=w.destroyMaybe(this._defaultViewModel)};k.loadDependencies=function(){return Promise.all([new Promise(function(n,u){f(["../../chunks/action"],n,u)}),new Promise(function(n,u){f(["../../chunks/block"],n,u)}),new Promise(function(n,u){f(["../../chunks/icon"],n,u)}),new Promise(function(n,u){f(["../../chunks/label"],n,u)}),new Promise(function(n,u){f(["../../chunks/panel"],
n,u)}),new Promise(function(n,u){f(["../../chunks/pick-list"],n,u)}),new Promise(function(n,u){f(["../../chunks/switch"],n,u)})])};k.castVisibleElements=function(n){return{...h,...n}};k.render=function(){const {label:n,visibleElements:{header:u}}=this;return c.tsx("div",{"aria-label":n,class:this.classes("esri-snapping-controls","esri-widget")},c.tsx("div",{class:"esri-snapping-controls__container"},u?this.renderHeaderView():this.renderContent()))};k.renderHeaderView=function(){return c.tsx("calcite-panel",
{heading:this.label,class:"esri-snapping-controls__panel"},this.renderContent())};k.renderContent=function(){return[this.renderToggles(),this.renderLayerList()]};k.renderToggles=function(){return c.tsx("calcite-block",{class:"esri-snapping-controls__toggle-block",open:!0},this.renderEnabledToggle(),c.tsx("div",{class:"esri-snapping-controls__nested-container"},this.renderSelfEnabledToggle(),this.renderFeatureEnabledToggle()))};k.renderEnabledToggle=function(){if(this.visibleElements.enabledToggle){var {messages:{enableSnapping:n},
viewModel:{snappingOptions:{enabled:u,enabledToggled:l}}}=this;return c.tsx("calcite-label",{layout:"inline-space-between"},n,c.tsx("calcite-switch",{switched:u,disabled:l,bind:this,onCalciteSwitchChange:this._enableSnappingSwitchChange}))}};k.renderSelfEnabledToggle=function(){if(this.visibleElements.selfEnabledToggle){var {messages:{geometryGuides:n},viewModel:{snappingOptions:{enabled:u,selfEnabled:l,enabledToggled:p}}}=this;return c.tsx("calcite-label",{layout:"inline-space-between"},n,c.tsx("calcite-switch",
{switched:l,disabled:p||!u,bind:this,onCalciteSwitchChange:this._selfEnabledSwitchChange}))}};k.renderFeatureEnabledToggle=function(){if(this.visibleElements.featureEnabledToggle){var {messages:{featureToFeature:n},viewModel:{snappingOptions:{enabled:u,featureEnabled:l,enabledToggled:p}}}=this;return c.tsx("calcite-label",{layout:"inline-space-between"},n,c.tsx("calcite-switch",{switched:l,disabled:p||!u,bind:this,onCalciteSwitchChange:this._featureEnabledSwitchChange}))}};k.renderLayerList=function(){if(this.visibleElements.layerList){var {messages:{snappingLayers:n,
searchLayers:u}}=this;return c.tsx("calcite-block",{heading:n,open:!0,collapsible:!0},c.tsx("calcite-pick-list",{multiple:!0,bind:this,onCalciteListChange:this._layerListChange,filterEnabled:10<=this.viewModel.layerListViewModel.operationalItems.length,"filter-placeholder":u},this.renderLayerListItemCollection(this.viewModel.layerListViewModel.operationalItems)))}};k.renderLayerListItemCollection=function(n){return n.map(u=>0<u.children.length?this.renderLayerListItemGroup(u):this.renderLayerListItem(u)).toArray()};
k.renderLayerListItem=function(n){var u,{messages:{untitledLayer:l}}=this;l=n.title||l;const p=0<(null==(u=n.children)?void 0:u.length);return c.tsx("calcite-pick-list-item",{slot:p?"parent-item":null,key:`${this.id}-pick-list-item-${n.uid}`,label:l,value:n.layer.id,selected:n.enabled})};k.renderLayerListItemGroup=function(n){return c.tsx("calcite-pick-list-group",{"group-title":n.title||this.messages.untitledLayer},[...this.renderLayerListItemCollection(n.children)])};k._enableSnappingSwitchChange=
function(n){this.snappingOptions.enabled=n.detail.switched};k._featureEnabledSwitchChange=function(n){this.snappingOptions.featureEnabled=n.detail.switched};k._selfEnabledSwitchChange=function(n){this.snappingOptions.selfEnabled=n.detail.switched};k._layerListChange=function(n){this.viewModel.updateEnabledFeatureSources([...n.detail.keys()])};g._createClass(d,[{key:"viewModel",set:function(n){if(n!==this._get("viewModel")){if(w.isNone(this._defaultViewModel)||this._defaultViewModel!==n)this._defaultViewModel=
w.destroyMaybe(this._defaultViewModel);this._set("viewModel",n)}}}]);return d}(t);a.__decorate([K.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],F.prototype,"label",void 0);a.__decorate([K.property(),b.messageBundle("esri/widgets/support/SnappingControls/t9n/SnappingControls")],F.prototype,"messages",void 0);a.__decorate([K.property(),b.messageBundle("esri/t9n/common")],F.prototype,"messagesCommon",void 0);a.__decorate([z.aliasOf("viewModel.snappingOptions")],F.prototype,"snappingOptions",
void 0);a.__decorate([z.aliasOf("viewModel.view")],F.prototype,"view",void 0);a.__decorate([K.property()],F.prototype,"viewModel",null);a.__decorate([K.property()],F.prototype,"visibleElements",void 0);a.__decorate([J.cast("visibleElements")],F.prototype,"castVisibleElements",null);return F=a.__decorate([D.subclass("esri.widgets.support.SnappingControls")],F)})},"esri/widgets/support/SnappingControls/SnappingControlsViewModel":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/HandleOwner ../../../core/watchUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../../LayerList/support/layerListUtils ./SnappingLayerListViewModel".split(" "),
function(f,g,a,w,z,F,J,G,K,D,t,m){a=function(b){function c(h){h=b.call(this,h)||this;h.layerListViewModel=new m.SnappingLayerListViewModel;h.snappingOptions=null;h.view=null;return h}f._inheritsLoose(c,b);var e=c.prototype;e.initialize=function(){this.handles.add([z.init(this,"view",h=>{this.layerListViewModel.view=h}),z.init(this,"snappingOptions.featureSources",()=>{this.layerListViewModel.featureSnappingSources=this.snappingOptions.featureSources})])};e.updateEnabledFeatureSources=function(h){for(const r of this.snappingOptions.featureSources)t.canDisplayLayer(r.layer)&&
(r.enabled=h.includes(r.layer.id))};f._createClass(c,[{key:"state",get:function(){return this.get("snappingOptions")?"ready":"disabled"}}]);return c}(w.HandleOwnerMixin(a));g.__decorate([F.property({constructOnly:!0})],a.prototype,"layerListViewModel",void 0);g.__decorate([F.property({constructOnly:!0})],a.prototype,"snappingOptions",void 0);g.__decorate([F.property()],a.prototype,"state",null);g.__decorate([F.property({constructOnly:!0})],a.prototype,"view",void 0);return a=g.__decorate([D.subclass("esri.widgets.support.SnappingControls.SnappingControlsViewModel")],
a)})},"esri/widgets/LayerList/support/layerListUtils":function(){define(["exports"],function(f){function g(G){if(G)return null!=G.listMode?G.listMode:void 0}function a(G){if(G)return null!=G.minScale?G.minScale:void 0}function w(G){if(G)return null!=G.maxScale?G.maxScale:void 0}function z(G){if(G&&G.listMode!==J.hideChildren&&"wmts"!==G.type)return"group"===G.type?"layers":"sublayers"}function F(G,K){G&&G.sort((D,t)=>{D=K.indexOf(D.uid);t=K.indexOf(t.uid);return D>t?-1:D<t?1:0})}const J={hide:"hide",
hideChildren:"hide-children"};f.canDisplayLayer=function(G){return g(G)!==J.hide};f.canSortSublayers=function(G){G=G&&(G.get("layer.layer")||G.layer);if(!G)return!1;G=G.get("capabilities.exportMap.supportsDynamicLayers");return"boolean"===typeof G?G:!0};f.findLayerListMode=g;f.findLayerMaxScale=w;f.findLayerMinScale=a;f.findLayerVisibilityMode=function(G){if(!G)return"inherited";var K=G.get("layer.capabilities.exportMap.supportsSublayerVisibility");if("boolean"===typeof K)return K?"independent":"inherited";
K=G.get("capabilities.exportMap.supportsSublayerVisibility");return"boolean"===typeof K?K?"independent":"inherited":null!=G.visibilityMode?G.visibilityMode:"independent"};f.findSelectedItem=function(G,K){var D;const t=null==(D=G.layer)?void 0:D.uid;return t&&K.find(m=>{var b;return(null==(b=m.layer)?void 0:b.uid)===t})};f.getItemLayers=function(G){return(G=null==G?void 0:G.layer)&&"group"===G.type?G.layers:null};f.getNormalizedChildLayerProperty=z;f.isLayerOutsideScaleRange=function(G,K){if(!G||isNaN(K))return!1;
var D=a(G);G=w(G);D=!isNaN(D)&&0<D&&K>D;K=!isNaN(G)&&0<G&&K<G;return D||K};f.sortChildLayersToIds=function(G,K){if(G=null==G?void 0:G.layer){var D=z(G);D&&(G=G.get(D),F(G,K))}};f.sortLayersToIds=F;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/widgets/support/SnappingControls/SnappingLayerListViewModel":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../../../views/interactive/snapping/FeatureSnappingLayerSource ../../LayerList/LayerListViewModel ./snappingLayerListUtils ./SnappingListItem".split(" "),
function(f,g,a,w,z,F,J,G,K,D,t,m,b){f.SnappingLayerListViewModel=function(e){function h(){var d=e.apply(this,arguments)||this;d.featureSnappingSources=new w;return d}g._inheritsLoose(h,e);var r=h.prototype;r._compileList=function(){var d=this.get("view.map.layers");d&&(d=d.filter(m.isValidSnappingLayer),this._watchLayersListMode(d),(d=this._getViewableLayers(d))&&d.length?(this._createNewItems(d),this._removeItems(d),this._sortItems(d),this._beforeCallListItemsCreated()):this._removeAllItems())};
r._createListItem=function(d){const {view:k}=this,n=c(this.featureSnappingSources,d);d=new b.SnappingListItem({layer:d,view:k,featureSource:n});for(const u of d.children)u.featureSource=c(this.featureSnappingSources,u.layer);this._watchItemProperties(d);return d};g._createClass(h,[{key:"operationalItemsFlat",get:function(){return this.operationalItems.flatten(d=>d.children)}}]);return h}(t);a.__decorate([z.property()],f.SnappingLayerListViewModel.prototype,"featureSnappingSources",void 0);a.__decorate([z.property()],
f.SnappingLayerListViewModel.prototype,"operationalItems",void 0);f.SnappingLayerListViewModel=a.__decorate([K.subclass("esri.widgets.support.SnappingControls.SnappingLayerListViewModel")],f.SnappingLayerListViewModel);const c=(e,h)=>{if(!m.isValidSnappingLayerSource(h))return null;let r=e.find(d=>d.layer===h);r||(r=new D({layer:h,enabled:!1}),e.add(r));return r};Object.defineProperty(f,"__esModule",{value:!0})})},"esri/widgets/LayerList/LayerListViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Collection ../../core/Evented ../../core/Handles ../../core/promiseUtils ../../core/watchUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/accessorSupport/decorators/subclass ./ListItem ./support/layerListUtils".split(" "),
function(f,g,a,w,z,F,J,G,K,D,t,m,b,c){const e=a.ofType(b);a=function(h){function r(k){var n=h.call(this,k)||this;n._handles=new z;n.listItemCreatedFunction=null;n.operationalItems=new e;n.view=null;n._callListItemsCreatedDebounced=F.debounce(f._asyncToGenerator(function*(){return n._callListItemsCreated()}),300);return n}f._inheritsLoose(r,h);var d=r.prototype;d.initialize=function(){this._handles.add(J.init(this,["view","view.ready"],()=>this._viewHandles()),"view")};d.destroy=function(){this._handles.destroy();
this.view=this._handles=null;this.operationalItems.removeAll()};d.triggerAction=function(k,n){k&&!k.disabled&&this.emit("trigger-action",{action:k,item:n})};d.moveListItem=function(k,n,u,l){var p,E;const x=null==k?void 0:k.layer;if(x){var M=null==(p=this.view)?void 0:null==(E=p.map)?void 0:E.layers;p=n?c.getItemLayers(n):M;M=u?c.getItemLayers(u):M;p&&M&&({operationalItems:E}=this,n=(null==n?void 0:n.children)||E,E=(null==u?void 0:u.children)||E,l=M.length-l,k.parent=u||null,n.includes(k)&&n.remove(k),
p.includes(x)&&p.remove(x),E.includes(k)||E.add(k,l),M.includes(x)||M.add(x,l))}};d._createLayerViewHandles=function(k){const {_handles:n}=this;n.remove("layer-views");this._compileList();k&&n.add(k.on("change",()=>this._compileList()),"layer-views")};d._createMapLayerHandles=function(k){const {_handles:n}=this;n.remove("map-layers");this._compileList();k&&n.add(k.on("change",()=>this._compileList()),"map-layers")};d._watchItemProperties=function(k){this._handles.add([k.children.on("change",()=>{this._callListItemCreatedChildren(k.children)})],
`children-change-${k.uid}`)};d._callListItemCreatedChildren=function(k){k.forEach(n=>this._callListItemCreated(n))};d._callListItemCreated=function(k){"function"===typeof this.listItemCreatedFunction&&this.listItemCreatedFunction.call(null,{item:k});this._callListItemCreatedChildren(k.children)};d._createListItem=function(k){const {view:n}=this;k=new b({layer:k,view:n});this._watchItemProperties(k);return k};d._removeAllItems=function(){const {_handles:k,operationalItems:n}=this;n.forEach(u=>{k.remove(`children-change-${u.uid}`)});
n.removeAll()};d._getViewableLayers=function(k){if(k)return k.filter(n=>"hide"!==c.findLayerListMode(n))};d._watchLayersListMode=function(k){const {_handles:n}=this;n.remove("layer-list-mode");k&&k.forEach(u=>{n.add(J.watch(u,"listMode",()=>this._compileList()),"layer-list-mode")})};d._compileList=function(){var k=this.get("view.map.layers");this._watchLayersListMode(k);(k=this._getViewableLayers(k))&&k.length?(this._createNewItems(k),this._removeItems(k),this._sortItems(k),this._beforeCallListItemsCreated()):
this._removeAllItems()};d._beforeCallListItemsCreated=function(){var k=f._asyncToGenerator(function*(){return this._callListItemsCreatedDebounced().catch(F.throwIfNotAbortError)});return function(){return k.apply(this,arguments)}}();d._callListItemsCreated=function(){var k=f._asyncToGenerator(function*(){var n;yield null==(n=this.view)?void 0:n.when();this.operationalItems.forEach(u=>this._callListItemCreated(u))});return function(){return k.apply(this,arguments)}}();d._createNewItems=function(k){const {operationalItems:n}=
this;k.forEach(u=>{n.find(l=>l.layer===u)||n.add(this._createListItem(u))})};d._removeItems=function(k){const {_handles:n,operationalItems:u}=this,l=[];u.forEach(p=>{p&&k&&k.find(E=>p.layer===E)||(n.remove(`children-change-${p.uid}`),l.push(p))});u.removeMany(l)};d._sortItems=function(k){const {operationalItems:n}=this;n.sort((u,l)=>{u=k.indexOf(u.layer);l=k.indexOf(l.layer);return u>l?-1:u<l?1:0})};d._viewHandles=function(){const {_handles:k,view:n}=this;k.remove(["map-layers","layer-views","view-layers"]);
this._compileList();n&&n.ready&&k.add([J.init(this,"view.map.allLayers",u=>this._createMapLayerHandles(u)),J.init(this,"view.allLayerViews",u=>this._createLayerViewHandles(u)),J.init(this,"listItemCreatedFunction",()=>this._compileList())],"view-layers")};f._createClass(r,[{key:"state",get:function(){const k=this.get("view");return this.get("view.ready")?"ready":k?"loading":"disabled"}}]);return r}(w.EventedAccessor);g.__decorate([G.property()],a.prototype,"listItemCreatedFunction",void 0);g.__decorate([G.property({type:e})],
a.prototype,"operationalItems",void 0);g.__decorate([G.property({readOnly:!0})],a.prototype,"state",null);g.__decorate([G.property()],a.prototype,"view",void 0);return a=g.__decorate([m.subclass("esri.widgets.LayerList.LayerListViewModel")],a)})},"esri/widgets/LayerList/ListItem":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Collection ../../core/HandleOwner ../../core/Identifiable ../../core/watchUtils ../../core/accessorSupport/decorators/aliasOf ../../core/has ../../core/accessorSupport/decorators/cast ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/subclass ../../support/actions/ActionBase ../../support/actions/ActionButton ../../support/actions/ActionSlider ../../support/actions/ActionToggle ./ListItemPanel ./support/layerListUtils".split(" "),
function(f,g,a,w,z,F,J,G,K,D,t,m,b,c,e,h,r,d,k){var n;K=w.ofType({key:"type",defaultKeyValue:"button",base:c,typeMap:{button:e,toggle:r,slider:h}});const u=w.ofType(K);a=n=function(l){function p(x){x=l.call(this,x)||this;x.actionsSections=new u;x.actionsOpen=!1;x.children=new (w.ofType(n));x.childrenSortable=!0;x.error=null;x.layer=null;x.layerView=null;x.open=!1;x.panel=null;x.parent=null;x.sortable=!0;x.view=null;x.visible=null;return x}f._inheritsLoose(p,l);var E=p.prototype;E.initialize=function(){this.handles.add([J.init(this,
"layer",x=>this._watchLayerProperties(x)),J.init(this,"view",x=>this._updateChildren(x)),J.init(this,"panel",x=>this._setListItemOnPanel(x)),J.init(this,["layer","view"],()=>this._getLayerView())])};E.destroy=function(){this.view=null};E.castPanel=function(x){this.get("panel.open")&&!x.hasOwnProperty("open")&&(x.open=!0);return x?new d(x):null};E.clone=function(){return new n({actionsSections:this.actionsSections.clone(),actionsOpen:this.actionsOpen,children:this.children.clone(),layer:this.layer,
open:this.open,panel:this.panel,title:this.title,view:this.view,visible:this.visible})};E._setListItemOnPanel=function(x){x&&(x.listItem=this)};E._updateChildren=function(x){const M=this.children;M&&M.forEach(B=>B.view=x)};E._addChildren=function(x){this.handles.remove("child-list-mode");this.children.removeAll();if(x){x.forEach(B=>{this.handles.add(J.watch(B,"listMode",()=>this._addChildren(x)),"child-list-mode")});var M=x.filter(B=>"hide"!==k.findLayerListMode(B));this.children.addMany(this._makeChildren(M))}};
E._watchSublayerChanges=function(x){x&&this.handles.add(x.on("change",()=>{this._addChildren(x)}),"layer")};E._initializeChildLayers=function(x){this._addChildren(x);this._watchSublayerChanges(x)};E._makeChildren=function(x){return x.map(M=>k.canDisplayLayer(M)?new n({layer:M,parent:this,view:this.view}):null).reverse()};E._watchLayerProperties=function(x){if(this.handles&&(this.handles.remove("layer"),this.handles.remove("child-list-mode"),x))if(this.handles.add(J.watch(x,"listMode",()=>this._watchLayerProperties(x)),
"layer"),"hide-children"===k.findLayerListMode(x))this.children.removeAll();else{var M=k.getNormalizedChildLayerProperty(x);M&&this.handles.add(J.init(x,M,()=>{x.hasOwnProperty(M)&&this._initializeChildLayers(x[M])}),"layer")}};E._getLayerView=function(){var x=f._asyncToGenerator(function*(){const {layer:M,view:B}=this;if(M&&B)try{const q=yield B.whenLayerView(M);q.layer===this.layer&&this._set("layerView",q)}catch{}});return function(){return x.apply(this,arguments)}}();E._isLayerUpdating=function(x){return x&&
"loading"===x.loadStatus};f._createClass(p,[{key:"title",get:function(){const x=this.get("layer.layer");return(!x||x&&this.get("layer.layer.loaded"))&&this.get("layer.title")||this.get("layer.attributes.title")||""},set:function(x){void 0===x?this._clearOverride("title"):this._override("title",x)}},{key:"updating",get:function(){const x=this.layerView;return x?x.updating:this._isLayerUpdating(this.layer)}},{key:"visibleAtCurrentScale",get:function(){return!k.isLayerOutsideScaleRange(this.layer,this.get("view.scale"))}},
{key:"visibilityMode",get:function(){return k.findLayerVisibilityMode(this.layer)}}]);return p}(F.IdentifiableMixin(z.HandleOwnerMixin(a)));g.__decorate([m.property({type:u})],a.prototype,"actionsSections",void 0);g.__decorate([m.property()],a.prototype,"actionsOpen",void 0);g.__decorate([m.property({type:w})],a.prototype,"children",void 0);g.__decorate([m.property()],a.prototype,"childrenSortable",void 0);g.__decorate([G.aliasOf("layer.loadError?")],a.prototype,"error",void 0);g.__decorate([m.property()],
a.prototype,"layer",void 0);g.__decorate([m.property({readOnly:!0})],a.prototype,"layerView",void 0);g.__decorate([m.property()],a.prototype,"open",void 0);g.__decorate([m.property({type:d})],a.prototype,"panel",void 0);g.__decorate([D.cast("panel")],a.prototype,"castPanel",null);g.__decorate([m.property()],a.prototype,"parent",void 0);g.__decorate([m.property()],a.prototype,"sortable",void 0);g.__decorate([m.property()],a.prototype,"title",null);g.__decorate([m.property({readOnly:!0})],a.prototype,
"updating",null);g.__decorate([m.property({value:null})],a.prototype,"view",void 0);g.__decorate([G.aliasOf("layer.visible")],a.prototype,"visible",void 0);g.__decorate([m.property({readOnly:!0})],a.prototype,"visibleAtCurrentScale",null);g.__decorate([m.property({readOnly:!0})],a.prototype,"visibilityMode",null);return a=n=g.__decorate([b.subclass("esri.widgets.LayerList.ListItem")],a)})},"esri/support/actions/ActionSlider":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/accessorSupport/decorators/subclass ./ActionBase".split(" "),
function(f,g,a,w,z,F,J,G){var K;w=K=function(D){function t(m){m=D.call(this,m)||this;m.displayValueEnabled=!1;m.max=1;m.min=0;m.step=.1;m.type="slider";m.value=null;return m}f._inheritsLoose(t,D);t.prototype.clone=function(){return new K({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,displayValueEnabled:this.displayValueEnabled,max:this.max,min:this.min,step:this.step,value:this.value})};return t}(G);g.__decorate([a.property()],
w.prototype,"displayValueEnabled",void 0);g.__decorate([a.property()],w.prototype,"max",void 0);g.__decorate([a.property()],w.prototype,"min",void 0);g.__decorate([a.property()],w.prototype,"step",void 0);g.__decorate([a.property()],w.prototype,"value",void 0);return w=K=g.__decorate([J.subclass("esri.support.Action.ActionSlider")],w)})},"esri/widgets/LayerList/ListItemPanel":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Handles ../../core/Identifiable ../../core/watchUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/accessorSupport/decorators/subclass ../Widget ../support/widget ../support/jsxFactory".split(" "),
function(f,g,a,w,z,F,J,G,K,D,t,m,b,c){z=function(e){function h(d,k){d=e.call(this,d,k)||this;d._legend=null;d._handles=new w;d.content=null;d.image=null;d.listItem=null;d.open=!1;d.visible=!0;return d}g._inheritsLoose(h,e);var r=h.prototype;r.initialize=function(){this.own([F.init(this,"content",d=>this._createLegend(d))])};r.destroy=function(){const {_legend:d}=this;d&&d.destroy();this._legend=null};r.render=function(){return c.tsx("div",{class:"esri-layer-list-panel"},this._renderContents())};r._renderContent=
function(d){const {_legend:k,listItem:n}=this;return d?"legend"===d?n&&n.view&&n.layer&&k?c.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--legend"),key:k},k.render()):null:"string"===typeof d?c.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--string"),key:d,innerHTML:d}):b.isWidget(d)?c.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--widget"),key:d},d.render()):
d instanceof HTMLElement?c.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--html-element"),key:d,bind:d,afterCreate:this._attachToNode}):null:null};r._renderContents=function(){const {content:d}=this;return Array.isArray(d)?d.map(k=>this._renderContent(k)):this._renderContent(d)};r._getLegendOptions=function(d){if(d){var {layer:k,view:n}=d;if(k&&n)return{view:n,layerInfos:[{layer:k,title:""}]}}};r._createLegend=function(d){this._hasLegend(d)&&!this._legend&&
(new Promise(function(k,n){f(["../Legend"],function(u){k(Object.freeze({__proto__:null,default:u}))},n)})).then(({default:k})=>{const {_handles:n,listItem:u}=this,l=new k(this._getLegendOptions(u));this._legend=l;this.notifyChange("className");this.notifyChange("title");k=F.init(this,["listItem.view","listItem.layer"],()=>this._updateLegend(l));n.add(k,"legends");this.scheduleRender()})};r._hasLegend=function(d){return"legend"===d?!0:Array.isArray(d)?d.some(k=>"legend"===k):!1};r._attachToNode=function(d){d.appendChild(this)};
r._updateLegend=function(d){const {listItem:k}=this;if(k){var {layer:n,view:u}=k;d.view=u;d.layerInfos=[{layer:n,title:null}];this.scheduleRender()}};r._getWidget=function(d){return"legend"===d?this._legend:b.isWidget(d)?d:null};r._getFirstWidget=function(){const {content:d}=this;if(Array.isArray(d)){let k=null;d.some(n=>{(n=this._getWidget(n))&&(k=n);return!!n});return k}return this._getWidget(d)};g._createClass(h,[{key:"className",get:function(){const {image:d}=this,k=this._getFirstWidget();return this._get("className")||
!d&&k?k.iconClass:""},set:function(d){void 0===d?this._clearOverride("className"):this._override("className",d)}},{key:"title",get:function(){const d=this._getFirstWidget();return this._get("title")||d?d.label:""},set:function(d){void 0===d?this._clearOverride("title"):this._override("title",d)}}]);return h}(z.IdentifiableMixin(m));a.__decorate([J.property()],z.prototype,"className",null);a.__decorate([J.property()],z.prototype,"content",void 0);a.__decorate([J.property()],z.prototype,"image",void 0);
a.__decorate([J.property()],z.prototype,"listItem",void 0);a.__decorate([J.property()],z.prototype,"title",null);a.__decorate([J.property()],z.prototype,"open",void 0);a.__decorate([J.property()],z.prototype,"visible",void 0);return z=a.__decorate([t.subclass("esri.widgets.LayerList.ListItemPanel")],z)})},"esri/widgets/support/SnappingControls/snappingLayerListUtils":function(){define(["exports","../../../core/maybe","../../LayerList/support/layerListUtils"],function(f,g,a){const w=J=>z(J)||F(J),
z=J=>{if(!("type"in J))return!1;switch(J.type){case "feature":case "geojson":case "csv":case "graphics":case "wfs":return!0;default:return!1}},F=J=>{const G=a.getNormalizedChildLayerProperty(J);if(J.hasOwnProperty(G)&&g.isSome(J[G]))for(const K of J[G])if(w(K))return!0;return!1};f.isValidSnappingLayer=w;f.isValidSnappingLayerGroup=F;f.isValidSnappingLayerSource=z;Object.defineProperty(f,"__esModule",{value:!0})})},"esri/widgets/support/SnappingControls/SnappingListItem":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../../LayerList/ListItem ../../LayerList/support/layerListUtils ./snappingLayerListUtils".split(" "),
function(f,g,a,w,z,F,J,G,K,D,t,m){var b;f.SnappingListItem=b=function(c){function e(){var r=c.apply(this,arguments)||this;r.featureSource=null;return r}g._inheritsLoose(e,c);var h=e.prototype;h._initializeChildLayers=function(r){r=r.filter(m.isValidSnappingLayer);c.prototype._initializeChildLayers.call(this,r)};h._makeChildren=function(r){return r.map(d=>t.canDisplayLayer(d)?new b({layer:d,parent:this,view:this.view}):null).reverse()};g._createClass(e,[{key:"enabled",get:function(){return w.isSome(this.featureSource)?
this.featureSource.enabled:!1}}]);return e}(D);a.__decorate([z.property()],f.SnappingListItem.prototype,"children",void 0);a.__decorate([z.property()],f.SnappingListItem.prototype,"enabled",null);a.__decorate([z.property()],f.SnappingListItem.prototype,"featureSource",void 0);a.__decorate([z.property()],f.SnappingListItem.prototype,"parent",void 0);f.SnappingListItem=b=a.__decorate([K.subclass("esri.widgets.support.SnappingControls.SnappingListItem")],f.SnappingListItem);Object.defineProperty(f,"__esModule",
{value:!0})})},"*noref":1}});
define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../intl ../core/Collection ../core/handleUtils ../core/maybe ../core/accessorSupport/decorators/aliasOf ../core/has ../core/accessorSupport/decorators/cast ../core/Logger ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/subclass ../views/interactive/snapping/SnappingOptions ./Widget ./Sketch/SketchViewModel ./support/SelectionToolbar ./support/SnappingControls ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory ../intl/substitute".split(" "),function(f,
g,a,w,z,F,J,G,K,D,t,m,b,c,e,h,r,d,k,n,u,l,p){const E={createTools:{point:!0,polyline:!0,polygon:!0,rectangle:!0,circle:!0},selectionTools:{"rectangle-selection":!0,"lasso-selection":!0},undoRedoMenu:!0,settingsMenu:!0};w=function(x){function M(q,I){I=x.call(this,q,I)||this;I._activeCreateOptions=null;I._defaultViewModel=null;I._menuOpen=!1;I._selectionToolbar=null;I._selectionHandlesGroup=null;I._snappingControls=null;I._viewModelHandlesGroup=null;I.availableCreateTools=["point","polyline","polygon",
"rectangle","circle"];I.createGraphic=null;I.creationMode="continuous";I.defaultCreateOptions=null;I.defaultUpdateOptions=null;I.iconClass="esri-icon-edit";I.label=void 0;I.layer=null;I.layout="horizontal";I.messages=null;I.snappingOptions=new c;I.updateGraphics=new z;I.view=null;I.visibleElements={...E};I._activateCreateTool=I._activateCreateTool.bind(g._assertThisInitialized(I));null!=q&&q.viewModel||(I._defaultViewModel=new h,I.viewModel=I._defaultViewModel);return I}g._inheritsLoose(M,x);var B=
M.prototype;B.initialize=function(){const {layer:q,view:I}=this,A=new r({view:"2d"===(null==I?void 0:I.type)?I:null,layers:q?[q]:null});this._selectionHandlesGroup=F.handlesGroup([A.watch("activeToolInfo",N=>{N&&this.viewModel.cancel()}),A.on("complete",N=>this._onSelectionOperationComplete(N))]);this._selectionToolbar=A;this._setUpSnappingControls()};B.loadDependencies=function(){return new Promise(function(q,I){f(["../chunks/action"],q,I)})};B.destroy=function(){this._selectionToolbar.destroy();
this._cleanupViewModel();this._selectionHandlesGroup=J.removeMaybe(this._selectionHandlesGroup);this._snappingControls=J.destroyMaybe(this._snappingControls)};B.castVisibleElements=function(q){return{...E,...q,createTools:{...E.createTools,...null==q?void 0:q.createTools},selectionTools:{...E.selectionTools,...null==q?void 0:q.selectionTools}}};B.create=function(q,I){this._activeCreateOptions=I||null;this.viewModel.create(q,I)};B.update=function(q,I){return this.viewModel.update(q,I)};B.complete=
function(){};B.cancel=function(){this._selectionToolbar.cancel();this.viewModel.cancel()};B.undo=function(){var q;this.viewModel.undo();null==(q=this.view)?void 0:q.focus()};B.redo=function(){var q;this.viewModel.redo();null==(q=this.view)?void 0:q.focus()};B.delete=function(){};B.render=function(){const {label:q,layout:I,viewModel:{state:A}}=this;return l.tsx("div",{"aria-label":q,class:this.classes("esri-sketch","esri-widget",{["esri-disabled"]:"disabled"===A,["esri-sketch--vertical"]:"vertical"===
I})},l.tsx("div",{role:"toolbar",class:"esri-sketch__panel"},this.renderTopPanelContents()),l.tsx("div",{class:this.classes("esri-sketch__panel","esri-sketch__info-panel")},this.renderInfoPanelContents()))};B.renderTopPanelContents=function(){const q=this.classes("esri-sketch__section","esri-sketch__tool-section"),{availableCreateTools:I,visibleElements:A}=this;return[l.tsx("div",{role:"menu",key:"selection-button-container",class:q},this.renderDefaultSelectionButton(),this.renderSelectionToolbar()),
I&&I.length?l.tsx("div",{role:"menu",class:q},this.renderDrawButtons()):null,A.undoRedoMenu?l.tsx("div",{role:"menu",key:"undo-redo-menu-button-container",class:q},this.renderUndoRedoMenuButtons()):null,A.settingsMenu?l.tsx("div",{key:"settings-menu-button-container",class:"esri-sketch__section"},this.renderSettingsMenuButton()):null]};B.renderInfoPanelContents=function(){if(this._menuOpen)return this.renderSettingsMenu();if(this.updateGraphics.length)return[l.tsx("div",{class:this.classes("esri-sketch__section",
"esri-sketch__info-section","esri-sketch__info-count-section"),key:"feature-count-container"},this.renderFeatureCount()),l.tsx("div",{class:this.classes("esri-sketch__section","esri-sketch__info-section"),key:"delete-button-container"},this.renderDeleteButton())]};B.renderSettingsMenu=function(){const {settings:q}=this.messages;return[l.tsx("div",{role:"menu",class:"esri-sketch__menu-container",key:"settings-menu-container"},l.tsx("header",{class:"esri-sketch__menu-header",key:"settings-menu-header"},
l.tsx("span",{class:"esri-sketch__menu-title"},q)),this.renderSnappingControls())]};B.renderSnappingControls=function(){if(J.isSome(this._snappingControls))return this._snappingControls.render()};B.renderFeatureCount=function(){const {layout:q,messages:I,updateGraphics:{length:A}}=this,N=p.substitute(1===A?I.featureCount:I.featuresCount,{count:A});return l.tsx("div",{class:"esri-sketch__feature-count-badge","aria-label":N},l.tsx("span",{class:"esri-sketch__feature-count-number"},"vertical"===q?A:
N))};B.renderDeleteButton=function(){const q=this.messages.deleteFeature;return l.tsx("calcite-action",{bind:this,icon:"trash",label:q,onclick:this.delete,scale:"s",text:q,title:q})};B.renderDefaultSelectionButton=function(){if(this.viewModel.updateOnGraphicClick){var q=this.messages.selectFeature;return l.tsx("calcite-action",{active:"ready"===this.state,bind:this,icon:"cursor",label:q,onclick:this._activateDefaultSelectTool,scale:"s",text:q,title:q})}};B.renderSelectionToolbar=function(){var q;
if("2d"===(null==(q=this.view)?void 0:q.type))return q=this.visibleElements.selectionTools,this._selectionToolbar.visibleElements={lassoTool:!!q["lasso-selection"],rectangleTool:!!q["rectangle-selection"]},this._selectionToolbar.render()};B.renderDrawButtons=function(){const q=this.visibleElements.createTools;return this.availableCreateTools.map(I=>{if("point"===I&&q.point)return this.renderPointButton();if("polyline"===I&&q.polyline)return this.renderPolylineButton();if("polygon"===I&&q.polygon)return this.renderPolygonButton();
if("rectangle"===I&&q.rectangle)return this.renderRectangleButton();if("circle"===I&&q.circle)return this.renderCircleButton()})};B.renderPointButton=function(){const q=this.messages.drawPoint;return l.tsx("calcite-action",{active:"point"===this.activeTool,bind:this,icon:"pin",label:q,onclick:()=>this._activateCreateTool("point"),scale:"s",text:q,title:q})};B.renderPolygonButton=function(){const q=this.messages.drawPolygon;return l.tsx("calcite-action",{active:"polygon"===this.activeTool,bind:this,
icon:"polygon",label:q,onclick:()=>this._activateCreateTool("polygon"),scale:"s",text:q,title:q})};B.renderPolylineButton=function(){const q=this.messages.drawPolyline;return l.tsx("calcite-action",{active:"polyline"===this.activeTool,bind:this,icon:"line",label:q,onclick:()=>this._activateCreateTool("polyline"),scale:"s",text:q,title:q})};B.renderCircleButton=function(){const q=this.messages.drawCircle;return l.tsx("calcite-action",{active:"circle"===this.activeTool,bind:this,icon:"circle",label:q,
onclick:()=>this._activateCreateTool("circle"),scale:"s",text:q,title:q})};B.renderRectangleButton=function(){const q=this.messages.drawRectangle;return l.tsx("calcite-action",{active:"rectangle"===this.activeTool,bind:this,icon:"rectangle",label:q,onclick:()=>this._activateCreateTool("rectangle"),scale:"s",text:q,title:q})};B.renderUndoRedoMenuButtons=function(){return[this.renderUndoButton(),this.renderRedoButton()]};B.renderUndoButton=function(){const q=this.messages.undo;return l.tsx("calcite-action",
{disabled:!this.viewModel.canUndo(),bind:this,icon:k.isRTL(this.container)?"redo":"undo",label:q,onclick:this.undo,scale:"s",text:q,title:q})};B.renderRedoButton=function(){const q=this.messages.redo;return l.tsx("calcite-action",{disabled:!this.viewModel.canRedo(),bind:this,icon:k.isRTL(this.container)?"undo":"redo",label:q,onclick:this.redo,scale:"s",text:q,title:q})};B.renderSettingsMenuButton=function(){const q=this.messages.settings;return l.tsx("calcite-action",{active:this._menuOpen,bind:this,
icon:"gear",label:q,onclick:this._toggleMenu,scale:"s",text:q,title:q})};B._activateCreateTool=function(q){this.activeTool===q?this.cancel():(this._selectionToolbar.cancel(),this.create(q))};B._onCreateOperation=function(q){if("complete"===q.state){var {creationMode:I}=this,{type:A}=q;if("create"===A){const {tool:N,graphic:V}=q;q=this._activeCreateOptions;this._activeCreateOptions=null;"continuous"===I?this.create(N,q):"update"===I&&this.update([V])}}};B._toggleMenu=function(){this._menuOpen=!this._menuOpen;
this.scheduleRender()};B._onSelectionOperationComplete=function(q){const {viewModel:{defaultUpdateOptions:I}}=this,{selection:A}=q;!q.aborted&&A.length&&(q=I.tool,this.update(A,{...I,tool:1<A.length&&"reshape"===q?"transform":q}));this.notifyChange("state")};B._activateDefaultSelectTool=function(){var q;this.cancel();null==(q=this.view)?void 0:q.focus()};B._cleanupViewModel=function(){this._defaultViewModel=J.destroyMaybe(this._defaultViewModel);this._viewModelHandlesGroup=J.removeMaybe(this._viewModelHandlesGroup)};
B._setUpSnappingControls=function(){const {snappingOptions:q,view:I}=this;this._snappingControls=J.destroyMaybe(this._snappingControls);q&&I&&(this._snappingControls=new d({snappingOptions:q,view:I,visibleElements:{header:!1}}))};g._createClass(M,[{key:"activeTool",get:function(){const q=this._selectionToolbar.activeToolInfo;if(q)switch(q.toolName){case "lasso":return"lasso-selection";case "rectangle":return"rectangle-selection";case "default":return"custom-selection"}return this.viewModel.activeTool}},
{key:"state",get:function(){return this._selectionToolbar.activeToolInfo?"active":this.viewModel.state}},{key:"viewModel",set:function(q){q!==this._get("viewModel")&&((J.isNone(this._defaultViewModel)||this._defaultViewModel!==q)&&this._cleanupViewModel(),this._set("viewModel",q),this.viewModel&&(this._viewModelHandlesGroup=F.handlesGroup([this.viewModel.on("create",I=>{this.scheduleRender();this._onCreateOperation(I)}),this.viewModel.on("update",()=>this.scheduleRender()),this.viewModel.on("delete",
I=>this.emit("delete",I)),this.viewModel.on("undo",()=>this.scheduleRender()),this.viewModel.on("redo",()=>this.scheduleRender()),this.viewModel.watch("layer",I=>{this._selectionToolbar.layers=I?[I]:null}),this.viewModel.watch("view",I=>{this._selectionToolbar.view="2d"===(null==I?void 0:I.type)?I:null;this._setUpSnappingControls()}),this.viewModel.watch("state",()=>this.notifyChange("state"))])))}}]);return M}(e);a.__decorate([m.property()],w.prototype,"activeTool",null);a.__decorate([m.property({cast:x=>
{if(!x||!x.length)return null;const M=new Set(["point","polyline","polygon","rectangle","circle"]);return x.filter(B=>M.has(B))}})],w.prototype,"availableCreateTools",void 0);a.__decorate([G.aliasOf("viewModel.createGraphic")],w.prototype,"createGraphic",void 0);a.__decorate([m.property()],w.prototype,"creationMode",void 0);a.__decorate([G.aliasOf("viewModel.defaultCreateOptions")],w.prototype,"defaultCreateOptions",void 0);a.__decorate([G.aliasOf("viewModel.defaultUpdateOptions")],w.prototype,"defaultUpdateOptions",
void 0);a.__decorate([m.property()],w.prototype,"iconClass",void 0);a.__decorate([m.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],w.prototype,"label",void 0);a.__decorate([G.aliasOf("viewModel.layer")],w.prototype,"layer",void 0);a.__decorate([m.property({type:["horizontal","vertical"]})],w.prototype,"layout",void 0);a.__decorate([m.property(),n.messageBundle("esri/widgets/Sketch/t9n/Sketch")],w.prototype,"messages",void 0);a.__decorate([G.aliasOf("viewModel.snappingOptions")],
w.prototype,"snappingOptions",void 0);a.__decorate([m.property()],w.prototype,"state",null);a.__decorate([G.aliasOf("viewModel.updateGraphics")],w.prototype,"updateGraphics",void 0);a.__decorate([G.aliasOf("viewModel.view")],w.prototype,"view",void 0);a.__decorate([m.property(),u.vmEvent(["create","update","undo","redo"])],w.prototype,"viewModel",null);a.__decorate([m.property()],w.prototype,"visibleElements",void 0);a.__decorate([D.cast("visibleElements")],w.prototype,"castVisibleElements",null);
a.__decorate([G.aliasOf("viewModel.complete")],w.prototype,"complete",null);a.__decorate([G.aliasOf("viewModel.delete")],w.prototype,"delete",null);return w=a.__decorate([b.subclass("esri.widgets.Sketch")],w)});