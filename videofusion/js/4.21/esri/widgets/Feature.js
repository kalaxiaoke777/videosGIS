// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.21/esri/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Feature/FeatureAttachments":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/watchUtils ../../core/accessorSupport/decorators/aliasOf ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/subclass ../Attachments ../Widget ./FeatureAttachments/FeatureAttachmentsViewModel ./support/FeatureElementInfo ../support/widgetUtils ../support/jsxFactory".split(" "),
function(h,m,t,k,z,L,K,O,I,D,B,F,c,g,G){z=function(y){function r(E,x){E=y.call(this,E,x)||this;E._featureElementInfo=null;E.attachmentsWidget=new D;E.description=null;E.displayType=null;E.graphic=null;E.headingLevel=2;E.title=null;E.viewModel=new F;return E}h._inheritsLoose(r,y);var H=r.prototype;H.initialize=function(){this._featureElementInfo=new c;t.init(this,["viewModel.description","viewModel.title","headingLevel"],()=>this._setupFeatureElementInfo());t.init(this,"viewModel.graphic",E=>this.attachmentsWidget.graphic=
E)};H.destroy=function(){this.attachmentsWidget.destroy();this._featureElementInfo.destroy()};H.render=function(){var E;const {attachmentsWidget:x}=this;return G.tsx("div",{class:"esri-feature-attachments"},null==(E=this._featureElementInfo)?void 0:E.render(),null==x?void 0:x.render())};H._setupFeatureElementInfo=function(){const {description:E,title:x,headingLevel:A}=this;this._featureElementInfo.set({description:E,title:x,headingLevel:A})};return r}(B);m.__decorate([O.property({readOnly:!0})],z.prototype,
"attachmentsWidget",void 0);m.__decorate([k.aliasOf("viewModel.description")],z.prototype,"description",void 0);m.__decorate([k.aliasOf("attachmentsWidget.displayType")],z.prototype,"displayType",void 0);m.__decorate([k.aliasOf("viewModel.graphic")],z.prototype,"graphic",void 0);m.__decorate([O.property()],z.prototype,"headingLevel",void 0);m.__decorate([k.aliasOf("viewModel.title")],z.prototype,"title",void 0);m.__decorate([O.property({type:F})],z.prototype,"viewModel",void 0);return z=m.__decorate([I.subclass("esri.widgets.Feature.FeatureAttachments")],
z)})},"esri/widgets/Attachments":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Error ../core/unitFormatUtils ../core/watchUtils ../core/accessorSupport/decorators/aliasOf ../core/has ../core/accessorSupport/decorators/cast ../core/Logger ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/subclass ./Widget ./Attachments/AttachmentsViewModel ./Attachments/support/attachmentUtils ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory".split(" "),
function(h,m,t,k,z,L,K,O,I,D,B,F,c,g,G,y,r){const H={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},E=window.CSS;K=function(x){function A(a,d){a=x.call(this,a,d)||this;a.abilities=null;a.displayType="list";a.graphic=null;a.label=void 0;a.messages=null;a.messagesUnits=null;a.selectedFile=null;a.submitting=!1;a.viewModel=new c;a.visibleElements={...H};a._supportsImageOrientation=E&&E.supports&&E.supports("image-orientation",
"from-image");a._addAttachmentForm=null;a._updateAttachmentForm=null;return a}h._inheritsLoose(A,x);var b=A.prototype;b.initialize=function(){this.own(z.on(this,"viewModel.attachmentInfos","change",()=>this.scheduleRender()),z.init(this,"viewModel.mode",()=>this._modeChanged()))};b.castVisibleElements=function(a){return{...H,...a}};b.addAttachment=function(){const {_addAttachmentForm:a,viewModel:d}=this;this._set("submitting",!0);this._set("error",null);return d.addAttachment(a).then(n=>{this._set("submitting",
!1);this._set("error",null);d.mode="view";return n}).catch(n=>{this._set("submitting",!1);this._set("error",new t("attachments:add-attachment",this.messages.addErrorMessage,n));throw n;})};b.deleteAttachment=function(a){const {viewModel:d}=this;this._set("submitting",!0);this._set("error",null);return d.deleteAttachment(a).then(n=>{this._set("submitting",!1);this._set("error",null);d.mode="view";return n}).catch(n=>{this._set("submitting",!1);this._set("error",new t("attachments:delete-attachment",
this.messages.deleteErrorMessage,n));throw n;})};b.updateAttachment=function(){const {viewModel:a}=this,{_updateAttachmentForm:d}=this;this._set("submitting",!0);this._set("error",null);return a.updateAttachment(d).then(n=>{this._set("submitting",!1);this._set("error",null);a.mode="view";return n}).catch(n=>{this._set("submitting",!1);this._set("error",new t("attachments:update-attachment",this.messages.updateErrorMessage,n));throw n;})};b.render=function(){const {submitting:a,viewModel:d}=this,{state:n}=
d;return r.tsx("div",{class:this.classes("esri-attachments","esri-widget")},a?this.renderProgressBar():null,"loading"===n?this.renderLoading():this.renderAttachments(),this.renderErrorMessage())};b.renderErrorMessage=function(){const {error:a,visibleElements:d}=this;return a&&d.errorMessage?r.tsx("div",{key:"error-message",class:"esri-attachments__error-message"},a.message):null};b.renderAttachments=function(){const {mode:a,activeAttachmentInfo:d}=this.viewModel;return"add"===a?this.renderAddForm():
"edit"===a?this.renderDetailsForm(d):this.renderAttachmentContainer()};b.renderLoading=function(){return r.tsx("div",{class:"esri-attachments__loader-container",key:"loader"},r.tsx("div",{class:"esri-attachments__loader"}))};b.renderProgressBar=function(){return this.visibleElements.progressBar?r.tsx("div",{class:"esri-attachments__progress-bar",key:"progress-bar"}):null};b.renderAddForm=function(){const {submitting:a,selectedFile:d}=this;var n=a||!d,v=this.visibleElements.cancelAddButton?r.tsx("button",
{type:"button",bind:this,disabled:a,onclick:this._cancelForm,class:this.classes("esri-button","esri-button--tertiary","esri-button--small","esri-button--half",a&&"esri-button--disabled")},this.messages.cancel):null;n=this.visibleElements.addSubmitButton?r.tsx("button",{type:"submit",disabled:n,class:this.classes("esri-button","esri-button--secondary","esri-button--small","esri-button--half",{["esri-button--disabled"]:n})},this.messages.add):null;const l=d?r.tsx("span",{key:"file-name",class:"esri-attachments__file-name"},
d.name):null;v=r.tsx("form",{bind:this,afterCreate:G.storeNode,afterRemoved:G.discardNode,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},r.tsx("fieldset",{class:"esri-attachments__file-fieldset"},l,r.tsx("label",{class:this.classes("esri-attachments__file-label","esri-button","esri-button--secondary")},d?this.messages.changeFile:this.messages.selectFile,r.tsx("input",{class:"esri-attachments__file-input",type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))),
n,v);return r.tsx("div",{key:"add-form-container",class:"esri-attachments__form-node"},v)};b.renderDetailsForm=function(a){const {visibleElements:d,viewModel:n,selectedFile:v,submitting:l}=this,{contentType:e,size:p,url:f}=a;var {abilities:w}=n,J=l||!v,M=w.editing&&w.operations.delete&&d.deleteButton?r.tsx("button",{key:"delete-button",type:"button",disabled:l,bind:this,onclick:X=>this._submitDeleteAttachment(X,a),class:this.classes("esri-button","esri-button--small","esri-button--tertiary","esri-attachments__delete-button",
{["esri-button--disabled"]:l})},this.messages.delete):null;J=w.editing&&w.operations.update&&d.updateButton?r.tsx("button",{disabled:J,key:"update-button",type:"submit",class:this.classes("esri-button","esri-button--small","esri-button--third",{["esri-button--disabled"]:J})},this.messages.update):null;const Q=this.visibleElements.cancelUpdateButton?r.tsx("button",{disabled:l,key:"cancel-button",type:"button",bind:this,onclick:this._cancelForm,class:this.classes("esri-button","esri-button--small",
"esri-button--tertiary","esri-button--third",{["esri-button--disabled"]:l})},this.messages.cancel):null;var S=v?r.tsx("span",{key:"file-name",class:"esri-attachments__file-name"},v.name):null;w=w.editing&&w.operations.update?r.tsx("fieldset",{key:"file",class:"esri-attachments__file-fieldset"},S,r.tsx("label",{class:this.classes("esri-attachments__file-label","esri-button","esri-button--secondary")},this.messages.changeFile,r.tsx("input",{class:"esri-attachments__file-input",type:"file",name:"attachment",
bind:this,onchange:this._handleFileInputChange}))):null;S=r.tsx("fieldset",{key:"size",class:"esri-attachments__metadata-fieldset"},r.tsx("label",null,k.formatFileSize(this.messagesUnits,p)));const T=r.tsx("fieldset",{key:"content-type",class:"esri-attachments__metadata-fieldset"},r.tsx("label",null,e));M=r.tsx("form",{bind:this,afterCreate:G.storeNode,afterRemoved:G.discardNode,"data-node-ref":"_updateAttachmentForm",onsubmit:this._submitUpdateAttachment},r.tsx("div",{class:"esri-attachments__metadata"},
S,T),w,r.tsx("div",{class:"esri-attachments__actions"},M,Q,J));return r.tsx("div",{key:"edit-form-container",class:"esri-attachments__form-node"},r.tsx("a",{class:"esri-attachments__item-link",href:f,rel:"noreferrer",target:"_blank"},this.renderImageMask({attachmentInfo:a,size:400}),r.tsx("div",{class:"esri-attachments__item-link-overlay"},r.tsx("span",{class:"esri-attachments__item-link-overlay-icon"},r.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32"},r.tsx("path",
{d:"M28 13h1v16H3V3h16v1H4v24h24zm-5-9h4.293L15.646 15.638l.707.707L28 4.707V9h1V3h-6z"}),r.tsx("path",{fill:"none",d:"M0 0h32v32H0z"}))))),M)};b.renderImageMask=function({attachmentInfo:a,size:d}){var {supportsResizeAttachments:n}=this.viewModel;const {contentType:v,name:l,url:e}=a,p=n&&g.isSupportedImage(v);a=(a=this._getCSSTransform(a,p))?{transform:a,"image-orientation":"none"}:{};const f=-1===e.indexOf("?")?"?":"\x26";d=p?`${e}${f}w=${d}`:g.getIconPath(v);n={["esri-attachments__image--resizable"]:n};
return r.tsx("div",{class:this.classes({["esri-attachments__item-mask--icon"]:!p},"esri-attachments__item-mask")},r.tsx("img",{styles:a,alt:l,src:d,class:this.classes(n,"esri-attachments__image")}))};b.renderAttachmentInfo=function({attachmentInfo:a,displayType:d}){var {viewModel:n}=this;({abilities:n}=n);const {name:v,url:l}=a;d=this.renderImageMask({attachmentInfo:a,size:"list"===d?48:400});var e=n.editing?r.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-chevron-icon",
G.isRTL(this.container)?"esri-icon-left":"esri-icon-right")}):null;e=r.tsx("label",{class:"esri-attachments__label"},r.tsx("span",{class:"esri-attachments__filename"},v||this.messages.noTitle),e);d=[d,e];n=n.editing?r.tsx("button",{key:"details-button",bind:this,class:"esri-attachments__item-button",title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,"data-attachment-info-id":a.id,onclick:()=>this._startEditAttachment(a),type:"button"},d):r.tsx("a",{key:"details-link",
class:"esri-attachments__item-button",href:l,target:"_blank"},d);return r.tsx("li",{class:"esri-attachments__item",key:a},n)};b.renderAttachmentContainer=function(){const {displayType:a,viewModel:d,visibleElements:n}=this,{attachmentInfos:v,abilities:l}=d;var e=v&&v.length;const p={["esri-attachments__container--list"]:"preview"!==a,["esri-attachments__container--preview"]:"preview"===a},f=l.editing&&l.operations.add&&n.addButton?r.tsx("button",{bind:this,onclick:()=>this._startAddAttachment(),class:this.classes("esri-button",
"esri-button--tertiary","esri-attachments__add-attachment-button"),type:"button"},r.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-add-icon","esri-icon-plus")}),this.messages.add):null;e=e?r.tsx("ul",{class:"esri-attachments__items"},v.toArray().map(w=>this.renderAttachmentInfo({attachmentInfo:w,displayType:a}))):r.tsx("div",{class:"esri-widget__content--empty"},this.messages.noAttachments);return r.tsx("div",{key:"attachments-container",class:this.classes("esri-attachments__container",
p)},e,f)};b._modeChanged=function(){this._set("error",null);this._set("selectedFile",null)};b._handleFileInputChange=function(a){a=(a=a.target)&&a.files&&a.files.item(0);this._set("selectedFile",a)};b._submitDeleteAttachment=function(a,d){a.preventDefault();this.deleteAttachment(d)};b._submitAddAttachment=function(a){a.preventDefault();this.addAttachment()};b._submitUpdateAttachment=function(a){a.preventDefault();this.updateAttachment()};b._startEditAttachment=function(a){const {viewModel:d}=this;
d.activeAttachmentInfo=a;d.mode="edit"};b._startAddAttachment=function(){this.viewModel.mode="add"};b._cancelForm=function(a){a.preventDefault();this.viewModel.mode="view"};b._getCSSTransform=function(a,d){({orientationInfo:a}=a);return!this._supportsImageOrientation&&d&&a?[a.rotation?`rotate(${a.rotation}deg)`:"",a.mirrored?"scaleX(-1)":""].join(" "):""};return A}(F);m.__decorate([L.aliasOf("viewModel.abilities")],K.prototype,"abilities",void 0);m.__decorate([D.property()],K.prototype,"displayType",
void 0);m.__decorate([L.aliasOf("viewModel.graphic")],K.prototype,"graphic",void 0);m.__decorate([D.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],K.prototype,"label",void 0);m.__decorate([D.property(),y.messageBundle("esri/widgets/Attachments/t9n/Attachments")],K.prototype,"messages",void 0);m.__decorate([D.property(),y.messageBundle("esri/core/t9n/Units")],K.prototype,"messagesUnits",void 0);m.__decorate([D.property({readOnly:!0})],K.prototype,"selectedFile",void 0);m.__decorate([D.property({readOnly:!0})],
K.prototype,"submitting",void 0);m.__decorate([D.property({readOnly:!0})],K.prototype,"error",void 0);m.__decorate([D.property({type:c})],K.prototype,"viewModel",void 0);m.__decorate([D.property()],K.prototype,"visibleElements",void 0);m.__decorate([O.cast("visibleElements")],K.prototype,"castVisibleElements",null);return K=m.__decorate([B.subclass("esri.widgets.Attachments")],K)})},"esri/core/unitFormatUtils":function(){define(["exports","./mathUtils","./string","./unitUtils","../intl/number"],function(h,
m,t,k,z){function L(I,D,B){return I.units[D][B]}function K(I,D,B,F=2,c="abbr"){return`${z.formatNumber(D,{minimumFractionDigits:F,maximumFractionDigits:F})} ${L(I,B,c)}`}const O=["B","kB","MB","GB","TB"];h.formatAngleDegrees=function(I,D,B=2){I=k.convertUnit(I,D,"degrees");return z.formatNumber(I,{style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:B,minimumFractionDigits:B})};h.formatDMS=function(I,D,B=2){I=k.convertUnit(I,D,"degrees");D=I-Math.floor(I);I-=D;D*=60;let F=D-Math.floor(D);
D-=F;F*=60;return`${I.toFixed()}\u00b0 ${D.toFixed()}' ${F.toFixed(B)}"`};h.formatDecimal=K;h.formatFileSize=function(I,D){let B=0===D?0:Math.floor(Math.log(D)/Math.log(1024));B=m.clamp(B,0,O.length-1);D=z.formatNumber(D/1024**B,{maximumFractionDigits:2});return t.replace(I.units.bytes[O[B]],{fileSize:D})};h.formatImperialArea=function(I,D,B,F=2,c="abbr"){const g=k.preferredImperialAreaUnit(D,B);return K(I,k.convertUnit(D,B,g),g,F,c)};h.formatImperialLength=function(I,D,B,F=2,c="abbr"){const g=k.preferredImperialLengthUnit(D,
B);return K(I,k.convertUnit(D,B,g),g,F,c)};h.formatImperialVerticalLength=function(I,D,B,F=2,c="abbr"){const g=k.preferredImperialVerticalLengthUnit(D,B);return K(I,k.convertUnit(D,B,g),g,F,c)};h.formatMetricArea=function(I,D,B,F=2,c="abbr"){const g=k.preferredMetricAreaUnit(D,B);return K(I,k.convertUnit(D,B,g),g,F,c)};h.formatMetricLength=function(I,D,B,F=2,c="abbr"){const g=k.preferredMetricLengthUnit(D,B);return K(I,k.convertUnit(D,B,g),g,F,c)};h.formatMetricVerticalLength=function(I,D,B,F=2,c=
"abbr"){const g=k.preferredMetricVerticalLengthUnit(D,B);return K(I,k.convertUnit(D,B,g),g,F,c)};h.unitName=L;Object.defineProperty(h,"__esModule",{value:!0})})},"esri/widgets/Attachments/AttachmentsViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Graphic ../../core/Collection ../../core/Error ../../core/HandleOwner ../../core/maybe ../../core/watchUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/decorators/cast ../../core/Logger ../../core/accessorSupport/decorators/subclass ../../rest/query/support/AttachmentInfo ../../rest/support/AttachmentQuery ../Feature/support/featureUtils".split(" "),
function(h,m,t,k,z,L,K,O,I,D,B,F,c,g,G,y){const r={editing:!1,operations:{add:!0,update:!0,delete:!0}},H=k.ofType(g);k=function(E){function x(b){var a=E.call(this,b)||this;a._getAttachmentsPromise=null;a._attachmentLayer=null;a.abilities={...r};a.activeAttachmentInfo=null;a.attachmentInfos=new H;a.graphic=null;a.mode="view";a.handles.add([O.init(h._assertThisInitialized(a),"graphic",()=>a._graphicChanged())]);return a}h._inheritsLoose(x,E);var A=x.prototype;A.destroy=function(){this.graphic=this._attachmentLayer=
null};A.castAbilities=function(b){return{...r,...b}};A.getAttachments=function(){var b=h._asyncToGenerator(function*(){const {_attachmentLayer:a,attachmentInfos:d}=this;if(!a||"function"!==typeof a.queryAttachments)throw new z("invalid-layer","getAttachments(): A valid layer is required.");const n=this._getFeatureId();var v=new G({objectIds:[n],returnMetadata:!0});const l=[];this._getAttachmentsPromise=v=a.queryAttachments(v).then(e=>e[n]||l).catch(()=>l);this.notifyChange("state");v=yield v;d.removeAll();
v.length&&d.addMany(v);this._getAttachmentsPromise=null;this.notifyChange("state");return v});return function(){return b.apply(this,arguments)}}();A.addAttachment=function(){var b=h._asyncToGenerator(function*(a){const {_attachmentLayer:d,attachmentInfos:n,graphic:v,abilities:l}=this;if(!a)throw new z("invalid-attachment","addAttachment(): An attachment is required.",{attachment:a});if(!l.operations.add)throw new z("invalid-abilities","addAttachment(): add abilities are required.");if(!d||"function"!==
typeof d.addAttachment)throw new z("invalid-layer","addAttachment(): A valid layer is required.");a=yield d.addAttachment(v,a).then(e=>this._queryAttachment(e.objectId));n.add(a);return a});return function(a){return b.apply(this,arguments)}}();A.deleteAttachment=function(){var b=h._asyncToGenerator(function*(a){const {_attachmentLayer:d,attachmentInfos:n,graphic:v,abilities:l}=this;if(!a)throw new z("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:a});
if(!l.operations.delete)throw new z("invalid-abilities","deleteAttachment(): delete abilities are required.");if(!d||"function"!==typeof d.deleteAttachments)throw new z("invalid-layer","deleteAttachment(): A valid layer is required.");const e=yield d.deleteAttachments(v,[a.id]).then(()=>a);n.remove(e);return e});return function(a){return b.apply(this,arguments)}}();A.updateAttachment=function(){var b=h._asyncToGenerator(function*(a,d=this.activeAttachmentInfo){const {_attachmentLayer:n,attachmentInfos:v,
graphic:l,abilities:e}=this;if(!a)throw new z("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:a});if(!d)throw new z("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:d});if(!e.operations.update)throw new z("invalid-abilities","updateAttachment(): Update abilities are required.");const p=v.findIndex(f=>f===d);if(!n||"function"!==typeof n.updateAttachment)throw new z("invalid-layer","updateAttachment(): A valid layer is required.");
a=yield n.updateAttachment(l,d.id,a).then(f=>this._queryAttachment(f.objectId));v.splice(p,1,a);return a});return function(a){return b.apply(this,arguments)}}();A._queryAttachment=function(){var b=h._asyncToGenerator(function*(a){if(!a)throw new z("invalid-attachment-id","Could not query attachment.");const {_attachmentLayer:d}=this,n=this._getFeatureId();a=new G({objectIds:[n],attachmentsWhere:`AttachmentId=${a}`,returnMetadata:!0});return d.queryAttachments(a).then(v=>v[n][0])});return function(a){return b.apply(this,
arguments)}}();A._getFeatureId=function(){const {_attachmentLayer:b,graphic:a}=this;if(!b||!a)return null;const {objectIdField:d}=b,{attributes:n}=a;return n&&n[d]};A._graphicChanged=function(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch(()=>{}))};A._setAttachmentLayer=function(){var {graphic:b}=this;this._attachmentLayer=(b=y.getSourceLayer(b))?"scene"===b.type&&K.isSome(b.associatedLayer)?b.associatedLayer:b:null};h._createClass(x,[{key:"state",get:function(){return this._getAttachmentsPromise?
"loading":this.graphic?"ready":"disabled"}},{key:"supportsResizeAttachments",get:function(){return this.get("graphic.layer.capabilities.operations.supportsResizeAttachments")||!1}}]);return x}(L.HandleOwner);m.__decorate([I.property()],k.prototype,"abilities",void 0);m.__decorate([B.cast("abilities")],k.prototype,"castAbilities",null);m.__decorate([I.property()],k.prototype,"activeAttachmentInfo",void 0);m.__decorate([I.property({readOnly:!0,type:H})],k.prototype,"attachmentInfos",void 0);m.__decorate([I.property({type:t})],
k.prototype,"graphic",void 0);m.__decorate([I.property()],k.prototype,"mode",void 0);m.__decorate([I.property({readOnly:!0})],k.prototype,"state",null);m.__decorate([I.property({readOnly:!0})],k.prototype,"supportsResizeAttachments",null);return k=m.__decorate([c.subclass("esri.widgets.Attachments.AttachmentsViewModel")],k)})},"esri/widgets/Feature/support/featureUtils":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../intl ../../../core/Logger ../../../core/maybe ../../../core/string ../../../intl/date ../../../intl/number ../../../layers/support/fieldUtils ../../../popup/support/FieldInfoFormat ../../../support/arcadeOnDemand".split(" "),
function(h,m,t,k,z,L,K,O,I,D,B){function F(){F=m._asyncToGenerator(function*(q,u){return"function"===typeof q?q.call(null,u):q});return F.apply(this,arguments)}function c(q){return U.test(q)}function g(q,u){if(!c(u)||!q)return null;const C=u.replace(U,"").toLowerCase();let P;q.some(N=>N.name.toLowerCase()===C?(P=N,!0):!1);return P}function G(q,u){return(u=y(u,q))?u.name:q}function y(q,u){return q&&"function"===typeof q.getField?q.getField(u):null}function r({formattedAttributes:q,template:u,fieldInfoMap:C}){return`${L.replace(L.replace(u,
P=>{{const N=C.get(P.toLowerCase());P=`{${N&&N.fieldName||P}}`}return P}),q).replace(X,"")}`.trim()}function H(q,u,C=!1){const P=u[q];"string"===typeof P&&(C=(C?encodeURIComponent(P):P).replace(Y,"%27"),u[q]=C)}function E(q,u=!1){const C={...q};Object.keys(C).forEach(P=>H(P,C,u));return C}function x(q,u){return q.replace(V,(C,P,N)=>(C=y(u,N))?`{${C.name}}`:P)}function A(q,u,C){return(q=x(q,C))?q.replace(ha,(P,N,R)=>{N=`${N||R}`.trim();return L.replace(P,E(u,N&&"{"!==N[0]))}):q}function b(q,u){var C=
u.fieldName,P=a(u.fieldInfos,C),N=null==P?void 0:P.clone();P=u.preventPlacesFormatting;u=u.layer;C=y(u,C);if(N&&"date"===(null==C?void 0:C.type)){C=N.format||new D;C.dateFormat=C.dateFormat||"short-date-short-time";var R;if(!(R="feature"===(null==u?void 0:u.type)&&u.datesInUnknownTimezone)){if(R=!(null==u||!u.layer))R=u.layer,R="map-image"===(null==R?void 0:R.type);R=R&&u.layer.datesInUnknownTimezone}C.dateTimeFormatOptions=R?{timeZone:"UTC"}:null;N.format=C}N=N&&N.format;"string"!==typeof q||!N||
null!=N.dateFormat||null==N.places&&null==N.digitSeparator||(u=Number(q),isNaN(u)||(q=u));return"string"===typeof q||null==q||null==N?q:P?O.formatNumber(q,{...O.convertNumberFormatToIntlOptions(N),minimumFractionDigits:0,maximumFractionDigits:20}):N.format(q)}function a(q,u){if(q&&q.length&&u){var C=u.toLowerCase(),P=void 0;q.some(N=>N.fieldName&&N.fieldName.toLowerCase()===C?(P=N,!0):!1);return P}}function d({fieldName:q,graphic:u,layer:C}){if(M(q)||!C||"function"!==typeof C.getFeatureType)return null;
const {typeIdField:P}=C;return P&&q===P?(q=C.getFeatureType(u))?q.name:null:null}function n({fieldName:q,value:u,graphic:C,layer:P}){return M(q)||!P||"function"!==typeof P.getFieldDomain?null:(q=P.getFieldDomain(q,{feature:C}))&&"coded-value"===q.type?q.getName(u):null}function v(q){return"string"===typeof q?q.replace(aa,'\x3cbr class\x3d"esri-text-new-line" /\x3e'):q}function l(q){const {value:u,fieldName:C,fieldInfos:P,fieldInfoMap:N,layer:R,graphic:W}=q;return null==u?"":(q=n({fieldName:C,value:u,
graphic:W,layer:R}))||(q=d({fieldName:C,graphic:W,layer:R}))?q:N.get(C.toLowerCase())?b(u,{fieldInfos:P,fieldName:C,layer:R}):(q=R&&R.fieldsIndex)&&q.isDateField(C)?K.formatDate(u,da):v(u)}function e(q,u){return p.apply(this,arguments)}function p(){p=m._asyncToGenerator(function*(q,u){var C,P;const {layer:N,graphic:R,outFields:W,objectIds:Z,returnGeometry:ca,spatialReference:ia}=q;q=Z[0];if("number"!==typeof q&&"string"!==typeof q)return T.warn("Could not query required fields for the specified feature. The feature's ID is invalid.",
{layer:N,graphic:R,objectId:q,requiredFields:W}),null;if(null==(C=N.capabilities)||null==(P=C.operations)||!P.supportsQuery)return T.warn("The specified layer cannot be queried. The following fields will not be available.",{layer:N,graphic:R,requiredFields:W,returnGeometry:ca}),null;C=N.createQuery();C.objectIds=Z;C.outFields=null!=W&&W.length?W:[N.objectIdField];C.returnGeometry=!!ca;C.returnZ=!!ca;C.returnM=!!ca;C.outSpatialReference=ia;return(yield N.queryFeatures(C,u)).features[0]});return p.apply(this,
arguments)}function f(q){return w.apply(this,arguments)}function w(){w=m._asyncToGenerator(function*(q){var u;if(null==(u=q.expressionInfos)||!u.length)return!1;u=yield B.loadArcade();({arcadeUtils:{hasGeometryFunctions:u}}=u);return u(q)});return w.apply(this,arguments)}function J(){J=m._asyncToGenerator(function*({graphic:q,popupTemplate:u,layer:C,spatialReference:P},N){if(C&&u&&("function"===typeof C.load&&(yield C.load(N)),q.attributes)){var R=q.attributes[C.objectIdField];if(null!=R){R=[R];var W=
yield u.getRequiredFields(C.fieldsIndex),Z=I.featureHasFields(W,q);W=Z?[]:W;u=u.returnGeometry||(yield f(u));if(!Z||u)if(C=yield e({layer:C,graphic:q,outFields:W,objectIds:R,returnGeometry:u,spatialReference:P},N))C.geometry&&(q.geometry=C.geometry),C.attributes&&(q.attributes={...q.attributes,...C.attributes})}}});return J.apply(this,arguments)}function M(q=""){return q?-1!==q.indexOf("relationships/"):!1}function Q({attributes:q,graphic:u,relatedInfo:C}){q&&u&&C&&Object.keys(u.attributes).forEach(P=>
{var N={layerId:C.relation.id.toString(),fieldName:P};q[N?`${"relationships/"}${N.layerId}/${N.fieldName}`:""]=u.attributes[P]})}function S(q,u){q&&u&&(u.relatedFeatures&&u.relatedFeatures&&u.relatedFeatures.forEach(C=>Q({attributes:q,graphic:C,relatedInfo:u})),u.relatedStatsFeatures&&u.relatedStatsFeatures&&u.relatedStatsFeatures.forEach(C=>Q({attributes:q,graphic:C,relatedInfo:u})))}const T=k.getLogger("esri.widgets.Feature.support.featureUtils"),X=/href=(""|'')/gi,V=/(\{([^\{\r\n]+)\})/g,Y=/'/g,
U=/^\s*expression\//i,aa=/(\n)/gi,ba=/[\u00A0-\u9999<>&]/gim,ha=/href\s*=\s*(?:"([^"]+)"|'([^']+)')/gi,ja=/^(?:mailto:|tel:)/,da=K.convertDateFormatToIntlOptions("short-date-short-time"),ea=q=>{if(!q)return!1;q=q.toUpperCase();return-1<q.indexOf("CURRENT_TIMESTAMP")||-1<q.indexOf("CURRENT_DATE")||-1<q.indexOf("CURRENT_TIME")},fa=({layer:q,method:u,query:C,definitionExpression:P})=>{var N,R;null!=(N=q.capabilities)&&null!=(R=N.query)&&R.supportsCacheHint&&"attachments"!==u&&(q=z.isSome(C.where)&&C.where,
u=z.isSome(C.geometry)&&C.geometry,ea(P)||ea(q)||"extent"===(null==u?void 0:u.type)||"tile"===C.resultType||(C.cacheHint=!0))};h.applyTextFormattingHTML=v;h.createfieldInfoMap=function(q,u){const C=new Map;q&&q.forEach(P=>{const N=G(P.fieldName,u);P.fieldName=N;C.set(N.toLowerCase(),P)});return C};h.fixTokens=x;h.formatAttributes=function({fieldInfos:q,attributes:u,layer:C,graphic:P,fieldInfoMap:N,relatedInfos:R}){const W={...u};null==R?void 0:R.forEach(Z=>S(W,Z));Object.keys(W).forEach(Z=>{W[Z]=
l({fieldName:Z,fieldInfos:q,fieldInfoMap:N,layer:C,value:W[Z],graphic:P})});return W};h.formatEditInfo=function(q,u){const {creatorField:C,creationDateField:P,editorField:N,editDateField:R}=q;if(u){q=u[R];if("number"===typeof q)return u=u[N],{type:"edit",date:K.formatDate(q,da),user:u};q=u[P];return"number"===typeof q?(u=u[C],{type:"create",date:K.formatDate(q,da),user:u}):null}};h.formatValueToFieldInfo=b;h.getAllFieldInfos=function(q){const u=[];if(!q)return u;const {fieldInfos:C,content:P}=q;C&&
u.push(...C);if(!P||!Array.isArray(P))return u;P.forEach(N=>{"fields"===N.type&&(N=N&&N.fieldInfos)&&u.push(...N)});return u};h.getFieldInfo=a;h.getFieldInfoLabel=function(q,u){return(u=g(u,null==q?void 0:q.fieldName))?u.title||null:q?q.label||q.fieldName:null};h.getFixedFieldName=G;h.getFixedFieldNames=function(q,u){return q&&q.map(C=>G(C,u))};h.getSourceLayer=function(q){if(!z.isNone(q))return q.get("sourceLayer")||q.get("layer")};h.graphicCallback=function(q,u){return F.apply(this,arguments)};
h.htmlEntities=function(q){return q.replace(ba,u=>`&#${u.charCodeAt(0)};`)};h.isExpressionField=c;h.isRelatedField=M;h.preLayerQueryCallback=({query:q,layer:u,method:C})=>{fa({layer:u,method:C,query:q,definitionExpression:`${u.definitionExpression} ${u.serviceDefinitionExpression}`})};h.preRequestCallback=({queryPayload:q,layer:u,method:C})=>{fa({layer:u,method:C,query:q,definitionExpression:`${u.definitionExpression} ${u.serviceDefinitionExpression}`})};h.queryUpdatedFeature=function(q,u){return J.apply(this,
arguments)};h.shouldOpenInNewTab=function(q=""){if(q)return!ja.test(q.trim().toLowerCase())};h.substituteAttributes=r;h.substituteFieldsInLinksAndAttributes=function({attributes:q,globalAttributes:u,layer:C,text:P,expressionAttributes:N,fieldInfoMap:R}){return P?r({formattedAttributes:u,template:A(P,{...u,...N,...q},C),fieldInfoMap:R}):""};Object.defineProperty(h,"__esModule",{value:!0})})},"esri/widgets/Attachments/support/attachmentUtils":function(){define(["exports","../../../assets"],function(h,
m){h.getIconPath=function(t){const k=m.getAssetUrl("esri/themes/base/images/files/");return t?"text/plain"===t?`${k}text-32.svg`:"application/pdf"===t?`${k}pdf-32.svg`:"text/csv"===t?`${k}csv-32.svg`:"application/gpx+xml"===t?`${k}gpx-32.svg`:"application/x-dwf"===t?`${k}cad-32.svg`:"application/postscript"===t||"application/json"===t||"text/xml"===t||"model/vrml"===t?`${k}code-32.svg`:"application/x-zip-compressed"===t||"application/x-7z-compressed"===t||"application/x-gzip"===t||"application/x-tar"===
t||"application/x-gtar"===t||"application/x-bzip2"===t||"application/gzip"===t||"application/x-compress"===t||"application/x-apple-diskimage"===t||"application/x-rar-compressed"===t||"application/zip"===t?`${k}zip-32.svg`:-1!==t.indexOf("image/")?`${k}image-32.svg`:-1!==t.indexOf("audio/")?`${k}sound-32.svg`:-1!==t.indexOf("video/")?`${k}video-32.svg`:-1!==t.indexOf("msexcel")||-1!==t.indexOf("ms-excel")||-1!==t.indexOf("spreadsheetml")?`${k}excel-32.svg`:-1!==t.indexOf("msword")||-1!==t.indexOf("ms-word")||
-1!==t.indexOf("wordprocessingml")?`${k}word-32.svg`:-1!==t.indexOf("powerpoint")||-1!==t.indexOf("presentationml")?`${k}report-32.svg`:`${k}generic-32.svg`:`${k}generic-32.svg`};h.isSupportedImage=function(t){t=t.toLowerCase();return"image/bmp"===t||"image/emf"===t||"image/exif"===t||"image/gif"===t||"image/x-icon"===t||"image/jpeg"===t||"image/png"===t||"image/tiff"===t||"image/x-wmf"===t};Object.defineProperty(h,"__esModule",{value:!0})})},"esri/widgets/Feature/FeatureAttachments/FeatureAttachmentsViewModel":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../../Attachments/AttachmentsViewModel".split(" "),
function(h,m,t,k,z,L,K,O){k=function(I){function D(B){B=I.call(this,B)||this;B.description=null;B.title=null;return B}h._inheritsLoose(D,I);return D}(O);m.__decorate([t.property()],k.prototype,"description",void 0);m.__decorate([t.property()],k.prototype,"title",void 0);return k=m.__decorate([K.subclass("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")],k)})},"esri/widgets/Feature/support/FeatureElementInfo":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../../Widget ../../support/Heading ../../support/widgetUtils ../../support/jsxFactory".split(" "),
function(h,m,t,k,z,L,K,O,I,D,B){k=function(F){function c(G,y){G=F.call(this,G,y)||this;G.description=null;G.headingLevel=2;G.title=null;return G}h._inheritsLoose(c,F);var g=c.prototype;g.render=function(){return B.tsx("div",{class:"esri-feature-element-info"},this.renderTitle(),this.renderDescription())};g.renderTitle=function(){const {title:G}=this;return G?B.tsx(I.Heading,{level:this.headingLevel,class:"esri-feature-element-info__title"},G):null};g.renderDescription=function(){const {description:G}=
this;return G?B.tsx("div",{key:"description",class:"esri-feature-element-info__description"},G):null};return c}(O);m.__decorate([t.property()],k.prototype,"description",void 0);m.__decorate([t.property()],k.prototype,"headingLevel",void 0);m.__decorate([t.property()],k.prototype,"title",void 0);return k=m.__decorate([K.subclass("esri.widgets.Feature.support.FeatureElementInfo")],k)})},"esri/widgets/support/Heading":function(){define("exports ../../core/mathUtils ./widgetUtils ../../core/has ../../core/Logger ./jsxFactory".split(" "),
function(h,m,t,k,z,L){const K={heading:"esri-widget__heading"};h.CSS=K;h.Heading=function(O,I){const D=`h${m.clamp(Math.ceil(O.level),1,6)}`;delete O.level;return L.tsx(D,{...O,class:t.classes(K.heading,O.class)},I)};Object.defineProperty(h,"__esModule",{value:!0})})},"esri/widgets/Feature/FeatureContent":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/accessorSupport/decorators/aliasOf ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureContent/FeatureContentViewModel ./support/featureUtils ../support/widget ../support/jsxFactory".split(" "),
function(h,m,t,k,z,L,K,O,I,D,B,F,c){k=function(g){function G(r,H){r=g.call(this,r,H)||this;r.creator=null;r.graphic=null;r.viewModel=null;r._addTargetToAnchors=E=>{Array.from(E.querySelectorAll("a")).forEach(x=>{B.shouldOpenInNewTab(x.href)&&!x.hasAttribute("target")&&x.setAttribute("target","_blank")})};return r}h._inheritsLoose(G,g);var y=G.prototype;y.renderLoading=function(){return c.tsx("div",{class:"esri-feature-content__loader-container",key:"loader"},c.tsx("div",{class:"esri-feature-content__loader"}))};
y.renderCreated=function(){var r;const H=null==(r=this.viewModel)?void 0:r.created;return H?H instanceof HTMLElement?c.tsx("div",{key:H,bind:H,afterCreate:this._attachToNode}):F.isWidget(H)?c.tsx("div",{key:H},!H.destroyed&&H.render()):c.tsx("div",{key:H,innerHTML:H,afterCreate:this._addTargetToAnchors}):null};y.render=function(){var r;const H=null==(r=this.viewModel)?void 0:r.state;return c.tsx("div",{class:"esri-feature-content"},"loading"===H?this.renderLoading():this.renderCreated())};y._attachToNode=
function(r){r.appendChild(this)};return G}(I);m.__decorate([t.aliasOf("viewModel.creator")],k.prototype,"creator",void 0);m.__decorate([t.aliasOf("viewModel.graphic")],k.prototype,"graphic",void 0);m.__decorate([K.property({type:D})],k.prototype,"viewModel",void 0);return k=m.__decorate([O.subclass("esri.widgets.Feature.FeatureContent")],k)})},"esri/widgets/Feature/FeatureContent/FeatureContentViewModel":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Graphic ../../../core/Accessor ../../../core/HandleOwner ../../../core/watchUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../support/featureUtils".split(" "),
function(h,m,t,k,z,L,K,O,I,D,B,F){k=function(c){function g(y){var r=c.call(this,y)||this;r._loadingPromise=null;r.created=null;r.creator=null;r.destroyer=null;r.graphic=null;r.handles.add(L.init(h._assertThisInitialized(r),"creator",H=>{r._destroyContent();r._createContent(H)}));return r}h._inheritsLoose(g,c);var G=g.prototype;G.destroy=function(){this._destroyContent()};G._destroyContent=function(){const {created:y,graphic:r,destroyer:H}=this;y&&(F.graphicCallback(H,{graphic:r}).catch(()=>null),
this._set("created",null))};G._createContent=function(){var y=h._asyncToGenerator(function*(r){var {graphic:H}=this;this._loadingPromise=r=F.graphicCallback(r,{graphic:H}).catch(()=>null);this.notifyChange("state");H=yield r;r===this._loadingPromise&&(this._loadingPromise=null,this.notifyChange("state"),this._set("created",H))});return function(r){return y.apply(this,arguments)}}();h._createClass(g,[{key:"state",get:function(){return this._loadingPromise?"loading":"ready"}}]);return g}(z.HandleOwnerMixin(k));
m.__decorate([K.property({readOnly:!0})],k.prototype,"created",void 0);m.__decorate([K.property()],k.prototype,"creator",void 0);m.__decorate([K.property()],k.prototype,"destroyer",void 0);m.__decorate([K.property({type:t})],k.prototype,"graphic",void 0);m.__decorate([K.property({readOnly:!0})],k.prototype,"state",null);return k=m.__decorate([B.subclass("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],k)})},"esri/widgets/Feature/FeatureFields":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/watchUtils ../../core/accessorSupport/decorators/aliasOf ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureFields/FeatureFieldsViewModel ./support/FeatureElementInfo ../support/uriUtils ../support/widgetUtils ../support/decorators/messageBundle ../support/jsxFactory".split(" "),
function(h,m,t,k,z,L,K,O,I,D,B,F,c,g,G,y){z=function(r){function H(x,A){x=r.call(this,x,A)||this;x._featureElementInfo=null;x.attributes=null;x.description=null;x.expressionInfos=null;x.fieldInfos=null;x.title=null;x.viewModel=new B;x.messages=null;x.messagesURIUtils=null;return x}h._inheritsLoose(H,r);var E=H.prototype;E.initialize=function(){this._featureElementInfo=new F;t.init(this,["viewModel.description","viewModel.title"],()=>this._setupFeatureElementInfo())};E.destroy=function(){this._featureElementInfo.destroy()};
E.renderFieldInfo=function(x,A){var {attributes:b}=this.viewModel;const a=x.fieldName,d=x.label||a;b=b?null==b[a]?"":b[a]:"";x=!(!x.format||!x.format.dateFormat);b="number"!==typeof b||x?c.autoLink(this.messagesURIUtils,b):this._forceLTR(b);x={["esri-feature-fields__field-data--date"]:x};return y.tsx("tr",{key:`fields-element-info-row-${a}-${A}`},y.tsx("th",{key:`fields-element-info-row-header-${a}-${A}`,class:"esri-feature-fields__field-header",innerHTML:d}),y.tsx("td",{key:`fields-element-info-row-data-${a}-${A}`,
class:this.classes("esri-feature-fields__field-data",x),innerHTML:b}))};E.renderFields=function(){const {formattedFieldInfos:x}=this.viewModel;return null!=x&&x.length?y.tsx("table",{class:"esri-widget__table",summary:this.messages.fieldsSummary},y.tsx("tbody",null,x.map((A,b)=>this.renderFieldInfo(A,b)))):null};E.render=function(){var x;return y.tsx("div",{class:"esri-feature-fields"},null==(x=this._featureElementInfo)?void 0:x.render(),this.renderFields())};E._setupFeatureElementInfo=function(){const {description:x,
title:A}=this;this._featureElementInfo.set({description:x,title:A})};E._forceLTR=function(x){return`&lrm;${x}`};return H}(D);m.__decorate([k.aliasOf("viewModel.attributes")],z.prototype,"attributes",void 0);m.__decorate([k.aliasOf("viewModel.description")],z.prototype,"description",void 0);m.__decorate([k.aliasOf("viewModel.expressionInfos")],z.prototype,"expressionInfos",void 0);m.__decorate([k.aliasOf("viewModel.fieldInfos")],z.prototype,"fieldInfos",void 0);m.__decorate([k.aliasOf("viewModel.title")],
z.prototype,"title",void 0);m.__decorate([O.property({type:B})],z.prototype,"viewModel",void 0);m.__decorate([O.property(),G.messageBundle("esri/widgets/Feature/t9n/Feature")],z.prototype,"messages",void 0);m.__decorate([O.property(),G.messageBundle("esri/widgets/support/t9n/uriUtils")],z.prototype,"messagesURIUtils",void 0);return z=m.__decorate([I.subclass("esri.widgets.Feature.FeatureFields")],z)})},"esri/widgets/Feature/FeatureFields/FeatureFieldsViewModel":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../../../popup/ExpressionInfo ../../../popup/FieldInfo ../support/featureUtils".split(" "),
function(h,m,t,k,z,L,K,O,I,D,B){t=function(F){function c(g){g=F.call(this,g)||this;g.attributes=null;g.expressionInfos=null;g.description=null;g.fieldInfos=null;g.title=null;return g}h._inheritsLoose(c,F);h._createClass(c,[{key:"formattedFieldInfos",get:function(){const {expressionInfos:g,fieldInfos:G}=this,y=[];null==G?void 0:G.forEach(r=>{if(!r.hasOwnProperty("visible")||r.visible)r=r.clone(),r.label=B.getFieldInfoLabel(r,g),y.push(r)});return y}}]);return c}(t);m.__decorate([k.property()],t.prototype,
"attributes",void 0);m.__decorate([k.property({type:[I]})],t.prototype,"expressionInfos",void 0);m.__decorate([k.property()],t.prototype,"description",void 0);m.__decorate([k.property({type:[D]})],t.prototype,"fieldInfos",void 0);m.__decorate([k.property({readOnly:!0})],t.prototype,"formattedFieldInfos",null);m.__decorate([k.property()],t.prototype,"title",void 0);return t=m.__decorate([O.subclass("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")],t)})},"esri/widgets/support/uriUtils":function(){define(["exports",
"../../core/string"],function(h,m){function t(z){let L=null;k.some(K=>{K.pattern.test(z)&&(L=K);return!!L});return L}const k=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",
appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",
appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];h.autoLink=function(z,L){if("string"!==typeof L||!L)return L;const K=t(L);if(!K)return L;const O=L.match(K.pattern);
z=m.replace(m.replace(K.label,{messages:z,hierPart:O&&O[2]}),{appName:K.appName});return L.replace(K.pattern,`<a${K.target?` target="${K.target}"`:""} href="$1"${"_blank"===K.target?' rel\x3d"noreferrer"':""}>${z}</a>`)};Object.defineProperty(h,"__esModule",{value:!0})})},"esri/widgets/Feature/FeatureMedia":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/events ../../core/watchUtils ../../core/accessorSupport/decorators/aliasOf ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureMedia/FeatureMediaViewModel ./support/FeatureElementInfo ./support/featureUtils ../support/chartUtils ../support/widgetUtils ../support/decorators/messageBundle ../support/jsxFactory".split(" "),
function(h,m,t,k,z,L,K,O,I,D,B,F,c,g,G,y,r,H){L=function(E){function x(b,a){b=E.call(this,b,a)||this;b._refreshTimer=null;b._refreshIntervalInfo=null;b._featureElementInfo=null;b.attributes=null;b.activeMediaInfoIndex=null;b.description=null;b.fieldInfoMap=null;b.layer=null;b.mediaInfos=null;b.popupTemplate=null;b.relatedInfos=null;b.title=null;b.viewModel=new F;b.messages=null;return b}h._inheritsLoose(x,E);var A=x.prototype;A.initialize=function(){this._featureElementInfo=new c;this.own(k.init(this,
["viewModel.activeMediaInfo","viewModel.activeMediaInfoIndex"],()=>this._setupMediaRefreshTimer()),k.init(this,["viewModel.description","viewModel.title"],()=>this._setupFeatureElementInfo()))};A.destroy=function(){this._clearMediaRefreshTimer();this._featureElementInfo.destroy()};A.render=function(){var b;return H.tsx("div",{bind:this,class:"esri-feature-media",onkeyup:this._handleMediaKeyup},null==(b=this._featureElementInfo)?void 0:b.render(),this.renderMedia())};A.renderMedia=function(){const {formattedMediaInfoCount:b}=
this.viewModel;return b?H.tsx("div",{key:"media-element-container",class:"esri-feature-media__container"},this.renderMediaPageButton("previous"),this.renderMediaInfo(),this.renderMediaPageButton("next")):null};A.renderImageMediaInfo=function(b){var {_refreshIntervalInfo:a}=this;const {activeMediaInfoIndex:d,formattedMediaInfoCount:n}=this.viewModel,{value:v,refreshInterval:l,altText:e,title:p,type:f}=b,{sourceURL:w,linkURL:J}=v;b=g.shouldOpenInNewTab(J)?"_blank":"_self";const M="_blank"===b?"noreferrer":
"";a=l?a:null;a=H.tsx("img",{alt:e||p,key:`media-${f}-${d}-${n}-${a?a.timestamp:0}`,src:a?a.sourceURL:w});return(b=J?H.tsx("a",{title:p,href:J,rel:M,target:b},a):null)?b:a};A.renderChartMediaInfo=function(b){const {activeMediaInfoIndex:a,formattedMediaInfoCount:d}=this.viewModel;return H.tsx("div",{key:`media-${b.type}-${a}-${d}`,bind:this,class:"esri-feature-media__chart",afterCreate:this._getChartDependencies})};A.renderMediaInfoType=function(){const {activeMediaInfo:b}=this.viewModel;return b?
"image"===b.type?this.renderImageMediaInfo(b):-1!==b.type.indexOf("chart")?this.renderChartMediaInfo(b):null:null};A.renderMediaInfo=function(){var {activeMediaInfo:b}=this.viewModel;if(!b)return null;const a=b.title?H.tsx("div",{key:"media-title",class:"esri-feature-media__item-title",innerHTML:b.title}):null;b=b.caption?H.tsx("div",{key:"media-caption",class:"esri-feature-media__item-caption",innerHTML:b.caption}):null;return H.tsx("div",{key:"media-container",class:"esri-feature-media__item-container"},
H.tsx("div",{key:"media-item-container",class:"esri-feature-media__item"},this.renderMediaInfoType()),a,b)};A.renderMediaPageButton=function(b){if(2>this.viewModel.formattedMediaInfoCount)return null;const a=(b="previous"===b)?this.messages.previous:this.messages.next,d=b?this.classes("esri-feature-media__button","esri-feature-media__previous"):this.classes("esri-feature-media__button","esri-feature-media__next"),n=b?this.classes("esri-feature-media__icon","esri-feature-media__previous-icon","esri-icon-left-triangle-arrow"):
this.classes("esri-feature-media__icon","esri-feature-media__next-icon","esri-icon-right-triangle-arrow"),v=b?this.classes("esri-feature-media__icon","esri-feature-media__previous-icon--rtl","esri-icon-right-triangle-arrow"):this.classes("esri-feature-media__icon","esri-feature-media__next-icon--rtl","esri-icon-left-triangle-arrow");return H.tsx("button",{type:"button",key:b?"media-previous":"media-next",title:a,"aria-label":a,tabIndex:0,class:d,bind:this,onclick:b?this._previous:this._next},H.tsx("span",
{"aria-hidden":"true",class:n}),H.tsx("span",{"aria-hidden":"true",class:v}))};A._setupFeatureElementInfo=function(){const {description:b,title:a}=this;this._featureElementInfo.set({description:b,title:a})};A._next=function(){this.viewModel.next()};A._previous=function(){this.viewModel.previous()};A._getChartDependencies=function(){var b=h._asyncToGenerator(function*(a){const d=yield G.loadChartsModule(),{activeMediaInfo:n}=this.viewModel;this._renderChart({chartDiv:a,mediaInfo:n,chartsModule:d})});
return function(a){return b.apply(this,arguments)}}();A._handleMediaKeyup=function(b){const a=t.eventKey(b);"ArrowLeft"===a&&(b.stopPropagation(),this.viewModel.previous());"ArrowRight"===a&&(b.stopPropagation(),this.viewModel.next())};A._renderChart=function(b){const {chartsModule:a,chartDiv:d,mediaInfo:n}=b,{value:v,type:l}=n,{am4core:e}=a,p=G.getColorSet(e);y.isDarkTheme()&&e.useTheme(a.am4themes_dark);e.useTheme(a.am4themes_animated);e.useTheme(function(f){f instanceof e.ColorSet&&p&&(f.list=
p)});b="pie-chart"===l?this._createPieChart(b):this._createXYChart(b);d.setAttribute("aria-label",n.altText||n.title);b.data=v.series.map(f=>({tooltip:f.tooltip,value:f.value})).filter(f=>"pie-chart"===l?0<f.value:!0)};A._customizeChartTooltip=function(b,a){b.label.wrap=!0;b.label.maxWidth=200;b.autoTextColor=!1;b.getFillFromObject=!1;b.label.fill=a.color("#ffffff");b.background.fill=a.color({r:0,g:0,b:0,a:.7})};A._createPieChart=function(b){const {chartDiv:a,chartsModule:d}=b,{am4core:n,am4charts:v}=
d;b=n.create(a,v.PieChart);b.rtl=y.isRTL(this.container);const l=b.series.push(new v.PieSeries);l.labels.template.disabled=!0;l.ticks.template.disabled=!0;l.dataFields.value="value";l.dataFields.category="tooltip";this._customizeChartTooltip(l.tooltip,n);return b};A._getMinSeriesValue=function(b){let a=0;b.forEach(d=>a=Math.min(d.value,a));return a};A._createColumnChart=function(b,a){const {chartsModule:d,mediaInfo:n}=a;({value:a}=n);const {am4core:v,am4charts:l}=d,e=b.xAxes.push(new l.CategoryAxis);
e.dataFields.category="tooltip";e.renderer.labels.template.disabled=!0;this._customizeChartTooltip(e.tooltip,v);e.tooltip.events.on("sizechanged",()=>{e.tooltip.dy=-e.tooltip.contentHeight});var p=b.yAxes.push(new l.ValueAxis);const f=p.renderer.labels.template;p.renderer.minLabelPosition=.05;p.renderer.maxLabelPosition=.95;p.min=this._getMinSeriesValue(a.series);this._customizeChartTooltip(p.tooltip,v);f.wrap=!0;p=b.series.push(new l.ColumnSeries);p.dataFields.valueY="value";p.dataFields.categoryX=
"tooltip";b.cursor=new l.XYCursor;15<a.series.length&&(b.scrollbarX=new v.Scrollbar)};A._createBarChart=function(b,a){const {chartsModule:d,mediaInfo:n}=a;({value:a}=n);const {am4core:v,am4charts:l}=d,e=b.yAxes.push(new l.CategoryAxis);e.dataFields.category="tooltip";e.renderer.inversed=!0;e.renderer.labels.template.disabled=!0;this._customizeChartTooltip(e.tooltip,v);e.tooltip.events.on("sizechanged",()=>{e.tooltip.dx=e.tooltip.contentWidth});var p=b.xAxes.push(new l.ValueAxis);const f=p.renderer.labels.template;
p.renderer.minLabelPosition=.05;p.renderer.maxLabelPosition=.95;p.min=this._getMinSeriesValue(a.series);this._customizeChartTooltip(p.tooltip,v);f.wrap=!0;p=b.series.push(new l.ColumnSeries);p.dataFields.valueX="value";p.dataFields.categoryY="tooltip";b.cursor=new l.XYCursor;15<a.series.length&&(b.scrollbarY=new v.Scrollbar)};A._createLineChart=function(b,a){const {chartsModule:d,mediaInfo:n}=a;({value:a}=n);const {am4core:v,am4charts:l}=d,e=b.xAxes.push(new l.CategoryAxis);e.dataFields.category=
"tooltip";e.renderer.labels.template.disabled=!0;this._customizeChartTooltip(e.tooltip,v);e.tooltip.events.on("sizechanged",()=>{e.tooltip.dy=-e.tooltip.contentHeight});var p=b.yAxes.push(new l.ValueAxis);const f=p.renderer.labels.template;p.renderer.minLabelPosition=.05;p.renderer.maxLabelPosition=.95;p.min=this._getMinSeriesValue(a.series);this._customizeChartTooltip(p.tooltip,v);f.wrap=!0;p=b.series.push(new l.LineSeries);p.dataFields.categoryX="tooltip";p.dataFields.valueY="value";b.cursor=new l.XYCursor;
15<a.series.length&&(b.scrollbarX=new v.Scrollbar)};A._createXYChart=function(b){const {chartDiv:a,chartsModule:d,mediaInfo:n}=b,{type:v}=n,{am4core:l,am4charts:e}=d,p=l.create(a,e.XYChart);p.rtl=y.isRTL(this.container);"column-chart"===v&&this._createColumnChart(p,b);"bar-chart"===v&&this._createBarChart(p,b);"line-chart"===v&&this._createLineChart(p,b);return p};A._clearMediaRefreshTimer=function(){const {_refreshTimer:b}=this;b&&(clearTimeout(b),this._refreshTimer=null)};A._updateMediaInfoTimestamp=
function(b){const a=Date.now();this._refreshIntervalInfo={timestamp:a,sourceURL:this._getImageSource(b,a)};this.scheduleRender()};A._setupMediaRefreshTimer=function(){this._clearMediaRefreshTimer();const {activeMediaInfo:b}=this.viewModel;b&&"image"===b.type&&b.refreshInterval&&this._setRefreshTimeout(b)};A._setRefreshTimeout=function(b){const {refreshInterval:a,value:d}=b;a&&(b=6E4*a,this._updateMediaInfoTimestamp(d.sourceURL),this._refreshTimer=setInterval(()=>{this._updateMediaInfoTimestamp(d.sourceURL)},
b))};A._getImageSource=function(b,a){const d=-1!==b.indexOf("?")?"\x26":"?",[n,v=""]=b.split("#");return`${n}${d}timestamp=${a}${v?"#":""}${v}`};return x}(B);m.__decorate([z.aliasOf("viewModel.attributes")],L.prototype,"attributes",void 0);m.__decorate([z.aliasOf("viewModel.activeMediaInfoIndex")],L.prototype,"activeMediaInfoIndex",void 0);m.__decorate([z.aliasOf("viewModel.description")],L.prototype,"description",void 0);m.__decorate([z.aliasOf("viewModel.fieldInfoMap")],L.prototype,"fieldInfoMap",
void 0);m.__decorate([z.aliasOf("viewModel.layer")],L.prototype,"layer",void 0);m.__decorate([z.aliasOf("viewModel.mediaInfos")],L.prototype,"mediaInfos",void 0);m.__decorate([z.aliasOf("viewModel.popupTemplate")],L.prototype,"popupTemplate",void 0);m.__decorate([z.aliasOf("viewModel.relatedInfos")],L.prototype,"relatedInfos",void 0);m.__decorate([z.aliasOf("viewModel.title")],L.prototype,"title",void 0);m.__decorate([I.property({type:F})],L.prototype,"viewModel",void 0);m.__decorate([I.property(),
r.messageBundle("esri/widgets/Feature/t9n/Feature")],L.prototype,"messages",void 0);return L=m.__decorate([D.subclass("esri.widgets.Feature.FeatureMedia")],L)})},"esri/widgets/Feature/FeatureMedia/FeatureMediaViewModel":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../../../popup/FieldInfo ../../../popup/content/support/ChartMediaInfoValueSeries ../support/featureUtils ../support/relatedFeatureUtils".split(" "),
function(h,m,t,k,z,L,K,O,I,D,B,F){t=function(c){function g(y){y=c.call(this,y)||this;y.activeMediaInfoIndex=0;y.attributes=null;y.description=null;y.fieldInfoMap=null;y.formattedAttributes=null;y.expressionAttributes=null;y.layer=null;y.mediaInfos=null;y.popupTemplate=null;y.relatedInfos=null;y.title=null;return y}h._inheritsLoose(g,c);var G=g.prototype;G.setActiveMedia=function(y){this._setContentElementMedia(y)};G.next=function(){this._pageContentElementMedia(1)};G.previous=function(){this._pageContentElementMedia(-1)};
G._setContentElementMedia=function(y){const {formattedMediaInfoCount:r}=this;this.activeMediaInfoIndex=(y+r)%r};G._pageContentElementMedia=function(y){const {activeMediaInfoIndex:r}=this;this._setContentElementMedia(r+y)};G._formatMediaInfos=function(){const {attributes:y,mediaInfos:r,formattedAttributes:H,expressionAttributes:E,fieldInfoMap:x,layer:A}=this;return null==r?void 0:r.map(b=>{if(!b)return null;b.title=B.substituteFieldsInLinksAndAttributes({attributes:y,fieldInfoMap:x,globalAttributes:H,
expressionAttributes:E,layer:A,text:b.title});b.caption=B.substituteFieldsInLinksAndAttributes({attributes:y,fieldInfoMap:x,globalAttributes:H,expressionAttributes:E,layer:A,text:b.caption});b.altText=B.substituteFieldsInLinksAndAttributes({attributes:y,fieldInfoMap:x,globalAttributes:H,expressionAttributes:E,layer:A,text:b.altText});if("image"===b.type){var {value:a}=b;this._setImageValue({value:a,formattedAttributes:H,layer:A});return b.value.sourceURL?b:void 0}return"pie-chart"===b.type||"line-chart"===
b.type||"column-chart"===b.type||"bar-chart"===b.type?({value:a}=b,this._setChartValue({value:a,chartType:b.type,attributes:y,formattedAttributes:H,layer:A}),b):null}).filter(Boolean)};G._setImageValue=function(y){const {fieldInfoMap:r}=this,{value:H,formattedAttributes:E,layer:x}=y,{linkURL:A,sourceURL:b}=H;b&&(y=B.fixTokens(b,x),H.sourceURL=B.substituteAttributes({formattedAttributes:E,template:y,fieldInfoMap:r}));A&&(y=B.fixTokens(A,x),H.linkURL=B.substituteAttributes({formattedAttributes:E,template:y,
fieldInfoMap:r}))};G._setChartValue=function(y){const {value:r,attributes:H,formattedAttributes:E,chartType:x,layer:A}=y,{popupTemplate:b,relatedInfos:a}=this,{fields:d,normalizeField:n}=r;r.fields=B.getFixedFieldNames(d,A);n&&(r.normalizeField=B.getFixedFieldName(n,A));if(d.some(l=>!!(null!=E[l]||B.isRelatedField(l)&&a.size))){var v=null==b?void 0:b.fieldInfos;d.forEach(l=>{B.isRelatedField(l)?r.series=[...r.series,...this._getRelatedChartInfos({fieldInfos:v,fieldName:l,formattedAttributes:E,chartType:x,
value:r})]:(l=this._getChartOption({value:r,attributes:H,chartType:x,formattedAttributes:E,fieldName:l,fieldInfos:v}),r.series.push(l))})}};G._getRelatedChartInfos=function(y){var r;const {fieldInfos:H,fieldName:E,formattedAttributes:x,chartType:A,value:b}=y,a=[];y=F.getRelatedFieldInfo(E);const {layerId:d,fieldName:n}=y;y=null==(r=this.relatedInfos)?void 0:r.get(d.toString());if(!y)return a;const {relatedFeatures:v,relation:l}=y;if(!l||!v)return a;({cardinality:r}=l);v.forEach(e=>{const {attributes:p}=
e;p&&Object.keys(p).forEach(f=>{f===n&&a.push(this._getChartOption({value:b,attributes:p,formattedAttributes:x,fieldName:E,chartType:A,relatedFieldName:f,fieldInfos:H}))})});return"one-to-many"===r||"many-to-many"===r?a:[a[0]]};G._getTooltip=function({label:y,value:r,chartType:H}){return"pie-chart"===H?y:`${y}: ${r}`};G._getChartOption=function(y){const {value:r,attributes:H,formattedAttributes:E,fieldName:x,relatedFieldName:A,fieldInfos:b,chartType:a}=y;var {layer:d}=this;const {normalizeField:n,
tooltipField:v}=r;var l=n?B.isRelatedField(n)?H[F.getRelatedFieldInfo(n).fieldName]:H[n]:null;y=A&&void 0!==H[A]?H[A]:void 0!==H[x]?H[x]:E[x];const e=void 0===y?null:y&&l?y/l:y;y=new D({value:e});if(B.isRelatedField(x)){var p=F.getRelatedFieldInfo(x);var f=F.getRelatedFieldInfo(v);f=f?f.fieldName:null;d=B.formatValueToFieldInfo(e,{fieldInfos:b,fieldName:A,layer:d,preventPlacesFormatting:!!l});p=p?p.label||p.fieldName:A;y.tooltip=this._getTooltip({label:f&&void 0!==H[f]?H[f]:p,value:d,chartType:a});
return y}l=B.getFieldInfo(b,x);d=B.getFixedFieldName(x,d);l=v&&void 0!==E[v]?E[v]:B.getFieldInfoLabel(l||new I({fieldName:d}),null==(p=this.popupTemplate)?void 0:p.expressionInfos);y.tooltip=this._getTooltip({label:l,value:E[d],chartType:a});return y};h._createClass(g,[{key:"activeMediaInfo",get:function(){return this.formattedMediaInfos[this.activeMediaInfoIndex]||null}},{key:"formattedMediaInfos",get:function(){return this._formatMediaInfos()||[]}},{key:"formattedMediaInfoCount",get:function(){return this.formattedMediaInfos.length}}]);
return g}(t);m.__decorate([k.property()],t.prototype,"activeMediaInfoIndex",void 0);m.__decorate([k.property({readOnly:!0})],t.prototype,"activeMediaInfo",null);m.__decorate([k.property()],t.prototype,"attributes",void 0);m.__decorate([k.property()],t.prototype,"description",void 0);m.__decorate([k.property()],t.prototype,"fieldInfoMap",void 0);m.__decorate([k.property()],t.prototype,"formattedAttributes",void 0);m.__decorate([k.property()],t.prototype,"expressionAttributes",void 0);m.__decorate([k.property({readOnly:!0})],
t.prototype,"formattedMediaInfos",null);m.__decorate([k.property()],t.prototype,"layer",void 0);m.__decorate([k.property({readOnly:!0})],t.prototype,"formattedMediaInfoCount",null);m.__decorate([k.property()],t.prototype,"mediaInfos",void 0);m.__decorate([k.property()],t.prototype,"popupTemplate",void 0);m.__decorate([k.property()],t.prototype,"relatedInfos",void 0);m.__decorate([k.property()],t.prototype,"title",void 0);return t=m.__decorate([O.subclass("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")],
t)})},"esri/widgets/Feature/support/relatedFeatureUtils":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../request ../../../core/Error ../../../core/Logger ../../../core/promiseUtils ../../../layers/support/fieldUtils ../../../rest/support/Query ../../../rest/support/RelationshipQuery ../../../rest/support/StatisticDefinition ../../../tasks/QueryTask ./featureUtils".split(" "),function(h,m,t,k,z,L,K,O,I,D,B,F){function c(a,d){if(!d.relationships)return null;let n=null;
({relationships:d}=d);d.some(v=>v.id===parseInt(a,10)?(n=v,!0):!1);return n}function g({originRelationship:a,relationships:d,layerId:n}){let v;d&&d.some(l=>{`${l.relatedTableId}`===n&&l.id===a.id&&(v=l);return!!v});return v}function G(a,d){d=d.toLowerCase();for(const n in a)if(n.toLowerCase()===d)return a[n];return null}function y(a,d,n,v){const l=new I;l.outFields=["*"];l.relationshipId="number"===typeof d.id?d.id:parseInt(d.id,10);l.objectIds=[a.attributes[n.objectIdField]];return n.queryRelatedFeatures(l,
v)}function r(a,d,n){let v=0;const l=[];for(;v<d.length;)l.push(`${a} IN (${d.slice(v,n+v)})`),v+=n;return l.join(" OR ")}function H(a,d,n,v){return E.apply(this,arguments)}function E(){E=m._asyncToGenerator(function*(a,d,n,v){var l=n.layerId.toString();const {layerInfo:e,queryTask:p,relation:f,relatedFields:w,outStatistics:J}=d;l=g({originRelationship:f,relationships:e.relationships,layerId:l});if(l.relationshipTableId&&l.keyFieldInRelationshipTable){n=(yield y(a,l,n,v))[a.attributes[n.objectIdField]];
if(!n)return null;const M=n.features.map(Q=>Q.attributes[e.objectIdField]);if(0<(null==J?void 0:J.length)&&e.supportsStatistics)return d=new O,d.where=r(e.objectIdField,M,1E3),d.outFields=w,d.outStatistics=J,d={features:Promise.resolve(n),statsFeatures:p.execute(d)},L.eachAlways(d)}return(l=null==l?void 0:l.keyField)?(n=K.isNumericField(x(e.fields,l)),a=G(a.attributes,f.keyField),l=n?`${l}=${a}`:`${l}='${a}'`,a=p.execute(new O({where:l,outFields:d.relatedFields}),v),d=d.outStatistics&&0<d.outStatistics.length&&
e.supportsStatistics?p.execute(new O({where:l,outFields:d.relatedFields,outStatistics:d.outStatistics}),v):null,v={features:a},d&&(v.statsFeatures=d),L.eachAlways(v)):null});return E.apply(this,arguments)}function x(a,d){if(null!=a){d=d.toLowerCase();for(const n of a)if(n&&n.name.toLowerCase()===d)return n}return null}const A=z.getLogger("esri.widgets.Feature.support.relatedFeatureUtils"),b=new Map;h.createRelatedInfo=function(a,d){if(a=c(a,d)){var n=`${d.url}/${a.relatedTableId}`;d=new B({url:n,
sourceSpatialReference:d.spatialReference});return{url:n,queryTask:d,relation:a,relatedFields:[],outStatistics:[]}}};h.getDestinationRelation=g;h.getRelatedFieldInfo=function(a){if(!F.isRelatedField(a))return null;const [d,n]=a.split("/").slice(1);return{layerId:d,fieldName:n}};h.queryLayerInfos=function({relatedInfos:a,layer:d},n){const v={};a.forEach((l,e)=>{({relation:l}=l);if(!l)throw e=new k("relation-required","A relation is required on a layer to retrieve related records."),A.error(e),e;({relatedTableId:l}=
l);if("number"!==typeof l)throw e=new k("A related table ID is required on a layer to retrieve related records."),A.error(e),e;l=`${d.url}/${l}`;const p=b.get(l),f=p?p:t(l,{query:{f:"json"},signal:n&&n.signal});p||b.set(l,f);v[e]=f});return L.eachAlways(v)};h.queryRelatedFeatures=function({graphic:a,relatedInfos:d,layer:n},v){const l={};d.forEach((e,p)=>{e.layerInfo&&(l[p]=H(a,e,n,v))});return L.eachAlways(l)};h.setRelatedFeatures=function(a,d){if(d&&a){var {features:n,statsFeatures:v}=a;a=n&&n.value;
d.relatedFeatures=a?a.features:[];a=v&&v.value;d.relatedStatsFeatures=a?a.features:[]}};h.updateRelatedInfo=function({relatedInfo:a,fieldName:d,fieldInfo:n}){a.relatedFields.push(d);n.statisticType&&(d=new D({statisticType:n.statisticType,onStatisticField:d,outStatisticFieldName:d}),a.outStatistics.push(d))};Object.defineProperty(h,"__esModule",{value:!0})})},"esri/widgets/support/chartUtils":function(){define("require exports ../../chunks/_rollupPluginBabelHelpers ../../intl ../../core/has ../../intl/locale".split(" "),
function(h,m,t,k,z,L){function K(c){if(!c)return"en-us";if(D.has(c.toLowerCase()))return c.toLowerCase();{c=c.split("-")[0].toLowerCase();let G=null;for(g of D.keys())if(g.startsWith(c)){G=g;break}var g=G}return g||"en-us"}function O(){O=t._asyncToGenerator(function*(c=L.getLocale()){c=K(c);if(B&&c===F)return B;B=(new Promise(function(g,G){h(["../../chunks/index"],g,G)})).then(function(g){return g.index});F=c;try{const [g,G]=yield Promise.all([B,D.get(F)()]);F===c&&(g.am4core.options.defaultLocale=
G.default);g.am4core.options.suppressWarnings=!0;g.am4core.options.autoDispose=!0}catch{return F=B=null}return B});return O.apply(this,arguments)}k="#ffffff #858585 #ffbebe #ffebbe #ffebaf #ffffbe #e9ffbe #d3ffbe #beffe8 #bee8ff #bed2ff #e8beff #ffbee8 #ebebeb #707070 #ff7f7f #ffa77f #ffd37f #ffff73 #d1ff73 #a3ff73 #73ffdf #73dfff #73b2ff #df73ff #ff73df #d6d6d6 #5c5c5c #ff0000 #ff5500 #ffaa00 #ffff00 #aaff00 #55ff00 #00ffc5 #00c5ff #0070ff #c500ff #ff00c5 #c2c2c2 #474747 #e60000 #e64c00 #e69800 #e6e600 #98e600 #4ce600 #00e6a9 #00a9e6 #005ce6 #a900e6 #e600a9 #adadad #242424 #a80000 #a83800 #a87000 #a8a800 #70a800 #38a800 #00a884 #0084a8 #004da8 #8400a8 #a80084 #999999 #1a1a1a #730000 #732600 #734c00 #737300 #4c7300 #267300 #00734c #004c73 #002673 #4c0073 #73004".split(" ");
var I=[{name:"default",colors:[].concat(k.slice(30,39),k.slice(28,30).reverse())},{name:"cat-dark",colors:"#ed5151 #149ece #a7c636 #9e559c #fc921f #ffde3e #f789d8 #b7814a #3caf99 #6b6bd6 #b54779 #7f7f7f".split(" ")},{name:"tropical-bliss",colors:"#fce138 #ff9399 #fcd27e #f1983c #a553b7 #b1a9d0 #6ecffc #4c81cd #fc6f84 #fc3e5a #6af689 #48885c".split(" ")},{name:"desert-blooms",colors:"#102432 #144d59 #ffc730 #ed9310 #a64f1b #661510 #d9351a #b31515 #4a0932 #8c213f #18382e #2c6954".split(" ")},{name:"under-the-sea",
colors:"#bf9727 #607100 #00734c #704489 #01acca #024e76 #f09100 #ea311f #c6004b #7570b3 #666666 #333333".split(" ")},{name:"vibrant-rainbow",colors:"#fffb00 #f5cb11 #9fd40c #46e39c #32b8a6 #7ff2fa #ac08cc #dd33ff #eb7200 #e8a784 #bf2e2e #6c7000".split(" ")},{name:"ocean-bay",colors:"#191921 #11495c #78b1c2 #454f4b #8f8f82 #9be0c0 #87b051 #f7ec88 #ebdcc1 #dbb658 #c43541 #75351e".split(" ")},{name:"prairie-summer",colors:"#332424 #751555 #d47013 #d68989 #211173 #82aad6 #7bfaeb #6ec9a8 #6b6408 #eada40 #ccc54a #1fc235".split(" ")},
{name:"pastel-chalk",colors:"#fffd99 #f5e6a4 #c1d48c #b8e3d0 #a0b8b5 #cbf7fa #d791f2 #dfc1eb #f2b983 #e8c4b2 #bf8e8e #94995c".split(" ")},{name:"seq-yellow-orange-red-bright",colors:"#910000 #b1260b #c0370f #e05919 #ef6a1d #ff7b22 #ffa143 #ffb454 #ffda74 #ffed85".split(" ")},{name:"seq-reds-bright",colors:"#57453b #7b4238 #9f4036 #c23d33 #d7483c #ec5244 #f3696c #f9816c #ffc4ae #fff0dc".split(" ")},{name:"seq-purples-bright",colors:"#4e465c #5a4a78 #695291 #775baa #8663c3 #946bdc #aa89e8 #c1a6f3 #d7c4ff #e6e1ff".split(" ")},
{name:"seq-blues-bright",colors:"#404d54 #435c6c #48799d #4b88b6 #4d96ce #50a5e7 #74bbed #98d0f3 #bce6f9 #e6faff".split(" ")},{name:"seq-greens-bright",colors:"#39544c #386757 #368165 #359b73 #33b581 #4bc392 #64d2a2 #7ce0b3 #cbf6d9 #f4ffea".split(" ")},{name:"seq-browns-bright",colors:"#524834 #715b38 #8f6e3c #ae8140 #cc9444 #eba748 #eeb664 #f0c47f #f9e0b7 #fff8eb".split(" ")}];const D=new Map([["ar",()=>(new Promise(function(c,g){h(["../../chunks/ar2"],c,g)})).then(function(c){return c.ar})],["bs-ba",
()=>(new Promise(function(c,g){h(["../../chunks/bs_BA"],c,g)})).then(function(c){return c.bs_BA})],["ca-es",()=>(new Promise(function(c,g){h(["../../chunks/ca_ES"],c,g)})).then(function(c){return c.ca_ES})],["cs-cz",()=>(new Promise(function(c,g){h(["../../chunks/cs_CZ"],c,g)})).then(function(c){return c.cs_CZ})],["da-dk",()=>(new Promise(function(c,g){h(["../../chunks/da_DK"],c,g)})).then(function(c){return c.da_DK})],["de-de",()=>(new Promise(function(c,g){h(["../../chunks/de_DE"],c,g)})).then(function(c){return c.de_DE})],
["de-ch",()=>(new Promise(function(c,g){h(["../../chunks/de_CH"],c,g)})).then(function(c){return c.de_CH})],["el-gr",()=>(new Promise(function(c,g){h(["../../chunks/el_GR"],c,g)})).then(function(c){return c.el_GR})],["en-us",()=>(new Promise(function(c,g){h(["../../chunks/en_US"],c,g)})).then(function(c){return c.en_US})],["en-ca",()=>(new Promise(function(c,g){h(["../../chunks/en_CA"],c,g)})).then(function(c){return c.en_CA})],["es-es",()=>(new Promise(function(c,g){h(["../../chunks/es_ES"],c,g)})).then(function(c){return c.es_ES})],
["et-ee",()=>(new Promise(function(c,g){h(["../../chunks/et_EE"],c,g)})).then(function(c){return c.et_EE})],["fi-fi",()=>(new Promise(function(c,g){h(["../../chunks/fi_FI"],c,g)})).then(function(c){return c.fi_FI})],["fr-fr",()=>(new Promise(function(c,g){h(["../../chunks/fr_FR"],c,g)})).then(function(c){return c.fr_FR})],["he-il",()=>(new Promise(function(c,g){h(["../../chunks/he_IL"],c,g)})).then(function(c){return c.he_IL})],["hr-hr",()=>(new Promise(function(c,g){h(["../../chunks/hr_HR"],c,g)})).then(function(c){return c.hr_HR})],
["hu-hu",()=>(new Promise(function(c,g){h(["../../chunks/hu_HU"],c,g)})).then(function(c){return c.hu_HU})],["id-id",()=>(new Promise(function(c,g){h(["../../chunks/id_ID"],c,g)})).then(function(c){return c.id_ID})],["it-it",()=>(new Promise(function(c,g){h(["../../chunks/it_IT"],c,g)})).then(function(c){return c.it_IT})],["ja-jp",()=>(new Promise(function(c,g){h(["../../chunks/ja_JP"],c,g)})).then(function(c){return c.ja_JP})],["ko-kr",()=>(new Promise(function(c,g){h(["../../chunks/ko_KR"],c,g)})).then(function(c){return c.ko_KR})],
["lt-lt",()=>(new Promise(function(c,g){h(["../../chunks/lt_LT"],c,g)})).then(function(c){return c.lt_LT})],["lv-lv",()=>(new Promise(function(c,g){h(["../../chunks/lv_LV"],c,g)})).then(function(c){return c.lv_LV})],["nb-no",()=>(new Promise(function(c,g){h(["../../chunks/nb_NO"],c,g)})).then(function(c){return c.nb_NO})],["nl-nl",()=>(new Promise(function(c,g){h(["../../chunks/nl_NL"],c,g)})).then(function(c){return c.nl_NL})],["pl-pl",()=>(new Promise(function(c,g){h(["../../chunks/pl_PL"],c,g)})).then(function(c){return c.pl_PL})],
["pt-br",()=>(new Promise(function(c,g){h(["../../chunks/pt_BR"],c,g)})).then(function(c){return c.pt_BR})],["pt-pt",()=>(new Promise(function(c,g){h(["../../chunks/pt_PT"],c,g)})).then(function(c){return c.pt_PT})],["ro-ro",()=>(new Promise(function(c,g){h(["../../chunks/ro_RO"],c,g)})).then(function(c){return c.ro_RO})],["ru-ru",()=>(new Promise(function(c,g){h(["../../chunks/ru_RU"],c,g)})).then(function(c){return c.ru_RU})],["sk-sk",()=>(new Promise(function(c,g){h(["../../chunks/sk_SK"],c,g)})).then(function(c){return c.sk_SK})],
["sl-sl",()=>(new Promise(function(c,g){h(["../../chunks/sl_SL"],c,g)})).then(function(c){return c.sl_SL})],["sr-rs",()=>(new Promise(function(c,g){h(["../../chunks/sr_RS"],c,g)})).then(function(c){return c.sr_RS})],["sv-se",()=>(new Promise(function(c,g){h(["../../chunks/sv_SE"],c,g)})).then(function(c){return c.sv_SE})],["th-th",()=>(new Promise(function(c,g){h(["../../chunks/th_TH"],c,g)})).then(function(c){return c.th_TH})],["tr-tr",()=>(new Promise(function(c,g){h(["../../chunks/tr_TR"],c,g)})).then(function(c){return c.tr_TR})],
["uk-ua",()=>(new Promise(function(c,g){h(["../../chunks/uk_UA"],c,g)})).then(function(c){return c.uk_UA})],["vi-vn",()=>(new Promise(function(c,g){h(["../../chunks/vi_VN"],c,g)})).then(function(c){return c.vi_VN})],["zh-cn",()=>(new Promise(function(c,g){h(["../../chunks/zh_Hans"],c,g)})).then(function(c){return c.zh_Hans})],["zh-hk",()=>(new Promise(function(c,g){h(["../../chunks/zh_Hant"],c,g)})).then(function(c){return c.zh_Hant})],["zh-tw",()=>(new Promise(function(c,g){h(["../../chunks/zh_Hant"],
c,g)})).then(function(c){return c.zh_Hant})]]);let B,F;m.getChartLocale=K;m.getColorSet=function(c,g="default"){const G=I.find(y=>y.name===g);return G?G.colors.map(y=>c.color(y)):null};m.loadChartsModule=function(){return O.apply(this,arguments)};Object.defineProperty(m,"__esModule",{value:!0})})},"esri/widgets/Feature/FeatureViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Graphic ../../arcade/featureset/support/FeatureSetQueryInterceptor ../../core/Accessor ../../core/Handles ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/throttle ../../core/watchUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/subclass ../../popup/content/TextContent ./FeatureAttachments/FeatureAttachmentsViewModel ./FeatureContent/FeatureContentViewModel ./FeatureFields/FeatureFieldsViewModel ./FeatureMedia/FeatureMediaViewModel ./support/arcadeFeatureUtils ./support/featureUtils ./support/relatedFeatureUtils".split(" "),
function(h,m,t,k,z,L,K,O,I,D,B,F,c,g,G,y,r,H,E,x,A,b,a){var d;const n=K.getLogger("esri.widgets.FeatureViewModel"),v={attachmentsContent:!0,customContent:!0,fieldsContent:!0,mediaContent:!0,textContent:!0};z=d=function(l){function e(f){var w=l.call(this,f)||this;w._handles=new L;w._error=null;w._featureAbortController=null;w.graphicChangedThrottled=D.throttle(w.graphicChanged,1,h._assertThisInitialized(w));w._expressionAttributes=null;w.abilities={...v};w.content=null;w.contentViewModels=[];w.defaultPopupTemplateEnabled=
!1;w.formattedAttributes=null;w.lastEditInfo=null;w.relatedInfos=new Map;w.title="";w.view=null;w._isAllowedContentType=J=>{const {abilities:M}=h._assertThisInitialized(w);return"attachments"===J.type&&M.attachmentsContent||"custom"===J.type&&M.customContent||"fields"===J.type&&M.fieldsContent||"media"===J.type&&M.mediaContent||"text"===J.type&&M.textContent};w._handles.add(B.init(h._assertThisInitialized(w),["graphic","_effectivePopupTemplate","abilities"],()=>w.graphicChangedThrottled()));return w}
h._inheritsLoose(e,l);var p=e.prototype;p.destroy=function(){this._clear();this._cancelFeatureQuery();this._error=null;this._handles.destroy();this.graphic=this._handles=null;this._destroyContentViewModels();this.relatedInfos.clear()};p.castAbilities=function(f){return{...v,...f}};p.setActiveMedia=function(f,w){f=this.contentViewModels[f];f instanceof x&&f.setActiveMedia(w)};p.nextMedia=function(f){f=this.contentViewModels[f];f instanceof x&&f.next()};p.previousMedia=function(f){f=this.contentViewModels[f];
f instanceof x&&f.previous()};p._clear=function(){this._set("title","");this._set("content",null);this._set("formattedAttributes",null)};p.graphicChanged=function(){var f=h._asyncToGenerator(function*(){this._cancelFeatureQuery();this._error=null;this._clear();const {graphic:w}=this;if(w){var J=I.createAbortController();this._featureAbortController=J;try{yield this._queryFeature({signal:J.signal})}catch(M){I.isAbortError(M)||(this._error=M,n.error("error","The popupTemplate could not be displayed for this feature.",
{error:M,graphic:w,popupTemplate:this._effectivePopupTemplate}))}this._featureAbortController===J&&(this._featureAbortController=null)}});return function(){return f.apply(this,arguments)}}();p._cancelFeatureQuery=function(){const {_featureAbortController:f}=this;f&&f.abort();this._featureAbortController=null};p._compileContent=function(f){this._destroyContentViewModels();if(this.graphic)return Array.isArray(f)?f.filter(this._isAllowedContentType).map((w,J)=>{if("attachments"===w.type)return this._compileAttachments(w,
J);if("custom"===w.type)return this._compileCustom(w,J);if("fields"===w.type)return this._compileFields(w,J);if("media"===w.type)return this._compileMedia(w,J);if("text"===w.type)return this._compileText(w,J)}):"string"===typeof f?this._compileText(new y({text:f}),0).text:f};p._destroyContentViewModels=function(){this.contentViewModels.forEach(f=>f&&!f.destroyed&&f.destroy());this._set("contentViewModels",[])};p._compileAttachments=function(f,w){const {graphic:J}=this,{description:M,title:Q}=f;this.contentViewModels[w]=
new r({graphic:J,...this._compileTitleAndDesc({title:Q,description:M})});return f};p._compileCustom=function(f,w){const {graphic:J}=this,{creator:M,destroyer:Q}=f;this.contentViewModels[w]=new H({graphic:J,creator:M,destroyer:Q});return f};p._compileTitleAndDesc=function({title:f,description:w}){const {_fieldInfoMap:J,_sourceLayer:M,graphic:Q,formattedAttributes:S,_expressionAttributes:T}=this,{attributes:X}=Q,V=S.global;return{title:b.substituteFieldsInLinksAndAttributes({attributes:X,fieldInfoMap:J,
globalAttributes:V,expressionAttributes:T,layer:M,text:f}),description:b.substituteFieldsInLinksAndAttributes({attributes:X,fieldInfoMap:J,globalAttributes:V,expressionAttributes:T,layer:M,text:w})}};p._compileFields=function(f,w){const {_effectivePopupTemplate:J,formattedAttributes:M}=this,Q=f.clone();f=(null==f?void 0:f.fieldInfos)||(null==J?void 0:J.fieldInfos);const S=null==J?void 0:J.expressionInfos,T={...M.global,...M.content[w]},{description:X,title:V}=Q;f=new E({attributes:T,expressionInfos:S,
fieldInfos:f,...this._compileTitleAndDesc({title:V,description:X})});this.contentViewModels[w]=f;Q.fieldInfos=f.formattedFieldInfos.slice(0);return Q};p._compileMedia=function(f,w){const {graphic:J,_fieldInfoMap:M,_effectivePopupTemplate:Q,relatedInfos:S,_sourceLayer:T,_expressionAttributes:X}=this;var {attributes:V}=J;const Y=this.formattedAttributes.global;f=f.clone();const {description:U,mediaInfos:aa,title:ba}=f;V=new x({activeMediaInfoIndex:f.activeMediaInfoIndex||0,attributes:V,layer:T,fieldInfoMap:M,
formattedAttributes:Y,expressionAttributes:X,mediaInfos:aa,popupTemplate:Q,relatedInfos:S,...this._compileTitleAndDesc({title:ba,description:U})});f.mediaInfos=V.formattedMediaInfos.slice(0);this.contentViewModels[w]=V;return f};p._compileText=function(f,w){f=f.clone();const {graphic:J,_fieldInfoMap:M,_sourceLayer:Q,_expressionAttributes:S}=this;if(f&&f.text){const {attributes:T}=J;f.text=b.substituteFieldsInLinksAndAttributes({attributes:T,fieldInfoMap:M,globalAttributes:this.formattedAttributes.global,
expressionAttributes:S,layer:Q,text:f.text})}this.contentViewModels[w]=new H({graphic:J,creator:f.text});return f};p._compileLastEditInfo=function(){const {_effectivePopupTemplate:f,_sourceLayer:w,graphic:J}=this;if(f){var {lastEditInfoEnabled:M}=f,Q=null==w?void 0:w.editFieldsInfo;if(M&&Q)return b.formatEditInfo(Q,J.attributes)}};p._compileTitle=function(f){const {_fieldInfoMap:w,_sourceLayer:J,graphic:M,_expressionAttributes:Q}=this,{attributes:S}=M;return b.substituteFieldsInLinksAndAttributes({attributes:S,
fieldInfoMap:w,globalAttributes:this.formattedAttributes.global,expressionAttributes:Q,layer:J,text:f})};p._getTitle=function(){var f=h._asyncToGenerator(function*(){const {_effectivePopupTemplate:w,graphic:J}=this;return b.graphicCallback(null==w?void 0:w.title,{graphic:J})});return function(){return f.apply(this,arguments)}}();p._getContent=function(){var f=h._asyncToGenerator(function*(){const {_effectivePopupTemplate:w,graphic:J}=this;return b.graphicCallback(null==w?void 0:w.content,{graphic:J})});
return function(){return f.apply(this,arguments)}}();p._queryFeature=function(){var f=h._asyncToGenerator(function*(w){const {_featureAbortController:J,_sourceLayer:M,graphic:Q,_effectivePopupTemplate:S,spatialReference:T,map:X,view:V}=this,{content:{value:Y},title:{value:U}}=yield I.eachAlways({content:this._getContent(),title:this._getTitle()});J===this._featureAbortController&&Q&&(yield b.queryUpdatedFeature({graphic:Q,popupTemplate:S,layer:M,spatialReference:T},w),{expressionAttributes:{value:w}}=
yield I.eachAlways({checkForRelatedFeatures:this._checkForRelatedFeatures(w),expressionAttributes:A.createCompiledExpressions({popupTemplate:this._effectivePopupTemplate,spatialReference:T,graphic:Q,map:X,interceptor:d.interceptor,view:V})}),J===this._featureAbortController&&Q&&(this._expressionAttributes=w,this._set("formattedAttributes",this._createFormattedAttributes(Y,w)),this._set("title",this._compileTitle(U)),this._set("lastEditInfo",this._compileLastEditInfo()||null),this._set("content",this._compileContent(Y)||
null)))});return function(w){return f.apply(this,arguments)}}();p._createFormattedAttributes=function(f,w){const {_effectivePopupTemplate:J,graphic:M,relatedInfos:Q,_sourceLayer:S,_fieldInfoMap:T}=this,X={...M.attributes,...w},V={global:b.formatAttributes({fieldInfos:null==J?void 0:J.fieldInfos,graphic:M,attributes:X,layer:S,fieldInfoMap:T,relatedInfos:Q}),content:[]};Array.isArray(f)&&f.forEach((Y,U)=>{"fields"===Y.type&&Y.fieldInfos&&(V.content[U]=b.formatAttributes({fieldInfos:Y.fieldInfos,graphic:M,
attributes:X,layer:S,fieldInfoMap:T,relatedInfos:Q}))});return V};p._checkForRelatedFeatures=function(f){const {graphic:w,_effectivePopupTemplate:J}=this;return this._queryRelatedInfos(w,b.getAllFieldInfos(J),f)};p._queryRelatedInfos=function(){var f=h._asyncToGenerator(function*(w,J,M){const {relatedInfos:Q,_sourceLayer:S}=this;Q.clear();const T=O.isSome(S.associatedLayer)?yield S.associatedLayer.load(M):S;if(T){var X=J.filter(U=>U&&b.isRelatedField(U.fieldName));if(X&&X.length){J.forEach(U=>this._configureRelatedInfo(U,
T));var V=yield a.queryLayerInfos({relatedInfos:Q,layer:T},M);Object.keys(V).forEach(U=>{var aa;const ba=Q.get(U.toString());U=null==(aa=V[U])?void 0:aa.value;ba&&U&&(ba.layerInfo=U.data)});var Y=yield a.queryRelatedFeatures({graphic:w,relatedInfos:Q,layer:T},M);Object.keys(Y).forEach(U=>{var aa;a.setRelatedFeatures(null==(aa=Y[U])?void 0:aa.value,Q.get(U.toString()))})}}});return function(w,J,M){return f.apply(this,arguments)}}();p._configureRelatedInfo=function(f,w){const {relatedInfos:J}=this,
M=a.getRelatedFieldInfo(f.fieldName);if(M){var {layerId:Q,fieldName:S}=M;Q&&(w=J.get(Q.toString())||a.createRelatedInfo(Q,w))&&(a.updateRelatedInfo({relatedInfo:w,fieldName:S,fieldInfo:f}),this.relatedInfos.set(Q,w))}};h._createClass(e,[{key:"_effectivePopupTemplate",get:function(){return O.isSome(this.graphic)?this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled):null}},{key:"_fieldInfoMap",get:function(){return b.createfieldInfoMap(b.getAllFieldInfos(this._effectivePopupTemplate),
this._sourceLayer)}},{key:"_sourceLayer",get:function(){return b.getSourceLayer(this.graphic)}},{key:"state",get:function(){return this.graphic?this._error?"error":this.waitingForContent?"loading":"ready":"disabled"}},{key:"graphic",set:function(f){this._set("graphic",f?f.clone():null)}},{key:"spatialReference",get:function(){return this.get("view.spatialReference")||null},set:function(f){void 0===f?this._clearOverride("spatialReference"):this._override("spatialReference",f)}},{key:"map",get:function(){return this.get("view.map")||
null},set:function(f){void 0===f?this._clearOverride("map"):this._override("map",f)}},{key:"waitingForContent",get:function(){return!!this._featureAbortController}}]);return e}(z);z.interceptor=new k.FeatureSetQueryInterceptor(b.preLayerQueryCallback,b.preRequestCallback);m.__decorate([F.property()],z.prototype,"_error",void 0);m.__decorate([F.property()],z.prototype,"_featureAbortController",void 0);m.__decorate([F.property({readOnly:!0})],z.prototype,"_effectivePopupTemplate",null);m.__decorate([F.property({readOnly:!0})],
z.prototype,"_fieldInfoMap",null);m.__decorate([F.property({readOnly:!0})],z.prototype,"_sourceLayer",null);m.__decorate([F.property()],z.prototype,"abilities",void 0);m.__decorate([g.cast("abilities")],z.prototype,"castAbilities",null);m.__decorate([F.property({readOnly:!0})],z.prototype,"content",void 0);m.__decorate([F.property({readOnly:!0})],z.prototype,"contentViewModels",void 0);m.__decorate([F.property({type:Boolean})],z.prototype,"defaultPopupTemplateEnabled",void 0);m.__decorate([F.property({readOnly:!0})],
z.prototype,"state",null);m.__decorate([F.property({readOnly:!0})],z.prototype,"formattedAttributes",void 0);m.__decorate([F.property({type:t,value:null})],z.prototype,"graphic",null);m.__decorate([F.property({readOnly:!0})],z.prototype,"lastEditInfo",void 0);m.__decorate([F.property()],z.prototype,"relatedInfos",void 0);m.__decorate([F.property()],z.prototype,"spatialReference",null);m.__decorate([F.property({readOnly:!0})],z.prototype,"title",void 0);m.__decorate([F.property()],z.prototype,"map",
null);m.__decorate([F.property({readOnly:!0})],z.prototype,"waitingForContent",null);m.__decorate([F.property()],z.prototype,"view",void 0);return z=d=m.__decorate([G.subclass("esri.widgets.FeatureViewModel")],z)})},"esri/arcade/featureset/support/FeatureSetQueryInterceptor":function(){define(["exports"],function(h){h.FeatureSetQueryInterceptor=function(m,t){this.preLayerQueryCallback=m;this.preRequestCallback=t;this.preLayerQueryCallback||(this.preLayerQueryCallback=k=>{});this.preRequestCallback||
(this.preLayerQueryCallback=k=>{})};Object.defineProperty(h,"__esModule",{value:!0})})},"esri/core/throttle":function(){define(["exports"],function(h){function m(t,k,z,L){let K=null,O=1E3;"number"===typeof k?(O=k,L=z):(K=null!=k?k:null,O=z);let I=0,D;const B=()=>{I=0;t.apply(L,D)};k=(...F)=>{K&&K.apply(L,F);D=F;O?I||(I=setTimeout(B,O)):B()};k.remove=()=>{I&&(clearTimeout(I),I=0)};k.forceUpdate=()=>{I&&(clearTimeout(I),B())};k.hasPendingUpdates=()=>!!I;return k}h["default"]=m;h.throttle=m;Object.defineProperty(h,
"__esModule",{value:!0})})},"esri/widgets/Feature/support/arcadeFeatureUtils":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/Logger ../../../core/promiseUtils ../../../layers/FeatureLayer ./featureUtils".split(" "),function(h,m,t,k,z,L,K){function O(E){return`<ul class="esri-widget__list">${E.map(x=>`<li>${"string"===typeof x?K.applyTextFormattingHTML(K.htmlEntities(x)):x}</li>`).join("")}</ul>`}function I(E){return`<table class="esri-widget__table">${E.keys().map(x=>
{var A=E.field(x);A="string"===typeof A?K.applyTextFormattingHTML(K.htmlEntities(A)):A;return`<tr><th>${x}</th><td>${A}</td></tr>`}).join("")}</table>`}function D({aggregatedFeatures:E,arcadeUtils:x,featureSetVars:A,context:b,viewInfo:a,map:d,graphic:n,interceptor:v}){A.forEach(l=>{l=l.toLowerCase();var e={map:d,spatialReference:a.sr,interceptor:v};"$map"===l&&(b.vars[l]=x.convertMapToFeatureSetCollection(e));"$layer"===l&&(b.vars[l]=x.convertFeatureLayerToFeatureSet({layer:n.sourceLayer,spatialReference:a.sr,
interceptor:v}));"$datastore"===l&&(b.vars[l]=x.convertServiceUrlToWorkspace({url:n.sourceLayer.url,spatialReference:a.sr,interceptor:v}));if("$aggregatedfeatures"===l){e=n.layer;const {fields:p,objectIdField:f,geometryType:w,spatialReference:J,displayField:M}=e;e=new L({fields:p,objectIdField:f,geometryType:w,spatialReference:J,displayField:M,..."feature"===e.type?{templates:e.templates,typeIdField:e.typeIdField,types:e.types}:null,source:E});b.vars[l]=x.convertFeatureLayerToFeatureSet({layer:e,
spatialReference:a.sr,interceptor:v})}})}function B(){return new Promise(function(E,x){h(["../../../support/arcadeUtils"],E,x)})}function F(E){return c.apply(this,arguments)}function c(){c=t._asyncToGenerator(function*({graphic:E,view:x}){const {isAggregate:A,layer:b}=E;if(!A||!b||"2d"!==(null==x?void 0:x.type))return[];x=yield x.whenLayerView(b);if(!x.createQuery||!x.queryFeatures)return[];const a=x.createQuery();a.aggregateIds=[E.getObjectId()];({features:E}=yield x.queryFeatures(a));return E});
return c.apply(this,arguments)}function g(E){return G.apply(this,arguments)}function G(){G=t._asyncToGenerator(function*({expressionAttributes:E,info:x,arcadeUtils:A,interceptor:b,spatialReference:a,map:d,graphic:n,view:v}){const l=`expression/${x.name}`,e=A.createSyntaxTree(x.expression),p=r.filter(w=>A.hasVariable(e,w));yield A.loadScriptDependencies(e,!0,p);const f=A.getViewInfo({spatialReference:a});a=A.createExecContext(n,f);a.interceptor=b;a.useAsync=!0;v=yield F({graphic:n,view:v});D({aggregatedFeatures:v,
arcadeUtils:A,featureSetVars:p,context:a,viewInfo:f,map:d,graphic:n,interceptor:b});b=A.createFunction(e,a);b=yield A.executeAsyncFunction(b,a).catch(w=>H.error("arcade-execution-error",{error:w,graphic:n,expressionInfo:x}));E[l]="string"===typeof b?K.applyTextFormattingHTML(K.htmlEntities(b)):Array.isArray(b)?O(b):b&&"esri.arcade.Dictionary"===b.declaredClass?I(b):b});return G.apply(this,arguments)}function y(){y=t._asyncToGenerator(function*({popupTemplate:E,spatialReference:x,graphic:A,interceptor:b,
map:a,view:d}){E=E.expressionInfos;const n=[],v={};if(!E||!E.length)return v;const l=yield B();for(const e of E)n.push(g({expressionAttributes:v,info:e,arcadeUtils:l,interceptor:b,spatialReference:x,map:a,graphic:A,view:d}));yield z.eachAlways(n);return v});return y.apply(this,arguments)}const r=["$datastore","$map","$layer","$aggregatedfeatures"],H=k.getLogger("esri.widgets.Feature.support.arcadeFeatureUtils");m.createCompiledExpressions=function(E){return y.apply(this,arguments)};Object.defineProperty(m,
"__esModule",{value:!0})})},"esri/widgets/Feature/support/FeatureContentMixin":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../../support/widget ../../support/jsxFactory".split(" "),function(h,m,t,k,z,L,K,O,I,D){h.FeatureContentMixin=B=>{B=function(F){function c(){var g=
F.apply(this,arguments)||this;g.renderNodeContent=G=>I.isWidget(G)&&!G.destroyed?D.tsx("div",{key:G},G.render()):G instanceof HTMLElement?D.tsx("div",{key:G,bind:G,afterCreate:g._attachToNode}):I.hasDomNode(G)?D.tsx("div",{key:G,bind:G.domNode,afterCreate:g._attachToNode}):null;return g}m._inheritsLoose(c,F);c.prototype._attachToNode=function(g){g.appendChild(this)};return c}(B);return B=t.__decorate([O.subclass("esri.widgets.Feature.ContentMixin")],B)};Object.defineProperty(h,"__esModule",{value:!0})})},
"*noref":1}});
define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../intl ../core/watchUtils ../core/accessorSupport/decorators/aliasOf ../core/has ../core/accessorSupport/decorators/cast ../core/Logger ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/subclass ./Widget ./Feature/FeatureAttachments ./Feature/FeatureContent ./Feature/FeatureFields ./Feature/FeatureMedia ./Feature/FeatureViewModel ./Feature/support/FeatureContentMixin ./support/Heading ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory ../intl/substitute".split(" "),function(h,
m,t,k,z,L,K,O,I,D,B,F,c,g,G,y,r,H,E,x,A,b,a){const d={title:!0,content:!0,lastEditedInfo:!0};k=function(n){function v(e,p){e=n.call(this,e,p)||this;e._contentWidgets=[];e.graphic=null;e.defaultPopupTemplateEnabled=!1;e.headingLevel=2;e.label=void 0;e.messages=null;e.messagesCommon=null;e.messagesURIUtils=null;e.spatialReference=null;e.title=null;e.visibleElements={...d};e.map=null;e.view=null;e.viewModel=new r;return e}m._inheritsLoose(v,n);var l=v.prototype;l.initialize=function(){this.own(z.init(this,
"viewModel.contentViewModels",()=>this._setupContentWidgets()))};l.loadDependencies=function(){return new Promise(function(e,p){h(["../chunks/notice"],e,p)})};l.destroy=function(){this._destroyContentWidgets()};l.castVisibleElements=function(e){return{...d,...e}};l.render=function(){var {state:e}=this.viewModel;e=b.tsx("div",{class:"esri-feature__size-container",key:"container"},this.renderTitle(),"error"===e?this.renderError():"loading"===e?this.renderLoading():this.renderContentContainer());return b.tsx("div",
{class:this.classes("esri-feature","esri-widget")},e)};l.setActiveMedia=function(e,p){this.viewModel.setActiveMedia(e,p)};l.nextMedia=function(e){this.viewModel.nextMedia(e)};l.previousMedia=function(e){this.viewModel.previousMedia(e)};l.renderError=function(){const {messagesCommon:e,messages:p,visibleElements:f}=this;return b.tsx("calcite-notice",{active:!0,color:"red",icon:"exclamation-mark-circle",scale:"s"},f.title?b.tsx("div",{key:"error-title",slot:"title"},e.errorMessage):null,b.tsx("div",
{key:"error-message",slot:"message"},p.loadingError))};l.renderLoading=function(){return b.tsx("div",{key:"loading-container",class:"esri-feature__loading-container"},b.tsx("span",{class:this.classes("esri-icon-loading-indicator esri-rotating","esri-feature__loading-spinner")}))};l.renderContentContainer=function(){const {visibleElements:e}=this;return e.content?b.tsx("div",{class:"esri-feature__main-container"},[this.renderContent(),this.renderLastEditInfo()]):null};l.renderTitle=function(){const {visibleElements:e,
title:p}=this;return e.title?b.tsx(E.Heading,{level:this.headingLevel,class:"esri-feature__title",innerHTML:p}):null};l.renderContent=function(){var e=this.viewModel.content;return e?Array.isArray(e)?e.length?b.tsx("div",{key:"content-content-elements"},e.map(this.renderContentElement,this)):null:"string"===typeof e?(e=this._contentWidgets[0],!e||e.destroyed?null:b.tsx("div",{key:"content-content"},e.render())):this.renderNodeContent(e):null};l.renderContentElement=function(e,p){const {visibleElements:f}=
this;if("boolean"!==typeof f.content&&!f.content[e.type])return null;switch(e.type){case "attachments":return this.renderAttachments(p);case "custom":return this.renderCustom(e,p);case "fields":return this.renderFields(p);case "media":return this.renderMedia(p);case "text":return this.renderText(e,p);default:return null}};l.renderAttachments=function(e){const p=this._contentWidgets[e];if(!p||p.destroyed)return null;const {state:f,attachmentInfos:w}=p.viewModel;return"loading"===f||0<w.length?b.tsx("div",
{key:this._buildKey("attachments-element",e),class:this.classes("esri-feature__content-element")},p.render()):null};l.renderCustom=function(e,p){({creator:e}=e);const f=this._contentWidgets[p];return!f||f.destroyed?null:e?b.tsx("div",{key:this._buildKey("custom-element",p),class:"esri-feature__content-element"},f.render()):null};l.renderFields=function(e){const p=this._contentWidgets[e];return!p||p.destroyed?null:b.tsx("div",{key:this._buildKey("fields-element",e),class:"esri-feature__content-element"},
p.render())};l.renderMedia=function(e){const p=this._contentWidgets[e];return!p||p.destroyed?null:b.tsx("div",{key:this._buildKey("media-element",e),class:"esri-feature__content-element"},p.render())};l.renderLastEditInfo=function(){const {visibleElements:e,messages:p}=this;var {lastEditInfo:f}=this.viewModel;if(!f||!e.lastEditedInfo)return null;const {date:w,user:J}=f;f=a.substitute("edit"===f.type?J?p.lastEditedByUser:p.lastEdited:J?p.lastCreatedByUser:p.lastCreated,{date:w,user:J});return b.tsx("div",
{key:"edit-info-element",class:this.classes("esri-feature__last-edited-info","esri-feature__content-element")},f)};l.renderText=function(e,p){const f=this._contentWidgets[p];return!f||f.destroyed?null:e.text?b.tsx("div",{key:this._buildKey("text-element",p),class:this.classes("esri-feature__content-element","esri-feature__text")},f.render()):null};l._buildKey=function(e,...p){const f=this.get("viewModel.graphic.uid")||"0";p=p.join("-");return`${e}__${f}-${p}`};l._destroyContentWidgets=function(){this._contentWidgets.forEach(e=>
{e.viewModel=null;e&&!e.destroyed&&e.destroy()});this._contentWidgets=[]};l._setupContentWidgets=function(){this._destroyContentWidgets();const {headingLevel:e,visibleElements:p}=this;var f=this.get("viewModel.content");const {contentViewModels:w}=this.viewModel;Array.isArray(f)?f.forEach((J,M)=>{"attachments"===J.type&&(this._contentWidgets[M]=new c({displayType:J.displayType,headingLevel:p.title?e+1:e,viewModel:w[M]}));"fields"===J.type&&(this._contentWidgets[M]=new G({viewModel:w[M]}));"media"===
J.type&&(this._contentWidgets[M]=new y({viewModel:w[M]}));"text"===J.type&&(this._contentWidgets[M]=new g({viewModel:w[M]}));"custom"===J.type&&(this._contentWidgets[M]=new g({viewModel:w[M]}))},this):(f=w[0])&&!f.destroyed&&(this._contentWidgets[0]=new g({viewModel:f}));this.scheduleRender()};return v}(H.FeatureContentMixin(F));t.__decorate([L.aliasOf("viewModel.graphic")],k.prototype,"graphic",void 0);t.__decorate([L.aliasOf("viewModel.defaultPopupTemplateEnabled")],k.prototype,"defaultPopupTemplateEnabled",
void 0);t.__decorate([D.property()],k.prototype,"headingLevel",void 0);t.__decorate([D.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],k.prototype,"label",void 0);t.__decorate([D.property(),A.messageBundle("esri/widgets/Feature/t9n/Feature")],k.prototype,"messages",void 0);t.__decorate([D.property(),A.messageBundle("esri/t9n/common")],k.prototype,"messagesCommon",void 0);t.__decorate([D.property(),A.messageBundle("esri/widgets/support/t9n/uriUtils")],k.prototype,"messagesURIUtils",
void 0);t.__decorate([L.aliasOf("viewModel.spatialReference")],k.prototype,"spatialReference",void 0);t.__decorate([L.aliasOf("viewModel.title")],k.prototype,"title",void 0);t.__decorate([D.property()],k.prototype,"visibleElements",void 0);t.__decorate([O.cast("visibleElements")],k.prototype,"castVisibleElements",null);t.__decorate([L.aliasOf("viewModel.map")],k.prototype,"map",void 0);t.__decorate([L.aliasOf("viewModel.view")],k.prototype,"view",void 0);t.__decorate([D.property({type:r})],k.prototype,
"viewModel",void 0);return k=t.__decorate([B.subclass("esri.widgets.Feature")],k)});