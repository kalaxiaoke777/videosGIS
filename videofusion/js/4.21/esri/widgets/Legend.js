// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.21/esri/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Legend/LegendViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../intl ../../core/Accessor ../../core/Collection ../../core/Handles ../../core/watchUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/accessorSupport/decorators/subclass ./support/ActiveLayerInfo ../../intl/locale".split(" "),function(E,J,u,y,t,C,L,T,R,p,A,b,d,g){const r=t.ofType(d),
m="esri.layers.BuildingSceneLayer esri.layers.CSVLayer esri.layers.FeatureLayer esri.layers.GeoJSONLayer esri.layers.GeoRSSLayer esri.layers.GroupLayer esri.layers.HeatmapLayer esri.layers.ImageryLayer esri.layers.ImageryTileLayer esri.layers.MapImageLayer esri.layers.OGCFeatureLayer esri.layers.PointCloudLayer esri.layers.StreamLayer esri.layers.SceneLayer esri.layers.TileLayer esri.layers.WFSLayer esri.layers.WMSLayer esri.layers.WMTSLayer esri.layers.WCSLayer".split(" "),G=["view.basemapView.baseLayerViews",
"view.groundView.layerViews","view.layerViews","view.basemapView.referenceLayerViews"];u=function(K){function z(q){q=K.call(this,q)||this;q._handles=new C;q._layerViewByLayerId={};q._layerInfosByLayerViewId={};q._activeLayerInfosByLayerViewId={};q._activeLayerInfosWithNoParent=new t;q.activeLayerInfos=new r;q.basemapLegendVisible=!1;q.groundLegendVisible=!1;q.hideLayersNotInCurrentView=!1;q.keepCacheOnDestroy=!1;q.respectLayerVisibility=!0;q.layerInfos=[];q.view=null;return q}E._inheritsLoose(z,K);
var O=z.prototype;O.initialize=function(){this._handles.add(L.init(this,"view",this._viewHandles),"view");this._handles.add(g.onLocaleChange(()=>this._refresh()))};O.destroy=function(){this._destroyViewActiveLayerInfos();this._handles.destroy();this.view=this._handles=null};O._viewHandles=function(){this._handles.remove("state");this.view&&this._handles.add(L.init(this,"state",this._stateHandles),"state")};O._stateHandles=function(){this._resetAll();"ready"===this.state&&this._watchPropertiesAndAllLayerViews()};
O._resetAll=function(){this._handles.remove(["all-layer-views","legend-properties"]);this._destroyViewActiveLayerInfos();this.activeLayerInfos.removeAll()};O._destroyViewActiveLayerInfos=function(){Object.keys(this._activeLayerInfosByLayerViewId).forEach(this._destroyViewActiveLayerInfo,this)};O._destroyViewActiveLayerInfo=function(q){this._handles.remove(q);const D=this._activeLayerInfosByLayerViewId[q];delete this._activeLayerInfosByLayerViewId[q];D&&D.parent&&D.parent.children.remove(D)};O._watchPropertiesAndAllLayerViews=
function(){const {allLayerViews:q}=this.view;q.length&&this._refresh();this._handles.add(q.on("change",this._allLayerViewsChangeHandle.bind(this)),"all-layer-views");this._handles.add(L.watch(this,"layerInfos, basemapLegendVisible, groundLegendVisible",this._propertiesChangeHandle.bind(this)),"legend-properties")};O._allLayerViewsChangeHandle=function(q){q.removed.forEach(D=>this._destroyViewActiveLayerInfo(D.uid));this._refresh()};O._propertiesChangeHandle=function(){this._destroyViewActiveLayerInfos();
this._refresh()};O._refresh=function(){this._layerInfosByLayerViewId={};this.activeLayerInfos.removeAll();this._generateLayerViews().filter(this._filterLayerViewsByLayerInfos,this).filter(this._isLayerViewSupported,this).forEach(this._generateActiveLayerInfo,this);this._sortActiveLayerInfos(this.activeLayerInfos)};O._sortActiveLayerInfos=function(q){if(!(2>q.length)){var D=[];q.forEach(f=>{if(!f.parent){var x=f.layer.parent;(x=(x=x&&"uid"in x&&this._layerViewByLayerId[x.uid])&&this._activeLayerInfosByLayerViewId[x.uid])&&
-1!==q.indexOf(x)&&(D.push(f),f.parent=x,x.children.add(f),this._sortActiveLayerInfos(x.children))}});q.removeMany(D);var S={};this.view.allLayerViews.forEach((f,x)=>S[f.layer.uid]=x);q.sort((f,x)=>(S[x.layer.uid]||0)-(S[f.layer.uid]||0))}};O._generateLayerViews=function(){const q=[];G.filter(this._filterLayerViews,this).map(this.get,this).filter(D=>null!=D).forEach(this._collectLayerViews("layerViews",q));return q};O._filterLayerViews=function(q){const D=!this.groundLegendVisible&&"view.groundView.layerViews"===
q;return!(!this.basemapLegendVisible&&("view.basemapView.baseLayerViews"===q||"view.basemapView.referenceLayerViews"===q))&&!D};O._collectLayerViews=function(q,D){const S=f=>{f&&f.forEach(x=>{D.push(x);S(x[q])});return D};return S};O._filterLayerViewsByLayerInfos=function(q){const D=this.layerInfos;return D&&D.length?D.some(S=>this._hasLayerInfo(S,q)):!0};O._hasLayerInfo=function(q,D){const S=this._isLayerUIDMatching(q.layer,D.layer.uid);S&&(this._layerInfosByLayerViewId[D.uid]=q);return S};O._isLayerUIDMatching=
function(q,D){return q&&(q.uid===D||this._hasLayerUID(q.layers,D))};O._hasLayerUID=function(q,D){return q&&q.some(S=>this._isLayerUIDMatching(S,D))};O._isLayerViewSupported=function(q){return m.includes(q.layer.declaredClass)?(this._layerViewByLayerId[q.layer.uid]=q,!0):!1};O._generateActiveLayerInfo=function(q){this._isLayerActive(q)?this._buildActiveLayerInfo(q):(this._handles.remove(q.uid),this._handles.add(L.watch(q,"legendEnabled, layer.legendEnabled",()=>this._layerActiveHandle(q)),q.uid))};
O._layerActiveHandle=function(q){this._isLayerActive(q)&&(this._handles.remove(q.uid),this._buildActiveLayerInfo(q))};O._isLayerActive=function(q){return this.respectLayerVisibility?q.legendEnabled&&q.get("layer.legendEnabled"):!0};O._buildActiveLayerInfo=function(q){var D,S=q.layer;const f=q.uid;var x=this._layerInfosByLayerViewId[f];let l=this._activeLayerInfosByLayerViewId[f];l||(l=new d({layer:S,layerView:q,title:x&&void 0!==x.title&&x.layer.uid===S.uid?x.title:S.title,view:this.view,respectLayerVisibility:this.respectLayerVisibility,
hideLayersNotInCurrentView:this.hideLayersNotInCurrentView,keepCacheOnDestroy:this.keepCacheOnDestroy,sublayerIds:x&&x.sublayerIds||[]}),this._activeLayerInfosByLayerViewId[f]=l);x=S.parent&&"uid"in S.parent&&this._layerViewByLayerId[null==(D=S.parent)?void 0:D.uid];l.parent=this._activeLayerInfosByLayerViewId[null==x?void 0:x.uid];if(!this._handles.has(f)){D=L.watch(S,"title",B=>this._titleHandle(B,l));x=L.watch(S,"renderer?, opacity, pointSymbol?, lineSymbol?, polygonSymbol?",()=>this._constructLegendElements(l));
const N=L.whenTrue(this.view,"stationary",()=>this._scaleHandle(l)),H=L.watch(q,"_effectiveRenderer",()=>this._constructLegendElements(l));D=[D,x,N,H];this.respectLayerVisibility&&(q=L.watch(q,"legendEnabled",B=>this._legendEnabledHandle(B,l)),S=L.watch(S,"legendEnabled",B=>this._legendEnabledHandle(B,l)),D.push(q,S));this._handles.add(D,f)}l.isScaleDriven||this._constructLegendElements(l);this._addActiveLayerInfo(l)};O._titleHandle=function(q,D){D.title=q;this._constructLegendElements(D)};O._legendEnabledHandle=
function(q,D){q?this._addActiveLayerInfo(D):this._removeActiveLayerInfo(D)};O._scaleHandle=function(q){(q.isScaleDriven||q.hideLayersNotInCurrentView)&&this._constructLegendElements(q)};O._addActiveLayerInfo=function(q){const {layerView:D,layer:S}=q;if(this._isLayerActive(D)&&-1===this.activeLayerInfos.indexOf(q)){var f=q.parent;if(f)-1===f.children.indexOf(q)&&f.children.push(q),this._sortActiveLayerInfos(f.children);else{var x;f=null==(x=this.layerInfos)?void 0:x.some(l=>l.layer.uid===S.uid);S.parent&&
"uid"in S.parent&&!f?this._activeLayerInfosWithNoParent.add(q):(this.activeLayerInfos.add(q),this._sortActiveLayerInfos(this.activeLayerInfos))}if(this._activeLayerInfosWithNoParent.length){const l=[];this._activeLayerInfosWithNoParent.forEach(N=>{var H=N.layer.parent;H=H&&"uid"in H&&this._layerViewByLayerId[null==H?void 0:H.uid];if(H=this._activeLayerInfosByLayerViewId[null==H?void 0:H.uid])l.push(N),N.parent=H});l.length&&(this._activeLayerInfosWithNoParent.removeMany(l),l.forEach(N=>this._addActiveLayerInfo(N)))}}};
O._removeActiveLayerInfo=function(q){const D=q.parent;D?D.children.remove(q):this.activeLayerInfos.remove(q)};O._constructLegendElements=function(q){const D=q.layer;"featureCollections"in D&&D.featureCollections?q.buildLegendElementsForFeatureCollections(D.featureCollections):"renderer"in D&&D.renderer?q.buildLegendElementsForRenderer(D.renderer):"url"in D&&D.url?q.buildLegendElementsForTools():q.children.forEach(S=>this._constructLegendElements(S))};E._createClass(z,[{key:"state",get:function(){return this.get("view.ready")?
"ready":"disabled"}}]);return z}(y);J.__decorate([T.property({type:r})],u.prototype,"activeLayerInfos",void 0);J.__decorate([T.property()],u.prototype,"basemapLegendVisible",void 0);J.__decorate([T.property()],u.prototype,"groundLegendVisible",void 0);J.__decorate([T.property()],u.prototype,"hideLayersNotInCurrentView",void 0);J.__decorate([T.property()],u.prototype,"keepCacheOnDestroy",void 0);J.__decorate([T.property()],u.prototype,"respectLayerVisibility",void 0);J.__decorate([T.property()],u.prototype,
"layerInfos",void 0);J.__decorate([T.property({readOnly:!0})],u.prototype,"state",null);J.__decorate([T.property()],u.prototype,"view",void 0);return u=J.__decorate([b.subclass("esri.widgets.Legend.LegendViewModel")],u)})},"esri/widgets/Legend/support/ActiveLayerInfo":function(){define("require ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Color ../../../kernel ../../../request ../../../symbols ../../../core/Accessor ../../../core/Collection ../../../core/Handles ../../../core/jsonMap ../../../core/Logger ../../../core/maybe ../../../core/promiseUtils ../../../core/screenUtils ../../../core/urlUtils ../../../core/watchUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../layers/support/ExportImageParameters ../../../layers/support/fieldUtils ../../../renderers/support/jsonUtils ../../../renderers/support/rendererConversion ../../../renderers/visualVariables/support/SizeVariableLegendOptions ../../../symbols/support/cimSymbolUtils ../../../symbols/support/symbolUtils ../../../symbols/support/utils ./clusterUtils ./colorRampUtils ./heatmapRampUtils ./relationshipRampUtils ./sizeRampUtils ./utils ../../../symbols/SimpleMarkerSymbol ../../../symbols/SimpleFillSymbol".split(" "),
function(E,J,u,y,t,C,L,T,R,p,A,b,d,g,r,m,G,K,z,O,q,D,S,f,x,l,N,H,B,h,n,M,V,c,F,e,v){function Q(qa){return"esri.renderers.SimpleRenderer"===qa.declaredClass}function W(qa){return"esri.renderers.ClassBreaksRenderer"===qa.declaredClass}function Z(qa){return"esri.renderers.UniqueValueRenderer"===qa.declaredClass}function ka(qa){return"esri.renderers.HeatmapRenderer"===qa.declaredClass}function ia(qa){return"esri.renderers.PointCloudClassBreaksRenderer"===qa.declaredClass}function oa(qa){return"esri.renderers.PointCloudStretchRenderer"===
qa.declaredClass}function ja(qa){return"esri.renderers.PointCloudUniqueValueRenderer"===qa.declaredClass}function X(qa){return"esri.renderers.DotDensityRenderer"===qa.declaredClass}function ca(qa){return"esri.layers.BuildingSceneLayer"===qa.declaredClass}function ha(qa){qa="authoringInfo"in qa&&(null==qa?void 0:qa.authoringInfo);return"univariate-color-size"===(null==qa?void 0:qa.type)}function fa(qa){qa="authoringInfo"in qa&&(null==qa?void 0:qa.authoringInfo);return"univariate-color-size"===(null==
qa?void 0:qa.type)&&"above-and-below"===(null==qa?void 0:qa.univariateTheme)}const ea=b.getLogger("esri.widgets.Legend.support.ActiveLayerInfo"),ra=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,sa=new A.JSONMap({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),ya={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],
f32:[-3.4*1E39,3.4*1E39],f64:[-Number.MAX_VALUE,Number.MAX_VALUE]},xa=new e({size:6,outline:{color:[128,128,128,.5],width:.5}}),Ga=new v({style:"solid"}),Ha=new e({style:"path",path:"M10,5 L5,0 0,5 M5,0 L5,15",size:15,outline:{width:1,color:[85,85,85,1]}});let Aa={};L=function(qa){function Ba(k){k=qa.call(this,k)||this;k._handles=new p;k._hasColorRamp=!1;k._hasOpacityRamp=!1;k._hasSizeRamp=!1;k._webStyleSymbolCache=new Map;k._dotDensityUrlCache=new Map;k._scaleDrivenSizeVariable=null;k._hasClusterSizeVariable=
!1;k.children=new R;k.layerView=null;k.layer=null;k.legendElements=[];k.parent=null;k.hideLayersNotInCurrentView=!1;k.keepCacheOnDestroy=!1;k.respectLayerVisibility=!0;k.sublayerIds=[];k.title=null;k.view=null;return k}J._inheritsLoose(Ba,qa);var da=Ba.prototype;da.initialize=function(){const k=()=>this.notifyChange("ready");this._handles.add([G.on(this,"children","change",a=>{const {added:w,removed:I}=a,P=this._handles;w.map(U=>{const Y=`activeLayerInfo-ready-watcher-${U.layer.uid}`;P.add(G.init(U,
"ready",k),Y)});I.forEach(U=>P.remove(U.layer.uid));k()})]);this.keepCacheOnDestroy||(Aa={})};da.destroy=function(){this._handles.destroy();this._scaleDrivenSizeVariable=this._dotDensityUrlCache=this._webStyleSymbolCache=this._handles=null;this.keepCacheOnDestroy||(Aa=null)};da.buildLegendElementsForFeatureCollections=function(){var k=J._asyncToGenerator(function*(a){if(this.hideLayersNotInCurrentView&&!(yield this._isLayerInCurrentView()))this.legendElements=[],this.notifyChange("ready");else{a=
a.map(w=>{if("esri.layers.FeatureLayer"===w.declaredClass)return this._getRendererLegendElements(w.renderer,{title:w.title});if(w.featureSet&&w.featureSet.features.length){var I=w.layerDefinition,P=I&&I.drawingInfo;P=P&&f.fromJSON(P.renderer);I=sa.read(I.geometryType);return P?this._getRendererLegendElements(P,{title:w.name,geometryType:I}):(ea.warn("drawingInfo not available!"),null)}return null});try{const w=[];yield g.eachAlways(a).then(I=>{I.forEach(({value:P})=>P&&w.push(...P))});this.legendElements=
w;this.notifyChange("ready")}catch(w){ea.warn("error while building legend for layer!",w)}}});return function(a){return k.apply(this,arguments)}}();da.buildLegendElementsForRenderer=function(){var k=J._asyncToGenerator(function*(a){try{this.legendElements=(this.hideLayersNotInCurrentView?yield this._isLayerInCurrentView():1)?yield this._getRendererLegendElements(a):[],this.notifyChange("ready")}catch(w){ea.warn("error while building legend for layer!",w)}});return function(a){return k.apply(this,
arguments)}}();da.buildLegendElementsForTools=function(){var k=J._asyncToGenerator(function*(){var a=this;const w=this.layer;if("esri.layers.WMTSLayer"===w.declaredClass)this._constructLegendElementsForWMTSlayer();else if("esri.layers.WMSLayer"===w.declaredClass)yield this._constructLegendElementsForWMSSublayers();else if(ca(w))yield this._constructLegendElementsForBuildingSceneLayer();else if("esri.layers.MapImageLayer"===w.declaredClass||"esri.layers.TileLayer"===w.declaredClass||ca(w))yield this._constructLegendElementsForSublayers();
else{this._handles.remove("imageryLayers-watcher");var I="default";if("esri.layers.ImageryLayer"===w.declaredClass){var P,U;I=(null==w?void 0:null==(P=w.renderingRule)?void 0:P.functionName)||"default";P=null!=(U=w.bandIds)&&U.length?w.bandIds.join(""):"###";I=I+"_"+P}yield this._getLegendLayers(`${w.uid}-${I}`).then(function(){var Y=J._asyncToGenerator(function*(ba){a.legendElements=[];a.notifyChange("ready");ba=ba.map(function(){var la=J._asyncToGenerator(function*(ta){if("esri.layers.ImageryLayer"===
w.declaredClass||"esri.layers.ImageryTileLayer"===w.declaredClass){const va=w.watch(["renderingRule","bandIds"],()=>g.debounce(J._asyncToGenerator(function*(){Aa["default"]=null;w.renderer?yield a.buildLegendElementsForRenderer(w.renderer):yield a.buildLegendElementsForTools()}))());a._handles.add(va,"imageryLayers-watcher")}(ta=a._generateSymbolTableElementForLegendLayer(ta))&&ta.infos.length&&("esri.layers.ImageryLayer"===w.declaredClass&&(ta.title=w.title),a.legendElements.push(ta));a.notifyChange("ready")});
return function(ta){return la.apply(this,arguments)}}());yield g.eachAlways(ba)});return function(ba){return Y.apply(this,arguments)}}()).catch(Y=>{ea.warn("Request to server for legend has failed!",Y)})}});return function(){return k.apply(this,arguments)}}();da._isLayerInCurrentView=function(){var k=J._asyncToGenerator(function*(){const a=this.layer,w=this.layerView,I=w&&"createQuery"in w&&"queryFeatureCount"in w;if(!(I||w&&"createQuery"in a&&"queryFeatureCount"in a))return!0;yield G.whenFalseOnce(w,
"updating");const P=I?"createQuery"in w&&w.createQuery():"createQuery"in a&&a.createQuery();P.geometry=this.view.extent;return 0!==(I?"queryFeatureCount"in w&&(yield w.queryFeatureCount(P)):"queryFeatureCount"in a&&(yield a.queryFeatureCount(P)))});return function(){return k.apply(this,arguments)}}();da._getParentLayerOpacity=function(k){let a=1;const w=k.parent;w&&"uid"in w&&(a=this._getParentLayerOpacity(w));return k.opacity*a};da._isGroupActive=function(){const k=this.children;return k.length?
k.some(a=>a.ready):!1};da._isScaleDrivenSizeVariable=function(k){if(k&&"size"!==k.type)return!1;const a=k.minSize,w=k.maxSize;return"object"===typeof a&&a?this._isScaleDrivenSizeVariable(a):"object"===typeof w&&w?this._isScaleDrivenSizeVariable(w):!!k.expression||ra.test(k.valueExpression)};da._isLayerScaleDriven=function(k){if("minScale"in k&&0<k.minScale||"maxScale"in k&&0<k.maxScale)return!0;if("sublayers"in k&&k.sublayers)return k.sublayers.some(w=>this._isLayerScaleDriven(w));const a=k.parent;
if(!1===k.loaded&&a&&"esri.layers.MapImageLayer"===a.declaredClass&&"source"in k&&k.source&&"map-layer"===k.source.type)for(const w of a.sourceJSON.layers)if(w.id===k.source.mapLayerId&&(0<w.minScale||0<w.maxScale))return!0;return!1};da._constructLegendElementsForWMTSlayer=function(){this.legendElements=[];this._handles.remove("wmts-activeLayer-watcher");const k=this.layer.activeLayer;this._handles.add(G.watch(this.layer,"activeLayer",()=>this._constructLegendElementsForWMTSlayer()),"wmts-activeLayer-watcher");
if(k.styleId&&k.styles){let a=null;k.styles.some(w=>k.styleId===w.id?(a=w.legendUrl,!0):!1);a&&(this.legendElements=[{type:"symbol-table",title:k.title,infos:[{src:a,opacity:this.opacity}]}])}this.notifyChange("ready")};da._constructLegendElementsForWMSSublayers=function(){var k=J._asyncToGenerator(function*(){this.legendElements=[];this._handles.remove("wms-sublayers-watcher");const a=this.layer;let w=null;if(a.customParameters||a.customLayerParameters)w={...a.customParameters,...a.customLayerParameters};
this._handles.add(G.watch(this.layer,"sublayers",()=>this._constructLegendElementsForWMSSublayers()),"wms-sublayers-watcher");this.legendElements=yield this._generateLegendElementsForWMSSublayers(a.sublayers,w);this.notifyChange("ready")});return function(){return k.apply(this,arguments)}}();da._generateLegendElementsForWMSSublayers=function(){var k=J._asyncToGenerator(function*(a,w){const I=[];this._handles.add(a.on("change",()=>this._constructLegendElementsForWMSSublayers()),"wms-sublayers-watcher");
a=a.toArray();for(const P of a)a=P.watch(["title","visible","legendEnabled"],()=>this._constructLegendElementsForWMSSublayers()),this._handles.add(a,"wms-sublayers-watcher"),(!this.respectLayerVisibility||P.visible&&P.legendEnabled)&&(a=yield this._generateSymbolTableElementForWMSSublayer(P,w))&&a.infos.length&&I.unshift(a);return I});return function(a,w){return k.apply(this,arguments)}}();da._generateSymbolTableElementForWMSSublayer=function(){var k=J._asyncToGenerator(function*(a,w){return!a.legendUrl&&
a.sublayers?(w=(yield this._generateLegendElementsForWMSSublayers(a.sublayers,w)).filter(I=>I),{type:"symbol-table",title:a.title,infos:w}):this._generateSymbolTableElementForLegendUrl(a,w)});return function(a,w){return k.apply(this,arguments)}}();da._generateSymbolTableElementForLegendUrl=function(){var k=J._asyncToGenerator(function*(a,w){var I;let P=a.legendUrl;if(P){var U={type:"symbol-table",title:a.title||a.name||a.id&&a.id+"",infos:[]};w&&(P=m.addQueryParameters(P,w));w=null;a=null==(I=a.layer)?
void 0:I.opacity;try{if(w=(yield C(P,{responseType:"image"})).data)w.style.opacity=a}catch{}U.infos.push({src:P,preview:w,opacity:a});return U}});return function(a,w){return k.apply(this,arguments)}}();da._getLegendLayers=function(k,a){const w=Aa&&Aa[k];return w?Promise.resolve(w):this._legendRequest(a).then(I=>{I=I.layers;return Aa[k]=I})};da._legendRequest=function(k){var a=this.layer;k={f:"json",dynamicLayers:k};if("esri.layers.ImageryLayer"===a.declaredClass){var w=a.exportImageServiceParameters.renderingRule;
w&&(k.renderingRule=JSON.stringify(w.toJSON()));a.bandIds&&(k.bandIds=a.bandIds.join());if(a.raster||a.viewId){const {raster:I,viewId:P}=a;k={raster:I,viewId:P,...k}}}w=a.url.replace(/(\/)+$/,"");"version"in a&&10.01<=a.version?(a=w.indexOf("?"),w=-1<a?w.substring(0,a)+"/legend"+w.substring(a):w+"/legend"):(a=w.toLowerCase().indexOf("/rest/"),a=w.substring(0,a)+w.substring(a+5,w.length),w="https://utility.arcgis.com/sharing/tools/legend?soapUrl\x3d"+encodeURI(a)+"\x26returnbytes\x3dtrue");return C(w,
{query:k}).then(I=>I.data)};da._constructLegendElementsForBuildingSceneLayer=function(){var k=J._asyncToGenerator(function*(){this.legendElements=[];this._handles.remove("sublayers-watcher");const a=this.layer;this._handles.add(G.watch(a,"sublayers",()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");try{this.legendElements=yield this._generateLegendElementsForBuildingSublayers(a.sublayers,this.opacity),this.notifyChange("ready")}catch(w){ea.warn("Request to server for legend has failed!",
w)}});return function(){return k.apply(this,arguments)}}();da._generateLegendElementsForBuildingSublayers=function(){var k=J._asyncToGenerator(function*(a,w){let I=[];this._handles.add(a.on("change",()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");a=a.toArray();for(const U of a)if(a=U.watch(["renderer","opacity","title","visible"],()=>this._constructLegendElementsForBuildingSceneLayer()),this._handles.add(a,"sublayers-watcher"),!this.respectLayerVisibility||U.visible){a=
U&&null!=U.opacity?U.opacity:null;var P=null!=a?a*w:w;"building-group"===U.type?(a={type:"symbol-table",title:U.title,infos:[]},P=yield this._generateLegendElementsForBuildingSublayers(U.sublayers,P),a.infos.push(...P),I=[a,...I]):U.renderer&&(I=[...yield this._getRendererLegendElements(U.renderer,{title:U.title,opacity:P,sublayer:U}),...I])}return I.filter(U=>!!U&&("infos"in U?0<U.infos.length:!0))});return function(a,w){return k.apply(this,arguments)}}();da._constructLegendElementsForSublayers=
function(){var k=J._asyncToGenerator(function*(){this.legendElements=[];this._handles.remove("sublayers-watcher");const a=this.layer;this._handles.add(G.watch(a,"sublayers",()=>this._constructLegendElementsForSublayers),"sublayers-watcher");try{this.legendElements=yield this._generateLegendElementsForSublayers(a.sublayers,this.opacity),this.notifyChange("ready")}catch(w){ea.warn("Request to server for legend has failed!",w)}});return function(){return k.apply(this,arguments)}}();da._generateLegendElementsForSublayers=
function(){var k=J._asyncToGenerator(function*(a,w,I){const P=this.layer;let U=[];this._handles.add(a.on("change",()=>this._constructLegendElementsForSublayers()),"sublayers-watcher");a=a.toArray();!I&&this.sublayerIds&&this.sublayerIds.length&&(a=this.sublayerIds.map(Y=>P.findSublayerById(Y)).filter(Boolean));for(const Y of a)if(a=Y.watch("renderer, opacity, title, visible, legendEnabled",()=>this._constructLegendElementsForSublayers()),this._handles.add(a,"sublayers-watcher"),!this.respectLayerVisibility||
Y.visible&&Y.legendEnabled&&this._isSublayerInScale(Y))a=Y&&null!=Y.opacity?Y.opacity:null,a=null!=a?a*w:w,Y.renderer&&!Y.sublayers&&2<Y.originIdOf("renderer")?(yield Y.load(),U=[...yield this._getRendererLegendElements(Y.renderer,{title:Y.title,opacity:a,sublayer:Y}),...U]):(a=yield this._generateSymbolTableElementForSublayer(Y,a,I))&&U.unshift(a);return U.filter(Y=>!!Y&&("infos"in Y?0<Y.infos.length:!0))});return function(a,w,I){return k.apply(this,arguments)}}();da._generateSymbolTableElementForSublayer=
function(){var k=J._asyncToGenerator(function*(a,w,I){if(!I){I=new Map;var P=this.layer,U=a.source;let Y=null;if(U&&("map-layer"!==U.type||U.mapLayerId!==a.id||U.gdbVersion&&U.gdbVersion!==("gdbVersion"in P&&P.gdbVersion))||2<a.originIdOf("renderer")||2<a.originIdOf("labelingInfo")||2<a.originIdOf("labelsVisible"))U=new D.ExportImageParameters({layer:this.layer}),Y=U.hasDynamicLayers?U.dynamicLayers:null,U.destroy();(yield this._getLegendLayers(Y||`${P.uid}-default`,Y)).forEach(ba=>I.set(ba.layerId,
ba))}P=I.get(a.id);return!P&&a.sublayers?(w=yield this._generateLegendElementsForSublayers(a.sublayers,w,I),{type:"symbol-table",title:a.title,infos:w}):this._generateSymbolTableElementForLegendLayer(P,a,w)});return function(a,w,I){return k.apply(this,arguments)}}();da._generateSymbolTableElementForLegendLayer=function(k,a,w){var I;if(!k||!k.legend||this.respectLayerVisibility&&!this._isLegendLayerInScale(k,a))return null;var P=null==a?void 0:a.renderer;let U=(null==a?void 0:a.title)||k.layerName;
P&&(!a||2<(null==a?void 0:a.originIdOf("renderer")))&&(P=(null==a?void 0:a.title)||this._getRendererTitle(P,a))&&(U&&"string"!==typeof P&&"title"in P&&(P.title=U),U=P);const Y={type:"symbol-table",title:U,legendType:k.legendType?k.legendType:null,infos:[]},ba=a?this._sanitizeLegendForSublayer(k.legend.slice(),a):k.legend;0<(null==(I=k.legendGroups)?void 0:I.length)?k.legendGroups.forEach(la=>{var ta;const va={type:"symbol-table",title:la.heading,legendType:k.legendType?k.legendType:null,infos:this._generateSymbolTableElementInfosForLegendLayer(ba.filter(aa=>
aa.groupId===la.id),k.layerId,w)};0<(null==(ta=va.infos)?void 0:ta.length)&&Y.infos.push(va)}):Y.infos=this._generateSymbolTableElementInfosForLegendLayer(ba,k.layerId,w);return 0<Y.infos.length?Y:null};da._generateSymbolTableElementInfosForLegendLayer=function(k,a,w){return k.map(I=>{let P=I.url;if(I.imageData&&0<I.imageData.length)P=`data:image/png;base64,${I.imageData}`;else if(0!==P.indexOf("http"))P=t.addTokenParameter(`${this.layer.url}/${a}/images/${P}`);else return null;return{label:I.label,
src:P,opacity:null==w?this.opacity:w,width:I.width,height:I.height}}).filter(I=>!!I)};da._isSublayerInScale=function(k){const a=k.minScale||0;k=k.maxScale||0;return 0<a&&a<this.scale||k>this.scale?!1:!0};da._isLegendLayerInScale=function(k,a){a=a||this.layer;let w=null,I=null,P=!0;!a.minScale&&0!==a.minScale||!a.maxScale&&0!==a.maxScale?(0===k.minScale&&a.tileInfo&&(w=a.tileInfo.lods[0].scale),0===k.maxScale&&a.tileInfo&&(I=a.tileInfo.lods[a.tileInfo.lods.length-1].scale)):(w=Math.min(a.minScale,
k.minScale)||a.minScale||k.minScale,I=Math.max(a.maxScale,k.maxScale));if(0<w&&w<this.scale||I>this.scale)P=!1;return P};da._sanitizeLegendForSublayer=function(k,a){if("version"in this.layer&&10.1>this.layer.version||0===k.length)return k;a=a.renderer;let w=null,I=null;k.some(P=>P.values)&&k.some((P,U)=>{P.values||(w=U,I=P,I.label||(I.label="others"));return null!=I});a?"unique-value"===a.type?I&&(k.splice(w,1),k.push(I)):"class-breaks"===a.type&&(I&&k.splice(w,1),k.reverse(),I&&k.push(I)):I&&(k.splice(w,
1),k.push(I));return k};da._getRendererLegendElements=function(){var k=J._asyncToGenerator(function*(a,w={}){var I=this.view;I=Q(a)||W(a)||Z(a)||ka(a)||X(a)?"2d"===I.type||x.isSupportedRenderer3D(a):"raster-stretch"===a.type||"raster-colormap"===a.type||"raster-shaded-relief"===a.type||ia(a)||oa(a)||ja(a)||"vector-field"===a.type;return I?ia(a)||oa(a)||ja(a)||"esri.renderers.PointCloudRGBRenderer"===a.declaredClass?this._constructPointCloudRendererLegendElements(a,w):X(a)?this._constructDotDensityRendererLegendElements(a):
this._constructRendererLegendElements(a,w):(ea.warn(`Renderer of type '${a.type}' not supported!`),[])});return function(a){return k.apply(this,arguments)}}();da._getPointCloudRendererTitle=function(k){return k.legendOptions&&k.legendOptions.title||k.field};da._constructPointCloudRendererLegendElements=function(k,a={}){a=a.title;const w=[];let I=null;var P=null;if(ia(k))I={type:"symbol-table",title:a||this._getPointCloudRendererTitle(k),infos:[]},k.colorClassBreakInfos.forEach(U=>{I.infos.unshift({label:U.label||
U.minValue+" - "+U.maxValue,value:[U.minValue,U.maxValue],symbol:this._getAppliedCloneSymbol(xa,U.color)})});else if(oa(k)){P=k.stops;let U=null;if(P.length&&(1===P.length&&(U=P[0].color),!U)){const Y=P[0].value,ba=P[P.length-1].value;null!=Y&&null!=ba&&(U=n.getColorFromPointCloudStops(Y+(ba-Y)/2,P))}I={type:"symbol-table",title:null,infos:[{label:null,value:null,symbol:this._getAppliedCloneSymbol(xa,U||xa.color)}]};P=n.getRampStopsForPointCloud(k.stops);P={type:"color-ramp",title:a||this._getPointCloudRendererTitle(k),
infos:P,preview:H.renderColorRampPreviewHTML(P.map(Y=>Y.color))}}else ja(k)&&(I={type:"symbol-table",title:a||this._getPointCloudRendererTitle(k),infos:[]},k.colorUniqueValueInfos.forEach(U=>{I.infos.push({label:U.label||U.values.join(", "),value:U.values.join(", "),symbol:this._getAppliedCloneSymbol(xa,U.color)})}));I&&I.infos.length&&w.push(I);P&&P.infos.length&&w.push(P);a=w.reduce((U,Y)=>U.concat(Y.infos),[]).filter(U=>!!U.symbol).map(U=>this._getSymbolPreview(U,this.opacity,{symbolConfig:{applyColorModulation:!!k.colorModulation}}));
return g.eachAlways(a).then(()=>w)};da._getElementInfoForDotDensity=function(k,a){const {backgroundColor:w,outline:I,dotSize:P}=k,U=P+"-"+a+"-"+w+"-"+(I&&JSON.stringify(I.toJSON())),Y=this._dotDensityUrlCache;k=Y.has(U)?Y.get(U):H.renderDotDensityPreviewHTML(k,a);Y.set(U,k);return{opacity:1,src:k.src,preview:k,width:k.width,height:k.height}};da._constructDotDensityRendererLegendElements=function(k){const a=k.calculateDotValue(this.view.scale),w={type:"symbol-table",title:{value:a&&Math.round(a),unit:k.legendOptions&&
k.legendOptions.unit||""},infos:[]};k.attributes.forEach(I=>{const P=this._getElementInfoForDotDensity(k,I.color);P.label=I.label||I.valueExpressionTitle||I.field;w.infos.push(P)});return Promise.resolve([w])};da._constructRendererLegendElements=function(){var k=J._asyncToGenerator(function*(a,w={}){const {title:I,sublayer:P}=w,U=P||this.layer;a=yield this._loadRenderer(a);this._hasSizeRamp=this._hasOpacityRamp=this._hasColorRamp=!1;this._scaleDrivenSizeVariable=null;const Y=(yield this._getVisualVariableLegendElements(a,
U))||[],ba={type:"symbol-table",title:I||this._getRendererTitle(a,U),infos:[]};let la=null,ta=!1;const va=new Set;if(ha(a)){var aa=I,ma=fa(a)?"univariate-above-and-below-ramp":"univariate-color-size-ramp",ua=Y.findIndex(na=>"color-ramp"===na.type);ua=-1!==ua?Y.splice(ua,1)[0]:null;var pa=Y.findIndex(na=>"size-ramp"===na.type);pa=-1!==pa?Y.splice(pa,1)[0]:null;var za=[];ua&&(aa=ua.title,za.push(ua));pa&&(aa=pa.title,za.push(pa));0<za.length&&Y.push({type:ma,title:aa,infos:za})}else if(ka(a))aa=M.getHeatmapRampStops(a),
Y.push({type:"heatmap-ramp",title:I,infos:aa,preview:H.renderColorRampPreviewHTML(aa.map(na=>na.color))});else if(Z(a)){if((ma=a&&a.authoringInfo)&&"relationship"===ma.type){const {focus:na,numClasses:wa,field1:Da,field2:Ea}=ma;if(wa&&Da&&Ea){ua=[Da,Ea];ma=V.getRotationAngleForFocus(na)||0;for(aa of ua){const {field:Ia,normalizationField:Fa,label:Ja}=aa;ua=Ja||{field:this._getFieldAlias(Ia,U),normField:Fa&&this._getFieldAlias(Fa,U)};pa=Ha.clone();pa.angle=ma;ba.infos.push({label:ua,symbol:pa});va.add(pa);
ma+=90}aa=V.getRelationshipRampElement({focus:na,numClasses:wa,infos:a.uniqueValueInfos});Y.unshift(aa)}}else{const na=a.field;a.uniqueValueInfos.forEach(wa=>{wa.symbol&&ba.infos.push({label:wa.label||this._getDomainName(na,wa.value,U)||wa.value,value:wa.value,symbol:wa.symbol})})}a.defaultSymbol&&(ba.infos.push({label:a.defaultLabel||"others",symbol:a.defaultSymbol}),ta=!0)}else if(W(a))la=this._isUnclassedRenderer(a),la&&this._hasSizeRamp||(a.classBreakInfos.forEach(na=>{na.symbol&&ba.infos.unshift({label:na.label||
(la?null:na.minValue+" - "+na.maxValue),value:[na.minValue,na.maxValue],symbol:na.symbol})}),la&&(ba.title=null),this._updateInfosforClassedSizeRenderer(a,ba.infos)),a.defaultSymbol&&!la&&(ba.infos.push({label:a.defaultLabel||"others",symbol:a.defaultSymbol}),ta=!0);else if("raster-stretch"===a.type)if("esri.layers.ImageryTileLayer"===this.layer.declaredClass&&"Map"===(null==(pa=this.layer)?void 0:null==(za=pa.raster)?void 0:za.tileType))this._getServerSideLegend();else if("esri.layers.ImageryTileLayer"===
this.layer.declaredClass||"esri.layers.WCSLayer"===this.layer.declaredClass)aa=this._constructTileImageryStretchRendererElements(a),"stretch-ramp"===aa.type?Y.push(aa):ba.infos=aa;else{aa=this.layer;a.statistics&&a.statistics.length?(pa=null!=a.statistics[0].min?a.statistics[0].min:a.statistics[0][0],ua=null!=a.statistics[0].max?a.statistics[0].max:a.statistics[0][1]):(pa=null==(ua=a)?void 0:ua.outputMin,ua=null==(ma=a)?void 0:ma.outputMax);ma=[];ma=d.unwrap(aa.renderingRule?yield aa.generateRasterInfo(aa.renderingRule):
aa.serviceRasterInfo);const na=ma.keyProperties.BandProperties;1===ma.bandCount?(pa=null!=pa?pa:ma.statistics&&ma.statistics[0].min,ua=null!=ua?ua:ma.statistics&&ma.statistics[0].max,pa||ua?Y.push(this._getStretchLegendElements(a,{min:pa,max:ua})):this._getServerSideLegend()):aa.bandIds&&1===aa.bandIds.length?(pa=null!=pa?pa:ma.statistics&&ma.statistics[aa.bandIds[0]].min,ua=null!=ua?ua:ma.statistics&&ma.statistics[aa.bandIds[0]].max,pa||ua?Y.push(this._getStretchLegendElements(a,{min:pa,max:ua})):
this._getServerSideLegend()):3<=ma.bandCount?na&&na.length>=ma.bandCount?aa.bandIds&&3===aa.bandIds.length?(ma=aa.bandIds.map(wa=>na[wa].BandName),ba.infos=this._createSymbolTableElementMultiBand(ma)):"lerc"===aa.format?(ma=[0,1,2].map(wa=>na[wa].BandName),ba.infos=this._createSymbolTableElementMultiBand(ma)):this._getServerSideLegend():"lerc"===aa.format?(ma=["band1","band2","band3"],ba.infos=this._createSymbolTableElementMultiBand(ma)):this._getServerSideLegend():this._getServerSideLegend()}else if("raster-colormap"===
a.type)a.colormapInfos.forEach(na=>{ba.infos.push({label:na.label,value:na.value,symbol:this._getAppliedCloneSymbol(Ga,na.color)})});else if(Q(a)){aa=a.symbol;switch(w.geometryType){case "point":aa="pointSymbol"in U&&U.pointSymbol;break;case "polyline":aa="lineSymbol"in U&&U.lineSymbol;break;case "polygon":aa="polygonSymbol"in U&&U.polygonSymbol}a.symbol&&!this._hasSizeRamp&&ba.infos.push({label:a.label,symbol:aa})}else"vector-field"===a.type?(a.outputUnit&&(this.title="("+a.toJSON().outputUnit+")"),
ba.title=a.attributeField,aa=a.getClassBreakInfos(),null!=aa&&aa.length?aa.forEach(na=>{ba.infos.push({label:na.minValue+" - "+na.maxValue,symbol:na.symbol})}):ba.infos.push({label:a.attributeField,symbol:a.getDefaultSymbol()})):"raster-shaded-relief"===a.type&&Y.push(this._getStretchLegendElements(a,{min:0,max:255}));const Ca=a.defaultSymbol;!Ca||ta||Q(a)||la&&!this._hasColorRamp&&!this._hasSizeRamp&&!this._hasOpacityRamp||Y.push({type:"symbol-table",infos:[{label:a.defaultLabel||"others",symbol:Ca}]});
ba.infos.length&&Y.unshift(ba);const Ka=null==w.opacity?this.opacity:w.opacity,La=this._isTallSymbol("visualVariables"in a&&a.visualVariables),Ma="esri.layers.ImageryLayer"===this.layer.declaredClass||"esri.layers.ImageryTileLayer"===this.layer.declaredClass;w=Y.reduce((na,wa)=>na.concat(this._getAllInfos(wa)),[]).filter(na=>!(null==na||!na.symbol)).map(na=>this._getSymbolPreview(na,Ka,{isDefault:na.symbol===Ca,applyScaleDrivenSize:!va.has(na.symbol),symbolConfig:{isTall:La,isSquareFill:Ma}}));a=
null;yield g.eachAlways(w);return Y});return function(a){return k.apply(this,arguments)}}();da._getServerSideLegend=function(){setTimeout(()=>this.buildLegendElementsForTools(),0)};da._getAllInfos=function(k){const a=null==k?void 0:k.infos;return a?a.reduce((w,I)=>w.concat(this._getAllInfos(I)),[]):[k]};da._constructTileImageryStretchRendererElements=function(k){function a(ta){var va;const aa=(null!=P&&null!=(va=P.bandIds)&&va.length?P.bandIds:Array.from(Array(Math.min(U.bandCount,3)).keys())).map(ma=>
ta&&ta[ma]&&ta[ma].BandName||"band"+(ma+1));3>aa.length?aa.push(aa[1]):3<aa.length&&aa.splice(3);return aa}var w,I;const P=this.layer,U=P.rasterInfo,Y=U.bandCount||k.statistics.length;var ba,la=[];la=U.keyProperties&&U.keyProperties.BandProperties;(ba=null!=k&&null!=(w=k.statistics)&&w.length?k.statistics:null==U?void 0:U.statistics)?(w=void 0!==ba[0].min?ba[0].min:ba[0][0],ba=ba[0].max||ba[0][1]):(ba=ya[P.rasterInfo.pixelType.toLowerCase()],w=ba[0],ba=ba[1]);P.hasStandardTime()&&(w=P.getStandardTimeValue(w),
ba=P.getStandardTimeValue(ba));if(1===U.bandCount||1===(null==(I=P.bandIds)?void 0:I.length))return this._getStretchLegendElements(k,{min:w,max:ba});la=la&&la.length>=Y?a(la):a();return this._createSymbolTableElementMultiBand(la)};da._getStretchLegendElements=function(k,a){k=n.getStrectchRampStops(k.colorRamp,a);return{type:"stretch-ramp",title:"",infos:k,preview:H.renderColorRampPreviewHTML(k.map(w=>w.color))}};da._createSymbolTableElementMultiBand=function(k){const a=[],w=["red","green","blue"];
k.forEach((I,P)=>{a.push({label:{colorName:w[P],bandName:I},src:F.RGB_IMG_SOURCE[P],opacity:1})});return a};da._updateInfosforClassedSizeRenderer=function(k,a){const w=k.authoringInfo&&"class-breaks-size"===k.authoringInfo.type,I=k.classBreakInfos.some(P=>B.isVolumetricSymbol(P.symbol));if(w&&I){const P=c.REAL_WORLD_MAX_SIZE;k=k.classBreakInfos.length;const U=(P-c.REAL_WORLD_MIN_SIZE)/(1<k?k-1:k);a.forEach((Y,ba)=>{Y.size=P-U*ba})}};da._isTallSymbol=function(k){let a=!1,w=!1;if(k)for(let I=0;I<k.length&&
(!a||!w);I++){const P=k[I];"size"===P.type&&("height"===P.axis&&(a=!0),"width-and-depth"===P.axis&&(w=!0))}return a&&w};da._getSymbolPreview=function(){var k=J._asyncToGenerator(function*(a,w,I){var P=null!=I&&I.isDefault||null!=a.size||!this._hasSizeRamp?a.size:r.px2pt(22);this._scaleDrivenSizeVariable&&null!=I&&I.applyScaleDrivenSize&&({getSize:P}=yield new Promise(function(U,Y){E(["../../../renderers/visualVariables/support/visualVariableUtils"],U,Y)}),P=P(this._scaleDrivenSizeVariable,null,{view:this.view.type,
scale:this.scale,shape:"simple-marker"===a.symbol.type?a.symbol.style:null}));return H.renderPreviewHTML(a.symbol,{size:P,opacity:w,scale:!1,symbolConfig:null==I?void 0:I.symbolConfig}).then(U=>{a.preview=U;return a}).catch(()=>{a.preview=null;return a})});return function(a,w,I){return k.apply(this,arguments)}}();da._loadRenderer=function(){var k=J._asyncToGenerator(function*(a){var w,I;const P=[];var U=this.layer;a=a.clone();this._hasClusterSizeVariable=!1;const Y="visualVariables"in a&&(null==(w=
a.visualVariables)?void 0:w.some(la=>"size"===la.type&&"outline"!==la.target&&!ra.test(la.valueExpression)));if(a&&"visualVariables"in a&&!Y&&"featureReduction"in U&&"cluster"===(null==(I=U.featureReduction)?void 0:I.type)&&(w=d.unwrap(h.getClusterSizeVariable(this.layerView._effectiveRenderer,this.view)))){U=U.featureReduction;if("clusterMinSize"in U&&"clusterMaxSize"in U){const {clusterMinSize:la,clusterMaxSize:ta}=U;w.legendOptions=new l({showLegend:la!==ta})}a.visualVariables=(a.visualVariables||
[]).concat([w]);this._hasClusterSizeVariable=!0}const ba=yield this._getMedianColor(a);if(W(a)||Z(a))U=(a.classBreakInfos||a.uniqueValueInfos).map(la=>this._fetchSymbol(la.symbol,ba).then(ta=>{la.symbol=ta}).catch(()=>{la.symbol=null})),Array.prototype.push.apply(P,U);P.push(this._fetchSymbol(a.symbol||a.defaultSymbol,a.defaultSymbol?null:ba).then(la=>{this._applySymbolToRenderer(a,la,Q(a))}).catch(()=>{this._applySymbolToRenderer(a,null,Q(a))}));return g.eachAlways(P).then(()=>a)});return function(a){return k.apply(this,
arguments)}}();da._applySymbolToRenderer=function(k,a,w){w?k.symbol=a:k.defaultSymbol=a};da._getMedianColor=function(){var k=J._asyncToGenerator(function*(a){if(!("visualVariables"in a&&a.visualVariables))return null;a=a.visualVariables.find(P=>"color"===P.type);if(!a)return null;var w=null,I=null;if(a.stops){if(1===a.stops.length)return a.stops[0].color;w=a.stops[0].value;I=a.stops[a.stops.length-1].value}w+=(I-w)/2;({getColor:I}=yield new Promise(function(P,U){E(["../../../renderers/visualVariables/support/visualVariableUtils"],
P,U)}));return I(a,w)});return function(a){return k.apply(this,arguments)}}();da._fetchSymbol=function(k,a){if(!k)return Promise.reject();if("web-style"===k.type){var w=k.portal;w=k.name+"-"+k.styleName+"-"+k.styleUrl+"-"+(w&&w.url)+"-"+(w&&w.user&&w.user.username);const I=this._webStyleSymbolCache;I.has(w)||("2d"===this.view.type?I.set(w,k.fetchCIMSymbol()):I.set(w,k.fetchSymbol()));return I.get(w).then(P=>this._getAppliedCloneSymbol(P,a)).catch(()=>{ea.warn("Fetching web-style failed!");return Promise.reject()})}return Promise.resolve(this._getAppliedCloneSymbol(k,
a))};da._getAppliedCloneSymbol=function(k,a){if(!k||!a)return k;k=k.clone();const w=a&&a.toRgba();-1<k.type.indexOf("3d")?this._applyColorTo3dSymbol(k,w):"cim"===k.type?N.applyCIMSymbolColor(k,a):k.color&&(k.color=new y(w||k.color));return k};da._applyColorTo3dSymbol=function(k,a){a&&k.symbolLayers.forEach(w=>{w&&(w.material||(w.material={}),w.material.color=new y(a))})};da._getVisualVariableLegendElements=function(){var k=J._asyncToGenerator(function*(a,w){var I=this;if(!("visualVariables"in a&&
a.visualVariables)||"vector-field"===a.type)return null;var P=a.visualVariables,U=[];const Y=[],ba=[];for(const va of P)"color"===va.type?U.push(va):"size"===va.type?Y.push(va):"opacity"===va.type&&ba.push(va);P=[...U,...Y,...ba];let la;if(0===U.length&&W(a)&&a.classBreakInfos&&1===a.classBreakInfos.length)var ta=(ta=a.classBreakInfos[0])&&ta.symbol;0===U.length&&Q(a)&&(ta=a.symbol);ta&&(-1<ta.type.indexOf("3d")?(U=ta.symbolLayers.getItemAt(0),"water"===U.type?d.isSome(U.color)&&(la=U.color):d.isSome(U.material)&&
d.isSome(U.material.color)&&(la=U.material.color)):ta.url||(la=ta.color));return(yield Promise.all(P.map(function(){var va=J._asyncToGenerator(function*(aa){if(!aa.legendOptions||!1!==aa.legendOptions.showLegend){const ua=I._getRampTitle(aa,w);let pa=null;var ma="getField"in w&&w.getField&&w.getField(aa.field);ma=ma&&S.isDateField(ma);"color"===aa.type?(aa=yield n.getRampStops(aa,null,ma),pa={type:"color-ramp",title:ua,infos:aa,preview:H.renderColorRampPreviewHTML(aa.map(za=>za.color))},I._hasColorRamp||
(I._hasColorRamp=!(null==pa.infos||!pa.infos.length))):"size"===aa.type&&"outline"!==aa.target?ra.test(aa.valueExpression)?I._hasClusterSizeVariable||(I._scaleDrivenSizeVariable=aa):(pa={type:"size-ramp",title:I._hasClusterSizeVariable?I._getClusterTitle(aa):ua,infos:yield c.getRampStops(a,aa,yield I._getMedianColor(a),I.scale,I.view.type,ma)},I._hasSizeRamp||(I._hasSizeRamp=!(null==pa.infos||!pa.infos.length))):"opacity"===aa.type&&(aa=yield n.getRampStops(aa,la,ma),pa={type:"opacity-ramp",title:ua,
infos:aa,preview:H.renderColorRampPreviewHTML(aa.map(za=>za.color))},I._hasOpacityRamp||(I._hasOpacityRamp=!(null==pa.infos||!pa.infos.length)));return pa&&pa.infos?pa:null}});return function(aa){return va.apply(this,arguments)}}()))).filter(va=>!!va)});return function(a,w){return k.apply(this,arguments)}}();da._getDomainName=function(k,a,w){return k&&"function"!==typeof k?(w=(k="getField"in w&&w.getField&&w.getField(k))&&"getFieldDomain"in w&&w.getFieldDomain?w.getFieldDomain(k.name):null)&&"coded-value"===
w.type?w.getName(a):null:null};da._getClusterTitle=function(k){var a=this.layer;k=k.field;if("featureReduction"in a&&a.featureReduction&&"cluster"===a.featureReduction.type&&(a=a.featureReduction,a=(a="popupTemplate"in a&&a.popupTemplate)&&a.fieldInfos))for(const w of a)if(w.fieldName===k)return"cluster_count"===k?w.label||{showCount:!0}:w.label;return{showCount:!0}};da._getRampTitle=function(k,a){let w=k.field,I=k.normalizationField,P=!1,U=!1,Y=!1;var ba=null;w="function"===typeof w?null:w;I="function"===
typeof I?null:I;ba=k.legendOptions&&k.legendOptions.title;if(null==ba)if(k.valueExpressionTitle)ba=k.valueExpressionTitle;else{if("renderer"in a&&a.renderer&&"authoringInfo"in a.renderer&&a.renderer.authoringInfo&&a.renderer.authoringInfo.visualVariables)for(k=a.renderer.authoringInfo.visualVariables,ba=0;ba<k.length;ba++){const la=k[ba];if("color"===la.type){if("ratio"===la.style){P=!0;break}if("percent"===la.style){U=!0;break}if("percent-of-total"===la.style){Y=!0;break}}}ba={field:w&&this._getFieldAlias(w,
a),normField:I&&this._getFieldAlias(I,a),ratio:P,ratioPercent:U,ratioPercentTotal:Y}}return ba};da._getRendererTitle=function(k,a){if(k.legendOptions&&k.legendOptions.title)return k.legendOptions.title;if(k.valueExpressionTitle)return k.valueExpressionTitle;let w=k.field,I=null,P=null;W(k)&&(I=k.normalizationField,P="percent-of-total"===k.normalizationType);w="function"===typeof w?null:w;I="function"===typeof I?null:I;k=null;if(w||I)k={field:w&&this._getFieldAlias(w,a),normField:I&&this._getFieldAlias(I,
a),normByPct:P};return k};da._getFieldAlias=function(k,a){var w="popupTemplate"in a&&a.popupTemplate;w=w&&w.fieldInfos;let I=null;w&&w.some(U=>k===U.fieldName?(I=U,!0):!1);w=null;"getField"in a&&a.getField?w=a.getField(k):"fieldsIndex"in a&&a.fieldsIndex&&(w=a.fieldsIndex.get(k));a=I||w;let P=null;a&&(P=I&&I.label||w&&w.alias||"name"in a&&a.name||"fieldName"in a&&a.fieldName);return P};da._isUnclassedRenderer=function(k){const a=k.visualVariables;let w=!1;W(k)&&k.classBreakInfos&&1===k.classBreakInfos.length&&
a&&(w=k.field?a.some(I=>!(!I||k.field!==I.field||(k.normalizationField||I.normalizationField)&&k.normalizationField!==I.normalizationField)):!!a.length);return w};J._createClass(Ba,[{key:"opacity",get:function(){var k;const a=this.layer.opacity,w=null==(k=this.parent)?void 0:k.opacity;k=(k=this.layer.parent)&&"uid"in k?this._getParentLayerOpacity(k):null;return null!=w?w*a:null!=k?k*a:a}},{key:"ready",get:function(){return null===this.layer?!0:0<this.children.length?this._isGroupActive():0<this.legendElements.length}},
{key:"scale",get:function(){return this.view&&this.view.scale}},{key:"isScaleDriven",get:function(){var k=this.layer;if(null===k)return!1;if("featureReduction"in k&&k.featureReduction&&"cluster"===k.featureReduction.type)return!0;if("renderer"in k&&k.renderer){if("dot-density"===k.renderer.type)return!0;const a=k.get("renderer.valueExpression");if(ra.test(a))return!0;if(k=k.get("renderer.visualVariables"))return k.some(w=>this._isScaleDrivenSizeVariable(w))}return this._isLayerScaleDriven(this.layer)}},
{key:"version",get:function(){return this._get("version")+1}}]);return Ba}(T);u.__decorate([K.property()],L.prototype,"children",void 0);u.__decorate([K.property()],L.prototype,"layerView",void 0);u.__decorate([K.property()],L.prototype,"layer",void 0);u.__decorate([K.property()],L.prototype,"legendElements",void 0);u.__decorate([K.property({readOnly:!0})],L.prototype,"opacity",null);u.__decorate([K.property()],L.prototype,"parent",void 0);u.__decorate([K.property({readOnly:!0,dependsOn:[]})],L.prototype,
"ready",null);u.__decorate([K.property()],L.prototype,"hideLayersNotInCurrentView",void 0);u.__decorate([K.property()],L.prototype,"keepCacheOnDestroy",void 0);u.__decorate([K.property()],L.prototype,"respectLayerVisibility",void 0);u.__decorate([K.property({readOnly:!0})],L.prototype,"scale",null);u.__decorate([K.property()],L.prototype,"sublayerIds",void 0);u.__decorate([K.property({readOnly:!0})],L.prototype,"isScaleDriven",null);u.__decorate([K.property()],L.prototype,"title",void 0);u.__decorate([K.property({readOnly:!0,
dependsOn:["ready"],value:0})],L.prototype,"version",null);u.__decorate([K.property()],L.prototype,"view",void 0);return L=u.__decorate([q.subclass("esri.widgets.Legend.support.ActiveLayerInfo")],L)})},"esri/layers/support/ExportImageParameters":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/HandleOwner ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/accessorSupport/decorators/subclass ./commonProperties ./sublayerUtils ../../views/support/floorFilterUtils".split(" "),
function(E,J,u,y,t,C,L,T,R,p,A,b,d,g){const r={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};E.ExportImageParameters=function(m){function G(z){z=m.call(this,z)||this;z.floors=null;z.scale=0;return z}J._inheritsLoose(G,m);var K=G.prototype;K.destroy=function(){this.layer=null};K.toJSON=
function(){var z=this.layer;z={dpi:z.dpi,format:z.imageFormat,transparent:z.imageTransparency,gdbVersion:z.gdbVersion||null};this.hasDynamicLayers&&this.dynamicLayers?z.dynamicLayers=this.dynamicLayers:z={...z,layers:this.layers,layerDefs:this.layerDefs};return z};J._createClass(G,[{key:"dynamicLayers",get:function(){if(!this.hasDynamicLayers)return null;const z=this.visibleSublayers.map(O=>{const q=g.getLayerFloorFilterClause(this.floors,O);return O.toExportImageJSON(q)});return z.length?JSON.stringify(z):
null}},{key:"hasDynamicLayers",get:function(){return this.layer&&d.isExportDynamic(this.visibleSublayers,this.layer.serviceSublayers,this.layer)}},{key:"layer",set:function(z){this._get("layer")!==z&&(this._set("layer",z),this.handles.remove("layer"),z&&this.handles.add([z.allSublayers.on("change",()=>this.notifyChange("visibleSublayers")),z.on("sublayer-update",O=>this.notifyChange(r[O.propertyName]))],"layer"))}},{key:"layers",get:function(){const z=this.visibleSublayers;return z?z.length?"show:"+
z.map(O=>O.id).join(","):"show:-1":null}},{key:"layerDefs",get:function(){var z;const O=!(null==(z=this.floors)||!z.length);z=this.visibleSublayers.filter(q=>null!=q.definitionExpression||O&&null!=q.floorInfo);return z.length?JSON.stringify(z.reduce((q,D)=>{var S=g.getLayerFloorFilterClause(this.floors,D);S=C.isSome(S)?g.combineFloorsDefinitionExpression(S,D):D.definitionExpression;q[D.id]=S;return q},{})):null}},{key:"version",get:function(){this.commitProperty("layers");this.commitProperty("layerDefs");
this.commitProperty("dynamicLayers");this.commitProperty("timeExtent");const z=this.layer;z&&(z.commitProperty("dpi"),z.commitProperty("imageFormat"),z.commitProperty("imageTransparency"),z.commitProperty("gdbVersion"));return(this._get("version")||0)+1}},{key:"visibleSublayers",get:function(){const z=[];if(!this.layer)return z;var O=this.layer.sublayers;const q=D=>{const S=this.scale,f=0===D.minScale||S<=D.minScale,x=0===D.maxScale||S>=D.maxScale;D.visible&&(0===S||f&&x)&&(D.sublayers?D.sublayers.forEach(q):
z.unshift(D))};O&&O.forEach(q);O=this._get("visibleSublayers");return!O||O.length!==z.length||O.some((D,S)=>z[S]!==D)?z:O}}]);return G}(t.HandleOwnerMixin(y));u.__decorate([L.property({readOnly:!0})],E.ExportImageParameters.prototype,"dynamicLayers",null);u.__decorate([L.property()],E.ExportImageParameters.prototype,"floors",void 0);u.__decorate([L.property({readOnly:!0})],E.ExportImageParameters.prototype,"hasDynamicLayers",null);u.__decorate([L.property()],E.ExportImageParameters.prototype,"layer",
null);u.__decorate([L.property({readOnly:!0})],E.ExportImageParameters.prototype,"layers",null);u.__decorate([L.property({readOnly:!0})],E.ExportImageParameters.prototype,"layerDefs",null);u.__decorate([L.property({type:Number})],E.ExportImageParameters.prototype,"scale",void 0);u.__decorate([L.property(b.combinedViewLayerTimeExtentProperty)],E.ExportImageParameters.prototype,"timeExtent",void 0);u.__decorate([L.property({readOnly:!0})],E.ExportImageParameters.prototype,"version",null);u.__decorate([L.property({readOnly:!0})],
E.ExportImageParameters.prototype,"visibleSublayers",null);E.ExportImageParameters=u.__decorate([A.subclass("esri.layers.mixins.ExportImageParameters")],E.ExportImageParameters);Object.defineProperty(E,"__esModule",{value:!0})})},"esri/layers/support/sublayerUtils":function(){define(["exports"],function(E){function J(u,y){if(!u||!u.length)return!0;y=y.slice().reverse().flatten(({sublayers:L})=>L&&L.toArray().reverse()).map(L=>L.id).toArray();if(u.length>y.length)return!1;let t=0;const C=y.length;
for(const {id:L}of u){for(;t<C&&y[t]!==L;)t++;if(t>=C)return!1}return!0}E.isExportDynamic=function(u,y,t){return u.some(C=>{const L=C.source;return!(!L||"map-layer"===L.type&&L.mapLayerId===C.id&&(!L.gdbVersion||L.gdbVersion===t.gdbVersion))||2<C.originIdOf("renderer")||2<C.originIdOf("labelingInfo")||2<C.originIdOf("opacity")||2<C.originIdOf("labelsVisible")})?!0:!J(u,y)};E.isSublayerOverhaul=function(u){return!!u&&u.some(y=>null!=y.minScale||y.layerDefinition&&null!=y.layerDefinition.minScale)};
E.shouldWriteSublayerStructure=function(u,y,t){return y.flatten(({sublayers:C})=>C).length!==u.length||u.some(C=>C.originIdOf("minScale")>t||C.originIdOf("maxScale")>t||C.originIdOf("renderer")>t||C.originIdOf("labelingInfo")>t||C.originIdOf("opacity")>t||C.originIdOf("labelsVisible")>t||C.originIdOf("source")>t)?!0:!J(u,y)};Object.defineProperty(E,"__esModule",{value:!0})})},"esri/views/support/floorFilterUtils":function(){define(["exports"],function(E){function J(u,y){if(null==u||!u.length)return null;
u=u.filter(t=>""!==t).map(t=>`'${t}'`);u.push("''");return`${y} IN (${u.join(",")}) OR ${y} IS NULL`}E.combineFloorsDefinitionExpression=function(u,y){({definitionExpression:y}=y);return u?y?`(${y}) AND (${u})`:u:y};E.getFloorFilterClause=function(u){var y;const t=u.layer;return"floorInfo"in t&&null!=(y=t.floorInfo)&&y.floorField&&"floors"in u.view?J(u.view.floors,t.floorInfo.floorField):null};E.getLayerFloorFilterClause=function(u,y){var t;return"floorInfo"in y&&null!=(t=y.floorInfo)&&t.floorField?
J(u,y.floorInfo.floorField):null};Object.defineProperty(E,"__esModule",{value:!0})})},"esri/renderers/support/rendererConversion":function(){define(["exports","../../core/has","../../core/Error","../../core/maybe","../../symbols/support/symbolConversion"],function(E,J,u,y,t){function C(p){return y.isNone(p)||"simple"===p.type||"unique-value"===p.type||"class-breaks"===p.type||"dictionary"===p.type}function L(p,A){if(!A)return null;A=Array.isArray(A)?A:[A];if(0<A.length){const b=A.map(g=>g.details.symbol.type||
g.details.symbol.declaredClass).filter(g=>!!g);b.sort();const d=[];b.forEach((g,r)=>{0!==r&&g===b[r-1]||d.push(g)});return new u("renderer-conversion-3d:unsupported-symbols",`Renderer contains symbols (${d.join(", ")}) which are not supported in 3D`,{renderer:p,symbolErrors:A})}return null}function T(p){const A=p.uniqueValueInfos.map(d=>t.to3D(d.symbol).error).filter(d=>!!d),b=t.to3D(p.defaultSymbol);b.error&&A.unshift(b.error);return L(p,A)}function R(p){const A=p.classBreakInfos.map(d=>t.to3D(d.symbol).error).filter(d=>
!!d),b=t.to3D(p.defaultSymbol);b.error&&A.unshift(b.error);return L(p,A)}E.isSupportedRenderer3D=C;E.validateTo3D=function(p){if(y.isNone(p))return null;if(!C(p))return new u("renderer-conversion-3d:unsupported-renderer",`Unsupported renderer of type '${p.type||p.declaredClass}'`,{renderer:p});switch(p.type){case "simple":return L(p,t.to3D(p.symbol).error);case "unique-value":return T(p);case "class-breaks":return R(p)}return null};Object.defineProperty(E,"__esModule",{value:!0})})},"esri/symbols/support/cimSymbolUtils":function(){define(["exports",
"../../Color","../cim/utils"],function(E,J,u){function y(b){b=u.toCIMSymbolJSON(b);if("CIMTextSymbol"===b.type)return b.height;let d=0;if(b.symbolLayers)for(const g of b.symbolLayers)u.isCIMMarker(g)&&g.size>d?d=g.size:u.isCIMStroke(g)&&g.width>d?d=g.width:u.isCIMFill(g);return d}function t(b,d,g,r){if("CIMTextSymbol"===b.type)b.height*=d;else{if(g&&b.effects)for(const m of b.effects)T(m,d);if(b.symbolLayers)for(const m of b.symbolLayers)switch(m.type){case "CIMPictureMarker":case "CIMVectorMarker":C(m,
d,r);break;case "CIMPictureStroke":case "CIMSolidStroke":null!=r&&r.preserveOutlineWidth||(m.width*=d);break;case "CIMPictureFill":m.height*=d;m.offsetX*=d;m.offsetY*=d;break;case "CIMHatchFill":t(m.lineSymbol,d,!0,{...r,preserveOutlineWidth:!1}),m.offsetX*=d,m.offsetY*=d,m.separation*=d}}}function C(b,d,g){b.markerPlacement&&L(b.markerPlacement,d);b.offsetX*=d;b.offsetY*=d;b.anchorPoint&&"Absolute"===b.anchorPointUnits&&(b.anchorPoint={x:b.anchorPoint.x*d,y:b.anchorPoint.y*d});b.size*=d;if("CIMVectorMarker"===
b.type&&b.markerGraphics)for(const r of b.markerGraphics)b.scaleSymbolsProportionally||t(r.symbol,d,!0,g)}function L(b,d){u.isCIMMarkerStrokePlacement(b)&&(b.offset*=d);switch(b.type){case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineSameSize":b.customEndingOffset*=d;b.offsetAlongLine*=d;if(b.placementTemplate&&b.placementTemplate.length){var g=b.placementTemplate.map(r=>r*d);b.placementTemplate=g}break;case "CIMMarkerPlacementAlongLineVariableSize":b.maxRandomOffset*=
d;b.placementTemplate&&b.placementTemplate.length&&(g=b.placementTemplate.map(r=>r*d),b.placementTemplate=g);break;case "CIMMarkerPlacementOnLine":b.startPointOffset*=d;break;case "CIMMarkerPlacementAtExtremities":b.offsetAlongLine*=d;break;case "CIMMarkerPlacementAtRatioPositions":b.beginPosition*=d;b.endPosition*=d;break;case "CIMMarkerPlacementPolygonCenter":b.offsetX*=d;b.offsetY*=d;break;case "CIMMarkerPlacementInsidePolygon":b.offsetX*=d,b.offsetY*=d,b.stepX*=d,b.stepY*=d}}function T(b,d){switch(b.type){case "CIMGeometricEffectArrow":case "CIMGeometricEffectDonut":b.width*=
d;break;case "CIMGeometricEffectBuffer":b.size*=d;break;case "CIMGeometricEffectCut":b.beginCut*=d;b.endCut*=d;b.middleCut*=d;break;case "CIMGeometricEffectDashes":b.customEndingOffset*=d;b.offsetAlongLine*=d;if(b.dashTemplate&&b.dashTemplate.length){const g=b.dashTemplate.map(r=>r*d);b.dashTemplate=g}break;case "CIMGeometricEffectExtension":case "CIMGeometricEffectJog":case "CIMGeometricEffectRadial":b.length*=d;break;case "CIMGeometricEffectMove":b.offsetX*=d;b.offsetY*=d;break;case "CIMGeometricEffectOffset":case "CIMGeometricEffectOffsetTangent":b.offset*=
d;break;case "CIMGeometricEffectRegularPolygon":b.radius*=d;break;case "CIMGeometricEffectTaperedPolygon":b.fromWidth*=d;b.length*=d;b.toWidth*=d;break;case "CIMGeometricEffectWave":b.amplitude*=d,b.period*=d}}function R(b,d){let g;g="CIMTextSymbol"===b.type?b.symbol:b;b="CIMPolygonSymbol"===b.type;if(g.symbolLayers)for(const r of g.symbolLayers)if(!(r.colorLocked||b&&(u.isCIMStroke(r)||u.isCIMMarker(r)&&r.markerPlacement&&u.isCIMMarkerStrokePlacement(r.markerPlacement))))switch(r.type){case "CIMVectorMarker":r.markerGraphics.forEach(m=>
{R(m.symbol,d)});break;case "CIMSolidStroke":case "CIMSolidFill":p(d,r.color);break;case "CIMHatchFill":R(r.lineSymbol,d)}}function p(b,d){for(const g of b)if(g.join(".")===d.join("."))return;b.push(d)}function A(b,d){var g="CIMTextSymbol"===b.type?b.symbol:b;b="CIMPolygonSymbol"===b.type?!0:!1;if(g.symbolLayers)for(const r of g.symbolLayers)if(!(r.colorLocked||b&&(u.isCIMStroke(r)||u.isCIMMarker(r)&&r.markerPlacement&&u.isCIMMarkerStrokePlacement(r.markerPlacement))))switch(g=d.toArray(0),r.type){case "CIMVectorMarker":r.markerGraphics.forEach(m=>
{A(m.symbol,d)});break;case "CIMSolidStroke":case "CIMSolidFill":r.color=g;break;case "CIMHatchFill":A(r.lineSymbol,d)}}E.applyCIMSymbolColor=function(b,d){d instanceof J||(d=new J(d));b=u.toCIMSymbolJSON(b);A(b,d)};E.applyCIMSymbolRotation=function(b,d,g=!1){b=u.toCIMSymbolJSON(b);g&&0!==d&&(d=360-d);if("CIMTextSymbol"===b.type)b.angle=d;else if("CIMPointSymbol"===b.type&&b.symbolLayers){g=d-(b.angle||0);for(const r of b.symbolLayers)if(u.isCIMMarker(r)){let m=r.rotation||0;m=r.rotateClockwise?m-
g:m+g;r.rotation=m}b.angle=d}};E.getCIMSymbolColor=function(b){b=u.toCIMSymbolJSON(b);const d=[];R(b,d);return d.length?new J(u.fromCIMColor(d[0])):null};E.getCIMSymbolRotation=function(b,d=!1){b=u.toCIMSymbolJSON(b);return"CIMTextSymbol"===b.type||"CIMPointSymbol"===b.type?d&&0!==b.angle?360-b.angle:b.angle||0:0};E.getCIMSymbolSize=y;E.scaleCIMMarker=C;E.scaleCIMSymbolTo=function(b,d,g){const r=u.toCIMSymbolJSON(b);b=y(b);if(0===b)if("CIMTextSymbol"===r.type)r.height=d;else{if(r.symbolLayers)for(const m of r.symbolLayers)switch(m.type){case "CIMPictureMarker":case "CIMVectorMarker":m.size=
d;break;case "CIMPictureStroke":case "CIMSolidStroke":m.width=d}}else t(r,d/b,!1,g)};Object.defineProperty(E,"__esModule",{value:!0})})},"esri/symbols/cim/utils":function(){define(["exports"],function(E){function J(u,y){"string"!==typeof u&&(u=String(u));switch(y){case "LowerCase":return u.toLowerCase();case "Allcaps":return u.toUpperCase();default:return u}}E._adjustTextCase=J;E.colorToArray=function(u){return[u.r,u.g,u.b,u.a]};E.createLabelOverrideFunction=function(u,y,t){const C=p=>{let A=p.length;
for(;A--;)if(-1===" /-,\n".indexOf(p.charAt(A)))return!1;return!0},L=[];var T=0;let R=-1;do R=y.indexOf("[",T),R>=T&&(R>T&&(T=y.substr(T,R-T),L.push([T,null,C(T)])),T=R+1,R=y.indexOf("]",T),R>=T&&(R>T&&(T=y.substr(T,R-T),(T=u[T])&&L.push([null,T,!1])),T=R+1));while(-1!==R);T<y.length-1&&(u=y.substr(T),L.push([u,null,C(u)]));return p=>{let A="",b=null;for(const d of L){const [g,r,m]=d;if(g)m?b=g:(b&&(A+=b,b=null),A+=g);else{const G=p.attributes[r];G&&(b&&(A+=b,b=null),A+=G)}}return J(A,t)}};E.evaluateValueOrFunction=
function(u,y,t,C){return"function"===typeof u?u(y,t,C):u};E.fromCIMColor=function(u){return u?{r:u[0],g:u[1],b:u[2],a:u[3]/255}:{r:0,g:0,b:0,a:0}};E.isCIMFill=function(u){return"CIMGradientFill"===u.type||"CIMHatchFill"===u.type||"CIMPictureFill"===u.type||"CIMSolidFill"===u.type||"CIMWaterFill"===u.type};E.isCIMMarker=function(u){return"CIMVectorMarker"===u.type||"CIMPictureMarker"===u.type||"CIMBarChartMarker"===u.type||"CIMCharacterMarker"===u.type||"CIMPieChartMarker"===u.type||"CIMStackedBarChartMarker"===
u.type};E.isCIMMarkerStrokePlacement=function(u){return"CIMMarkerPlacementAlongLineRandomSize"===u.type||"CIMMarkerPlacementAlongLineSameSize"===u.type||"CIMMarkerPlacementAlongLineVariableSize"===u.type||"CIMMarkerPlacementAtExtremities"===u.type||"CIMMarkerPlacementAtMeasuredUnits"===u.type||"CIMMarkerPlacementAtRatioPositions"===u.type||"CIMMarkerPlacementOnLine"===u.type||"CIMMarkerPlacementOnVertices"===u.type};E.isCIMStroke=function(u){return"CIMGradientStroke"===u.type||"CIMPictureStroke"===
u.type||"CIMSolidStroke"===u.type};E.resampleHermite=function(u,y,t,C,L,T,R=!0){const p=y/L;t/=T;const A=Math.ceil(p/2),b=Math.ceil(t/2);for(let r=0;r<T;r++)for(let m=0;m<L;m++){const G=4*(m+(R?T-r-1:r)*L);var d=0;let K=0,z=0,O=0,q=0,D=0,S=0;const f=(r+.5)*t;for(let x=Math.floor(r*t);x<(r+1)*t;x++){var g=Math.abs(f-(x+.5))/b;const l=(m+.5)*p;g*=g;for(let N=Math.floor(m*p);N<(m+1)*p;N++){let H=Math.abs(l-(N+.5))/A;d=Math.sqrt(g+H*H);-1<=d&&1>=d&&(d=2*d*d*d-3*d*d+1,0<d&&(H=4*(N+x*y),S+=d*u[H+3],z+=
d,255>u[H+3]&&(d=d*u[H+3]/250),O+=d*u[H],q+=d*u[H+1],D+=d*u[H+2],K+=d))}}C[G]=O/K;C[G+1]=q/K;C[G+2]=D/K;C[G+3]=S/z}};E.toCIMSymbolJSON=function(u){var y;return null==(y=u.data)?void 0:y.symbol};Object.defineProperty(E,"__esModule",{value:!0})})},"esri/symbols/support/symbolUtils":function(){define("require exports ../../chunks/_rollupPluginBabelHelpers ../../core/has ../../core/maybe ../../support/arcadeOnDemand ./utils".split(" "),function(E,J,u,y,t,C,L){function T(g,r){return R.apply(this,arguments)}
function R(){R=u._asyncToGenerator(function*(g,r){switch(g.type){case "web-style":var {previewWebStyleSymbol:m}=yield new Promise(function(G,K){E(["./previewWebStyleSymbol"],G,K)});return m(g,T,r);case "label-3d":case "line-3d":case "mesh-3d":case "point-3d":case "polygon-3d":return{previewSymbol3D:m}=yield new Promise(function(G,K){E(["./previewSymbol3D"],G,K)}),m(g,r);case "simple-marker":case "simple-line":case "simple-fill":case "picture-marker":case "picture-fill":case "text":return{previewSymbol2D:m}=
yield new Promise(function(G,K){E(["./previewSymbol2D"],G,K)}),m(g,r);case "cim":return{previewCIMSymbol:m}=yield new Promise(function(G,K){E(["./previewCIMSymbol"],G,K)}),m(g,r)}});return R.apply(this,arguments)}function p(g){return g&&"opacity"in g?g.opacity*p(g.parent):1}function A(){A=u._asyncToGenerator(function*(g,r){var m,G;if(g){var K=g.sourceLayer;K=null!=(m=t.isSome(r)&&null!=(G=r.useSourceLayer)&&G?K:g.layer)?m:K;m=p(K);if(t.isSome(g.symbol)&&(!t.isSome(r)||!0!==r.ignoreGraphicSymbol))return g=
"web-style"===g.symbol.type?yield g.symbol.fetchSymbol(t.isSome(r)?r.abortOptions:null):g.symbol.clone(),L.applyColorToSymbol(g,null,m),g;var z=t.isSome(r)&&r.renderer||K&&"renderer"in K&&K.renderer;if(G=z&&"getSymbolAsync"in z?yield z.getSymbolAsync(g,r):null){G="web-style"===G.type?yield G.fetchSymbol(t.isSome(r)?r.abortOptions:null):G.clone();if(!("visualVariables"in z&&z.visualVariables&&z.visualVariables.length))return L.applyColorToSymbol(G,null,m),G;"arcadeRequiredForVisualVariables"in z&&
z.arcadeRequiredForVisualVariables&&(t.isNone(r)||t.isNone(r.arcade))&&(r={...t.unwrap(r)},r.arcade=yield C.loadArcade());K=yield new Promise(function(x,l){E(["../../renderers/visualVariables/support/visualVariableUtils"],x,l)});var O=[],q=[],D=[],S=[];for(var f of z.visualVariables)switch(f.type){case "color":O.push(f);break;case "opacity":q.push(f);break;case "rotation":S.push(f);break;case "size":f.target||D.push(f)}f=(f=!!O.length&&O[O.length-1])?K.getColor(f,g,r):null;q=(q=!!q.length&&q[q.length-
1])?K.getOpacity(q,g,r):null;null!=m&&(q=null!=q?q*m:m);L.applyColorToSymbol(G,f,q);D.length&&(m=K.getAllSizes(D,g,r),yield L.applySizesToSymbol(G,m));for(const x of S)L.applyRotationToSymbol(G,K.getRotationAngle(x,g,r),x.axis);return G}}});return A.apply(this,arguments)}function b(){b=u._asyncToGenerator(function*(g,r){var m;if(g){var G=p(g.layer||g.sourceLayer);if(t.isSome(g.symbol)&&(!t.isSome(r)||!0!==r.ignoreGraphicSymbol))return g="web-style"===g.symbol.type?yield g.symbol.fetchSymbol(t.isSome(r)?
r.abortOptions:null):g.symbol.clone(),L.getColorFromSymbol(g,G);var K=t.isSome(r)&&r.renderer||g.get("layer.renderer")||g.get("sourceLayer.renderer"),z=yield K.getSymbolAsync(g,r);if(z){z="web-style"===z.type?yield z.fetchSymbol(t.isSome(r)?r.abortOptions:null):z.clone();z=L.getColorFromSymbol(z,G);if(!("visualVariables"in K)||"visualVariables"in K&&!K.visualVariables||"visualVariables"in K&&(null==(m=K.visualVariables)||!m.length))return z;K.arcadeRequiredForVisualVariables&&(t.isNone(r)||t.isNone(r.arcade))&&
(r={...t.unwrap(r)},r.arcade=yield C.loadArcade());m=yield new Promise(function(D,S){E(["../../renderers/visualVariables/support/visualVariableUtils"],D,S)});var O=[],q=[];for(const D of K.visualVariables)switch(D.type){case "color":O.push(D);break;case "opacity":q.push(D)}K=(K=0<O.length?O[O.length-1]:null)?m.getColor(K,g,r):z;g=(z=0<q.length?q[q.length-1]:null)?m.getOpacity(z,g,r):null;null!=G&&(g=null!=g?g*G:G);return K?L.applyOpacityToColor(K,g):null}}});return b.apply(this,arguments)}let d=null;
J.getDisplayedColor=function(g,r){return b.apply(this,arguments)};J.getDisplayedSymbol=function(g,r){return A.apply(this,arguments)};J.renderColorRampPreviewHTML=function(g,r={}){var m="horizontal"===r.align;const {width:G=m?75:24,height:K=m?24:75,gradient:z=!0}=r;r=window.devicePixelRatio;var O=G*r,q=K*r;r=document.createElement("canvas");r.width=O;r.height=q;r.style.width=`${G}px`;r.style.height=`${K}px`;const D=r.getContext("2d");var S=m?O:0,f=m?0:q;if(z){const x=D.createLinearGradient(0,0,S,f);
m=g.length;const l=1===m?0:1/(m-1);g.forEach((N,H)=>x.addColorStop(H*l,N.toString()));D.fillStyle=x;D.fillRect(0,0,O,q)}else{O=m?O/g.length:O;q=m?q:q/g.length;f=S=0;for(const x of g)D.fillStyle=x.toString(),D.fillRect(S,f,O,q),S=m?S+O:0,f=m?0:f+q}g=document.createElement("div");g.style.width=`${G}px`;g.style.height=`${K}px`;g.appendChild(r);return g};J.renderDotDensityPreviewHTML=function(g,r,m){const {backgroundColor:G,outline:K,dotSize:z}=g;m=m&&m.swatchSize||22;const O=Math.round(m*m/z**2*.8),
q=window.devicePixelRatio;g=document.createElement("canvas");const D=m*q;g.width=D;g.height=D;g.style.width=`${g.width/q}px`;g.style.height=`${g.height/q}px`;const S=g.getContext("2d");G&&(S.fillStyle=G.toCss(!0),S.fillRect(0,0,D,D),S.fill());S.fillStyle=r.toCss(!0);if(d&&d.length/2===O)for(r=0;r<2*O;r+=2)S.fillRect(d[r],d[r+1],z*q,z*q),S.fill();else for(d=[],r=0;r<2*O;r+=2){const f=Math.floor(Math.random()*(D-0+1)),x=Math.floor(Math.random()*(D-0+1));d.push(f,x);S.fillRect(f,x,z*q,z*q);S.fill()}K&&
(K.color&&(S.strokeStyle=K.color.toCss(!0)),S.lineWidth=K.width,S.strokeRect(0,0,D,D));m=new Image(m,m);m.src=g.toDataURL();return m};J.renderPreviewHTML=T;Object.defineProperty(J,"__esModule",{value:!0})})},"esri/symbols/support/utils":function(){define("require exports ../../chunks/_rollupPluginBabelHelpers ../../Color ../../symbols ../../core/asyncUtils ../../core/has ../../core/maybe ../../core/screenUtils ../../chunks/vec3f64 ./gfxUtils ./Symbol3DMaterial".split(" "),function(E,J,u,y,t,C,L,T,
R,p,A,b){function d(h){h=h.symbolLayers;if(!h)return null;let n=null;h.forEach(M=>{if("object"!==M.type||null==M.resource.href)n="water"===M.type?T.unwrap(M.color):T.isSome(M.material)?T.unwrap(M.material.color):null});return n?new y(n):null}function g(h,n){if(null==n)return h;h=h.toRgba();h[3]*=n;return new y(h)}function r(h,n,M){if(h=h.symbolLayers){var V=c=>{c=T.isSome(c)?c:null;n=n||c||null!=M&&B;return g(n,M)};h.forEach(c=>{if("object"!==c.type||null==c.resource.href||n)if("water"===c.type)c.color=
V(c.color);else{var F=T.isSome(c.material)?c.material.color:null;F=V(F);T.isNone(c.material)?c.material=new b["default"]({color:F}):c.material.color=F;null!=M&&"outline"in c&&T.isSome(c.outline)&&T.isSome(c.outline.color)&&(c.outline.color=g(c.outline.color,M))}})}}function m(h,n){return G.apply(this,arguments)}function G(){G=u._asyncToGenerator(function*(h,n){(h=h.symbolLayers)&&(yield C.forEach(h,function(){var M=u._asyncToGenerator(function*(V){return K(V,n)});return function(V){return M.apply(this,
arguments)}}()))});return G.apply(this,arguments)}function K(h,n){return z.apply(this,arguments)}function z(){z=u._asyncToGenerator(function*(h,n){switch(h.type){case "extrude":h.size="number"===typeof n[2]?n[2]:0;break;case "icon":case "line":case "text":n=O(n);T.isSome(n)&&(h.size=n);break;case "path":{const M=S(n,p.ONES,[h.width,void 0,h.height]);h.width=l(n[0],h.width,1,M);h.height=l(n[2],h.height,1,M)}break;case "object":yield q(h,n)}});return z.apply(this,arguments)}function O(h){for(const n of h)if("number"===
typeof n)return n;return null}function q(h,n){return D.apply(this,arguments)}function D(){D=u._asyncToGenerator(function*(h,n){const {resourceSize:M,symbolSize:V}=yield f(h),c=S(n,M,V);h.width=l(n[0],V[0],M[0],c);h.depth=l(n[1],V[1],M[1],c);h.height=l(n[2],V[2],M[2],c)});return D.apply(this,arguments)}function S(h,n,M){for(let V=0;3>V;V++){const c=h[V];switch(c){case "symbol-value":return null!=M[V]?M[V]/n[V]:1;case "proportional":break;default:if(c&&n[V])return c/n[V]}}return 1}function f(h){return x.apply(this,
arguments)}function x(){x=u._asyncToGenerator(function*(h){const n=yield(yield new Promise(function(v,Q){E(["./symbolLayerUtils"],v,Q)})).computeObjectLayerResourceSize(h,10),{width:M,height:V,depth:c}=h;h=[M,c,V];let F=1;for(var e=0;3>e;e++)if(null!=h[e]){F=h[e]/n[e];break}for(e=0;3>e;e++)null==h[e]&&(h[e]=n[e]*F);return{resourceSize:n,symbolSize:h}});return x.apply(this,arguments)}function l(h,n,M,V){switch(h){case "proportional":return M*V;case "symbol-value":return null!=n?n:M;default:return h}}
function N(){N=u._asyncToGenerator(function*(h,n){if(h&&n){if(t.isSymbol3D(h))return m(h,n);if(t.isSymbol2D(h)&&(n=O(n),!T.isNone(n)))switch(h.type){case "simple-marker":h.size=n;break;case "picture-marker":{const M=h.width/h.height;1<M?(h.width=n,h.height=n*M):(h.width=n*M,h.height=n);break}case "simple-line":h.width=n;break;case "text":h.font.size=n}}});return N.apply(this,arguments)}const H=/\/resource\/(.*?)\.svg$/,B=new y("white");J.applyColorToSymbol=function(h,n,M){if(h&&(n||null!=M))if(n&&
(n=new y(n)),t.isSymbol3D(h))r(h,n,M);else if(t.isSymbol2D(h)){if(n=n||h.color)h.color=g(n,M);null!=M&&"outline"in h&&h.outline&&h.outline.color&&(h.outline.color=g(h.outline.color,M))}};J.applyOpacityToColor=g;J.applyRotationToSymbol=function(h,n,M){h&&null!=n&&(t.isSymbol3D(h)?(h=h.symbolLayers)&&h.forEach(V=>{if(V&&"object"===V.type)switch(M){case "tilt":V.tilt=n;break;case "roll":V.roll=n;break;default:V.heading=n}}):!t.isSymbol2D(h)||"simple-marker"!==h.type&&"picture-marker"!==h.type&&"text"!==
h.type||(h.angle=n))};J.applySizesToSymbol=function(h,n){return N.apply(this,arguments)};J.getColorFromSymbol=function(h,n){if(!h)return null;let M=null;t.isSymbol3D(h)?M=d(h):t.isSymbol2D(h)&&(M=h.color?new y(h.color):null);return M?g(M,n):null};J.getIconHref=function(h,n){n=n.resource.href;return!L("esri-canvas-svg-support")&&h.styleOrigin&&H.test(n)?n.replace(H,"/resource/png/$1.png"):n};J.getSymbolOutlineSize=function(h){if(!h)return 0;if(t.isSymbol3D(h)){{const n=h.symbolLayers&&h.symbolLayers.length;
n?(h=h.symbolLayers.getItemAt(n-1),h="outline"in h?T.get(h,"outline","size"):void 0):h=void 0}return T.isSome(h)?h:0}return(h=A.getStroke(h))&&R.px2pt(h.width)||0};J.isVolumetricSymbol=function(h){if(T.isNone(h)||!("symbolLayers"in h)||T.isNone(h.symbolLayers))return!1;switch(h.type){case "point-3d":return h.symbolLayers.some(n=>"object"===n.type);case "line-3d":return h.symbolLayers.some(n=>"path"===n.type);case "polygon-3d":return h.symbolLayers.some(n=>"object"===n.type||"extrude"===n.type);default:return!1}};
Object.defineProperty(J,"__esModule",{value:!0})})},"esri/symbols/support/gfxUtils":function(){define("exports ../../assets ../../Color ../../request ../../core/ItemCache ../../core/screenUtils ./cimSymbolUtils".split(" "),function(E,J,u,y,t,C,L){function T(d){if(!d)return null;let g;switch(d.type){case "simple-fill":case "picture-fill":case "simple-marker":g=T(d.outline);break;case "simple-line":{const r=C.pt2px(d.width);"none"!==d.style&&0!==r&&(g={color:d.color,style:b(d.style),width:r,cap:d.cap,
join:"miter"===d.join?C.pt2px(d.miterLimit):d.join});break}default:g=null}return g}const R={left:"start",center:"middle",right:"end",justify:"start"},p={top:"text-before-edge",middle:"central",baseline:"alphabetic",bottom:"text-after-edge"},A=new t(1E3),b=function(){const d={};return function(g){if(d[g])return d[g];const r=g.replace(/-/g,"");return d[g]=r}}();u=new u([128,128,128]);E.defaultThematicColor=u;E.dekebabifyLineStyle=b;E.getFill=function(d){const g=d.style;let r=null;if(d)switch(d.type){case "simple-marker":"cross"!==
g&&"x"!==g&&(r=d.color);break;case "simple-fill":"solid"===g?r=d.color:"none"!==g&&(r={type:"pattern",x:0,y:0,src:J.getAssetUrl(`esri/symbols/patterns/${g}.png`),width:5,height:5});break;case "picture-fill":r={type:"pattern",src:d.url,width:C.pt2px(d.width)*d.xscale,height:C.pt2px(d.height)*d.yscale,x:C.pt2px(d.xoffset),y:C.pt2px(d.yoffset)};break;case "text":r=d.color;break;case "cim":r=L.getCIMSymbolColor(d)}return r};E.getPatternUrlWithColor=function(d,g){const r=d+"-"+g;return void 0!==A.get(r)?
Promise.resolve(A.get(r)):y(d,{responseType:"image"}).then(m=>{m=m.data;const G=m.naturalWidth,K=m.naturalHeight,z=document.createElement("canvas");z.width=G;z.height=K;const O=z.getContext("2d");O.fillStyle=g;O.fillRect(0,0,G,K);O.globalCompositeOperation="destination-in";O.drawImage(m,0,0);m=z.toDataURL();A.put(r,m);return m})};E.getSVGAlign=function(d){return d=(d=d.horizontalAlignment)&&R[d.toLowerCase()]||"middle"};E.getSVGBaseline=function(d){return(d=d.verticalAlignment)&&p[d.toLowerCase()]||
"alphabetic"};E.getSVGBaselineShift=function(d){return"bottom"===d.verticalAlignment?"super":null};E.getStroke=T;Object.defineProperty(E,"__esModule",{value:!0})})},"esri/core/ItemCache":function(){define(["./MemCache"],function(E){return function(){function J(y,t){this._storage=new E.MemCacheStorage;this._storage.maxSize=y;t&&this._storage.registerRemoveFunc("",t)}var u=J.prototype;u.put=function(y,t){this._storage.put(y,t,1,1)};u.pop=function(y){return this._storage.pop(y)};u.get=function(y){return this._storage.get(y)};
u.clear=function(){this._storage.clearAll()};u.destroy=function(){this._storage.destroy()};return J}()})},"esri/widgets/Legend/support/clusterUtils":function(){define(["exports","../../../renderers/visualVariables/SizeVariable"],function(E,J){const u=(y,t)=>{y=y.featuresTilingScheme.getClosestInfoForScale(y.scale).level;return null!=t&&t.levels?t.levels[y]:null};E.getClusterSizeVariable=function(y,t){if(!(y&&"visualVariables"in y&&y.visualVariables))return null;y=y.visualVariables.find(C=>"size"===
C.type);return(t=u(t,y))?new J({field:y.field,minSize:t[2].size,minDataValue:t[2].value,maxSize:t[3].size,maxDataValue:t[3].value}):null};Object.defineProperty(E,"__esModule",{value:!0})})},"esri/widgets/Legend/support/colorRampUtils":function(){define(["require","exports","../../../chunks/_rollupPluginBabelHelpers","../../../Color","./utils"],function(E,J,u,y,t){function C(d,g){const r=[],m=d.length-1;5===d.length?r.push(0,2,4):r.push(0,m);return d.map((G,K)=>-1<r.indexOf(K)?t.createStopLabel(G,
K,m,g):null)}function L(){L=u._asyncToGenerator(function*(d,g,r){let m=!1,G=[],K=[];if(d.stops){var z=d.stops;G=z.map(q=>q.value);(m=z.some(q=>!!q.label))&&(K=z.map(q=>q.label))}z=G[G.length-1];if(null==G[0]&&null==z)return null;const O=m?null:C(G,r);return(yield Promise.all(G.map(function(){var q=u._asyncToGenerator(function*(D,S){const f="opacity"===d.type?yield T(D,d,g):(yield new Promise(function(x,l){E(["../../../renderers/visualVariables/support/visualVariableUtils"],x,l)})).getColor(d,D);return{value:D,
color:f,label:m?K[S]:O[S]}});return function(D,S){return q.apply(this,arguments)}}()))).reverse()});return L.apply(this,arguments)}function T(d,g){return R.apply(this,arguments)}function R(){R=u._asyncToGenerator(function*(d,g,r=b){r=new y(r);d=(yield new Promise(function(m,G){E(["../../../renderers/visualVariables/support/visualVariableUtils"],m,G)})).getOpacity(g,d);null!=d&&(r.a=d);return r});return R.apply(this,arguments)}function p(d,g){const {startIndex:r,endIndex:m,weight:G}=A(d,g);if(r===
m)return g[r].color;d=y.blendColors(g[r].color,g[m].color,G);return new y(d)}function A(d,g){let r=0,m=g.length-1;g.some((G,K)=>{if(d<G.value)return m=K,!0;r=K;return!1});return{startIndex:r,endIndex:m,weight:(d-g[r].value)/(g[m].value-g[r].value)}}const b=new y([64,64,64]);J.getColorFromPointCloudStops=p;J.getRampStops=function(d,g,r){return L.apply(this,arguments)};J.getRampStopsForPointCloud=function(d){let g=!1,r=[],m=[];r=d.map(z=>z.value);(g=d.some(z=>!!z.label))&&(m=d.map(z=>z.label));const G=
r[r.length-1];if(null==r[0]&&null==G)return null;const K=g?null:C(r,!1);return r.map((z,O)=>{const q=p(z,d);return{value:z,color:q,label:g?m[O]:K[O]}}).reverse()};J.getStrectchRampStops=function(d,g){let r=[];if(d&&"multipart"===d.type)d.colorRamps.reverse().forEach(function(m,G){0===G?r.push({value:g.max,color:new y(m.toColor),label:"high"}):r.push({value:null,color:new y(m.toColor),label:""});G===d.colorRamps.length-1?r.push({value:g.min,color:new y(m.fromColor),label:"low"}):r.push({value:null,
color:new y(m.fromColor),label:""})});else{let m,G;d&&"algorithmic"===d.type?(m=d.fromColor,G=d.toColor):(m=[0,0,0,1],G=[255,255,255,1]);r=[{value:g.max,color:new y(G),label:"high"},{value:g.min,color:new y(m),label:"low"}]}return r};Object.defineProperty(J,"__esModule",{value:!0})})},"esri/widgets/Legend/support/utils":function(){define(["exports","../../../intl/date","../../../renderers/support/numberUtils"],function(E,J,u){const y=J.convertDateFormatToIntlOptions("short-date");E.RGB_IMG_SOURCE=
["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII\x3d","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII\x3d","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII\x3d"];
E.createStopLabel=function(t,C,L,T){let R="";0===C?R="\x3c ":C===L&&(R="\x3e ");C=null;C=T?J.formatDate(t,y):u.format(t);return R+C};Object.defineProperty(E,"__esModule",{value:!0})})},"esri/renderers/support/numberUtils":function(){define(["exports","../../intl","../../intl/number"],function(E,J,u){function y(A,b){return A-b}function t(A,b){let d;d=Number(A.toFixed(b));d<A?A=d+1/10**b:(A=d,d-=1/10**b);d=Number(d.toFixed(b));A=Number(A.toFixed(b));return[d,A]}function C(A,b,d,g,r){A=T(A,b,d,g);b=
null==A.next||A.next<=r;return(null==A.previous||A.previous<=r)&&b||A.previous+A.next<=2*r}function L(A){A=String(A);var b=A.match(R);if(b&&b[1])return{integer:b[1].split("").length,fractional:b[3]?b[3].split("").length:0};if(-1<A.toLowerCase().indexOf("e")&&(b=A.split("e"),A=b[0],b=b[1],A&&b)){A=Number(A);b=Number(b);const d=0<b;d||(b=Math.abs(b));A=L(A);d?(A.integer+=b,A.fractional=b>A.fractional?0:A.fractional-b):(A.fractional+=b,A.integer=b>A.integer?1:A.integer-b);return A}return{integer:0,fractional:0}}
function T(A,b,d,g){const r={previous:null,next:null};if(null!=d){const m=A-d;r.previous=Math.floor(Math.abs(100*(b-d-m)/m))}null!=g&&(A=g-A,r.next=Math.floor(Math.abs(100*(g-b-A)/A)));return r}const R=/^-?(\d+)(\.(\d+))?$/i,p={maximumFractionDigits:20};E.format=function(A){return u.formatNumber(A,p)};E.numDigits=L;E.percentChange=T;E.round=function(A,b={}){A=A.slice(0);const {tolerance:d=2,strictBounds:g=!1,indexes:r=A.map((G,K)=>K)}=b;r.sort(y);for(b=0;b<r.length;b++){const G=r[b],K=A[G],z=0===
G?null:A[G-1],O=G===A.length-1?null:A[G+1],q=L(K).fractional;if(q){let D=0,S=!1;for(var m=void 0;D<=q&&!S;)m=t(K,D),m=g&&0===b?m[1]:m[0],S=C(K,m,z,O,d),D++;S&&(A[G]=m)}}return A};Object.defineProperty(E,"__esModule",{value:!0})})},"esri/widgets/Legend/support/heatmapRampUtils":function(){define(["exports","../../../renderers/support/HeatmapColorStop"],function(E,J){E.getHeatmapRampStops=function(u){u=u.colorStops;let y=u.length-1;if(u&&u[0]){const t=u[y];t&&1!==t.ratio&&(u=u.slice(0),u.push(new J({ratio:1,
color:t.color})),y++)}return u.map((t,C)=>{let L="";0===C?L="low":C===y&&(L="high");return{color:t.color,label:L,ratio:t.ratio}}).reverse()};Object.defineProperty(E,"__esModule",{value:!0})})},"esri/widgets/Legend/support/relationshipRampUtils":function(){define(["exports","../../../core/lang","../../../symbols/support/gfxUtils","../../../symbols/support/previewSymbol3D"],function(E,J,u,y){function t(p){if(p){var {type:A}=p;return-1<A.indexOf("3d")?y.getSymbolLayerFill(p.symbolLayers.getItemAt(0)):
"simple-line"===A||"simple-marker"===p.type&&("x"===p.style||"cross"===p.style)?(p=u.getStroke(p))&&p.color:u.getFill(p)}}function C(p,A){const b=A.HH.label,d=A.LL.label,g=A.HL.label;A=A.LH.label;switch(p){case "HH":return{top:b,bottom:d,left:g,right:A};case "HL":return{top:g,bottom:A,left:d,right:b};case "LL":return{top:d,bottom:b,left:A,right:g};case "LH":return{top:A,bottom:g,left:b,right:d};default:return{top:b,bottom:d,left:g,right:A}}}function L(p){let A=T[p];p&&null==A&&(A=T.HH);return A||
0}const T={HH:315,HL:45,LL:135,LH:225},R={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};E.getRelationshipRampColors2D=function(p,A){const b=[],d=p.length**.5;p=J.clone(p);var g=(A||"HH").split("");A=g[0];for(g="H"===g[1];p.length;){const r=[];for(;r.length<d;)r.push(p.shift());g&&r.reverse();b.push(r)}"L"===A&&b.reverse();return b};E.getRelationshipRampElement=
function(p){const {focus:A,infos:b,numClasses:d}=p;var g=R[d];const r={};b.forEach(m=>{r[m.value]={label:m.label,fill:t(m.symbol)}});p=[];for(let m=0;m<d;m++){const G=[];for(let K=0;K<d;K++)G.push(r[g[m][K]].fill);p.push(G)}g=C(A,r);return{type:"relationship-ramp",numClasses:d,focus:A,colors:p,labels:g,rotation:L(A)}};E.getRotationAngleForFocus=L;Object.defineProperty(E,"__esModule",{value:!0})})},"esri/symbols/support/previewSymbol3D":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../assets ../../core/colorUtils ../../core/has ../../core/Error ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/screenUtils ./gfxUtils ./IconSymbol3DLayerResource ./ObjectSymbol3DLayerResource ./previewUtils ./renderUtils ./styleUtils ./utils".split(" "),
function(E,J,u,y,t,C,L,T,R,p,A,b,d,g,r,m,G){function K(e){const v=e.outline;var Q=T.isSome(e.material)?e.material.color:null;Q=T.isSome(Q)?Q.toHex():null;if(T.isNone(v)||"none"===v.pattern)return"fill"===e.type&&"#ffffff"===Q?{color:"#bdc3c7",width:.75}:null;Q=p.pt2px(v.size)||0;return{color:"rgba("+(T.isSome(v.color)?v.color.toRgba():"255,255,255,1")+")",width:Math.min(Q,80),style:"pattern"in e?A.dekebabifyLineStyle(v.pattern):null,join:"butt",cap:v.patternCap}}function z(e,v){var Q=v&&v.resource;
Q=Q&&Q.href;if(e.thumbnail&&e.thumbnail.url)return Promise.resolve(e.thumbnail.url);if(Q&&"object"!==v.type)return Promise.resolve(G.getIconHref(e,v));const W=u.getAssetUrl("esri/images/Legend/legend3dsymboldefault.png");return e.styleOrigin&&(e.styleOrigin.styleName||e.styleOrigin.styleUrl)?m.resolveWebStyleSymbol(e.styleOrigin,{portal:e.styleOrigin.portal},"webRef").catch(Z=>Z).then(Z=>{var ka;return(null==Z?void 0:null==(ka=Z.thumbnail)?void 0:ka.url)||W}):Promise.resolve(W)}function O(e,v=1){const Q=
e.a;e=y.toHSV(e);const {r:W,g:Z,b:ka}=y.toRGB({h:e.h,s:e.s/v,v:100-(100-e.v)/v});return[W,Z,ka,Q]}function q(e){return"water"===e.type?T.isNone(e.color)?null:e.color:T.isNone(e.material)||T.isNone(e.material.color)?null:e.material.color}function D(e,v=0){var Q=q(e);if(!Q){if("fill"===e.type)return null;v=g.adjustColorComponentBrightness(A.defaultThematicColor.r,v);return[v,v,v,100]}e=Q.toRgba();for(Q=0;3>Q;Q++)e[Q]=g.adjustColorComponentBrightness(e[Q],v);return e}function S(e,v){return f.apply(this,
arguments)}function f(){f=J._asyncToGenerator(function*(e,v){e=e.style;return"none"===e?null:{type:"pattern",x:0,y:0,src:yield A.getPatternUrlWithColor(u.getAssetUrl(`esri/symbols/patterns/${e}.png`),v.toCss(!0)),width:5,height:5}});return f.apply(this,arguments)}function x(e){return e.outline?K(e):{color:"rgba(0, 0, 0, 1)",width:1.5}}function l(e,v){e=q(e);if(!e)return null;let Q;Q="rgba("+(g.adjustColorComponentBrightness(e.r,v)+",");Q+=g.adjustColorComponentBrightness(e.g,v)+",";Q+=g.adjustColorComponentBrightness(e.b,
v)+",";return Q+e.a+");"}function N(e,v){v=l(e,v);if(!v)return{};if("pattern"in e&&"none"===e.pattern)return null;const Q=Math.min(e.size?p.pt2px(e.size):.75,80);return{color:v,width:Q,style:"pattern"in e?A.dekebabifyLineStyle(e.pattern):null,cap:"cap"in e?e.cap:null,join:"join"in e?"miter"===e.join?p.pt2px(2):e.join:null}}function H(e,v,Q){Q*=.75;return{type:"linear",x1:Q?.25*Q:0,y1:Q?.5*Q:0,x2:Q||4,y2:Q?.5*Q:4,colors:[{color:e,offset:0},{color:v,offset:1}]}}function B(e){const v=e.depth,Q=e.height;
return(e=e.width)&&v&&Q&&e===v&&e<Q}function h(e,v,Q){const W=[];if(!e)return W;switch(e.type){case "icon":switch(e.resource&&e.resource.primitive||b.defaultPrimitive){case "circle":W.push({shape:{type:"circle",cx:0,cy:0,r:.5*v},fill:D(e,0),stroke:K(e)});break;case "square":W.push({shape:{type:"path",path:[{command:"M",values:[0,v]},{command:"L",values:[0,0]},{command:"L",values:[v,0]},{command:"L",values:[v,v]},{command:"Z",values:[]}]},fill:D(e,0),stroke:K(e)});break;case "triangle":W.push({shape:{type:"path",
path:[{command:"M",values:[0,v]},{command:"L",values:[.5*v,0]},{command:"L",values:[v,v]},{command:"Z",values:[]}]},fill:D(e,0),stroke:K(e)});break;case "cross":W.push({shape:{type:"path",path:[{command:"M",values:[.5*v,0]},{command:"L",values:[.5*v,v]},{command:"M",values:[0,.5*v]},{command:"L",values:[v,.5*v]}]},stroke:x(e)});break;case "x":W.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[v,v]},{command:"M",values:[v,0]},{command:"L",values:[0,v]}]},stroke:x(e)});
break;case "kite":W.push({shape:{type:"path",path:[{command:"M",values:[0,.5*v]},{command:"L",values:[.5*v,0]},{command:"L",values:[v,.5*v]},{command:"L",values:[.5*v,v]},{command:"Z",values:[]}]},fill:D(e,0),stroke:K(e)})}break;case "object":switch(e.resource&&e.resource.primitive||d.defaultPrimitive){case "cone":var Z=D(e,0);e=D(e,-.6);e=H(Z,e,Q?20:v);v=g.getConeShapes(v,Q);W.push({shape:v[0],fill:e});W.push({shape:v[1],fill:e});break;case "inverted-cone":Q=D(e,0);e=D(e,-.6);e=H(Q,e,v);v=g.getInvertedConeShapes(v);
W.push({shape:v[0],fill:e});W.push({shape:v[1],fill:Q});break;case "cube":v=g.getCubeShapes(v,Q);W.push({shape:v[0],fill:D(e,0)});W.push({shape:v[1],fill:D(e,-.3)});W.push({shape:v[2],fill:D(e,-.5)});break;case "cylinder":{Z=D(e,0);const ka=D(e,-.6);Z=H(Z,ka,Q?20:v);v=g.getCylinderShapes(v,Q);W.push({shape:v[0],fill:Z});W.push({shape:v[1],fill:Z});W.push({shape:v[2],fill:D(e,0)});break}case "diamond":v=g.getDiamondShapes(v);W.push({shape:v[0],fill:D(e,-.3)});W.push({shape:v[1],fill:D(e,0)});W.push({shape:v[2],
fill:D(e,-.3)});W.push({shape:v[3],fill:D(e,-.7)});break;case "sphere":Q=D(e,0);e=D(e,-.6);e=H(Q,e);e.x1=0;e.y1=0;e.x2=.25*v;e.y2=.25*v;W.push({shape:{type:"circle",cx:0,cy:0,r:.5*v},fill:e});break;case "tetrahedron":v=g.getTetrahedronShapes(v),W.push({shape:v[0],fill:D(e,-.3)}),W.push({shape:v[1],fill:D(e,0)}),W.push({shape:v[2],fill:D(e,-.6)})}}return W}function n(e,v){const Q=v&&v.size?p.pt2px(v.size):null,W=v&&v.maxSize?p.pt2px(v.maxSize):null,Z=v&&v.disableUpsampling,ka=e.symbolLayers,ia=[];
let oa=0,ja=0;const X=ka.getItemAt(ka.length-1);let ca;X&&"icon"===X.type&&(ca=X.size&&p.pt2px(X.size));ka.forEach(ha=>{if("icon"===ha.type||"object"===ha.type){var fa="icon"===ha.type?ha.size&&p.pt2px(ha.size):0,ea=Q||fa?Math.ceil(Math.min(Q||fa,W||120)):22;if(ha&&ha.resource&&ha.resource.href){var ra=z(e,ha).then(function(sa){const ya=ha.get("material.color");var xa="icon"===ha.type?"multiply":"tint";return r.tintImageWithColor(sa,ea,ya,xa,Z)}).then(function(sa){const ya=sa.width,xa=sa.height;oa=
Math.max(oa,ya);ja=Math.max(ja,xa);return[{shape:{type:"image",x:0,y:0,width:ya,height:xa,src:sa.url},fill:null,stroke:null}]});ia.push(ra)}else{let sa=ea;"icon"===ha.type&&ca&&Q&&(sa=fa/ca*ea);fa="tall"===(null==v?void 0:v.symbolConfig)||(null==v?void 0:null==(ra=v.symbolConfig)?void 0:ra.isTall)||("object"===ha.type?B(ha):!1);oa=Math.max(oa,fa?20:sa);ja=Math.max(ja,sa);ia.push(Promise.resolve(h(ha,sa,fa)))}}});return R.eachAlways(ia).then(function(ha){const fa=[];ha.forEach(function(ea){ea.value?
fa.push(ea.value):ea.error&&F.warn("error while building swatchInfo!",ea.error)});return r.renderSymbol(fa,[oa,ja],{node:v&&v.node,scale:!1,opacity:v&&v.opacity})})}function M(e,v){const Q=e.symbolLayers,W=[];e=G.isVolumetricSymbol(e);const Z=v&&v.size?p.pt2px(v.size):null,ka=(v&&v.maxSize?p.pt2px(v.maxSize):null)||80;let ia=0,oa=0,ja;Q.forEach((X,ca)=>{if(X&&("line"===X.type||"path"===X.type)){var ha=[];switch(X.type){case "line":var fa=N(X,0);if(T.isNone(fa))break;var ea=fa&&fa.width||0;0===ca&&
(ja=ea);X=Math.min(Z||ea,ka);ca=0===ca?X:Z?ea/ja*X:X;ea=20<ca?2*ca:40;oa=Math.max(oa,ca);ia=Math.max(ia,ea);fa.width=ca;ha.push({shape:{type:"path",path:[{command:"M",values:[0,.5*oa]},{command:"L",values:[ia,.5*oa]}]},stroke:fa});break;case "path":fa=Math.min(Z||22,ka);ca=D(X,0);ea=D(X,-.2);var ra=l(X,-.4);ra=ra?{color:ra,width:1}:{};if("quad"===X.profile){const sa=X.width;X=X.height;X=g.getPathSymbolShapes(sa&&X?sa/X:1,0===X,0===sa);ra={...ra,join:"bevel"};ha.push({shape:X[0],fill:ea,stroke:ra});
ha.push({shape:X[1],fill:ea,stroke:ra});ha.push({shape:X[2],fill:ca,stroke:ra})}else ha.push({shape:g.shapes.pathSymbol3DLayer[0],fill:ea,stroke:ra}),ha.push({shape:g.shapes.pathSymbol3DLayer[1],fill:ca,stroke:ra});ia=oa=Math.max(oa,fa)}W.push(ha)}});return Promise.resolve(r.renderSymbol(W,[ia,oa],{node:v&&v.node,scale:e,opacity:v&&v.opacity}))}function V(e,v){return c.apply(this,arguments)}function c(){c=J._asyncToGenerator(function*(e,v){const Q="mesh-3d"===e.type;e=e.symbolLayers;var W=v&&v.size?
p.pt2px(v.size):null;const Z=v&&v.maxSize?p.pt2px(v.maxSize):null;W=W||22;const ka=[];let ia=0,oa=0;var ja=!1;for(let ra=0;ra<e.length;ra++){var X=e.getItemAt(ra);const sa=[];if(!Q||"fill"===X.type){var ca=g.shapes.fill[0];switch(X.type){case "fill":var ha=K(X);ja=Math.min(W,Z||120);ia=Math.max(ia,ja);oa=Math.max(oa,ja);ja=!0;var fa=D(X,0),ea="pattern"in X&&X.pattern;X=q(X);!Q&&T.isSome(ea)&&"style"===ea.type&&"solid"!==ea.style&&X&&(fa=yield S(ea,X));sa.push({shape:ca,fill:fa,stroke:ha});break;case "line":X=
N(X,0);if(T.isNone(X))break;X={stroke:X,shape:ca};ia=Math.max(ia,22);oa=Math.max(oa,22);sa.push(X);break;case "extrude":ca={join:"round",width:1,...N(X,-.4)};ha=D(X,0);X=D(X,-.2);fa=Math.min(W,Z||120);ea=g.getExtrudeSymbolShapes(fa);ca.width=1;sa.push({shape:ea[0],fill:X,stroke:ca});sa.push({shape:ea[1],fill:X,stroke:ca});sa.push({shape:ea[2],fill:ha,stroke:ca});X=22*.7+.5*fa;ia=Math.max(ia,22);oa=Math.max(oa,X);break;case "water":ja=q(X),X=O(ja),ca=O(ja,2),ha=O(ja,3),fa=g.getWaterSymbolShapes(),
ja=!0,sa.push({shape:fa[0],fill:X}),sa.push({shape:fa[1],fill:ca}),sa.push({shape:fa[2],fill:ha}),X=Math.min(W,Z||120),ia=Math.max(ia,X),oa=Math.max(oa,X)}ka.push(sa)}}return Promise.resolve(r.renderSymbol(ka,[ia,oa],{node:v&&v.node,scale:ja,opacity:v&&v.opacity}))});return c.apply(this,arguments)}const F=L.getLogger("esri.symbols.support.previewSymbol3D");E.getPatternDescriptor=S;E.getSymbolLayerFill=D;E.previewSymbol3D=function(e,v){if(0===e.symbolLayers.length)return Promise.reject(new C("symbolPreview: renderPreviewHTML3D",
"No symbolLayers in the symbol."));switch(e.type){case "point-3d":return n(e,v);case "line-3d":return M(e,v);case "polygon-3d":case "mesh-3d":return V(e,v)}return Promise.reject(new C("symbolPreview: swatchInfo3D","symbol not supported."))};Object.defineProperty(E,"__esModule",{value:!0})})},"esri/core/colorUtils":function(){define(["exports"],function(E){function J(p,A){const b=[];let d,g;if(p[0].length!==A.length)throw"dimensions do not match";const r=p.length,m=p[0].length;let G=0;for(d=0;d<r;d++){for(g=
G=0;g<m;g++)G+=p[d][g]*A[g];b.push(G)}return b}function u(p){p=[p.r/255,p.g/255,p.b/255].map(A=>.04045>=A?A/12.92:((A+.055)/1.055)**2.4);p=J(T,p);return{x:100*p[0],y:100*p[1],z:100*p[2]}}function y(p){p=J(R,[p.x/100,p.y/100,p.z/100]).map(A=>Math.min(1,Math.max(.0031308>=A?12.92*A:1.055*A**(1/2.4)-.055,0)));return{r:Math.round(255*p[0]),g:Math.round(255*p[1]),b:Math.round(255*p[2])}}function t(p){p=[p.x/95.047,p.y/100,p.z/108.883].map(A=>A>(6/29)**3?A**(1/3):1/3*(29/6)**2*A+4/29);return{l:116*p[1]-
16,a:500*(p[0]-p[1]),b:200*(p[1]-p[2])}}function C(p){const A=p.l;p=[(A+16)/116+p.a/500,(A+16)/116,(A+16)/116-p.b/200].map(b=>b>6/29?b**3:3*(6/29)**2*(b-4/29));return{x:95.047*p[0],y:100*p[1],z:108.883*p[2]}}function L(p){if("r"in p&&"g"in p&&"b"in p)return p;if("l"in p&&"c"in p&&"h"in p){var A=p.c;var b=p.h;A={l:p.l,a:A*Math.cos(b),b:A*Math.sin(b)};return y(C(A))}if("l"in p&&"a"in p&&"b"in p)return y(C(p));if("x"in p&&"y"in p&&"z"in p)return y(p);if("h"in p&&"s"in p&&"v"in p){{b=(p.h+360)%360/60;
A=p.v/100*255;p=p.s/100*A;const d=p*(1-Math.abs(b%2-1));switch(Math.floor(b)){case 0:b={r:p,g:d,b:0};break;case 1:b={r:d,g:p,b:0};break;case 2:b={r:0,g:p,b:d};break;case 3:b={r:0,g:d,b:p};break;case 4:b={r:d,g:0,b:p};break;case 5:case 6:b={r:p,g:0,b:d};break;default:b={r:0,g:0,b:0}}b.r=Math.round(b.r+A-p);b.g=Math.round(b.g+A-p);b.b=Math.round(b.b+A-p);A=b}return A}return p}const T=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],R=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,
-.204,1.057]];E.darken=function(p,A){p=t(u(p));p.l*=1-A;return y(C(p))};E.toHSV=function(p){if("h"in p&&"s"in p&&"v"in p)return p;var A=L(p);{p=A.r;const b=A.g,d=A.b;A=Math.max(p,b,d);const g=A-Math.min(p,b,d);p=0===g?0:A===p?(b-d)/g%6:A===b?(d-p)/g+2:(p-b)/g+4;0>p&&(p+=6);p={h:60*p,s:100*(0===g?0:g/A),v:100/255*A}}return p};E.toLAB=function(p){return"l"in p&&"a"in p&&"b"in p?p:t(u(L(p)))};E.toLCH=function(p){if(!("l"in p&&"c"in p&&"h"in p)){{var A=t(u(L(p)));p=A.l;var b=A.a;const d=A.b;A=Math.sqrt(b*
b+d*d);b=Math.atan2(d,b);b=0<b?b:b+2*Math.PI;p={l:p,c:A,h:b}}}return p};E.toRGB=L;E.toXYZ=function(p){return"x"in p&&"y"in p&&"z"in p?p:u(L(p))};Object.defineProperty(E,"__esModule",{value:!0})})},"esri/symbols/support/previewUtils":function(){define(["exports","../../Color"],function(E,J){function u(y,t){return Math.round(Math.min(Math.max(y+191.25*t,0),255))}E.adjustColorBrightness=function(y,t){if("type"in y&&("linear"===y.type||"pattern"===y.type))return y;y=new J(y);return new J([u(y.r,t),u(y.g,
t),u(y.b,t),y.a])};E.adjustColorComponentBrightness=u;E.getConeShapes=function(y,t){let C=t?20:y;t=t?4:6;C=22>=C?C-.5*t:C-t;t=.15*C;const L=C;y-=t;return[{type:"ellipse",cx:.5*C,cy:y,rx:.5*C,ry:t},{type:"path",path:[{command:"M",values:[.5*L,0]},{command:"L",values:[L,y]},{command:"L",values:[0,y]},{command:"Z",values:[]}]}]};E.getCubeShapes=function(y,t){let C=t?20:y;var L=t?4:6;L=C=22>=C?C-.5*L:C-L;t=t?.35*C:.5*C;return[{type:"path",path:[{command:"M",values:[.5*L,0]},{command:"L",values:[L,.5*
t]},{command:"L",values:[.5*L,t]},{command:"L",values:[0,.5*t]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*t]},{command:"L",values:[.5*L,t]},{command:"L",values:[.5*L,y]},{command:"L",values:[0,y-.5*t]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*L,t]},{command:"L",values:[.5*L,y]},{command:"L",values:[L,y-.5*t]},{command:"L",values:[L,.5*t]},{command:"Z",values:[]}]}]};E.getCylinderShapes=function(y,t){var C=t?20:y;t=t?4:6;C=22>=C?C-.5*t:C-t;t=
.5*C;const L=.15*C;y-=L;return[{type:"ellipse",cx:.5*C,cy:y,rx:t,ry:L},{type:"path",path:[{command:"M",values:[0,L]},{command:"L",values:[0,y]},{command:"L",values:[C,y]},{command:"L",values:[C,L]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*C,cy:L,rx:t,ry:L}]};E.getDiamondShapes=function(y){var t=y;t=22>t?t-2:t-4;const C=Math.floor(y/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*t,0]},{command:"L",values:[t,.5*y-C]},{command:"L",values:[.45*t-C,.5*y+C]},{command:"Z",values:[]}]},
{type:"path",path:[{command:"M",values:[.45*t,0]},{command:"L",values:[.45*t-C,.5*y+C]},{command:"L",values:[0,.5*y-C]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*y-C]},{command:"L",values:[.45*t-C,.5*y+C]},{command:"L",values:[.45*t,y]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*t,y]},{command:"L",values:[t,.5*y-C]},{command:"L",values:[.45*t-C,.5*y+C]},{command:"Z",values:[]}]}]};E.getExtrudeSymbolShapes=function(y){y*=.5;return[{type:"path",
path:[{command:"M",values:[0,.7*11]},{command:"L",values:[6.6,22*.7]},{command:"L",values:[6.6,22*.7+y]},{command:"L",values:[0,22*.7+y-.7*11]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[6.6,22*.7]},{command:"L",values:[6.6,22*.7+y]},{command:"L",values:[22,y]},{command:"L",values:[22,0]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[6.6,0]},{command:"L",values:[22,0]},{command:"L",values:[6.6,22*.7]},{command:"L",values:[0,.7*11]},{command:"Z",values:[]}]}]};
E.getInvertedConeShapes=function(y){let t=y;t=22>t?t-3:t-6;const C=.15*t,L=t;return[{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[L,0]},{command:"L",values:[.5*L,y-C]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*t,cy:0,rx:.5*t,ry:C}]};E.getPathSymbolShapes=function(y,t,C){let L=22,T=22;1>y?L*=.75:1<y&&(T*=1.25);let R=y=22;t&&C&&(L=T=y=R=0);return[{type:"path",path:[{command:"M",values:[y,0]},{command:"L",values:[C?y:.875*y,0]},{command:"L",values:[C?L-.5*y:0,T-.5*R]},{command:"L",
values:[L-.5*y,T-.5*R]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[y,0]},{command:"L",values:[y,t?0:.125*R]},{command:"L",values:[L-.5*y,t?T-.5*R:R]},{command:"L",values:[L-.5*y,T-.5*R]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[L-.5*y,T-.5*R]},{command:"L",values:[C?L-.5*y:0,T-.5*R]},{command:"L",values:[C?L-.5*y:0,t?T-.5*R:R]},{command:"L",values:[L-.5*y,t?T-.5*R:R]},{command:"Z",values:[]}]}]};E.getTetrahedronShapes=function(y){var t=y;t=22>t?t-1:
t-2;return[{type:"path",path:[{command:"M",values:[.45*y,0]},{command:"L",values:[y,t]},{command:"L",values:[.45*y,.6*t]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*y,0]},{command:"L",values:[.45*y,.6*t]},{command:"L",values:[0,t]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,t]},{command:"L",values:[.45*y,.6*t]},{command:"L",values:[y,t]},{command:"Z",values:[]}]}]};E.getWaterSymbolShapes=function(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},
{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},
{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]};
E.shapes={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],squareFill:[{type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],
cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],
tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",
path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};Object.defineProperty(E,"__esModule",{value:!0})})},"esri/symbols/support/renderUtils":function(){define("exports ../../kernel ../../request ../../core/colorUtils ../../core/Error ../../core/has ../../libs/maquette/projection ../../libs/maquette/projector ./svgUtils".split(" "),
function(E,J,u,y,t,C,L,T,R){function p(b,d,g){return b?u(b,{responseType:"image"}).then(r=>{r=r.data;const m=r.width,G=r.height,K=m/G;let z=d;g&&(z=Math.min(z,Math.max(m,G)));return{image:r,width:1>=K?Math.ceil(z*K):z,height:1>=K?z:Math.ceil(z/K)}}):Promise.reject(new t("renderUtils: imageDataSize","href not provided."))}const A=T.createProjector();E.renderSymbol=function(b,d,g){const r=Math.ceil(d[0]);d=Math.ceil(d[1]);if(!b.some(G=>!!G.length))return null;const m=g&&g.node||document.createElement("div");
null!=g.opacity&&(m.style.opacity=g.opacity.toString());A.append(m,R.renderSVG.bind(null,b,r,d,g));return m};E.tintImageWithColor=function(b,d,g,r,m){return p(b,d,m).then(G=>{const K=G.width?G.width:d,z=G.height?G.height:d;var O;if(O=G.image)O=g&&"ignore"!==r?"multiply"===r&&255===g.r&&255===g.g&&255===g.b&&1===g.a?!1:!0:!1;if(O){var q=G.image.width,D=G.image.height;C("edge")&&/\.svg$/i.test(b)&&(--q,--D);O=Math.ceil(K);var S=Math.ceil(z);var f=document.createElement("canvas");f.width=O;f.height=
S;f.style.width=O+"px";f.style.height=S+"px";f=f.getContext("2d");f.clearRect(0,0,O,S);O=f;O.drawImage(G.image,0,0,q,D,0,0,K,z);S=O.getImageData(0,0,K,z);f=[g.r/255,g.g/255,g.b/255,g.a];const l=y.toHSV(g);for(let N=0;N<S.data.length;N+=4){G=S.data;q=N;D=f;var x=l;switch(r){case "multiply":G[q+0]*=D[0];G[q+1]*=D[1];G[q+2]*=D[2];G[q+3]*=D[3];break;default:{const H=y.toHSV({r:G[q+0],g:G[q+1],b:G[q+2]});H.h=x.h;H.s=x.s;H.v=H.v/100*x.v;x=y.toRGB(H);G[q+0]=x.r;G[q+1]=x.g;G[q+2]=x.b;G[q+3]*=D[3]}}}O.putImageData(S,
0,0);b=O.canvas.toDataURL("image/png")}else(O=J.id&&J.id.findCredential(b))&&O.token&&(G=-1===b.indexOf("?")?"?":"\x26",b=`${b}${G}token=${O.token}`);return{url:b,width:K,height:z}}).catch(function(){return{url:b,width:d,height:d}})};Object.defineProperty(E,"__esModule",{value:!0})})},"esri/symbols/support/svgUtils":function(){define("exports ../../Color ../../core/has ../../chunks/mat2df32 ../../chunks/mat2d ../../widgets/support/widgetUtils ../../core/Logger ../../widgets/support/jsxFactory".split(" "),
function(E,J,u,y,t,C,L,T){function R(c,F){c*=V/180;return Math.abs(F*Math.sin(c))+Math.abs(F*Math.cos(c))}function p(c){return c.map(F=>`${F.command} ${F.values.join(" ")}`).join(" ").trim()}function A(c,F,e,v){if(c){if("circle"===c.type)return T.tsx("circle",{fill:F,"fill-rule":"evenodd",stroke:e.color,"stroke-width":e.width,"stroke-linecap":e.cap,"stroke-linejoin":e.join,"stroke-dasharray":e.dashArray,"stroke-miterlimit":"4",cx:c.cx,cy:c.cy,r:c.r});if("ellipse"===c.type)return T.tsx("ellipse",{fill:F,
"fill-rule":"evenodd",stroke:e.color,"stroke-width":e.width,"stroke-linecap":e.cap,"stroke-linejoin":e.join,"stroke-dasharray":e.dashArray,"stroke-miterlimit":"4",cx:c.cx,cy:c.cy,rx:c.rx,ry:c.ry});if("rect"===c.type)return T.tsx("rect",{fill:F,"fill-rule":"evenodd",stroke:e.color,"stroke-width":e.width,"stroke-linecap":e.cap,"stroke-linejoin":e.join,"stroke-dasharray":e.dashArray,"stroke-miterlimit":"4",x:c.x,y:c.y,width:c.width,height:c.height});if("image"===c.type)return T.tsx("image",{href:c.src,
x:c.x,y:c.y,width:c.width,height:c.height,preserveAspectRatio:"none"});if("path"===c.type)return c="string"!==typeof c.path?p(c.path):c.path,T.tsx("path",{fill:F,"fill-rule":"evenodd",stroke:e.color,"stroke-width":e.width,"stroke-linecap":e.cap,"stroke-linejoin":e.join,"stroke-dasharray":e.dashArray,"stroke-miterlimit":"4",d:c});if("text"===c.type)return T.tsx("text",{fill:F,"fill-rule":"evenodd",stroke:e.color,"stroke-width":e.width,"stroke-linecap":e.cap,"stroke-linejoin":e.join,"stroke-dasharray":e.dashArray,
"stroke-miterlimit":"4","text-anchor":v.align,"text-decoration":v.decoration,kerning:v.kerning,rotate:v.rotate,"text-rendering":N,"font-style":v.font.style,"font-variant":v.font.variant,"font-weight":v.font.weight,"font-size":v.font.size,"font-family":v.font.family,x:c.x,y:c.y},c.text)}return null}function b(c){const F={fill:"none",pattern:null,linearGradient:null};if(c)if("type"in c&&"pattern"===c.type){var e=`patternId-${++x}`;F.fill=`url(#${e})`;F.pattern={id:e,x:c.x,y:c.y,width:c.width,height:c.height,
image:{x:0,y:0,width:c.width,height:c.height,href:c.src}}}else"type"in c&&"linear"===c.type?(e=`linearGradientId-${++l}`,F.fill=`url(#${e})`,F.linearGradient={id:e,x1:c.x1,y1:c.y1,x2:c.x2,y2:c.y2,stops:c.colors.map(v=>({offset:v.offset,color:v.color&&(new J(v.color)).toString()}))}):c&&(c=new J(c),F.fill=c.toString());return F}function d(c){const F={color:"none",width:1,cap:"butt",join:"4",dashArray:"none"};if(c&&(null!=c.width&&(F.width=c.width),c.cap&&(F.cap=c.cap),c.join&&(F.join=c.join.toString()),
c.color&&(F.color=(new J(c.color)).toString()),c.style)){let v=null;c.style in M&&(v=M[c.style]);if(Array.isArray(v)){v=v.slice(0);for(var e=0;e<v.length;++e)v[e]*=c.width;if("butt"!==c.cap){for(e=0;e<v.length;e+=2)v[e]-=c.width,1>v[e]&&(v[e]=1);for(e=1;e<v.length;e+=2)v[e]+=c.width}v=v.join(",")}F.dashArray=v}return F}function g(c,F){const e={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};c&&(e.align=c.align,e.decoration=c.decoration,
e.kerning=c.kerning?"auto":"0",e.rotate=c.rotated?"90":"0",e.font.style=F.style||"normal",e.font.variant=F.variant||"normal",e.font.weight=F.weight||"normal",e.font.size=F.size&&F.size.toString()||"10pt",e.font.family=F.family||"serif");return e}function r(c){const {pattern:F,linearGradient:e}=c;return F?T.tsx("pattern",{id:F.id,patternUnits:"userSpaceOnUse",x:F.x,y:F.y,width:F.width,height:F.height},T.tsx("image",{x:F.image.x,y:F.image.y,width:F.image.width,height:F.image.height,href:F.image.href})):
e?(c=e.stops.map((v,Q)=>T.tsx("stop",{key:`${Q}-stop`,offset:v.offset,"stop-color":v.color})),T.tsx("linearGradient",{id:e.id,gradientUnits:"userSpaceOnUse",x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2},c)):null}function m(c,F,e){return t.translate(c,t.identity(c),[F,e])}function G(c,F,e,v,Q){t.scale(c,t.identity(c),[F,e]);c[4]=c[4]*F-v*F+v;c[5]=c[5]*e-Q*e+Q;return c}function K(c,F,e,v){var Q=F%360*Math.PI/180;t.rotate(c,t.identity(c),Q);F=Math.cos(Q);Q=Math.sin(Q);const W=c[4],Z=c[5];c[4]=W*F-Z*Q+v*Q-e*F+e;c[5]=
Z*F+W*Q-e*Q-v*F+v;return c}function z(c,F){h&&"left"in h?(h.left>c&&(h.left=c),h.right<c&&(h.right=c),h.top>F&&(h.top=F),h.bottom<F&&(h.bottom=F)):h={left:c,bottom:F,right:c,top:F}}function O(c){const F=c.args,e=F.length;switch(c.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(c=0;c<e;c+=2)z(F[c],F[c+1]);n.x=F[e-2];n.y=F[e-1];break;case "H":for(c=0;c<e;++c)z(F[c],n.y);n.x=F[e-1];break;case "V":for(c=0;c<e;++c)z(n.x,F[c]);n.y=F[e-1];break;case "m":c=0;"x"in n||(z(n.x=F[0],n.y=F[1]),
c=2);for(;c<e;c+=2)z(n.x+=F[c],n.y+=F[c+1]);break;case "l":case "t":for(c=0;c<e;c+=2)z(n.x+=F[c],n.y+=F[c+1]);break;case "h":for(c=0;c<e;++c)z(n.x+=F[c],n.y);break;case "v":for(c=0;c<e;++c)z(n.x,n.y+=F[c]);break;case "c":for(c=0;c<e;c+=6)z(n.x+F[c],n.y+F[c+1]),z(n.x+F[c+2],n.y+F[c+3]),z(n.x+=F[c+4],n.y+=F[c+5]);break;case "s":case "q":for(c=0;c<e;c+=4)z(n.x+F[c],n.y+F[c+1]),z(n.x+=F[c+2],n.y+=F[c+3]);break;case "A":for(c=0;c<e;c+=7)z(F[c+5],F[c+6]);n.x=F[e-2];n.y=F[e-1];break;case "a":for(c=0;c<e;c+=
7)z(n.x+=F[c+5],n.y+=F[c+6])}}function q(c,F,e){const v=H[c.toLowerCase()];"number"===typeof v&&(v?F.length>=v&&(c={action:c,args:F.slice(0,F.length-F.length%v)},e.push(c),O(c)):(c={action:c,args:[]},e.push(c),O(c)))}function D(c){const F={x:0,y:0,width:0,height:0};if("circle"===c.type)F.x=c.cx-c.r,F.y=c.cy-c.r,F.width=2*c.r,F.height=2*c.r;else if("ellipse"===c.type)F.x=c.cx-c.rx,F.y=c.cy-c.ry,F.width=2*c.rx,F.height=2*c.ry;else if("image"===c.type||"rect"===c.type)F.x=c.x,F.y=c.y,F.width=c.width,
F.height=c.height;else if("path"===c.type){{const Q=("string"!==typeof c.path?p(c.path):c.path).match(B),W=[];h={};n={};if(Q){c="";var e=[],v=Q.length;for(let Z=0;Z<v;++Z){const ka=Q[Z],ia=parseFloat(ka);isNaN(ia)?(c&&q(c,e,W),e=[],c=ka):e.push(ia)}q(c,e,W);c={x:0,y:0,width:0,height:0};h&&"left"in h&&(c.x=h.left,c.y=h.top,c.width=h.right-h.left,c.height=h.bottom-h.top)}else c=null}F.x=c.x;F.y=c.y;F.width=c.width;F.height=c.height}return F}function S(c){const F={x:0,y:0,width:0,height:0};let e=null,
v=Number.NEGATIVE_INFINITY,Q=Number.NEGATIVE_INFINITY;for(const W of c)e?(e.x=Math.min(e.x,W.x),e.y=Math.min(e.y,W.y),v=Math.max(v,W.x+W.width),Q=Math.max(Q,W.y+W.height)):(e=F,e.x=W.x,e.y=W.y,v=W.x+W.width,Q=W.y+W.height);e&&(e.width=v-e.x,e.height=Q-e.y);return e}function f(c,F,e,v,Q,W,Z,ka){var ia=(Z&&W?R(W,F):F)/2;const oa=(Z&&W?R(W,e):e)/2,ja=c.width+v,X=c.height+v;Z=y.create();const ca=y.create();var ha=!1;if(Q&&0!==ja&&0!==X){Q=ja/X;ha=F>e?F:e;let fa=1,ea=1;isNaN(ha)||(1<Q?(fa=ha/ja,ea=ha/
Q/X):(ea=ha/X,fa=ha*Q/ja));t.multiply(ca,ca,G(Z,fa,ea,ia,oa));ha=!0}Q=c.x+(ja-v)/2;c=c.y+(X-v)/2;t.multiply(ca,ca,m(Z,ia-Q,oa-c));!ha&&(ja>F||X>e)&&(ia=ja/F>X/e,F=(ia?F:e)/(ia?ja:X),t.multiply(ca,ca,G(Z,F,F,Q,c)));W&&t.multiply(ca,ca,K(Z,W,Q,c));ka&&t.multiply(ca,ca,m(Z,ka[0],ka[1]));return`matrix(${ca[0]},${ca[1]},${ca[2]},${ca[3]},${ca[4]},${ca[5]})`}let x=0,l=0;C=u("android");const N=u("chrome")||C&&4<=C?"auto":"optimizeLegibility",H={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},B=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;
let h={},n={};const M={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]},V=Math.PI;E.computeBBox=S;E.generateFillAttributes=b;E.generateStrokeAttributes=d;E.generateTextAttributes=g;E.getBoundingBox=D;E.getTransformMatrix=f;E.renderDef=r;E.renderSVG=function(c,F,e,v){const Q=[],W=[];for(const ka of c){c=[];var Z=[];let ia=0,oa=0,ja=0;for(const X of ka){const {shape:ca,
fill:ha,stroke:fa,font:ea,offset:ra}=X;ia+=fa&&fa.width||0;const sa=b(ha),ya=d(fa),xa="text"===ca.type?g(ca,ea):null;Q.push(r(sa));c.push(A(ca,sa.fill,ya,xa));Z.push(D(ca));ra&&(oa+=ra[0],ja+=ra[1])}Z=f(S(Z),F,e,ia,null==v?void 0:v.scale,null==v?void 0:v.rotation,null==v?void 0:v.useRotationSize,[oa,ja]);W.push(T.tsx("g",{transform:Z},c))}null!=v&&v.useRotationSize&&null!=v&&v.rotation&&(F=R(null==v?void 0:v.rotation,F),e=R(null==v?void 0:v.rotation,e));return T.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",
width:F,height:e},T.tsx("defs",null,Q),W)};E.renderShape=A;Object.defineProperty(E,"__esModule",{value:!0})})},"esri/chunks/mat2df32":function(){define(["exports"],function(E){function J(){const R=new Float32Array(6);R[0]=1;R[3]=1;return R}function u(R){const p=new Float32Array(6);p[0]=R[0];p[1]=R[1];p[2]=R[2];p[3]=R[3];p[4]=R[4];p[5]=R[5];return p}function y(R,p,A,b,d,g){const r=new Float32Array(6);r[0]=R;r[1]=p;r[2]=A;r[3]=b;r[4]=d;r[5]=g;return r}function t(R,p){return new Float32Array(R,p,6)}
function C(R,p,A,b){const d=p[b];p=p[b+1];R[b]=A[0]*d+A[2]*p+A[4];R[b+1]=A[1]*d+A[3]*p+A[5]}function L(R,p,A,b=0,d=0,g=2){for(d=d||p.length/g;b<d;b++)C(R,p,A,b*g)}var T=Object.freeze({__proto__:null,create:J,clone:u,fromValues:y,createView:t,transform:C,transformMany:L});E.clone=u;E.create=J;E.createView=t;E.fromValues=y;E.mat2df32=T;E.transform=C;E.transformMany=L})},"esri/chunks/mat2d":function(){define(["exports","./common"],function(E,J){function u(f,x){f[0]=x[0];f[1]=x[1];f[2]=x[2];f[3]=x[3];
f[4]=x[4];f[5]=x[5];return f}function y(f){f[0]=1;f[1]=0;f[2]=0;f[3]=1;f[4]=0;f[5]=0;return f}function t(f,x,l,N,H,B,h){f[0]=x;f[1]=l;f[2]=N;f[3]=H;f[4]=B;f[5]=h;return f}function C(f,x){const l=x[0],N=x[1],H=x[2],B=x[3],h=x[4];x=x[5];let n=l*B-N*H;if(!n)return null;n=1/n;f[0]=B*n;f[1]=-N*n;f[2]=-H*n;f[3]=l*n;f[4]=(H*x-B*h)*n;f[5]=(N*h-l*x)*n;return f}function L(f){return f[0]*f[3]-f[1]*f[2]}function T(f,x,l){const N=x[0],H=x[1],B=x[2],h=x[3],n=x[4];x=x[5];const M=l[0],V=l[1],c=l[2],F=l[3],e=l[4];
l=l[5];f[0]=N*M+B*V;f[1]=H*M+h*V;f[2]=N*c+B*F;f[3]=H*c+h*F;f[4]=N*e+B*l+n;f[5]=H*e+h*l+x;return f}function R(f,x,l){const N=x[0],H=x[1],B=x[2],h=x[3],n=x[4];x=x[5];const M=Math.sin(l);l=Math.cos(l);f[0]=N*l+B*M;f[1]=H*l+h*M;f[2]=N*-M+B*l;f[3]=H*-M+h*l;f[4]=n;f[5]=x;return f}function p(f,x,l){const N=x[1],H=x[2],B=x[3],h=x[4],n=x[5],M=l[0];l=l[1];f[0]=x[0]*M;f[1]=N*M;f[2]=H*l;f[3]=B*l;f[4]=h;f[5]=n;return f}function A(f,x,l){const N=x[0],H=x[1],B=x[2],h=x[3],n=x[4];x=x[5];const M=l[0];l=l[1];f[0]=
N;f[1]=H;f[2]=B;f[3]=h;f[4]=N*M+B*l+n;f[5]=H*M+h*l+x;return f}function b(f,x){const l=Math.sin(x);x=Math.cos(x);f[0]=x;f[1]=l;f[2]=-l;f[3]=x;f[4]=0;f[5]=0;return f}function d(f,x){f[0]=x[0];f[1]=0;f[2]=0;f[3]=x[1];f[4]=0;f[5]=0;return f}function g(f,x){f[0]=1;f[1]=0;f[2]=0;f[3]=1;f[4]=x[0];f[5]=x[1];return f}function r(f){return"mat2d("+f[0]+", "+f[1]+", "+f[2]+", "+f[3]+", "+f[4]+", "+f[5]+")"}function m(f){return Math.sqrt(f[0]**2+f[1]**2+f[2]**2+f[3]**2+f[4]**2+f[5]**2+1)}function G(f,x,l){f[0]=
x[0]+l[0];f[1]=x[1]+l[1];f[2]=x[2]+l[2];f[3]=x[3]+l[3];f[4]=x[4]+l[4];f[5]=x[5]+l[5];return f}function K(f,x,l){f[0]=x[0]-l[0];f[1]=x[1]-l[1];f[2]=x[2]-l[2];f[3]=x[3]-l[3];f[4]=x[4]-l[4];f[5]=x[5]-l[5];return f}function z(f,x,l){f[0]=x[0]*l;f[1]=x[1]*l;f[2]=x[2]*l;f[3]=x[3]*l;f[4]=x[4]*l;f[5]=x[5]*l;return f}function O(f,x,l,N){f[0]=x[0]+l[0]*N;f[1]=x[1]+l[1]*N;f[2]=x[2]+l[2]*N;f[3]=x[3]+l[3]*N;f[4]=x[4]+l[4]*N;f[5]=x[5]+l[5]*N;return f}function q(f,x){return f[0]===x[0]&&f[1]===x[1]&&f[2]===x[2]&&
f[3]===x[3]&&f[4]===x[4]&&f[5]===x[5]}function D(f,x){const l=f[0],N=f[1],H=f[2],B=f[3],h=f[4];f=f[5];const n=x[0],M=x[1],V=x[2],c=x[3],F=x[4];x=x[5];return Math.abs(l-n)<=J.EPSILON*Math.max(1,Math.abs(l),Math.abs(n))&&Math.abs(N-M)<=J.EPSILON*Math.max(1,Math.abs(N),Math.abs(M))&&Math.abs(H-V)<=J.EPSILON*Math.max(1,Math.abs(H),Math.abs(V))&&Math.abs(B-c)<=J.EPSILON*Math.max(1,Math.abs(B),Math.abs(c))&&Math.abs(h-F)<=J.EPSILON*Math.max(1,Math.abs(h),Math.abs(F))&&Math.abs(f-x)<=J.EPSILON*Math.max(1,
Math.abs(f),Math.abs(x))}var S=Object.freeze({__proto__:null,copy:u,identity:y,set:t,invert:C,determinant:L,multiply:T,rotate:R,scale:p,translate:A,fromRotation:b,fromScaling:d,fromTranslation:g,str:r,frob:m,add:G,subtract:K,multiplyScalar:z,multiplyScalarAndAdd:O,exactEquals:q,equals:D,mul:T,sub:K});E.add=G;E.copy=u;E.determinant=L;E.equals=D;E.exactEquals=q;E.frob=m;E.fromRotation=b;E.fromScaling=d;E.fromTranslation=g;E.identity=y;E.invert=C;E.mat2d=S;E.mul=T;E.multiply=T;E.multiplyScalar=z;E.multiplyScalarAndAdd=
O;E.rotate=R;E.scale=p;E.set=t;E.str=r;E.sub=K;E.subtract=K;E.translate=A})},"esri/widgets/Legend/support/sizeRampUtils":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../Color ../../../symbols ../../../renderers/support/numberUtils ../../../symbols/support/cimSymbolUtils ../../../symbols/support/utils ./utils".split(" "),function(E,J,u,y,t,C,L,T,R){function p(B,h){const n=B.length-1;return B.map((M,V)=>R.createStopLabel(M,V,n,h))}function A(){A=u._asyncToGenerator(function*(B,
h,n,M,V,c){var F,e,v=h.legendOptions;v=v&&v.customValues;const Q=g(B,n);var W=null!=h.minSize&&null!=h.maxSize;n=h.stops&&1<h.stops.length;var Z=!!h.target;if(Q&&(v||W||n&&!Z)){var ka=T.isVolumetricSymbol(Q),ia=null,oa=W=null;W=ka&&!n?C.round([h.minDataValue,h.maxDataValue]):v||(yield K(h,Q,M,V));v=null==B?void 0:B.authoringInfo;var ja=(Z="univariate-color-size"===(null==v?void 0:v.type))&&"above-and-below"===(null==v?void 0:v.univariateTheme);!W&&n&&(W=h.stops.map(fa=>fa.value),(ia=h.stops.some(fa=>
!!fa.label))&&(oa=h.stops.map(fa=>fa.label)));ka&&2<(null==(F=W)?void 0:F.length)&&!ja&&(W=[W[0],W[W.length-1]]);if(!W)return null;Z&&5!==(null==(e=W)?void 0:e.length)&&(W=O({minSize:W[0],maxSize:W[W.length-1]}));var X=ka?b(B,W):null,ca=T.getSymbolOutlineSize(Q),ha=ia?null:p(W,c);return(yield Promise.all(W.map(function(){var fa=u._asyncToGenerator(function*(ea,ra){const sa=ka?X[ra]:yield S(h,Q,ea,M,V),ya=x(ja&&"class-breaks"===B.type?d(B,ra):Q,sa);return{value:ea,symbol:ya,label:ia?oa[ra]:ha[ra],
size:sa,outlineSize:ca}});return function(ea,ra){return fa.apply(this,arguments)}}()))).reverse()}});return A.apply(this,arguments)}function b(B,h){B=null==B?void 0:B.authoringInfo;const n="univariate-color-size"===(null==B?void 0:B.type);let M=[12,30];if(n){const V=h[0],c=h[h.length-1];M=h.map(F=>12+(F-V)/(c-V)*18)}n&&"below"===(null==B?void 0:B.univariateTheme)&&M.reverse();return M}function d(B,h){const n=B.classBreakInfos,M=n.length;h=2>M||!(2<=h)?n[0].symbol.clone():n[M-1].symbol.clone();B.visualVariables.some(V=>
"color"===V.type)&&(-1<h.type.indexOf("3d")?m(h):G(h));return h}function g(B,h){let n=null,M=null;"simple"===B.type?n=B.symbol:"class-breaks"===B.type?(n=(B=B.classBreakInfos)&&B[0]&&B[0].symbol,M=1<B.length):"unique-value"===B.type&&(n=(B=B.uniqueValueInfos)&&B[0]&&B[0].symbol,M=1<B.length);if(!n||r(n))return null;n=n.clone();if(h||M)-1<n.type.indexOf("3d")?m(n):G(n);return n}function r(B){return B?t.isSymbol3D(B)?B.symbolLayers?B.symbolLayers.some(h=>h&&"fill"===h.type):!1:-1!==B.type.indexOf("fill"):
!1}function m(B){"line-3d"===B.type?B.symbolLayers.forEach(h=>{h.material={color:H}}):B.symbolLayers.forEach(h=>{"icon"!==h.type||h.resource&&h.resource.href?h.material={color:N}:(h.material={color:l},h.outline={color:H,size:1.5})})}function G(B){"cim"===B.type?L.applyCIMSymbolColor(B,new y(N)):-1!==B.type.indexOf("line")?B.color=H:(B.color=l,"simple-marker"===B.type&&(B.outline={color:H,width:1.5}))}function K(B,h,n,M){return z.apply(this,arguments)}function z(){z=u._asyncToGenerator(function*(B,
h,n,M){const V=(yield new Promise(function(e,v){E(["../../../renderers/visualVariables/support/visualVariableUtils"],e,v)})).getSizeRangeAtScale(B,n,M),c=V&&O(V);if(V||c){var F=c.map(e=>{{const v=V.minSize,Q=V.maxSize,W=B.minDataValue,Z=B.maxDataValue;let ka=null;e=ka=e<=v?W:e>=Q?Z:(e-v)/(Q-v)*(Z-W)+W}return e});F=C.round(F);for(let e=1;e<F.length-1;e++){const v=yield q(B,h,F[e],F[e-1],n,M);v&&(F[e]=v[0],c[e]=v[1])}return F}});return z.apply(this,arguments)}function O(B){const h=B.minSize;B=(B.maxSize-
h)/4;const n=[];for(let M=0;5>M;M++)n.push(h+B*M);return n}function q(B,h,n,M,V,c){return D.apply(this,arguments)}function D(){D=u._asyncToGenerator(function*(B,h,n,M,V,c){const F=yield S(B,h,n,V,c);M=yield S(B,h,M,V,c);var e=C.numDigits(n),v=e.fractional,Q=e.integer;let W=e=null;0<n&&1>n&&(e=10**v,n*=e,Q=C.numDigits(n).integer);for(v=Q-1;0<=v;v--){var Z=10**v;Q=Math.floor(n/Z)*Z;Z*=Math.ceil(n/Z);null!=e&&(Q/=e,Z/=e);let ka=(Q+Z)/2;[,ka]=C.round([Q,ka,Z],{indexes:[1]});const ia=yield S(B,h,Q,V,c),
oa=yield S(B,h,Z,V,c),ja=yield S(B,h,ka,V,c),X=C.percentChange(F,ia,M,null),ca=C.percentChange(F,oa,M,null),ha=C.percentChange(F,ja,M,null);let fa=20>=X.previous,ea=20>=ca.previous;fa&&ea&&(X.previous<=ca.previous?(fa=!0,ea=!1):(ea=!0,fa=!1));fa?W=[Q,ia]:ea?W=[Z,oa]:20>=ha.previous&&(W=[ka,ja]);if(W)break}return W});return D.apply(this,arguments)}function S(B,h,n,M,V){return f.apply(this,arguments)}function f(){f=u._asyncToGenerator(function*(B,h,n,M,V){const {getSize:c}=yield new Promise(function(F,
e){E(["../../../renderers/visualVariables/support/visualVariableUtils"],F,e)});return c(B,n,{scale:M,view:V,shape:"simple-marker"===h.type?h.style:null})});return f.apply(this,arguments)}function x(B,h){B=B.clone();if(t.isSymbol3D(B))T.isVolumetricSymbol(B)||B.symbolLayers.forEach(n=>{"fill"!==n.type&&(n.size=h)});else if("esri.symbols.SimpleMarkerSymbol"===B.declaredClass)B.size=h;else if("esri.symbols.PictureMarkerSymbol"===B.declaredClass){const n=B.width,M=B.height;B.height=h;B.width=n/M*h}else"esri.symbols.SimpleLineSymbol"===
B.declaredClass?B.width=h:"esri.symbols.TextSymbol"===B.declaredClass&&B.font&&(B.font.size=h);return B}const l=[255,255,255],N=[200,200,200],H=[128,128,128];J.REAL_WORLD_MAX_SIZE=30;J.REAL_WORLD_MIN_SIZE=12;J.getRampStops=function(B,h,n,M,V,c){return A.apply(this,arguments)};Object.defineProperty(J,"__esModule",{value:!0})})},"esri/widgets/Legend/styles/Card":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../intl ../../../core/Handles ../../../core/screenUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../../../symbols/support/svgUtils ../../Widget ./support/relationshipUtils ./support/univariateUtils ../support/styleUtils ../../support/Heading ../../support/decorators/accessibleHandler ../../support/decorators/messageBundle ../../support/jsxFactory ../../support/widgetUtils ../../../intl/substitute".split(" "),
function(E,J,u,y,t,C,L,T,R,p,A,b,d,g,r,m,G,K,z,O,q){const D=window.devicePixelRatio;u=function(S){function f(l,N){l=S.call(this,l,N)||this;l._handles=new y;l._hasIndicators=!1;l._selectedSectionName=null;l._sectionNames=[];l._sectionMap=new Map;l.activeLayerInfos=null;l.headingLevel=3;l.layout="stack";l.messages=null;l.messagesCommon=null;l.type="card";l.view=null;return l}E._inheritsLoose(f,S);var x=f.prototype;x.initialize=function(){this.own([this.watch("activeLayerInfos",l=>{this._handles.removeAll();
this._watchForSectionChanges(l)})])};x.destroy=function(){this._handles.destroy();this._handles=null};x.render=function(){this._hasIndicators="auto"===this.layout&&768>=this.view.container.clientWidth||"stack"===this.layout;var l=this.activeLayerInfos;l=l&&l.toArray().map(B=>this._renderLegendForLayer(B)).filter(B=>!!B);this._hasIndicators?this._selectedSectionName&&-1!==this._sectionNames.indexOf(this._selectedSectionName)||(this._selectedSectionName=this._sectionNames&&this._sectionNames[0]):this._selectedSectionName=
null;const N=this._sectionNames.length;var H=this._sectionNames.map((B,h)=>{h=q.substitute(this.messagesCommon.pagination.pageText,{index:h+1,total:N});return z.tsx("div",{key:B,role:"tab",id:B,"aria-label":h,"aria-controls":`${B}-panel`,"aria-selected":(this._selectedSectionName===B).toString(),tabIndex:this._selectedSectionName===B?0:-1,title:h,onclick:this._selectSection,onkeydown:this._focusSection,bind:this,class:this.classes("esri-legend--card__carousel-indicator",{["esri-legend--card__carousel-indicator--activated"]:this._selectedSectionName===
B}),"data-section-name":B})});H=this._hasIndicators&&1<N?z.tsx("div",{class:"esri-legend--card__carousel-indicator-container",key:"carousel-navigation",role:"tablist"},H):null;l=this._hasIndicators?this._sectionMap.get(this._selectedSectionName):l&&l.length?l:null;return z.tsx("div",{class:this.classes("esri-legend--card",{["esri-legend--stacked"]:this._hasIndicators})},l?l:z.tsx("div",{class:"esri-legend--card__message"},this.messages.noLegend),H)};x._selectSection=function(l){if(l=l.target.getAttribute("data-section-name"))this._selectedSectionName=
l};x._focusSection=function(l){switch(l.key){case "ArrowLeft":case "ArrowRight":this._switchSectionOnArrowPress(l);break;case "Enter":case " ":this._selectSection(l)}};x._switchSectionOnArrowPress=function(l){const N=l.key,H="ArrowLeft"===N?-1:1;l=l.target.getAttribute("data-section-name");l=this._sectionNames.indexOf(l);const B=this._sectionNames;let h=null;-1!==l&&(B[l+H]?h=document.getElementById(B[l+H]):"ArrowLeft"===N?h=document.getElementById(B[B.length-1]):"ArrowRight"===N&&(h=document.getElementById(B[0])),
h&&h.focus())};x._watchForSectionChanges=function(l){this._generateSectionNames();l&&(l.forEach(N=>{const H=`activeLayerInfo-${N.layer.uid}-version-change`;this._handles.remove(H);this._watchForSectionChanges(N.children);this._handles.add(N.watch("version",()=>this._generateSectionNames()),H)}),this._handles.remove("activeLayerInfos-collection-change"),this._handles.add(l.on("change",()=>this._watchForSectionChanges(l)),"activeLayerInfos-collection-change"))};x._generateSectionNames=function(){this._sectionNames.length=
0;this._selectedSectionName=null;this.activeLayerInfos&&this.activeLayerInfos.forEach(this._generateSectionNamesForActiveLayerInfo,this)};x._getSectionName=function(l,N,H){return`${this.id}${l.uid}-type-${N.type}-${H}`};x._generateSectionNamesForActiveLayerInfo=function(l){l.children.forEach(this._generateSectionNamesForActiveLayerInfo,this);l.legendElements&&l.legendElements.forEach((N,H)=>{this._sectionNames.push(this._getSectionName(l.layer,N,H))})};x._renderLegendForLayer=function(l){if(!l.ready)return null;
if(l.children.length){var N=l.children.map(H=>this._renderLegendForLayer(H)).toArray();return z.tsx("div",{key:l.layer.uid,class:this.classes("esri-legend--card__service","esri-legend--card__group-layer")},z.tsx("div",{class:"esri-legend--card__service-caption-container"},l.title),N)}{if((N=l.legendElements)&&!N.length)return null;const H=N.some(B=>"relationship-ramp"===B.type);N=N.map((B,h)=>this._renderLegendForElement(B,l,h,H)).filter(B=>!!B);return N.length?z.tsx("div",{key:l.layer.uid,class:this.classes("esri-legend--card__service",
{["esri-legend--card__group-layer-child"]:!!l.parent})},z.tsx("div",{class:"esri-legend--card__service-caption-container"},z.tsx("div",{class:"esri-legend--card__service-caption-text"},l.title)),z.tsx("div",{class:"esri-legend--card__service-content"},N)):null}};x._renderLegendForElement=function(l,N,H,B=!1){var h="color-ramp"===l.type,n="opacity-ramp"===l.type,M="size-ramp"===l.type;const V=N.layer;var c=null;"string"===typeof l.title?c=l.title:l.title&&(c=l.title,h=r.getTitle(this.messages,c,h||
n),c=c.title?`${c.title} (${h})`:h);H=this._getSectionName(V,l,H);h=this._hasIndicators?z.tsx("div",null,z.tsx(m.Heading,{level:this.headingLevel,class:"esri-legend--card__carousel-title"},N.title),z.tsx(m.Heading,{level:this.headingLevel+1,class:"esri-legend--card__layer-caption"},c)):c?z.tsx(m.Heading,{level:this.headingLevel,class:"esri-legend--card__layer-caption"},c):null;n=null;"symbol-table"===l.type?(M=l.infos.map((F,e)=>this._renderLegendForElementInfo(F,N,l.legendType,e)).filter(F=>!!F),
M.length&&(n=z.tsx("div",{class:this.classes({["esri-legend--card__label-container"]:!(M[0].properties.classes&&M[0].properties.classes["esri-legend--card__symbol-row"])&&!B,["esri-legend--card__relationship-label-container"]:B})},M))):"color-ramp"===l.type||"opacity-ramp"===l.type||"heatmap-ramp"===l.type?n=this._renderLegendForRamp(l,V.opacity):M?n=this._renderSizeRamp(l,V.opacity):"relationship-ramp"===l.type?n=d.renderRelationshipRamp(l,this.id,V.opacity):"univariate-above-and-below-ramp"===l.type?
n=this._renderUnivariateAboveAndBelowRamp(l,V.opacity):"univariate-color-size-ramp"===l.type&&(n=this._renderUnivariateColorSizeRamp(l,V.opacity));if(!n)return null;B=z.tsx("div",{key:H,class:"esri-legend--card__section",id:`${H}-panel`,role:"tabpanel","aria-labelledby":H,tabIndex:0},[h,n]);this._sectionMap.set(H,B);return B};x._renderUnivariateAboveAndBelowRamp=function(l,N){const {sizeRampElement:H,colorRampElement:B}=g.getUnivariateAboveAndBelowRampElements(l,N,"horizontal");l=g.getUnivariateSizeRampSize(H,
"full",!0,"horizontal");var h=g.getUnivariateColorRampSize(H,"above",!0,"horizontal"),n=g.getUnivariateColorRampSize(H,"below",!0,"horizontal");h=g.getUnivariateColorRampPreview(B,{width:h,height:12,rampAlignment:"horizontal",opacity:N,type:"above"});N=g.getUnivariateColorRampPreview(B,{width:n,height:12,rampAlignment:"horizontal",opacity:N,type:"below"});var M=g.getUnivariateColorRampMargin(H,"card");n=H.infos.map(c=>c.label);const V=n.length-1;n=n.map((c,F)=>0===F||F===V?z.tsx("div",{key:F},c):
null);M={marginTop:"3px",marginLeft:`${M}px`,display:"flex"};l={width:`${l}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return z.tsx("div",{class:"esri-legend--card__layer-row",key:"size-ramp-preview",styles:{display:"flex",flexDirection:"column"}},z.tsx("div",{class:this.classes("esri-legend--card__symbol-container","esri-legend__size-ramp--horizontal"),styles:{display:"flex",flexDirection:"row"}},H.infos.map((c,F)=>z.tsx("div",{key:F,class:"esri-legend--card__symbol",bind:c.preview,
afterCreate:r.attachToNode}))),h?z.tsx("div",{class:"esri-univariate-above-and-below-ramp__color--card",styles:M,key:"color-ramp-preview"},z.tsx("div",{bind:h,afterCreate:r.attachToNode}),z.tsx("div",{bind:N,afterCreate:r.attachToNode})):null,z.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},z.tsx("div",{class:"esri-legend__ramp-labels",styles:l},n)))};x._renderUnivariateColorSizeRamp=function(l,N){const {sizeRampElement:H,colorRampElement:B}=g.getUnivariateColorSizeRampElements(l,
"horizontal");l=g.getUnivariateSizeRampSize(H,"full",!1,"horizontal");var h=g.getUnivariateColorRampSize(H,"full",!1,"horizontal");N=g.getUnivariateColorRampPreview(B,{width:h,height:12,rampAlignment:"horizontal",opacity:N,type:"full"});var n=g.getUnivariateColorRampMargin(H,"card");const M=H.infos.length-1;h=H.infos.map((V,c)=>0===c||c===M?z.tsx("div",{key:c},V.label):null);n={marginTop:"3px",marginLeft:`${n}px`,display:"flex"};l={width:`${l}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};
return z.tsx("div",{class:"esri-legend--card__layer-row",key:"size-ramp-preview",styles:{display:"flex",flexDirection:"column"}},z.tsx("div",{class:this.classes("esri-legend--card__symbol-container","esri-legend__size-ramp--horizontal"),styles:{display:"flex",flexDirection:"row"}},H.infos.map((V,c)=>z.tsx("div",{key:c,class:"esri-legend--card__symbol",bind:V.preview,afterCreate:r.attachToNode}))),z.tsx("div",{class:"esri-univariate-above-and-below-ramp__color--card",styles:n,key:"color-ramp-preview"},
z.tsx("div",{bind:N,afterCreate:r.attachToNode})),z.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},z.tsx("div",{class:"esri-legend__ramp-labels",styles:l},h)))};x._renderLegendForElementInfo=function(l,N,H,B){var h=N.layer;if(l.type)return this._renderLegendForElement(l,N,B);N=r.isImageryStretchedLegend(h,H);if(l.preview){var n;if(!l.symbol||-1===l.symbol.type.indexOf("simple-fill")){if(!l.label)return z.tsx("div",{key:B,bind:l.preview,afterCreate:r.attachToNode});var M=
{["esri-legend--card__symbol-cell"]:this._hasIndicators};return z.tsx("div",{key:B,class:this.classes("esri-legend--card__layer-row",{["esri-legend--card__symbol-row"]:this._hasIndicators})},z.tsx("div",{class:this.classes(M),bind:l.preview,afterCreate:r.attachToNode}),z.tsx("div",{class:this.classes("esri-legend--card__image-label",{["esri-legend--card__label-cell"]:this._hasIndicators})},r.getTitle(this.messages,l.label,!1)||""))}let V=H=N=255,c=0,F=255,e=255,v=255,Q=0;const W=l.symbol.color&&l.symbol.color.a,
Z=l.symbol.outline&&l.symbol.outline.color&&l.symbol.outline.color.a;W&&(N=l.symbol.color.r,H=l.symbol.color.g,V=l.symbol.color.b,c=l.symbol.color.a*h.opacity);Z&&(F=l.symbol.outline.color.r,e=l.symbol.outline.color.g,v=l.symbol.outline.color.b,Q=l.symbol.outline.color.a*h.opacity);M=(h=null!=(M=null==(n=l.symbol.color)?void 0:n.isBright)?M:!0)?"rgba(255, 255, 255, .6)":"rgba(0, 0, 0, .6)";return z.tsx("div",{key:B,class:"esri-legend--card__layer-row"},z.tsx("div",{class:"esri-legend--card__label-element",
styles:{background:W?`rgba(${N}, ${H}, ${V}, ${c})`:"none",color:h?"black":"white",textShadow:`-1px -1px 0 ${M},\n                                              1px -1px 0 ${M},\n                                              -1px 1px 0 ${M},\n                                              1px 1px 0 ${M}`,border:Z?`1px solid rgba(${F}, ${e}, ${v}, ${Q})`:"none"}}," ",l.label," "))}if(l.src)return M=this._renderImage(l,h,N),z.tsx("div",{key:B,class:"esri-legend--card__layer-row"},M,z.tsx("div",{class:"esri-legend--card__image-label"},
l.label||""))};x._renderImage=function(l,N,H){const {label:B,src:h,opacity:n}=l;H={["esri-legend--card__imagery-layer-image--stretched"]:H,["esri-legend--card__symbol"]:!H};N={opacity:`${null!=n?n:N.opacity}`};return z.tsx("img",{alt:r.getTitle(this.messages,B,!1),src:h,border:0,width:l.width,height:l.height,class:this.classes(H),styles:N})};x._renderSizeRampLines=function(l){l=l.infos;var N=l[0],H=l[l.length-1],B=N.symbol;l=this._hasIndicators;N=t.pt2px(N.size+N.outlineSize)*D;H=t.pt2px(H.size+H.outlineSize)*
D;const h=l?N:N+50*D,n=l?N/2+50*D:N;var M;B?-1<B.type.indexOf("3d")?(M=B.symbolLayers&&B.symbolLayers.length)?(M=B.symbolLayers.getItemAt(M-1).get("resource.primitive"),M="triangle"===M||"cone"===M||"tetrahedron"===M):M=void 0:M="triangle"===B.style:M=void 0;if(B)if(-1<B.type.indexOf("3d")){var V=B.symbolLayers&&B.symbolLayers.length;V?(B=B.symbolLayers.getItemAt(V-1),B=B.resource&&B.resource.primitive,B="circle"===B||"cross"===B||"kite"===B||"sphere"===B||"cube"===B||"diamond"===B):B=void 0}else B=
B.style,B="circle"===B||"diamond"===B||"cross"===B;else B=void 0;V=document.createElement("canvas");V.width=h;V.height=n;V.style.width=`${V.width/D}px`;V.style.height=`${V.height/D}px`;const c=V.getContext("2d");if(l){c.beginPath();var F=h/2-H/2;c.moveTo(0,0);c.lineTo(F,n);F=h/2+H/2;c.moveTo(h,0);c.lineTo(F,n)}else c.beginPath(),c.moveTo(0,n/2-H/2),c.lineTo(h,0),c.moveTo(0,n/2+H/2),c.lineTo(h,n);c.strokeStyle="#ddd";c.stroke();return z.tsx("div",{bind:V,afterCreate:r.attachToNode,styles:l?{display:"flex",
marginTop:`-${M?0:B?N/2:0}px`,marginBottom:`-${M?H:B?H/2:0}px`}:{display:"flex",marginRight:`-${M?0:B?N/2:0}px`,marginLeft:`-${M?0:B?H/2:0}px`}})};x._renderSizeRamp=function(l,N){var H=l.infos;const B=H[0].label,h=H[H.length-1].label;let n=H[0].preview;H=H[H.length-1].preview;const M=this._hasIndicators,V={"flex-direction":M?"column":"row-reverse"};n&&(n=n.cloneNode(!0),n.style.display="flex");H&&(H=H.cloneNode(!0),H.style.display="flex");N={opacity:null!=N?`${N}`:""};return z.tsx("div",{class:this.classes("esri-legend--card__layer-row",
{["esri-legend--card__size-ramp-row"]:M})},z.tsx("div",{class:"esri-legend--card__ramp-label"},M?B:h),z.tsx("div",{class:"esri-legend--card__size-ramp-container",styles:V},z.tsx("div",{bind:n,afterCreate:r.attachToNode,class:"esri-legend--card__size-ramp-preview",styles:N}),this._renderSizeRampLines(l),z.tsx("div",{bind:H,afterCreate:r.attachToNode,class:"esri-legend--card__size-ramp-container",styles:N})),z.tsx("div",{class:"esri-legend--card__ramp-label"},M?h:B))};x._renderLegendForRamp=function(l,
N){var H=l.infos;const B="heatmap-ramp"===l.type,h=H.length-1;var n=2<h&&!B?25*h:100;const M=n+20,V=H.slice(0).reverse();V.forEach((v,Q)=>{v.offset=B?v.ratio:Q/h});const c=V.length-1;l=(l=0!==V.length%2&&V[V.length/2|0])&&z.tsx("div",{class:"esri-legend--card__interval-separators-container"},z.tsx("div",{class:"esri-legend--card__interval-separator"},"|"),z.tsx("div",{class:"esri-legend--card__ramp-label"},l.label));const F=H[H.length-1].label;H=H[0].label;let e=null;null!=N&&(e=`opacity: ${N}`);
N=A.renderSVG([[{shape:{type:"path",path:"M0 12.5 L10 0 L10 25 Z"},fill:V[0].color,stroke:{width:0}},{shape:{type:"rect",x:10,y:0,width:n,height:25},fill:{type:"linear",x1:10,y1:0,x2:n+10,y2:0,colors:V},stroke:{width:0}},{shape:{type:"path",path:`M${n+10} 0 L${M} ${12.5} L${n+10} ${25} Z`},fill:V[c].color,stroke:{width:0}}]],M,25);({messages:n}=this);return z.tsx("div",{class:"esri-legend--card__layer-row"},z.tsx("div",{class:"esri-legend--card__ramp-label"},B?n[F]:F),z.tsx("div",{class:"esri-legend--card__symbol-container"},
z.tsx("div",{style:e},N),l),z.tsx("div",{class:"esri-legend--card__ramp-label"},B?n[H]:H))};return f}(b);J.__decorate([C.property()],u.prototype,"activeLayerInfos",void 0);J.__decorate([C.property()],u.prototype,"headingLevel",void 0);J.__decorate([C.property()],u.prototype,"layout",void 0);J.__decorate([C.property(),K.messageBundle("esri/widgets/Legend/t9n/Legend")],u.prototype,"messages",void 0);J.__decorate([C.property(),K.messageBundle("esri/t9n/common")],u.prototype,"messagesCommon",void 0);
J.__decorate([C.property({readOnly:!0})],u.prototype,"type",void 0);J.__decorate([C.property()],u.prototype,"view",void 0);J.__decorate([G.accessibleHandler()],u.prototype,"_selectSection",null);return u=J.__decorate([p.subclass("esri.widgets.Legend.styles.Card")],u)})},"esri/widgets/Legend/styles/support/relationshipUtils":function(){define("exports ../../../../symbols/support/svgUtils ../../../support/widgetUtils ../../../../core/has ../../../../core/Logger ../../../support/jsxFactory".split(" "),
function(E,J,u,y,t,C){function L(p,A,b){const d=`${b}_arrowStart`;b=`${b}_arrowEnd`;p="left"===p;const g={markerStart:null,markerEnd:null};switch(A){case "HL":p?g.markerStart=`url(#${b})`:g.markerEnd=`url(#${d})`;break;case "LL":g.markerStart=`url(#${b})`;break;case "LH":p?g.markerEnd=`url(#${d})`:g.markerStart=`url(#${b})`;break;default:g.markerEnd=`url(#${d})`}return g}function T(p,A,b,d=60){const {focus:g,numClasses:r,colors:m,rotation:G}=p;p=!!g;const K=Math.sqrt(d**2+d**2)+(p?0:5);let z=null;
null!=b&&(z=`opacity: ${b}`);b=[];const O=[];var q=[],D=(d||75)/r;for(var S=0;S<r;S++){var f=S*D;for(var x=0;x<r;x++){var l=x*D;const N=J.generateFillAttributes(m[S][x]),H=J.generateStrokeAttributes(null);l={type:"rect",x:l,y:f,width:D,height:D};b.push(J.renderDef(N));O.push(J.renderShape(l,N.fill,H,null));q.push(J.getBoundingBox(l))}}D=null;p||(D="margin: -15px -15px -18px -15px");S=L("left",g,A);f=L("right",g,A);x=J.computeBBox(q);q=J.getTransformMatrix(x,K,K,0,!1,G,!1);x=J.getTransformMatrix(x,
K,K,0,!1,p?-45:null,!1);return C.tsx("div",{style:z,class:p?R.diamondMidColRamp:R.squareTableCell},C.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:K,height:K,style:D},C.tsx("defs",null,C.tsx("marker",{id:`${A}_arrowStart`,markerWidth:"10",markerHeight:"10",refX:"5",refY:"5",markerUnits:"strokeWidth",orient:"auto"},C.tsx("polyline",{points:"0,0 5,5 0,10",fill:"none",stroke:"#555555","stroke-width":"1"})),C.tsx("marker",{id:`${A}_arrowEnd`,markerWidth:"10",markerHeight:"10",refX:"0",refY:"5",
markerUnits:"strokeWidth",orient:"auto"},C.tsx("polyline",{points:"5,0 0,5 5,10",fill:"none",stroke:"#555555","stroke-width":"1"})),b),C.tsx("g",{transform:q},O),C.tsx("g",{transform:x},C.tsx("line",{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":S.markerStart,"marker-end":S.markerEnd,x1:-10,y1:d-15,x2:-10,y2:15}),C.tsx("line",{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":f.markerStart,"marker-end":f.markerEnd,x1:15,y1:d+10,x2:d-15,y2:d+10}))))}const R={diamondContainer:"esri-relationship-ramp--diamond__container",
diamondLeftCol:"esri-relationship-ramp--diamond__left-column",diamondRightCol:"esri-relationship-ramp--diamond__right-column",diamondMidCol:"esri-relationship-ramp--diamond__middle-column",diamondMidColLabel:"esri-relationship-ramp--diamond__middle-column--label",diamondMidColRamp:"esri-relationship-ramp--diamond__middle-column--ramp",squareTable:"esri-relationship-ramp--square__table",squareTableRow:"esri-relationship-ramp--square__table-row",squareTableCell:"esri-relationship-ramp--square__table-cell",
squareTableLabel:"esri-relationship-ramp--square__table-label",squareTableLabelLeftBottom:"esri-relationship-ramp--square__table-label--left-bottom",squareTableLabelRightBottom:"esri-relationship-ramp--square__table-label--right-bottom",squareTableLabelLeftTop:"esri-relationship-ramp--square__table-label--left-top",squareTableLabelRightTop:"esri-relationship-ramp--square__table-label--right-top"};E.renderRelationshipRamp=function(p,A,b){const {focus:d,labels:g}=p,r=!!d;p=T(p,A,b);return r?C.tsx("div",
{class:R.diamondContainer},C.tsx("div",{class:R.diamondLeftCol},g.left),C.tsx("div",{class:R.diamondMidCol},C.tsx("div",{class:R.diamondMidColLabel},g.top),p,C.tsx("div",{class:R.diamondMidColLabel},g.bottom)),C.tsx("div",{class:R.diamondRightCol},g.right)):C.tsx("div",{class:R.squareTable},C.tsx("div",{class:R.squareTableRow},C.tsx("div",{class:u.classes(R.squareTableCell,R.squareTableLabel,R.squareTableLabelRightBottom)},g.left),C.tsx("div",{class:R.squareTableCell}),C.tsx("div",{class:u.classes(R.squareTableCell,
R.squareTableLabel,R.squareTableLabelLeftBottom)},g.top)),C.tsx("div",{class:R.squareTableRow},C.tsx("div",{class:R.squareTableCell}),p,C.tsx("div",{class:R.squareTableCell})),C.tsx("div",{class:R.squareTableRow},C.tsx("div",{class:u.classes(R.squareTableCell,R.squareTableLabel,R.squareTableLabelRightTop)},g.bottom),C.tsx("div",{class:R.squareTableCell}),C.tsx("div",{class:u.classes(R.squareTableCell,R.squareTableLabel,R.squareTableLabelLeftTop)},g.right)))};Object.defineProperty(E,"__esModule",{value:!0})})},
"esri/widgets/Legend/styles/support/univariateUtils":function(){define("exports ../../../../core/screenUtils ../../../../libs/maquette/projection ../../../../libs/maquette/projector ../../../../symbols/support/symbolUtils ../../../support/widgetUtils ../../../../core/has ../../../../core/Logger ../../../support/jsxFactory".split(" "),function(E,J,u,y,t,C,L,T,R){function p(m="vertical"){return"vertical"===m?R.tsx("svg",{height:"4",width:"10"},R.tsx("line",{x1:"0",y1:"2",x2:"10",y2:"2",style:"stroke:rgb(200, 200, 200);stroke-width:1"})):
R.tsx("svg",{height:"10",width:"10"},R.tsx("line",{x1:"5",y1:"0",x2:"5",y2:"10",style:"stroke:rgb(200, 200, 200);stroke-width:1"}))}function A(m,G="vertical"){const K=document.createElement("div");K.style.height="20px";K.className=r.univariateAboveAndBelowSymbol;null!=m&&(K.style.opacity=m.toString());g.append(K,p.bind(null,G));return K}function b(m,G,K="vertical",z){m.infos.forEach((O,q)=>{if(z&&2===q)O.preview=A(G,K);else{q=J.pt2px(O.size)+("horizontal"===K?20:10);const D="div"===O.preview.tagName.toLowerCase(),
S=D?O.preview:document.createElement("div");S.className=r.univariateAboveAndBelowSymbol;"horizontal"===K?S.style.width=`${q}px`:S.style.height=`${q}px`;D||S.appendChild(O.preview);O.preview=S}})}function d(m,G,K,z="vertical"){let O=0;m=m.infos;const q=Math.floor(m.length/2);var D="full"===G||"above"===G?0:q;for(G="full"===G||"below"===G?m.length-1:q;D<=G;D++)if(K&&D===q)O+="horizontal"===z?10:20;else{const S=J.pt2px(m[D].size)+("horizontal"===z?20:10);O+=S}return Math.round(O)}const g=y.createProjector(),
r={univariateAboveAndBelowSymbol:"esri-univariate-above-and-below-ramp__symbol",colorRamp:"esri-legend__color-ramp"};E.getUnivariateAboveAndBelowRampElements=function(m,G,K="vertical"){var z=m.infos;m=z.filter(({type:q})=>"size-ramp"===q)[0];z=z.filter(({type:q})=>"color-ramp"===q)[0];m&&(m={...m},m.infos=[...m.infos]);z&&(z={...z},z.infos=[...z.infos]);b(m,G,K,!0);if("horizontal"===K){var O;m.infos.reverse();null==(O=z)?void 0:O.infos.reverse()}return{sizeRampElement:m,colorRampElement:z}};E.getUnivariateColorRampMargin=
function(m,G="classic"){m=m.infos;return"classic"===G?(J.pt2px(m[0].size)+10)/2:(J.pt2px(m[0].size)-J.pt2px(m[m.length-1].size))/2};E.getUnivariateColorRampPreview=function(m,G){if(!m)return null;m=m.infos.map(K=>K.color);m=t.renderColorRampPreviewHTML("full"===G.type?m:"above"===G.type?m.slice(0,3):m.slice(2,5),{width:G.width,height:G.height,align:G.rampAlignment});m.className=r.colorRamp;null!=G.opacity&&(m.style.opacity=G.opacity.toString());return m};E.getUnivariateColorRampSize=function(m,G,
K,z="vertical"){const O=d(m,G,K,z);m=m.infos;var q=Math.floor(m.length/2);const D="full"===G||"above"===G?0:q;q="full"===G||"below"===G?m.length-1:q;K=K?"vertical"===z?20:10:0;z="vertical"===z?10*("full"===G?2:1):20*("full"===G?2:1);return Math.round(O-(J.pt2px("full"===G?m[D].size+m[q].size:"above"===G?m[D].size:m[q].size)/2+K/2+z/2))};E.getUnivariateColorSizeRampElements=function(m,G="vertical"){var K=m.infos;m=K.filter(({type:O})=>"size-ramp"===O)[0];K=K.filter(({type:O})=>"color-ramp"===O)[0];
m&&(m={...m},m.infos=[...m.infos]);K&&(K={...K},K.infos=[...K.infos]);b(m,null,G,!1);if("horizontal"===G){var z;m.infos.reverse();null==(z=K)?void 0:z.infos.reverse()}return{sizeRampElement:m,colorRampElement:K}};E.getUnivariateSizeRampSize=d;Object.defineProperty(E,"__esModule",{value:!0})})},"esri/widgets/Legend/support/styleUtils":function(){define(["exports","../../../intl","../../../intl/substitute"],function(E,J,u){E.attachToNode=function(y){y.appendChild(this)};E.getTitle=function(y,t,C){if(t){if("string"===
typeof t||"number"===typeof t)return t;if("value"in t||"unit"in t)return u.substitute(y.dotValue,t);if("colorName"in t||"bandName"in t)return y[t.colorName]+": "+(y[t.bandName]||t.bandName);if("showCount"in t)return t.showCount?y.clusterCountTitle:null;var L=null;C?L=t.ratioPercentTotal?"showRatioPercentTotal":t.ratioPercent?"showRatioPercent":t.ratio?"showRatio":t.normField?"showNormField":t.field?"showField":null:C||(L=t.normField?"showNormField":t.normByPct?"showNormPct":t.field?"showField":null);
return L?u.substitute("showField"===L?"{field}":y[L],{field:t.field,normField:t.normField}):null}};E.isImageryStretchedLegend=function(y,t){return!!(t&&"Stretched"===t&&10.3<=y.version&&"esri.layers.ImageryLayer"===y.declaredClass)};E.isRendererTitle=function(y,t){return!t};Object.defineProperty(E,"__esModule",{value:!0})})},"esri/widgets/support/Heading":function(){define("exports ../../core/mathUtils ./widgetUtils ../../core/has ../../core/Logger ./jsxFactory".split(" "),function(E,J,u,y,t,C){const L=
{heading:"esri-widget__heading"};E.CSS=L;E.Heading=function(T,R){const p=`h${J.clamp(Math.ceil(T.level),1,6)}`;delete T.level;return C.tsx(p,{...T,class:u.classes(L.heading,T.class)},R)};Object.defineProperty(E,"__esModule",{value:!0})})},"esri/widgets/Legend/styles/Classic":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../intl ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../../Widget ./support/relationshipUtils ./support/univariateUtils ../support/styleUtils ../../support/Heading ../../support/widgetUtils ../../support/decorators/messageBundle ../../support/jsxFactory ../../../intl/number".split(" "),
function(E,J,u,y,t,C,L,T,R,p,A,b,d,g,r,m,G){const K={display:"flex",alignItems:"flex-start"},z={marginLeft:"3px"},O={display:"table-cell",verticalAlign:"middle"};u=function(q){function D(f,x){f=q.call(this,f,x)||this;f.activeLayerInfos=null;f.headingLevel=3;f.messages=null;f.type="classic";return f}E._inheritsLoose(D,q);var S=D.prototype;S.render=function(){var f=this.activeLayerInfos;f=f&&f.toArray().map(x=>this._renderLegendForLayer(x)).filter(x=>!!x);return m.tsx("div",null,f&&f.length?f:m.tsx("div",
{class:"esri-legend__message"},this.messages.noLegend))};S._renderLegendForLayer=function(f){if(!f.ready)return null;var x=!!f.children.length;const l=`${"esri-legend__"}${f.layer.uid}-version-${f.version}`,N=f.title?d.Heading({level:this.headingLevel,class:this.classes("esri-widget__heading","esri-legend__service-label")},f.title):null;if(x)return x=f.children.map(H=>this._renderLegendForLayer(H)).toArray(),m.tsx("div",{key:l,class:this.classes("esri-legend__service","esri-legend__group-layer")},
N,x);if((x=f.legendElements)&&!x.length)return null;x=x.map(H=>this._renderLegendForElement(H,f.layer)).filter(H=>!!H);return x.length?m.tsx("div",{key:l,class:this.classes("esri-legend__service",{["esri-legend__group-layer-child"]:!!f.parent}),tabIndex:0},N,m.tsx("div",{class:"esri-legend__layer"},x)):null};S._renderLegendForElement=function(f,x,l){var N="color-ramp"===f.type,H="opacity-ramp"===f.type;const B="size-ramp"===f.type;let h=null;if("symbol-table"===f.type||B){var n=f.infos.map(V=>this._renderLegendForElementInfo(V,
x,B,f.legendType)).filter(V=>!!V);n.length&&(h=m.tsx("div",{class:"esri-legend__layer-body"},n))}else"color-ramp"===f.type||"opacity-ramp"===f.type||"heatmap-ramp"===f.type||"stretch-ramp"===f.type?h=this._renderLegendForRamp(f,x.opacity):"relationship-ramp"===f.type?h=p.renderRelationshipRamp(f,this.id,x.opacity):"univariate-above-and-below-ramp"===f.type?h=this._renderUnivariateAboveAndBelowRamp(f,x.opacity):"univariate-color-size-ramp"===f.type&&(h=this._renderUnivariateColorSizeRamp(f,x.opacity));
if(!h)return null;n=f.title;var M=null;"string"===typeof n?M=n:n&&(M=b.getTitle(this.messages,n,N||H),M=b.isRendererTitle(n,N||H)&&n.title?`${n.title} (${M})`:M);N=l?"esri-legend__layer-child-table":"esri-legend__layer-table";H=M?m.tsx("div",{class:"esri-legend__layer-caption"},M):null;return m.tsx("div",{class:this.classes(N,{["esri-legend__layer-table--size-ramp"]:B||!l})},H,h)};S._renderUnivariateAboveAndBelowRamp=function(f,x){const {sizeRampElement:l,colorRampElement:N}=A.getUnivariateAboveAndBelowRampElements(f,
x);var H=A.getUnivariateColorRampSize(l,"above",!0);f=A.getUnivariateColorRampSize(l,"below",!0);const B=A.getUnivariateColorRampPreview(N,{width:12,height:H,rampAlignment:"vertical",opacity:x,type:"above"});x=A.getUnivariateColorRampPreview(N,{width:12,height:f,rampAlignment:"vertical",opacity:x,type:"below"});var h=A.getUnivariateColorRampMargin(l);const n=l.infos.map(v=>v.label),M=n.map((v,Q)=>{const W=2===Q;return 0===Q?m.tsx("div",{key:Q,class:v?B?"esri-univariate-above-and-below-ramp__label":
"esri-legend__ramp-label":null},v):W?m.tsx("div",null):null}),V=n.length-1,c=Math.floor(n.length/2),F=n.map((v,Q)=>{const W=Q===V;return Q===c||W?m.tsx("div",{key:Q,class:v?B?"esri-univariate-above-and-below-ramp__label":"esri-legend__ramp-label":null},v):null}),e={display:"table-cell",verticalAlign:"middle"};h={marginTop:`${h}px`};H={height:`${H}px`};f={height:`${f}px`};return m.tsx("div",{key:"univariate-above-and-below-ramp-preview",styles:K},m.tsx("div",{class:"esri-legend__layer-body"},l.infos.map((v,
Q)=>m.tsx("div",{class:this.classes("esri-legend__layer-row","esri-legend__size-ramp")},m.tsx("div",{class:"esri-legend__symbol",styles:e,bind:v.preview,afterCreate:b.attachToNode}),B||0!==Q%2?null:m.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},n[Q])))),B?m.tsx("div",{styles:h,key:"color-ramp-preview"},m.tsx("div",{styles:z},m.tsx("div",{styles:O},m.tsx("div",{class:"esri-legend__ramps",bind:B,afterCreate:b.attachToNode})),m.tsx("div",{styles:O},m.tsx("div",{class:"esri-legend__ramp-labels",
styles:H},M))),m.tsx("div",{styles:z},m.tsx("div",{styles:O},m.tsx("div",{class:"esri-legend__ramps",bind:x,afterCreate:b.attachToNode})),m.tsx("div",{styles:O},m.tsx("div",{class:"esri-legend__ramp-labels",styles:f},F)))):null)};S._renderUnivariateColorSizeRamp=function(f,x){const {sizeRampElement:l,colorRampElement:N}=A.getUnivariateColorSizeRampElements(f);var H=A.getUnivariateColorRampMargin(l);f=A.getUnivariateColorRampSize(l,"full",!1);x=A.getUnivariateColorRampPreview(N,{width:12,height:f,
rampAlignment:"vertical",opacity:x,type:"full"});const B=l.infos.length-1,h=l.infos.map((M,V)=>0===V||V===B?m.tsx("div",{key:V,class:M.label?N?"esri-univariate-above-and-below-ramp__label":"esri-legend__ramp-label":null},M.label):null),n={display:"table-cell",verticalAlign:"middle"};H={marginTop:`${H}px`};f={height:`${f}px`};return m.tsx("div",{key:"univariate-above-and-below-ramp-preview",styles:K},m.tsx("div",{class:"esri-legend__layer-body"},l.infos.map(M=>m.tsx("div",{class:this.classes("esri-legend__layer-row",
"esri-legend__size-ramp")},m.tsx("div",{class:"esri-legend__symbol",styles:n,bind:M.preview,afterCreate:b.attachToNode})))),m.tsx("div",{styles:H,key:"color-ramp-preview"},m.tsx("div",{styles:z},m.tsx("div",{styles:O},m.tsx("div",{class:"esri-legend__ramps",bind:x,afterCreate:b.attachToNode})),m.tsx("div",{styles:O},m.tsx("div",{class:"esri-legend__ramp-labels",styles:f},h)))))};S._renderLegendForRamp=function(f,x){const l=f.infos,N="heatmap-ramp"===f.type,H="stretch-ramp"===f.type,B=f.preview;B.className=
`${"esri-legend__color-ramp"} ${"opacity-ramp"===f.type?"esri-legend__opacity-ramp":""}`;null!=x&&(B.style.opacity=x.toString());f=l.map(h=>m.tsx("div",{class:h.label?"esri-legend__ramp-label":null},N?this.messages[h.label]:H?this._getStretchStopLabel(h):h.label));x={height:B.style.height};return m.tsx("div",{class:"esri-legend__layer-row"},m.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--symbols",styles:{width:"24px"}},m.tsx("div",{class:"esri-legend__ramps",bind:B,afterCreate:b.attachToNode})),
m.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},m.tsx("div",{class:"esri-legend__ramp-labels",styles:x},f)))};S._getStretchStopLabel=function(f){return f.label?this.messages[f.label]+": "+("string"===typeof f.value?f.value:G.formatNumber(f.value,{style:"decimal",notation:-1<f.value.toString().indexOf("e")?"scientific":"standard"})):""};S._renderLegendForElementInfo=function(f,x,l,N){if(f.type)return this._renderLegendForElement(f,x,!0);let H=null;N=b.isImageryStretchedLegend(x,
N);f.preview?H=m.tsx("div",{class:"esri-legend__symbol",bind:f.preview,afterCreate:b.attachToNode}):f.src&&(H=this._renderImage(f,x,N));if(!H)return null;x={["esri-legend__imagery-layer-info--stretched"]:N};return m.tsx("div",{class:"esri-legend__layer-row"},m.tsx("div",{class:this.classes("esri-legend__layer-cell esri-legend__layer-cell--symbols",{["esri-legend__imagery-layer-info--stretched"]:N,["esri-legend__size-ramp"]:!N&&l})},H),m.tsx("div",{class:this.classes("esri-legend__layer-cell esri-legend__layer-cell--info",
x)},b.getTitle(this.messages,f.label,!1)||""))};S._renderImage=function(f,x,l){const {label:N,src:H,opacity:B}=f;l={["esri-legend__imagery-layer-image--stretched"]:l,["esri-legend__symbol"]:!l};x={opacity:`${null!=B?B:x.opacity}`};return m.tsx("img",{alt:b.getTitle(this.messages,N,!1),src:H,border:0,width:f.width,height:f.height,class:this.classes(l),styles:x})};return D}(R);J.__decorate([y.property()],u.prototype,"activeLayerInfos",void 0);J.__decorate([y.property()],u.prototype,"headingLevel",void 0);
J.__decorate([y.property(),r.messageBundle("esri/widgets/Legend/t9n/Legend")],u.prototype,"messages",void 0);J.__decorate([y.property({readOnly:!0})],u.prototype,"type",void 0);return u=J.__decorate([T.subclass("esri.widgets.Legend.styles.Classic")],u)})},"*noref":1}});
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Handles ../core/watchUtils ../core/accessorSupport/decorators/aliasOf ../core/has ../core/accessorSupport/decorators/cast ../core/Logger ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/subclass ./Widget ./Legend/LegendViewModel ./Legend/styles/Card ./Legend/styles/Classic ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory".split(" "),function(E,J,u,y,t,C,L,T,R,p,A,b,d,
g,r,m,G){C=function(K){function z(q,D){q=K.call(this,q,D)||this;q._handles=new u;q.activeLayerInfos=null;q.basemapLegendVisible=!1;q.groundLegendVisible=!1;q.headingLevel=3;q.hideLayersNotInCurrentView=!1;q.keepCacheOnDestroy=!1;q.respectLayerVisibility=!0;q.iconClass="esri-icon-layer-list";q.label=void 0;q.layerInfos=null;q.messages=null;q.style=new g;q.view=null;q.viewModel=new b;return q}E._inheritsLoose(z,K);var O=z.prototype;O.initialize=function(){this.own(y.on(this,"activeLayerInfos","change",
()=>this._refreshActiveLayerInfos(this.activeLayerInfos)),y.watch(this,"headingLevel",q=>{const {style:D}=this;D&&(D.headingLevel=q)}),y.init(this,"style",(q,D)=>{D&&q!==D&&D.destroy();q&&(q.activeLayerInfos=this.activeLayerInfos,"card"===q.type&&(q.view=this.view),q.headingLevel=this.headingLevel)}))};O.destroy=function(){this._handles.destroy();this._handles=null};O.castStyle=function(q){if(q instanceof d||q instanceof g)return q;if("string"===typeof q)return"card"===q?new d:new g;if(q&&"string"===
typeof q.type){const D={...q};delete D.type;return new ("card"===q.type?d:g)(D)}return new g};O.render=function(){return G.tsx("div",{class:this.classes("esri-legend","esri-widget",this.style instanceof g?"esri-widget--panel":null)},this.style.render())};O._refreshActiveLayerInfos=function(q){this._handles.removeAll();q.forEach(D=>this._renderOnActiveLayerInfoChange(D));this.scheduleRender()};O._renderOnActiveLayerInfoChange=function(q){var D=y.init(q,"version",()=>this.scheduleRender());this._handles.add(D,
`version_${q.layer.uid}`);D=y.on(q,"children","change",()=>{q.children.forEach(S=>this._renderOnActiveLayerInfoChange(S))});this._handles.add(D,`children_${q.layer.uid}`);q.children.forEach(S=>this._renderOnActiveLayerInfoChange(S))};return z}(A);J.__decorate([t.aliasOf("viewModel.activeLayerInfos")],C.prototype,"activeLayerInfos",void 0);J.__decorate([t.aliasOf("viewModel.basemapLegendVisible")],C.prototype,"basemapLegendVisible",void 0);J.__decorate([t.aliasOf("viewModel.groundLegendVisible")],
C.prototype,"groundLegendVisible",void 0);J.__decorate([R.property()],C.prototype,"headingLevel",void 0);J.__decorate([t.aliasOf("viewModel.hideLayersNotInCurrentView")],C.prototype,"hideLayersNotInCurrentView",void 0);J.__decorate([t.aliasOf("viewModel.keepCacheOnDestroy")],C.prototype,"keepCacheOnDestroy",void 0);J.__decorate([t.aliasOf("viewModel.respectLayerVisibility")],C.prototype,"respectLayerVisibility",void 0);J.__decorate([R.property()],C.prototype,"iconClass",void 0);J.__decorate([R.property({aliasOf:{source:"messages.widgetLabel",
overridable:!0}})],C.prototype,"label",void 0);J.__decorate([t.aliasOf("viewModel.layerInfos")],C.prototype,"layerInfos",void 0);J.__decorate([R.property(),m.messageBundle("esri/widgets/Legend/t9n/Legend")],C.prototype,"messages",void 0);J.__decorate([R.property()],C.prototype,"style",void 0);J.__decorate([L.cast("style")],C.prototype,"castStyle",null);J.__decorate([t.aliasOf("viewModel.view")],C.prototype,"view",void 0);J.__decorate([R.property()],C.prototype,"viewModel",void 0);return C=J.__decorate([p.subclass("esri.widgets.Legend")],
C)});