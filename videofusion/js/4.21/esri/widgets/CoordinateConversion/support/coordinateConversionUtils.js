// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.21/esri/copyright.txt for details.
//>>built
define("exports ../../../geometry ../../../core/Error ../../../core/maybe ../../../geometry/support/webMercatorUtils ../../../rest/support/ProjectParameters ../../../geometry/Point ../../../geometry/SpatialReference".split(" "),function(h,A,p,v,w,x,r,y){function t(a,b){b=u(b);return[a[0].toFixed(b),a[1].toFixed(b)]}function u(a){return 500<=a?6:500>a&&50<=a?7:50>a&&5<=a?8:9}function m(a){return"number"===typeof a&&isFinite(a)}function q(a){return a&&m(a.x)&&m(a.y)}function n(a,b){if(a.spatialReference.isGeographic&&
b){const [c,g]=t([a.x,a.y],b);return`${c}, ${g}`}return`${a.x.toFixed(3)}, ${a.y.toFixed(3)}`}const z={utm:{conversionMode:"utmDefault",addSpaces:!0},usng:{numOfDigits:5,rounding:!1,addSpaces:!1},mgrs:{rounding:!1}},l=Array(3);h.clipLonLat=t;h.fromGeoCoordinateString=function(a){const {geometryServicePromise:b,coordinate:c,spatialReference:g,formatName:e}=a;return b.then(k=>k.fromGeoCoordinateString({strings:[c],sr:g,conversionType:e}).then(d=>{const f=new r({x:d[0][0],y:d[0][1],spatialReference:g});
if(!q(f))throw d;return f}).catch(d=>{throw new p("coordinate-conversion:from-geo-coordinate-string-failed","Failed to convert coordinate notation",{notationResult:d});}))};h.fromXY=function(a,b){const c=0<=a.indexOf(",")?",":" ",[g,e,k]=a.split(c).map(d=>(d=d.trim())?Number(d):null);if(!m(g)||!m(e))return null;a=new r({x:g,y:e,spatialReference:b||y.WGS84});k&&(a.z=k,a.hasZ=!0);return a};h.getDegreePrecision=u;h.isSupportedNotation=function(a){return"dd"===a||"dms"===a||"ddm"===a||"mgrs"===a||"usng"===
a||"utm"===a};h.isValidPoint=q;h.pointToCoordinate=n;h.project=function(a,b){const {spatialReference:c,geometryServicePromise:g,location:e,scale:k}=a;if(!c||e.spatialReference.wkid===c.wkid)return Promise.resolve({location:e,coordinate:n(e,k)});a=w.project(e,c);if(v.isSome(a))return Promise.resolve({location:a,coordinate:n(a,k)});if(l[0]===e&&l[1]===c.wkid)return l[2];l[0]=e;l[1]=c.wkid;a=g.then(d=>d.project(new x({geometries:[e],outSpatialReference:c}),{signal:b}).then(f=>{if(!q(f[0]))throw f[0];
return{location:f[0],coordinate:n(f[0],k)}}).catch(f=>{throw new p("coordinate-conversion:projection-failed","Failed to project point",{projectionResult:f});}));return l[2]=a};h.toGeoCoordinateString=function(a){const {formatName:b,location:c,geometryServicePromise:g}=a,e={coordinates:[[c.x,c.y]],sr:c.spatialReference,conversionType:b,...z[b]||{}};return g.then(k=>k.toGeoCoordinateString(e).then(d=>{const f=d[0];if(!f)throw d;return f}).catch(d=>{throw new p("coordinate-conversion:to-geo-coordinate-string-failed",
"Failed to convert coordinate notation",{notationResult:d});}))};Object.defineProperty(h,"__esModule",{value:!0})});