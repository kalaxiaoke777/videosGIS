// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.21/esri/copyright.txt for details.
//>>built
define("exports ../../core/mathUtils ../../core/maybe ../../chunks/vec3 ../../chunks/vec3f64 ../../chunks/sphere ./vectorStacks".split(" "),function(e,H,I,f,q,z,n){function t(a=A){return[a[0],a[1],a[2],a[3]]}function B(a,b=t()){return x(a[0],a[1],a[2],a[3],b)}function x(a,b,c,d,h=t()){h[0]=a;h[1]=b;h[2]=c;h[3]=d;return h}function C(a,b,c){var d=b[0]*b[0]+b[1]*b[1]+b[2]*b[2];d=1E-5<Math.abs(d-1)&&1E-12<d?1/Math.sqrt(d):1;c[0]=b[0]*d;c[1]=b[1]*d;c[2]=b[2]*d;c[3]=-(c[0]*a[0]+c[1]*a[1]+c[2]*a[2]);return c}
function D(a,b,c,d=t()){var h=c[0]-b[0],g=c[1]-b[1],k=c[2]-b[2];c=a[0]-b[0];const E=a[1]-b[1],F=a[2]-b[2];b=g*F-k*E;k=k*c-h*F;h=h*E-g*c;g=b*b+k*k+h*h;g=1E-5<Math.abs(g-1)&&1E-12<g?1/Math.sqrt(g):1;d[0]=b*g;d[1]=k*g;d[2]=h*g;d[3]=-(d[0]*a[0]+d[1]*a[1]+d[2]*a[2])}function y(a,b,c,d,h){if(3>a.count)return!1;a.getVec(c,r);let g=d,k=!1;for(;g<a.count-1&&!k;)a.getVec(g,p),g++,k=!f.exactEquals(r,p);if(!k)return!1;g=Math.max(g,h);for(k=!1;g<a.count&&!k;)a.getVec(g,m),g++,f.subtract(u,r,p),f.normalize(u,u),
f.subtract(v,p,m),f.normalize(v,v),k=!f.exactEquals(r,m)&&!f.exactEquals(p,m)&&.99619469809>Math.abs(f.dot(u,v));if(!k)return 0===c&&1===d&&2===h?!1:y(a,b,0,1,2);D(r,p,m,b);return!0}function G(a,b,c){a=f.scale(n.sv3d.get(),a,f.dot(a,b));f.subtract(c,b,a);return c}function l(a,b){return f.dot(a,b)+a[3]}function w(a,b,c,d,h){const g=f.dot(a,c);if(0===g)return!1;a=-(f.dot(a,b)+a[3])/g;d&1&&(a=H.clamp(a,0,1));if(!(d&4)&&0>a||!(d&8)&&1<a)return!1;f.add(h,b,f.scale(h,c,a));return!0}const r=q.create(),p=
q.create(),m=q.create(),u=q.create(),v=q.create(),A=[0,0,1,0];e.UP=A;e.clip=function(a,b){const c=f.dot(a,b.ray.direction);a=-l(a,b.ray.origin);if(0>a&&0<=c)return!1;if(-1E-6<c&&1E-6>c)return 0<a;if((0>a||0>c)&&!(0>a&&0>c))return!0;a/=c;0<c?a<b.c1&&(b.c1=a):a>b.c0&&(b.c0=a);return b.c0<=b.c1};e.clipInfinite=function(a,b){const c=f.dot(a,b.ray.direction);a=-l(a,b.ray.origin);if(-1E-6<c&&1E-6>c)return 0<a;a/=c;0<c?a<b.c1&&(b.c1=a):a>b.c0&&(b.c0=a);return b.c0<=b.c1};e.copy=B;e.create=t;e.distance=function(a,
b){return Math.abs(l(a,b))};e.fromManyPoints=function(a,b){return y(a,b,0,1,2)};e.fromManyPointsSampleAt=y;e.fromNormalAndOffset=function(a,b,c){f.copy(c,a);c[3]=b;return c};e.fromPoints=D;e.fromPositionAndNormal=C;e.fromValues=x;e.fromVectorsAndPoint=function(a,b,c,d){f.cross(m,b,a);return C(c,m,d)};e.intersectLine=function(a,b,c,d){c=f.subtract(n.sv3d.get(),c,b);return w(a,b,c,12,d)};e.intersectLineSegment=function(a,b,c){return w(a,b.origin,b.vector,0,c)};e.intersectLineSegmentClamp=function(a,
b,c){return w(a,b.origin,b.vector,1,c)};e.intersectRay=function(a,b,c){return I.isSome(b)?w(a,b.origin,b.direction,8,c):!1};e.isAABBFullyInside=function(a,b){const c=b[0],d=b[1],h=b[2],g=b[3],k=b[4];b=b[5];return 0<=a[0]*(0<a[0]?c:g)+a[1]*(0<a[1]?d:k)+a[2]*(0<a[2]?h:b)+a[3]};e.isPointInside=function(a,b){return 0<=l(a,b)};e.isPointOutside=function(a,b){return 0>l(a,b)};e.isSphereFullyInside=function(a,b){return 0<=l(a,z.getCenter(b))-b[3]};e.isSphereFullyOutside=function(a,b){return 0>l(a,z.getCenter(b))+
b[3]};e.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=-a[3];return b};e.normal=function(a){return a};e.projectPoint=function(a,b,c){const d=f.scale(n.sv3d.get(),a,-a[3]);b=f.subtract(n.sv3d.get(),b,d);a=G(a,b,n.sv3d.get());f.add(c,a,d);return c};e.projectVector=G;e.setOffsetFromPoint=function(a,b,c){a!==c&&B(a,c);c[3]=-f.dot(c,b);return c};e.signedDistance=l;e.wrap=function(a,b,c,d){return x(a,b,c,d,n.sv4d.get())};Object.defineProperty(e,"__esModule",{value:!0})});