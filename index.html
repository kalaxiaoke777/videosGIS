<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>多视频融合地图系统</title>
    <!-- Cesium CSS -->
    <link
      href="https://cesium.com/downloads/cesiumjs/releases/1.118/Build/Cesium/Widgets/widgets.css"
      rel="stylesheet"
    />
    <!-- 自定义样式表 -->
    <link href="css/styles.css" rel="stylesheet" />
    <!-- Cesium JS -->
    <script src="https://cesium.com/downloads/cesiumjs/releases/1.118/Build/Cesium/Cesium.js"></script>
  </head>
  <body>
    <div id="cesiumContainer"></div>
    <!-- 顶部标题栏 -->
    <div id="titleBar">
      <h1>🎥 多视频融合地图系统</h1>
      <span class="status" id="statusText">就绪</span>
    </div>
    <!-- 左侧控制面板 -->
    <div id="controlPanel">
      <!-- 视频区域管理 -->
      <div class="panel-section">
        <h3>🎬 视频区域管理</h3>
        <button
          id="btnAddRegion"
          class="btn-primary"
          style="width: 100%; margin-bottom: 10px"
        >
          ➕ 新建视频区域
        </button>
        <div id="regionList" style="max-height: 250px; overflow-y: auto">
          <!-- 视频区域列表将动态插入这里 -->
          <div class="hint-text" style="margin: 0; text-align: center">
            暂无视频区域，点击上方按钮新建
          </div>
        </div>
      </div>
      <div class="panel-section">
        <h3>📍 区域绘制</h3>
        <div class="button-group">
          <button id="btnStartDraw" class="btn-primary" disabled>
            开始绘制
          </button>
          <button id="btnFinishDraw" class="btn-success" disabled>
            完成绘制
          </button>
        </div>
        <button
          id="btnAddPoint"
          class="btn-primary"
          style="width: 100%; margin-bottom: 10px"
          disabled
        >
          ➕ 添加点位
        </button>
        <button
          id="btnClearDraw"
          class="btn-danger"
          style="width: 100%"
          disabled
        >
          清除当前区域
        </button>
        <div
          style="
            margin-top: 10px;
            padding: 8px;
            background: #f0f4ff;
            border-radius: 4px;
          "
        >
          <label
            style="
              display: flex;
              align-items: center;
              cursor: pointer;
              font-size: 12px;
            "
          >
            <input
              type="checkbox"
              id="enableSnap"
              checked
              style="margin-right: 8px; cursor: pointer"
            />
            <span>🧲 启用边缘捕捉（拖动时自动吸附）</span>
          </label>
        </div>
        <span class="hint-text" id="drawHint">请先选择或新建一个视频区域</span>
      </div>

      <div class="panel-section">
        <h3>📊 状态信息</h3>
        <div class="info-item">
          <strong>当前区域:</strong>
          <span class="info-value" id="currentRegionName">未选择</span>
        </div>
        <div class="info-item">
          <strong>绘制点数:</strong>
          <span class="info-value" id="pointCount">0</span>
        </div>
        <div class="info-item">
          <strong>视频状态:</strong>
          <span class="info-value" id="videoStatus">未加载</span>
        </div>
        <div class="info-item">
          <strong>总区域数:</strong>
          <span class="info-value" id="totalRegions">0</span>
        </div>
      </div>

      <!-- 视频源选择 -->
      <div class="panel-section" id="videoSourceSection" style="display: none">
        <h3>🎞️ 视频源</h3>
        <div class="video-file-input">
          <label
            style="
              display: block;
              margin-bottom: 5px;
              font-size: 12px;
              font-weight: 600;
            "
            >选择视频文件:</label
          >
          <input
            type="file"
            id="videoFileInput"
            accept="video/*"
            style="font-size: 11px"
          />
          <div style="margin-top: 8px; font-size: 11px; color: #666">
            当前: <span id="currentVideoFile">data/data_clipped_30s.mp4</span>
          </div>
        </div>
      </div>

      <!-- 视频方向调节 -->
      <div class="panel-section" id="rotationSection" style="display: none">
        <h3>🔄 视频方向</h3>
        <div class="info-item">
          <strong>旋转角度:</strong>
          <span class="info-value" id="rotationValue">0°</span>
        </div>
        <input
          type="range"
          id="rotationSlider"
          min="0"
          max="360"
          value="0"
          step="1"
          style="width: 100%; margin-top: 10px"
        />
        <div
          style="
            display: flex;
            justify-content: space-between;
            font-size: 11px;
            color: #999;
            margin-top: 5px;
          "
        >
          <span>0°</span>
          <span>90°</span>
          <span>180°</span>
          <span>270°</span>
          <span>360°</span>
        </div>
        <button
          id="btnResetRotation"
          class="btn-primary"
          style="width: 100%; margin-top: 10px"
        >
          重置方向
        </button>
      </div>

      <div class="panel-section" id="pointListSection" style="display: none">
        <h3>📌 点位坐标</h3>
        <div id="pointList" style="max-height: 300px; overflow-y: auto">
          <!-- 点位列表将动态插入这里 -->
        </div>
      </div>

      <!-- 导入/导出 -->
      <div class="panel-section">
        <h3>⬇️/⬆️ 导入导出</h3>
        <div class="button-group">
          <button id="btnExport" class="btn-primary">导出配置</button>
          <button id="btnImport" class="btn-primary">导入配置</button>
        </div>
        <input
          type="file"
          id="importFileInput"
          accept=".json"
          style="display: none"
        />
        <div class="hint-text">
          导出将保存所有视频区域配置（包含点位、旋转角度、视频源等）；导入可恢复完整配置
        </div>
      </div>
    </div>

    <!-- 右侧视频预览 -->
    <div id="videoContainer">
      <h3>🎬 视频预览</h3>
      <video id="videoSource" muted loop playsinline controls>
        <source src="data/data_clipped_30s.mp4" type="video/mp4" />
      </video>
      <div id="videoInfo">
        <div class="info-item">
          <strong>分辨率:</strong>
          <span id="videoRes">-</span>
        </div>
        <div class="video-controls">
          <button id="btnPlayPause" class="btn-primary">播放/暂停</button>
          <button id="btnRestart" class="btn-primary">重新开始</button>
        </div>
      </div>
    </div>

    <!-- 应用脚本 -->
    <script src="js/app.js"></script>
  </body>
</html>
```
